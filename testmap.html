<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>Test GameMap</title>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<link rel="stylesheet" href="gamemap.css" />
	<script type="text/javascript" src="jquery-1.10.2.js"></script>
	<script type="text/javascript" src="common.js"></script>
	<script type="text/javascript" src="bounds.js"></script>
	<script type="text/javascript" src="mapoptions.js"></script>
	<script type="text/javascript" src="mapstate.js"></script>
	<script type="text/javascript" src="location.js"></script>
	<script type="text/javascript" src="world.js"></script>
	<script type="text/javascript" src="maptile.js"></script>
	<script type="text/javascript" src="gamemap.js"></script>
	<script type="text/javascript">

		var g_GameMap = null;
		var g_MapState = null;
		
		var g_DefaultMapOptions = {
				getMapTileFunction : getDefaultMapTile,
				wikiUrl: "http://www.uesp.net/wiki/",
				missingMapTile:  "http://content3.uesp.net/gamemap/blacknulltile.jpg",
				iconPath: "icons/",
				wikiNamespace: "UESPWiki"
		};
		
		var g_SRMapOptions = {
				//mapContainer : "#gmMap",
				//getMapTileFunction : getSkyrimMapTile,
				//iconPath: "icons/",
				//wikiUrl: "http://www.uesp.net/wiki/Skyrim:",
				
				missingMapTile:  "http://content3.uesp.net/maps2/srmap/color/nullimage.jpg",
				wikiNamespace: "Skyrim",
				
				zoomOffset : 9,
				initialGamePosX : 1000,
				initialGamePosY : 8000,
				initialZoom : 13,
				gamePosX1: -232000,
				gamePosX2: 290500,
				gamePosY1: 207000,
				gamePosY2: -315000
				//gamePosX1: -233472,
				//gamePosX2: 262144,
				//gamePosY1: 192512,
				//gamePosY2: -180224,
		};
		
		
		var g_DBMapOptions = {
				//mapContainer : "#gmMap",
				//getMapTileFunction : getDBMapTile,
				//iconPath: "icons/",
				//wikiUrl: "http://www.uesp.net/wiki/Dragonborn:",
				
				missingMapTile:  "http://content3.uesp.net/maps2/images/dboutofrange.jpg",
				wikiNamespace: "Dragonborn",
				
				zoomOffset : 8,
				initialGamePosX : 7000,
				initialGamePosY : 50000,
				initialZoom : 12,
				gamePosX1: -175960,
				gamePosX2: 838840,
				gamePosY1: 522880,
				gamePosY2: -515960,
				//gamePosX1: -40960,
				//gamePosX2: 163840,
				//gamePosY1: 122880,
				//gamePosY2: -40960,
		};

		$( document ).ready( function()
		{
			g_GameMap = new uesp.gamemap.Map('gmMap', g_DefaultMapOptions);
			
			g_GameMap.setOnMapWorldsLoaded( function()
			{
				this.setMapOptions(1, g_SRMapOptions);
				this.setMapOptions(2, g_DBMapOptions);
				
				mapState = this.getMapStateFromQuery(this.getWorldMapState(1));
				this.setMapState(mapState);
				
				uesp.logDebug(uesp.LOG_LEVEL_ERROR, "onMapWorldsLoaded");
				uesp.logDebug(uesp.LOG_LEVEL_ERROR, mapState);
				
				this.fillWorldList('#gmWorldSelect');
			});
		});
		
		
		function getDefaultMapTile(xPos, yPos, zoom, worldName)
		{
			if (worldName == 'skyrim')
				return getSkyrimMapTile(xPos, yPos, zoom, worldName);
			else if (worldName == 'dragonborn') 
				return getDBMapTile(xPos, yPos, zoom, worldName);
			else
				return getOtherMapTile(xPos, yPos, zoom, worldName);
		}
		
		function getOtherMapTile(xPos, yPos, zoom, worldName)
		{
			return "http://content3.uesp.net/gamemap/" + worldName + "/zoom" + zoom + "/" + worldName + "-" + xPos + "-" + yPos + ".jpg";
		}

		function getSkyrimMapTile(xPos, yPos, zoom, worldName)
		{
			return "http://content3.uesp.net/maps2/srmap/color/zoom" + zoom + "/skyrim-" + xPos + "-" + yPos + "-" + zoom + ".jpg";
		}
		
		function getDBMapTile(xPos, yPos, zoom, worldName)
		{
			return "http://content3.uesp.net/maps2/dbmap/zoom" + zoom + "/solstheim-" + xPos + "-" + yPos + "-" + zoom + ".jpg";
		}
		
		function onChangeWorld(element)
		{
			var result = element.options[element.selectedIndex].value;
			//alert(result);
			g_GameMap.changeWorld(result);
		}

	</script>
</head>
<body>

Map Tiles...
<a href="#" onClick="g_GameMap.zoomOut();">Zoom Out</a>
<a href="#" onClick="g_GameMap.zoomIn();">Zoom In</a>
<a href="#" onClick="g_GameMap.setGamePos(2000, 7000);">Set Pos Test</a>
<a href="#" onClick="g_GameMap.setGameZoom(16);">Set Zoom Test</a>
<a href="#" onClick="console.debug(g_GameMap.getGamePositionOfCenter());">Check Center Pos</a>
<a href="#" onClick="g_GameMap.getTilePositionOfCenter();">Check CenterTile Pos</a>
<a href="#" onClick="g_MapState = g_GameMap.getMapState();">Save State</a>
<a href="#" onClick="g_GameMap.setMapState(g_MapState);">Restore State</a>
<a href="#" onClick="g_GameMap.changeWorld('Skyrim');">Skyrim</a>
<a href="#" onClick="g_GameMap.changeWorld(2);">Dragonborn</a>
Worlds 
<select id="gmWorldSelect" onchange="onChangeWorld(this)">
<option value="1">Skyrim
<option value="2">Dragonborn
</select>

<div id="gmMap">
</div>

<div id="gmMapDebug">Debug Div</div>
</body>
</html>
