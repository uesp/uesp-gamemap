var app=function(){"use strict";function noop(){}const identity=t=>t;function assign(t,e){for(const n in e)t[n]=e[n];return t}function run(t){return t()}function blank_object(){return Object.create(null)}function run_all(t){t.forEach(run)}function is_function(t){return"function"==typeof t}function safe_not_equal(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let src_url_equal_anchor;function src_url_equal(t,e){return src_url_equal_anchor||(src_url_equal_anchor=document.createElement("a")),src_url_equal_anchor.href=e,t===src_url_equal_anchor.href}function is_empty(t){return 0===Object.keys(t).length}function create_slot(t,e,n,i){if(t){const o=get_slot_context(t,e,n,i);return t[0](o)}}function get_slot_context(t,e,n,i){return t[1]&&i?assign(n.ctx.slice(),t[1](i(e))):n.ctx}function get_slot_changes(t,e,n,i){if(t[2]&&i){const o=t[2](i(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let i=0;i<n;i+=1)t[i]=e.dirty[i]|o[i];return t}return e.dirty|o}return e.dirty}function update_slot_base(t,e,n,i,o,r){if(o){const s=get_slot_context(e,n,i,r);t.p(s,o)}}function get_all_dirty_from_scope(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function action_destroyer(t){return t&&is_function(t.destroy)?t.destroy:noop}function split_css_unit(t){const e="string"==typeof t&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const is_client="undefined"!=typeof window;let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?t=>requestAnimationFrame(t):noop;const tasks=new Set;function run_tasks(t){tasks.forEach((e=>{e.c(t)||(tasks.delete(e),e.f())})),0!==tasks.size&&raf(run_tasks)}function loop(t){let e;return 0===tasks.size&&raf(run_tasks),{promise:new Promise((n=>{tasks.add(e={c:t,f:n})})),abort(){tasks.delete(e)}}}const globals="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function append(t,e){t.appendChild(e)}function get_root_for_style(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function append_empty_stylesheet(t){const e=element("style");return append_stylesheet(get_root_for_style(t),e),e.sheet}function append_stylesheet(t,e){return append(t.head||t,e),e.sheet}function insert(t,e,n){t.insertBefore(e,n||null)}function detach(t){t.parentNode&&t.parentNode.removeChild(t)}function destroy_each(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function element(t){return document.createElement(t)}function svg_element(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function text(t){return document.createTextNode(t)}function space(){return text(" ")}function empty(){return text("")}function listen(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function attr(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function children(t){return Array.from(t.childNodes)}function set_data(t,e){e=""+e,t.data!==e&&(t.data=e)}function set_input_value(t,e){t.value=null==e?"":e}function set_style(t,e,n,i){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,i?"important":"")}let crossorigin;function is_crossorigin(){if(void 0===crossorigin){crossorigin=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){crossorigin=!0}}return crossorigin}function add_iframe_resize_listener(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=element("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const i=is_crossorigin();let o;return i?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=listen(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{o=listen(n.contentWindow,"resize",e),e()}),append(t,n),()=>{(i||o&&n.contentWindow)&&o(),detach(n)}}function toggle_class(t,e,n){t.classList[n?"add":"remove"](e)}function custom_event(t,e,{bubbles:n=!1,cancelable:i=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,i,e),o}const managed_styles=new Map;let active=0,current_component;function hash(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function create_style_information(t,e){const n={stylesheet:append_empty_stylesheet(e),rules:{}};return managed_styles.set(t,n),n}function create_rule(t,e,n,i,o,r,s,a=0){const l=16.666/i;let c="{\n";for(let t=0;t<=1;t+=l){const i=e+(n-e)*r(t);c+=100*t+`%{${s(i,1-i)}}\n`}const h=c+`100% {${s(n,1-n)}}\n}`,u=`__svelte_${hash(h)}_${a}`,d=get_root_for_style(t),{stylesheet:p,rules:_}=managed_styles.get(d)||create_style_information(d,t);_[u]||(_[u]=!0,p.insertRule(`@keyframes ${u} ${h}`,p.cssRules.length));const f=t.style.animation||"";return t.style.animation=`${f?`${f}, `:""}${u} ${i}ms linear ${o}ms 1 both`,active+=1,u}function delete_rule(t,e){const n=(t.style.animation||"").split(", "),i=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),o=n.length-i.length;o&&(t.style.animation=i.join(", "),active-=o,active||clear_rules())}function clear_rules(){raf((()=>{active||(managed_styles.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&detach(e)})),managed_styles.clear())}))}function set_current_component(t){current_component=t}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(t){get_current_component().$$.on_mount.push(t)}function onDestroy(t){get_current_component().$$.on_destroy.push(t)}function createEventDispatcher(){const t=get_current_component();return(e,n,{cancelable:i=!1}={})=>{const o=t.$$.callbacks[e];if(o){const r=custom_event(e,n,{cancelable:i});return o.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(t){render_callbacks.push(t)}function add_flush_callback(t){flush_callbacks.push(t)}const seen_callbacks=new Set;let flushidx=0,promise;function flush(){if(0!==flushidx)return;const t=current_component;do{try{for(;flushidx<dirty_components.length;){const t=dirty_components[flushidx];flushidx++,set_current_component(t),update(t.$$)}}catch(t){throw dirty_components.length=0,flushidx=0,t}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let t=0;t<render_callbacks.length;t+=1){const e=render_callbacks[t];seen_callbacks.has(e)||(seen_callbacks.add(e),e())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(t)}function update(t){if(null!==t.fragment){t.update(),run_all(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(add_render_callback)}}function flush_render_callbacks(t){const e=[],n=[];render_callbacks.forEach((i=>-1===t.indexOf(i)?e.push(i):n.push(i))),n.forEach((t=>t())),render_callbacks=e}function wait(){return promise||(promise=Promise.resolve(),promise.then((()=>{promise=null}))),promise}function dispatch(t,e,n){t.dispatchEvent(custom_event(`${e?"intro":"outro"}${n}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(t,e){t&&t.i&&(outroing.delete(t),t.i(e))}function transition_out(t,e,n,i){if(t&&t.o){if(outroing.has(t))return;outroing.add(t),outros.c.push((()=>{outroing.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}else i&&i()}const null_transition={duration:0};function create_in_transition(t,e,n){const i={direction:"in"};let o,r,s=e(t,n,i),a=!1,l=0;function c(){o&&delete_rule(t,o)}function h(){const{delay:e=0,duration:n=300,easing:i=identity,tick:h=noop,css:u}=s||null_transition;u&&(o=create_rule(t,0,1,n,e,i,u,l++)),h(0,1);const d=now()+e,p=d+n;r&&r.abort(),a=!0,add_render_callback((()=>dispatch(t,!0,"start"))),r=loop((e=>{if(a){if(e>=p)return h(1,0),dispatch(t,!0,"end"),c(),a=!1;if(e>=d){const t=i((e-d)/n);h(t,1-t)}}return a}))}let u=!1;return{start(){u||(u=!0,delete_rule(t),is_function(s)?(s=s(i),wait().then(h)):h())},invalidate(){u=!1},end(){a&&(c(),a=!1)}}}function create_out_transition(t,e,n){const i={direction:"out"};let o,r=e(t,n,i),s=!0;const a=outros;function l(){const{delay:e=0,duration:n=300,easing:i=identity,tick:l=noop,css:c}=r||null_transition;c&&(o=create_rule(t,1,0,n,e,i,c));const h=now()+e,u=h+n;add_render_callback((()=>dispatch(t,!1,"start"))),loop((e=>{if(s){if(e>=u)return l(0,1),dispatch(t,!1,"end"),--a.r||run_all(a.c),!1;if(e>=h){const t=i((e-h)/n);l(1-t,t)}}return s}))}return a.r+=1,is_function(r)?wait().then((()=>{r=r(i),l()})):l(),{end(e){e&&r.tick&&r.tick(1,0),s&&(o&&delete_rule(t,o),s=!1)}}}function outro_and_destroy_block(t,e){transition_out(t,1,1,(()=>{e.delete(t.key)}))}function update_keyed_each(t,e,n,i,o,r,s,a,l,c,h,u){let d=t.length,p=r.length,_=d;const f={};for(;_--;)f[t[_].key]=_;const m=[],g=new Map,v=new Map,y=[];for(_=p;_--;){const t=u(o,r,_),a=n(t);let l=s.get(a);l?i&&y.push((()=>l.p(t,e))):(l=c(a,t),l.c()),g.set(a,m[_]=l),a in f&&v.set(a,Math.abs(_-f[a]))}const b=new Set,k=new Set;function w(t){transition_in(t,1),t.m(a,h),s.set(t.key,t),h=t.first,p--}for(;d&&p;){const e=m[p-1],n=t[d-1],i=e.key,o=n.key;e===n?(h=e.first,d--,p--):g.has(o)?!s.has(i)||b.has(i)?w(e):k.has(o)?d--:v.get(i)>v.get(o)?(k.add(i),w(e)):(b.add(o),d--):(l(n,s),d--)}for(;d--;){const e=t[d];g.has(e.key)||l(e,s)}for(;p;)w(m[p-1]);return run_all(y),m}function get_spread_update(t,e){const n={},i={},o={$$scope:1};let r=t.length;for(;r--;){const s=t[r],a=e[r];if(a){for(const t in s)t in a||(i[t]=1);for(const t in a)o[t]||(n[t]=a[t],o[t]=1);t[r]=a}else for(const t in s)o[t]=1}for(const t in i)t in n||(n[t]=void 0);return n}function get_spread_object(t){return"object"==typeof t&&null!==t?t:{}}function bind(t,e,n){const i=t.$$.props[e];void 0!==i&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function create_component(t){t&&t.c()}function mount_component(t,e,n,i){const{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),i||add_render_callback((()=>{const e=t.$$.on_mount.map(run).filter(is_function);t.$$.on_destroy?t.$$.on_destroy.push(...e):run_all(e),t.$$.on_mount=[]})),r.forEach(add_render_callback)}function destroy_component(t,e){const n=t.$$;null!==n.fragment&&(flush_render_callbacks(n.after_update),run_all(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function make_dirty(t,e){-1===t.$$.dirty[0]&&(dirty_components.push(t),schedule_update(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function init(t,e,n,i,o,r,s,a=[-1]){const l=current_component;set_current_component(t);const c=t.$$={fragment:null,ctx:[],props:r,update:noop,not_equal:o,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:blank_object(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};s&&s(c.root);let h=!1;if(c.ctx=n?n(t,e.props||{},((e,n,...i)=>{const r=i.length?i[0]:n;return c.ctx&&o(c.ctx[e],c.ctx[e]=r)&&(!c.skip_bound&&c.bound[e]&&c.bound[e](r),h&&make_dirty(t,e)),n})):[],c.update(),h=!0,run_all(c.before_update),c.fragment=!!i&&i(c.ctx),e.target){if(e.hydrate){const t=children(e.target);c.fragment&&c.fragment.l(t),t.forEach(detach)}else c.fragment&&c.fragment.c();e.intro&&transition_in(t.$$.fragment),mount_component(t,e.target,e.anchor,e.customElement),flush()}set_current_component(l)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(t,e){if(!is_function(e))return noop;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!is_empty(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function getDefaults(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let defaults=getDefaults();function changeDefaults(t){defaults=t}const escapeTest=/[&<>"']/,escapeReplace=new RegExp(escapeTest.source,"g"),escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g"),escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=t=>escapeReplacements[t];function escape(t,e){if(e){if(escapeTest.test(t))return t.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(t))return t.replace(escapeReplaceNoEncode,getEscapeReplacement);return t}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function unescape$1(t){return t.replace(unescapeTest,((t,e)=>"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(t,e){t="string"==typeof t?t:t.source,e=e||"";const n={replace:(e,i)=>(i=(i=i.source||i).replace(caret,"$1"),t=t.replace(e,i),n),getRegex:()=>new RegExp(t,e)};return n}const nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(t,e,n){if(t){let t;try{t=decodeURIComponent(unescape$1(n)).replace(nonWordAndColonTest,"").toLowerCase()}catch(t){return null}if(0===t.indexOf("javascript:")||0===t.indexOf("vbscript:")||0===t.indexOf("data:"))return null}e&&!originIndependentUrl.test(n)&&(n=resolveUrl(e,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(t){return null}return n}const baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(t,e){baseUrls[" "+t]||(justDomain.test(t)?baseUrls[" "+t]=t+"/":baseUrls[" "+t]=rtrim(t,"/",!0));const n=-1===(t=baseUrls[" "+t]).indexOf(":");return"//"===e.substring(0,2)?n?e:t.replace(protocol,"$1")+e:"/"===e.charAt(0)?n?e:t.replace(domain,"$1")+e:t+e}const noopTest={exec:function(){}};function splitCells(t,e){const n=t.replace(/\|/g,((t,e,n)=>{let i=!1,o=e;for(;--o>=0&&"\\"===n[o];)i=!i;return i?"|":" |"})).split(/ \|/);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function rtrim(t,e,n){const i=t.length;if(0===i)return"";let o=0;for(;o<i;){const r=t.charAt(i-o-1);if(r!==e||n){if(r===e||!n)break;o++}else o++}return t.slice(0,i-o)}function findClosingBracket(t,e){if(-1===t.indexOf(e[1]))return-1;const n=t.length;let i=0,o=0;for(;o<n;o++)if("\\"===t[o])o++;else if(t[o]===e[0])i++;else if(t[o]===e[1]&&(i--,i<0))return o;return-1}function checkSanitizeDeprecation(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(t,e){if(e<1)return"";let n="";for(;e>1;)1&e&&(n+=t),e>>=1,t+=t;return n+t}function outputLink(t,e,n,i){const o=e.href,r=e.title?escape(e.title):null,s=t[1].replace(/\\([\[\]])/g,"$1");if("!"!==t[0].charAt(0)){i.state.inLink=!0;const t={type:"link",raw:n,href:o,title:r,text:s,tokens:i.inlineTokens(s)};return i.state.inLink=!1,t}return{type:"image",raw:n,href:o,title:r,text:escape(s)}}function indentCodeCompensation(t,e){const n=t.match(/^(\s+)(?:```)/);if(null===n)return e;const i=n[1];return e.split("\n").map((t=>{const e=t.match(/^\s+/);if(null===e)return t;const[n]=e;return n.length>=i.length?t.slice(i.length):t})).join("\n")}class Tokenizer{constructor(t){this.options=t||defaults}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const t=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:rtrim(t,"\n")}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const t=e[0],n=indentCodeCompensation(t,e[3]||"");return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline._escapes,"$1"):e[2],text:n}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let t=e[2].trim();if(/#$/.test(t)){const e=rtrim(t,"#");this.options.pedantic?t=e.trim():e&&!/ $/.test(e)||(t=e.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const t=e[0].replace(/^ *>[ \t]?/gm,""),n=this.lexer.state.top;this.lexer.state.top=!0;const i=this.lexer.blockTokens(t);return this.lexer.state.top=n,{type:"blockquote",raw:e[0],tokens:i,text:t}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n,i,o,r,s,a,l,c,h,u,d,p,_=e[1].trim();const f=_.length>1,m={type:"list",raw:"",ordered:f,start:f?+_.slice(0,-1):"",loose:!1,items:[]};_=f?`\\d{1,9}\\${_.slice(-1)}`:`\\${_}`,this.options.pedantic&&(_=f?_:"[*+-]");const g=new RegExp(`^( {0,3}${_})((?:[\t ][^\\n]*)?(?:\\n|$))`);for(;t&&(p=!1,e=g.exec(t))&&!this.rules.block.hr.test(t);){if(n=e[0],t=t.substring(n.length),c=e[2].split("\n",1)[0].replace(/^\t+/,(t=>" ".repeat(3*t.length))),h=t.split("\n",1)[0],this.options.pedantic?(r=2,d=c.trimLeft()):(r=e[2].search(/[^ ]/),r=r>4?1:r,d=c.slice(r),r+=e[1].length),a=!1,!c&&/^ *$/.test(h)&&(n+=h+"\n",t=t.substring(h.length+1),p=!0),!p){const e=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),i=new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),o=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),s=new RegExp(`^ {0,${Math.min(3,r-1)}}#`);for(;t&&(u=t.split("\n",1)[0],h=u,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!o.test(h))&&!s.test(h)&&!e.test(h)&&!i.test(t);){if(h.search(/[^ ]/)>=r||!h.trim())d+="\n"+h.slice(r);else{if(a)break;if(c.search(/[^ ]/)>=4)break;if(o.test(c))break;if(s.test(c))break;if(i.test(c))break;d+="\n"+h}a||h.trim()||(a=!0),n+=u+"\n",t=t.substring(u.length+1),c=h.slice(r)}}m.loose||(l?m.loose=!0:/\n *\n *$/.test(n)&&(l=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(d),i&&(o="[ ] "!==i[0],d=d.replace(/^\[[ xX]\] +/,""))),m.items.push({type:"list_item",raw:n,task:!!i,checked:o,loose:!1,text:d}),m.raw+=n}m.items[m.items.length-1].raw=n.trimRight(),m.items[m.items.length-1].text=d.trimRight(),m.raw=m.raw.trimRight();const v=m.items.length;for(s=0;s<v;s++)if(this.lexer.state.top=!1,m.items[s].tokens=this.lexer.blockTokens(m.items[s].text,[]),!m.loose){const t=m.items[s].tokens.filter((t=>"space"===t.type)),e=t.length>0&&t.some((t=>/\n.*\n/.test(t.raw)));m.loose=e}if(m.loose)for(s=0;s<v;s++)m.items[s].loose=!0;return m}}html(t){const e=this.rules.block.html.exec(t);if(e){const t={type:"html",raw:e[0],pre:!this.options.sanitizer&&("pre"===e[1]||"script"===e[1]||"style"===e[1]),text:e[0]};if(this.options.sanitize){const n=this.options.sanitizer?this.options.sanitizer(e[0]):escape(e[0]);t.type="paragraph",t.text=n,t.tokens=this.lexer.inline(n)}return t}}def(t){const e=this.rules.block.def.exec(t);if(e){const t=e[1].toLowerCase().replace(/\s+/g," "),n=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:i}}}table(t){const e=this.rules.block.table.exec(t);if(e){const t={type:"table",header:splitCells(e[1]).map((t=>({text:t}))),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(t.header.length===t.align.length){t.raw=e[0];let n,i,o,r,s=t.align.length;for(n=0;n<s;n++)/^ *-+: *$/.test(t.align[n])?t.align[n]="right":/^ *:-+: *$/.test(t.align[n])?t.align[n]="center":/^ *:-+ *$/.test(t.align[n])?t.align[n]="left":t.align[n]=null;for(s=t.rows.length,n=0;n<s;n++)t.rows[n]=splitCells(t.rows[n],t.header.length).map((t=>({text:t})));for(s=t.header.length,i=0;i<s;i++)t.header[i].tokens=this.lexer.inline(t.header[i].text);for(s=t.rows.length,i=0;i<s;i++)for(r=t.rows[i],o=0;o<r.length;o++)r[o].tokens=this.lexer.inline(r[o].text);return t}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:"="===e[2].charAt(0)?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const t="\n"===e[1].charAt(e[1].length-1)?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:escape(e[1])}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):escape(e[0]):e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const t=e[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t))return;const e=rtrim(t.slice(0,-1),"\\");if((t.length-e.length)%2==0)return}else{const t=findClosingBracket(e[2],"()");if(t>-1){const n=(0===e[0].indexOf("!")?5:4)+e[1].length+t;e[2]=e[2].substring(0,t),e[0]=e[0].substring(0,n).trim(),e[3]=""}}let n=e[2],i="";if(this.options.pedantic){const t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);t&&(n=t[1],i=t[3])}else i=e[3]?e[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(t)?n.slice(1):n.slice(1,-1)),outputLink(e,{href:n?n.replace(this.rules.inline._escapes,"$1"):n,title:i?i.replace(this.rules.inline._escapes,"$1"):i},e[0],this.lexer)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let t=(n[2]||n[1]).replace(/\s+/g," ");if(t=e[t.toLowerCase()],!t){const t=n[0].charAt(0);return{type:"text",raw:t,text:t}}return outputLink(n,t,n[0],this.lexer)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrong.lDelim.exec(t);if(!i)return;if(i[3]&&n.match(/[\p{L}\p{N}]/u))return;const o=i[1]||i[2]||"";if(!o||o&&(""===n||this.rules.inline.punctuation.exec(n))){const n=i[0].length-1;let o,r,s=n,a=0;const l="*"===i[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,e=e.slice(-1*t.length+n);null!=(i=l.exec(e));){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(r=o.length,i[3]||i[4]){s+=r;continue}if((i[5]||i[6])&&n%3&&!((n+r)%3)){a+=r;continue}if(s-=r,s>0)continue;r=Math.min(r,r+s+a);const e=t.slice(0,n+i.index+(i[0].length-o.length)+r);if(Math.min(n,r)%2){const t=e.slice(1,-1);return{type:"em",raw:e,text:t,tokens:this.lexer.inlineTokens(t)}}const l=e.slice(2,-2);return{type:"strong",raw:e,text:l,tokens:this.lexer.inlineTokens(l)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let t=e[2].replace(/\n/g," ");const n=/[^ ]/.test(t),i=/^ /.test(t)&&/ $/.test(t);return n&&i&&(t=t.substring(1,t.length-1)),t=escape(t,!0),{type:"codespan",raw:e[0],text:t}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t,e){const n=this.rules.inline.autolink.exec(t);if(n){let t,i;return"@"===n[2]?(t=escape(this.options.mangle?e(n[1]):n[1]),i="mailto:"+t):(t=escape(n[1]),i=t),{type:"link",raw:n[0],text:t,href:i,tokens:[{type:"text",raw:t,text:t}]}}}url(t,e){let n;if(n=this.rules.inline.url.exec(t)){let t,i;if("@"===n[2])t=escape(this.options.mangle?e(n[0]):n[0]),i="mailto:"+t;else{let e;do{e=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(e!==n[0]);t=escape(n[0]),i="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:t,href:i,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(t,e){const n=this.rules.inline.text.exec(t);if(n){let t;return t=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):escape(n[0]):n[0]:escape(this.options.smartypants?e(n[0]):n[0]),{type:"text",raw:n[0],text:t}}}}const block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex(),block.bullet=/(?:[*+-]|\d{1,9}[.)])/,block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex(),block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex(),block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex(),block.normal={...block},block.gfm={...block.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"},block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.pedantic={...block.normal,html:edit("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function smartypants(t){return t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function mangle(t){let e,n,i="";const o=t.length;for(e=0;e<o;e++)n=t.charCodeAt(e),Math.random()>.5&&(n="x"+n.toString(16)),i+="&#"+n+";";return i}inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex(),inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,inline.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,inline._comment=edit(block._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex(),inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex(),inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex(),inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex(),inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex(),inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex(),inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex(),inline.normal={...inline},inline.pedantic={...inline.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()},inline.gfm={...inline.normal,escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex(),inline.breaks={...inline.gfm,br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};class Lexer{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||defaults,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={block:block.normal,inline:inline.normal};this.options.pedantic?(e.block=block.pedantic,e.inline=inline.pedantic):this.options.gfm&&(e.block=block.gfm,this.options.breaks?e.inline=inline.breaks:e.inline=inline.gfm),this.tokenizer.rules=e}static get rules(){return{block:block,inline:inline}}static lex(t,e){return new Lexer(e).lex(t)}static lexInline(t,e){return new Lexer(e).inlineTokens(t)}lex(t){let e;for(t=t.replace(/\r\n|\r/g,"\n"),this.blockTokens(t,this.tokens);e=this.inlineQueue.shift();)this.inlineTokens(e.src,e.tokens);return this.tokens}blockTokens(t,e=[]){let n,i,o,r;for(t=this.options.pedantic?t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t.replace(/^( *)(\t+)/gm,((t,e,n)=>e+"    ".repeat(n.length)));t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((i=>!!(n=i.call({lexer:this},t,e))&&(t=t.substring(n.raw.length),e.push(n),!0)))))if(n=this.tokenizer.space(t))t=t.substring(n.raw.length),1===n.raw.length&&e.length>0?e[e.length-1].raw+="\n":e.push(n);else if(n=this.tokenizer.code(t))t=t.substring(n.raw.length),i=e[e.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?e.push(n):(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.fences(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.heading(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.hr(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.blockquote(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.list(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.html(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.def(t))t=t.substring(n.raw.length),i=e[e.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(i.raw+="\n"+n.raw,i.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.table(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.lheading(t))t=t.substring(n.raw.length),e.push(n);else{if(o=t,this.options.extensions&&this.options.extensions.startBlock){let e=1/0;const n=t.slice(1);let i;this.options.extensions.startBlock.forEach((function(t){i=t.call({lexer:this},n),"number"==typeof i&&i>=0&&(e=Math.min(e,i))})),e<1/0&&e>=0&&(o=t.substring(0,e+1))}if(this.state.top&&(n=this.tokenizer.paragraph(o)))i=e[e.length-1],r&&"paragraph"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(n),r=o.length!==t.length,t=t.substring(n.raw.length);else if(n=this.tokenizer.text(t))t=t.substring(n.raw.length),i=e[e.length-1],i&&"text"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(n);else if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}throw new Error(e)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){let n,i,o,r,s,a,l=t;if(this.tokens.links){const t=Object.keys(this.tokens.links);if(t.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(l));)t.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,r.index)+"["+repeatString("a",r[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,r.index)+"["+repeatString("a",r[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(r=this.tokenizer.rules.inline.escapedEmSt.exec(l));)l=l.slice(0,r.index+r[0].length-2)+"++"+l.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;t;)if(s||(a=""),s=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((i=>!!(n=i.call({lexer:this},t,e))&&(t=t.substring(n.raw.length),e.push(n),!0)))))if(n=this.tokenizer.escape(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.tag(t))t=t.substring(n.raw.length),i=e[e.length-1],i&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):e.push(n);else if(n=this.tokenizer.link(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.reflink(t,this.tokens.links))t=t.substring(n.raw.length),i=e[e.length-1],i&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):e.push(n);else if(n=this.tokenizer.emStrong(t,l,a))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.codespan(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.br(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.del(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.autolink(t,mangle))t=t.substring(n.raw.length),e.push(n);else if(this.state.inLink||!(n=this.tokenizer.url(t,mangle))){if(o=t,this.options.extensions&&this.options.extensions.startInline){let e=1/0;const n=t.slice(1);let i;this.options.extensions.startInline.forEach((function(t){i=t.call({lexer:this},n),"number"==typeof i&&i>=0&&(e=Math.min(e,i))})),e<1/0&&e>=0&&(o=t.substring(0,e+1))}if(n=this.tokenizer.inlineText(o,smartypants))t=t.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(a=n.raw.slice(-1)),s=!0,i=e[e.length-1],i&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):e.push(n);else if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}throw new Error(e)}}else t=t.substring(n.raw.length),e.push(n);return e}}class Renderer{constructor(t){this.options=t||defaults}code(t,e,n){const i=(e||"").match(/\S*/)[0];if(this.options.highlight){const e=this.options.highlight(t,i);null!=e&&e!==t&&(n=!0,t=e)}return t=t.replace(/\n$/,"")+"\n",i?'<pre><code class="'+this.options.langPrefix+escape(i)+'">'+(n?t:escape(t,!0))+"</code></pre>\n":"<pre><code>"+(n?t:escape(t,!0))+"</code></pre>\n"}blockquote(t){return`<blockquote>\n${t}</blockquote>\n`}html(t){return t}heading(t,e,n,i){if(this.options.headerIds){return`<h${e} id="${this.options.headerPrefix+i.slug(n)}">${t}</h${e}>\n`}return`<h${e}>${t}</h${e}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(t,e,n){const i=e?"ol":"ul";return"<"+i+(e&&1!==n?' start="'+n+'"':"")+">\n"+t+"</"+i+">\n"}listitem(t){return`<li>${t}</li>\n`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>\n`}table(t,e){return e&&(e=`<tbody>${e}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+e+"</table>\n"}tablerow(t){return`<tr>\n${t}</tr>\n`}tablecell(t,e){const n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,e,n){if(null===(t=cleanUrl(this.options.sanitize,this.options.baseUrl,t)))return n;let i='<a href="'+t+'"';return e&&(i+=' title="'+e+'"'),i+=">"+n+"</a>",i}image(t,e,n){if(null===(t=cleanUrl(this.options.sanitize,this.options.baseUrl,t)))return n;let i=`<img src="${t}" alt="${n}"`;return e&&(i+=` title="${e}"`),i+=this.options.xhtml?"/>":">",i}text(t){return t}}class TextRenderer{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,n){return""+n}image(t,e,n){return""+n}br(){return""}}class Slugger{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,e){let n=t,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[t];do{i++,n=t+"-"+i}while(this.seen.hasOwnProperty(n))}return e||(this.seen[t]=i,this.seen[n]=0),n}slug(t,e={}){const n=this.serialize(t);return this.getNextSafeSlug(n,e.dryrun)}}class Parser{constructor(t){this.options=t||defaults,this.options.renderer=this.options.renderer||new Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(t,e){return new Parser(e).parse(t)}static parseInline(t,e){return new Parser(e).parseInline(t)}parse(t,e=!0){let n,i,o,r,s,a,l,c,h,u,d,p,_,f,m,g,v,y,b,k="";const w=t.length;for(n=0;n<w;n++)if(u=t[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[u.type]&&(b=this.options.extensions.renderers[u.type].call({parser:this},u),!1!==b||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)))k+=b||"";else switch(u.type){case"space":continue;case"hr":k+=this.renderer.hr();continue;case"heading":k+=this.renderer.heading(this.parseInline(u.tokens),u.depth,unescape$1(this.parseInline(u.tokens,this.textRenderer)),this.slugger);continue;case"code":k+=this.renderer.code(u.text,u.lang,u.escaped);continue;case"table":for(c="",l="",r=u.header.length,i=0;i<r;i++)l+=this.renderer.tablecell(this.parseInline(u.header[i].tokens),{header:!0,align:u.align[i]});for(c+=this.renderer.tablerow(l),h="",r=u.rows.length,i=0;i<r;i++){for(a=u.rows[i],l="",s=a.length,o=0;o<s;o++)l+=this.renderer.tablecell(this.parseInline(a[o].tokens),{header:!1,align:u.align[o]});h+=this.renderer.tablerow(l)}k+=this.renderer.table(c,h);continue;case"blockquote":h=this.parse(u.tokens),k+=this.renderer.blockquote(h);continue;case"list":for(d=u.ordered,p=u.start,_=u.loose,r=u.items.length,h="",i=0;i<r;i++)m=u.items[i],g=m.checked,v=m.task,f="",m.task&&(y=this.renderer.checkbox(g),_?m.tokens.length>0&&"paragraph"===m.tokens[0].type?(m.tokens[0].text=y+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=y+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:y}):f+=y),f+=this.parse(m.tokens,_),h+=this.renderer.listitem(f,v,g);k+=this.renderer.list(h,d,p);continue;case"html":k+=this.renderer.html(u.text);continue;case"paragraph":k+=this.renderer.paragraph(this.parseInline(u.tokens));continue;case"text":for(h=u.tokens?this.parseInline(u.tokens):u.text;n+1<w&&"text"===t[n+1].type;)u=t[++n],h+="\n"+(u.tokens?this.parseInline(u.tokens):u.text);k+=e?this.renderer.paragraph(h):h;continue;default:{const t='Token with "'+u.type+'" type was not found.';if(this.options.silent)return void console.error(t);throw new Error(t)}}return k}parseInline(t,e){e=e||this.renderer;let n,i,o,r="";const s=t.length;for(n=0;n<s;n++)if(i=t[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]&&(o=this.options.extensions.renderers[i.type].call({parser:this},i),!1!==o||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)))r+=o||"";else switch(i.type){case"escape":case"text":r+=e.text(i.text);break;case"html":r+=e.html(i.text);break;case"link":r+=e.link(i.href,i.title,this.parseInline(i.tokens,e));break;case"image":r+=e.image(i.href,i.title,i.text);break;case"strong":r+=e.strong(this.parseInline(i.tokens,e));break;case"em":r+=e.em(this.parseInline(i.tokens,e));break;case"codespan":r+=e.codespan(i.text);break;case"br":r+=e.br();break;case"del":r+=e.del(this.parseInline(i.tokens,e));break;default:{const t='Token with "'+i.type+'" type was not found.';if(this.options.silent)return void console.error(t);throw new Error(t)}}return r}}class Hooks{constructor(t){this.options=t||defaults}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(t){return t}postprocess(t){return t}}function onError(t,e,n){return i=>{if(i.message+="\nPlease report this to https://github.com/markedjs/marked.",t){const t="<p>An error occurred:</p><pre>"+escape(i.message+"",!0)+"</pre>";return e?Promise.resolve(t):n?void n(null,t):t}if(e)return Promise.reject(i);if(!n)throw i;n(i)}}function parseMarkdown(t,e){return(n,i,o)=>{"function"==typeof i&&(o=i,i=null);const r={...i},s=onError((i={...marked.defaults,...r}).silent,i.async,o);if(null==n)return s(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof n)return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(checkSanitizeDeprecation(i),i.hooks&&(i.hooks.options=i),o){const r=i.highlight;let a;try{i.hooks&&(n=i.hooks.preprocess(n)),a=t(n,i)}catch(t){return s(t)}const l=function(t){let n;if(!t)try{i.walkTokens&&marked.walkTokens(a,i.walkTokens),n=e(a,i),i.hooks&&(n=i.hooks.postprocess(n))}catch(e){t=e}return i.highlight=r,t?s(t):o(null,n)};if(!r||r.length<3)return l();if(delete i.highlight,!a.length)return l();let c=0;return marked.walkTokens(a,(function(t){"code"===t.type&&(c++,setTimeout((()=>{r(t.text,t.lang,(function(e,n){if(e)return l(e);null!=n&&n!==t.text&&(t.text=n,t.escaped=!0),c--,0===c&&l()}))}),0))})),void(0===c&&l())}if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then((e=>t(e,i))).then((t=>i.walkTokens?Promise.all(marked.walkTokens(t,i.walkTokens)).then((()=>t)):t)).then((t=>e(t,i))).then((t=>i.hooks?i.hooks.postprocess(t):t)).catch(s);try{i.hooks&&(n=i.hooks.preprocess(n));const o=t(n,i);i.walkTokens&&marked.walkTokens(o,i.walkTokens);let r=e(o,i);return i.hooks&&(r=i.hooks.postprocess(r)),r}catch(t){return s(t)}}}function marked(t,e,n){return parseMarkdown(Lexer.lex,Parser.parse)(t,e,n)}marked.options=marked.setOptions=function(t){return marked.defaults={...marked.defaults,...t},changeDefaults(marked.defaults),marked},marked.getDefaults=getDefaults,marked.defaults=defaults,marked.use=function(...t){const e=marked.defaults.extensions||{renderers:{},childTokens:{}};t.forEach((t=>{const n={...t};if(n.async=marked.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach((t=>{if(!t.name)throw new Error("extension name required");if(t.renderer){const n=e.renderers[t.name];e.renderers[t.name]=n?function(...e){let i=t.renderer.apply(this,e);return!1===i&&(i=n.apply(this,e)),i}:t.renderer}if(t.tokenizer){if(!t.level||"block"!==t.level&&"inline"!==t.level)throw new Error("extension level must be 'block' or 'inline'");e[t.level]?e[t.level].unshift(t.tokenizer):e[t.level]=[t.tokenizer],t.start&&("block"===t.level?e.startBlock?e.startBlock.push(t.start):e.startBlock=[t.start]:"inline"===t.level&&(e.startInline?e.startInline.push(t.start):e.startInline=[t.start]))}t.childTokens&&(e.childTokens[t.name]=t.childTokens)})),n.extensions=e),t.renderer){const e=marked.defaults.renderer||new Renderer;for(const n in t.renderer){const i=e[n];e[n]=(...o)=>{let r=t.renderer[n].apply(e,o);return!1===r&&(r=i.apply(e,o)),r}}n.renderer=e}if(t.tokenizer){const e=marked.defaults.tokenizer||new Tokenizer;for(const n in t.tokenizer){const i=e[n];e[n]=(...o)=>{let r=t.tokenizer[n].apply(e,o);return!1===r&&(r=i.apply(e,o)),r}}n.tokenizer=e}if(t.hooks){const e=marked.defaults.hooks||new Hooks;for(const n in t.hooks){const i=e[n];Hooks.passThroughHooks.has(n)?e[n]=o=>{if(marked.defaults.async)return Promise.resolve(t.hooks[n].call(e,o)).then((t=>i.call(e,t)));const r=t.hooks[n].call(e,o);return i.call(e,r)}:e[n]=(...o)=>{let r=t.hooks[n].apply(e,o);return!1===r&&(r=i.apply(e,o)),r}}n.hooks=e}if(t.walkTokens){const e=marked.defaults.walkTokens;n.walkTokens=function(n){let i=[];return i.push(t.walkTokens.call(this,n)),e&&(i=i.concat(e.call(this,n))),i}}marked.setOptions(n)}))},marked.walkTokens=function(t,e){let n=[];for(const i of t)switch(n=n.concat(e.call(marked,i)),i.type){case"table":for(const t of i.header)n=n.concat(marked.walkTokens(t.tokens,e));for(const t of i.rows)for(const i of t)n=n.concat(marked.walkTokens(i.tokens,e));break;case"list":n=n.concat(marked.walkTokens(i.items,e));break;default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[i.type]?marked.defaults.extensions.childTokens[i.type].forEach((function(t){n=n.concat(marked.walkTokens(i[t],e))})):i.tokens&&(n=n.concat(marked.walkTokens(i.tokens,e)))}return n},marked.parseInline=parseMarkdown(Lexer.lexInline,Parser.parseInline),marked.Parser=Parser,marked.parser=Parser.parse,marked.Renderer=Renderer,marked.TextRenderer=TextRenderer,marked.Lexer=Lexer,marked.lexer=Lexer.lex,marked.Tokenizer=Tokenizer,marked.Slugger=Slugger,marked.Hooks=Hooks,marked.parse=marked,marked.options,marked.setOptions,marked.use,marked.walkTokens,marked.parseInline,Parser.parse,Lexer.lex;const ZERO=1e-4;class Point{constructor(t,e,n){this.x=t?isNaN(t)?ZERO:0!=t?Number(t):ZERO:ZERO,this.y=e?isNaN(e)?ZERO:0!=e?Number(e):ZERO:ZERO,this.coordType=n}toArray(){return[this.x,this.y]}}window.ASSETS_DIR="assets/",window.MAP_ASSETS_DIR="assets/maps/",window.CONFIG_DIR=ASSETS_DIR+"configs/",window.TEMPLATES_DIR=ASSETS_DIR+"templates/",window.ICONS_DIR=ASSETS_DIR+"icons/",window.IMAGES_DIR=ASSETS_DIR+"images/",window.PARAM_TYPE_QUERY=0,window.PARAM_TYPE_HASH=1,window.CSS_OVERRIDE_FILENAME="override.css",window.MAP_CONFIG_FILENAME="config.json",window.DEFAULT_MAP_CONFIG_DIR=MAP_ASSETS_DIR+"default-"+MAP_CONFIG_FILENAME,window.GAME_DATA_SCRIPT="db/gamemap.php",window.LOCTYPES={MARKER:1,PATH:2,AREA:3},window.COORD_TYPES={XY:0,NORMALISED:1,PSEUDO_NORMALISED:1.5,WORLDSPACE:2},window.EDIT_TYPES={0:"adding",1:"editing",2:"reverting",3:"deleting",ADD:0,EDIT:1,REVERT:2,DELETE:3},window.MAPLOCK={NONE:!1,FULL:1,PARTIAL:2,PARTIAL_MARKER:3,PARTIAL_NEW_MARKER:3.5,PARTIAL_POLYGON:4,PARTIAL_NEW_POLYGON:4.5,PARTIAL_NEW_LINE:5,isPartial:t=>t>=MAPLOCK.PARTIAL,isPartialNoNew:t=>MAPLOCK.isPartial(t)&&!Object.keys(MAPLOCK).find((e=>MAPLOCK[e]===t)).toLowerCase().includes("new")},window.LABEL_POSITIONS={0:"none",4:"left",5:"center",6:"right",2:"top",8:"bottom",10:"auto"};const MINUTE=60,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY,MONTH=30*DAY,YEAR=365*DAY;if(window.isMobile=function(){return navigator.userAgent.match(/Mobi/)},window.isFirefox=function(){return-1!==navigator.userAgent.indexOf("Firefox")},window.isChrome=function(){return null!=window.chrome},!isMobile()||location.toString().includes("localhost")||location.toString().includes("devgame")){window.addEventListener("beforeprint",(function(t){t.preventDefault()}));let t={};t=function(){},window.print=t,t=window.console.log=window.console.log.bind(window.console.log,"%c[Debug]%o","color: black; font-weight: bold; padding: 2px; background: aqua;"),t.warn=window.console.warn=window.console.warn.bind(window.console.warn,"%c[Warn]%o","color: black; font-weight: bold; padding: 2px; background: yellow;"),t.error=window.console.error=window.console.error.bind(window.console.error,"%c[Error]%o","color: black; font-weight: bold; padding: 2px; background: palevioletred ;"),window.print=t,window.print.warn=t.warn,window.print.error=t.error}else{let t={log:function(){}};window.console=t;let e=function(){};window.print=e,e=t.log.bind(t),window.print=function(){},window.print.warn=function(){},window.print.error=function(){},window.console.warn=function(){},t.warn=function(){}}function setCookie(t,e,n){null==n&&(n=999999);const i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);let o="expires="+i.toUTCString();document.cookie=t+"="+e+";"+o+";path=/;SameSite=Lax"}function getCookie(t){var e=" "+document.cookie,n=e.indexOf(" "+t+"=");if(-1==n)e=null;else{n=e.indexOf("=",n)+1;var i=e.indexOf(";",n);-1==i&&(i=e.length),e=unescape(e.substring(n,i))}return e}window.getJSON=function(t,e){return new Promise(((e,n)=>{try{fetch(t).then((t=>t.text())).then((t=>{try{e(JSON.parse(t.replace(/\\"|"(?:\\"|[^"])*"|(\/\/.*|\/\*[\s\S]*?\*\/)/g,((t,e)=>e?"":t))))}catch(t){console.error(t),n(t)}}))}catch(t){n(t)}}))},window.getURLParams=function(t){let e;return e=null==t||t==PARAM_TYPE_QUERY?location.search.replace("#?",""):location.hash.replace("#?",""),new URLSearchParams(e)},window.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},window.beginsWith=function(t,e){return t.substring(0,e.length)===e},window.mergeObjects=function(t,e){return{...t,...e}},window.square=function(t){return t*t},window.getUniqueListFrom=function(t,e){return[...new Map(t.map((t=>[t[e],t]))).values()]},window.RGBAtoHex=function(t){if(/^rgb/.test(t)){const e=t.replace(/^rgba?\(|\s+|\)$/g,"").split(",");let n=`#${((1<<24)+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1)}`;if(e[4]){n+=(Math.round(255)+65536).toString(16).substr(-2).toUpperCase()}return n}return t},window.nextPowerOfTwo=function(t){for(t-=1;0!=(t&t-1);)t&=t-1;return t<<1},window.isNull=function(t){return null==t},window.changeFavIcon=function(t){let e=document.querySelector("link[rel*='icon']")||document.createElement("link");e.type="image/png",e.rel="icon",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)},window.injectCSS=function(t){t=t+"?"+Math.random().toString(36).substr(2,10),document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="'+t+'" />')},window.queryify=function(t){let e="?",n=Object.entries(t);return n.forEach((function(t){e+=t[0]+"="+t[1],n.indexOf(t)+1<n.length&&(e+="&")})),e},window.objectify=function(t){const e=new URLSearchParams(t),n={};for(const t of e.keys())e.getAll(t).length>1?n[t]=e.getAll(t):n[t]=e.get(t);return n},window.setPrefs=function(t,e){setCookie(t,e)},window.getPrefs=function(t,e){if(e=null!=e&&e,getURLParams().has(t))return getURLParams().get(t);{let n=null!=getCookie(t)&&""!=getCookie(t)?getCookie(t):e;return setPrefs(t,n),!("string"==typeof n||n instanceof String)||"true"!=n.toLowerCase()&&"false"!=n.toLowerCase()?n:JSON.parse(n)}},window.isString=function(t){return"string"==typeof t||t instanceof String},window.getTimeAgo=function(t){const e=Math.round((Date.now()-Number(t))/1e3);if(e<MINUTE)return"Just now";let n,i="";[n,i]=e<HOUR?[MINUTE,"minute"]:e<DAY?[HOUR,"hour"]:e<WEEK?[DAY,"day"]:e<MONTH?[WEEK,"week"]:e<YEAR?[MONTH,"month"]:[YEAR,"year"];const o=Math.floor(e/n);return`${o} ${i}${o>1?"s":""} ago`},window.getClientLocale=function(){if("undefined"!=typeof Intl)try{return Intl.NumberFormat().resolvedOptions().locale}catch(t){console.error("Cannot get locale from Intl")}},window.UTCtoLocalDate=function(t){return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()))},Object.assign(String.prototype,{toSentenceCase(){return this.toLowerCase().replace(/\.\s*([a-z])|^[a-z]/gm,(t=>t.toUpperCase()))}}),String.prototype.toTitleCase=function(){return this.replace(/(^\w{1})|(\s+\w{1})/g,(t=>t.toUpperCase()))},window.encodeURI=function(t){return t?encodeURIComponent(t):""},window.polygonCenter=function(t){var e,n,i,o,r,s,a,l,c=t.length;for(s=a=l=0,e=0,n=c-1;e<c;n=e++)i=t[e],o=t[n],r=Number(i.y)*Number(o.x)-Number(o.y)*Number(i.x),a+=(Number(i.x)+Number(o.x))*r,l+=(Number(i.y)+Number(o.y))*r,s+=3*r;return 0===s?new Point(Number(t[0].x).toFixed(3),Number(t[0].y).toFixed(3),t[0].coordType):new Point(Number(a/s).toFixed(3),Number(l/s).toFixed(3),MAPCONFIG.coordType)},window.structuredClone=function(t){return JSON.parse(JSON.stringify(t))},window.deepClone=function(t){return Object.assign(Object.create(Object.getPrototypeOf(t)),t)},NodeList.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator],HTMLCollection.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t){var e={exports:{}};return t(e,e.exports),e.exports
/*!
     * Materialize v1.0.0 (http://materializecss.com)
     * Copyright 2014-2017 Materialize
     * MIT License (https://raw.githubusercontent.com/Dogfalo/materialize/master/LICENSE)
     */}function create_fragment$y(t){let e,n;const i=t[1].default,o=create_slot(i,t,t[0],null);return{c(){e=element("div"),o&&o.c(),attr(e,"class","preload_box svelte-344nji")},m(t,i){insert(t,e,i),o&&o.m(e,null),n=!0},p(t,[e]){o&&o.p&&(!n||1&e)&&update_slot_base(o,i,t,t[0],n?get_slot_changes(i,t[0],e,null):get_all_dirty_from_scope(t[0]),null)},i(t){n||(transition_in(o,t),n=!0)},o(t){transition_out(o,t),n=!1},d(t){t&&detach(e),o&&o.d(t)}}}function instance$x(t,e,n){let{$$slots:i={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,i]}createCommonjsModule((function(t,e){var n=function t(e,n,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,i)}if("value"in o)return o.value;var s=o.get;return void 0!==s?s.call(i):void 0},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}
/*! cash-dom 1.3.5, https://github.com/kenwheeler/cash @license MIT */window.cash=function(){var t,e=document,n=window,i=Array.prototype,o=i.slice,r=i.filter,s=i.push,a=function(){},l=function(t){return typeof t==typeof a&&t.call},c=function(t){return"string"==typeof t},h=/^#[\w-]*$/,u=/^\.[\w-]*$/,d=/<.+>/,p=/^\w+$/;function _(t,n){return n=n||e,u.test(t)?n.getElementsByClassName(t.slice(1)):p.test(t)?n.getElementsByTagName(t):n.querySelectorAll(t)}function f(n){if(!t){var i=(t=e.implementation.createHTMLDocument(null)).createElement("base");i.href=e.location.href,t.head.appendChild(i)}return t.body.innerHTML=n,t.body.childNodes}function m(t){"loading"!==e.readyState?t():e.addEventListener("DOMContentLoaded",t)}function g(t,i){if(!t)return this;if(t.cash&&t!==n)return t;var o,r=t,s=0;if(c(t))r=h.test(t)?e.getElementById(t.slice(1)):d.test(t)?f(t):_(t,i);else if(l(t))return m(t),this;if(!r)return this;if(r.nodeType||r===n)this[0]=r,this.length=1;else for(o=this.length=r.length;s<o;s++)this[s]=r[s];return this}function v(t,e){return new g(t,e)}var y=v.fn=v.prototype=g.prototype={cash:!0,length:0,push:s,splice:i.splice,map:i.map,init:g};function b(t,e){for(var n=t.length,i=0;i<n&&!1!==e.call(t[i],t[i],i,t);i++);}function k(t,e){var n=t&&(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector);return!!n&&n.call(t,e)}function w(t){return c(t)?k:t.cash?function(e){return t.is(e)}:function(t,e){return t===e}}function x(t){return v(o.call(t).filter((function(t,e,n){return n.indexOf(t)===e})))}Object.defineProperty(y,"constructor",{value:v}),v.parseHTML=f,v.noop=a,v.isFunction=l,v.isString=c,v.extend=y.extend=function(t){t=t||{};var e=o.call(arguments),n=e.length,i=1;for(1===e.length&&(t=this,i=0);i<n;i++)if(e[i])for(var r in e[i])e[i].hasOwnProperty(r)&&(t[r]=e[i][r]);return t},v.extend({merge:function(t,e){for(var n=+e.length,i=t.length,o=0;o<n;i++,o++)t[i]=e[o];return t.length=i,t},each:b,matches:k,unique:x,isArray:Array.isArray,isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}});var L=v.uid="_cash"+Date.now();function $(t){return t[L]=t[L]||{}}function M(t,e,n){return $(t)[e]=n}function C(t,e){var n=$(t);return void 0===n[e]&&(n[e]=t.dataset?t.dataset[e]:v(t).attr("data-"+e)),n[e]}function E(t,e){var n=$(t);n?delete n[e]:t.dataset?delete t.dataset[e]:v(t).removeAttr("data-"+name)}y.extend({data:function(t,e){if(c(t))return void 0===e?C(this[0],t):this.each((function(n){return M(n,t,e)}));for(var n in t)this.data(n,t[n]);return this},removeData:function(t){return this.each((function(e){return E(e,t)}))}});var P=/\S+/g;function T(t){return c(t)&&t.match(P)}function S(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}function O(t,e,n){t.classList?t.classList.add(e):n.indexOf(" "+e+" ")&&(t.className+=" "+e)}function D(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(e,"")}y.extend({addClass:function(t){var e=T(t);return e?this.each((function(t){var n=" "+t.className+" ";b(e,(function(e){O(t,e,n)}))})):this},attr:function(t,e){if(t){if(c(t))return void 0===e?this[0]?this[0].getAttribute?this[0].getAttribute(t):this[0][t]:void 0:this.each((function(n){n.setAttribute?n.setAttribute(t,e):n[t]=e}));for(var n in t)this.attr(n,t[n]);return this}},hasClass:function(t){var e=!1,n=T(t);return n&&n.length&&this.each((function(t){return!(e=S(t,n[0]))})),e},prop:function(t,e){if(c(t))return void 0===e?this[0][t]:this.each((function(n){n[t]=e}));for(var n in t)this.prop(n,t[n]);return this},removeAttr:function(t){return this.each((function(e){e.removeAttribute?e.removeAttribute(t):delete e[t]}))},removeClass:function(t){if(!arguments.length)return this.attr("class","");var e=T(t);return e?this.each((function(t){b(e,(function(e){D(t,e)}))})):this},removeProp:function(t){return this.each((function(e){delete e[t]}))},toggleClass:function(t,e){if(void 0!==e)return this[e?"addClass":"removeClass"](t);var n=T(t);return n?this.each((function(t){var e=" "+t.className+" ";b(n,(function(n){S(t,n)?D(t,n):O(t,n,e)}))})):this}}),y.extend({add:function(t,e){return x(v.merge(this,v(t,e)))},each:function(t){return b(this,t),this},eq:function(t){return v(this.get(t))},filter:function(t){if(!t)return this;var e=l(t)?t:w(t);return v(r.call(this,(function(n){return e(n,t)})))},first:function(){return this.eq(0)},get:function(t){return void 0===t?o.call(this):t<0?this[t+this.length]:this[t]},index:function(t){var e=t?v(t)[0]:this[0],n=t?this:v(e).parent().children();return o.call(n).indexOf(e)},last:function(){return this.eq(-1)}});var I,R,A=(I=/(?:^\w|[A-Z]|\b\w)/g,R=/[\s-_]+/g,function(t){return t.replace(I,(function(t,e){return t[0===e?"toLowerCase":"toUpperCase"]()})).replace(R,"")}),B=function(){var t={},e=document.createElement("div").style;return function(n){if(n=A(n),t[n])return t[n];var i=n.charAt(0).toUpperCase()+n.slice(1);return b((n+" "+["webkit","moz","ms","o"].join(i+" ")+i).split(" "),(function(i){if(i in e)return t[i]=n=t[n]=i,!1})),t[n]}}();function z(t,e){return parseInt(n.getComputedStyle(t[0],null)[e],10)||0}function N(t,e,n){var i=C(t,"_cashEvents")||M(t,"_cashEvents",{});i[e]=i[e]||[],i[e].push(n),t.addEventListener(e,n)}function j(t,e,n){var i,o=C(t,"_cashEvents"),r=o&&o[e];r&&(n?(t.removeEventListener(e,n),(i=r.indexOf(n))>=0&&r.splice(i,1)):(b(r,(function(n){t.removeEventListener(e,n)})),r=[]))}function F(t,e){return"&"+encodeURIComponent(t)+"="+encodeURIComponent(e).replace(/%20/g,"+")}function W(t){var e=[];return b(t.options,(function(t){t.selected&&e.push(t.value)})),e.length?e:null}function H(t){var e=t.selectedIndex;return e>=0?t.options[e].value:null}function G(t){var e=t.type;if(!e)return null;switch(e.toLowerCase()){case"select-one":return H(t);case"select-multiple":return W(t);case"radio":case"checkbox":return t.checked?t.value:null;default:return t.value?t.value:null}}function Z(t,e,n){if(n){var i=t.childNodes[0];t.insertBefore(e,i)}else t.appendChild(e)}function U(t,e,n){var i=c(e);i||!e.length?b(t,i?function(t){return t.insertAdjacentHTML(n?"afterbegin":"beforeend",e)}:function(t,i){return Z(t,0===i?e:e.cloneNode(!0),n)}):b(e,(function(e){return U(t,e,n)}))}v.prefixedProp=B,v.camelCase=A,y.extend({css:function(t,e){if(c(t))return t=B(t),arguments.length>1?this.each((function(n){return n.style[t]=e})):n.getComputedStyle(this[0])[t];for(var i in t)this.css(i,t[i]);return this}}),b(["Width","Height"],(function(t){var e=t.toLowerCase();y[e]=function(){return this[0].getBoundingClientRect()[e]},y["inner"+t]=function(){return this[0]["client"+t]},y["outer"+t]=function(e){return this[0]["offset"+t]+(e?z(this,"margin"+("Width"===t?"Left":"Top"))+z(this,"margin"+("Width"===t?"Right":"Bottom")):0)}})),y.extend({off:function(t,e){return this.each((function(n){return j(n,t,e)}))},on:function(t,e,n,i){var o;if(!c(t)){for(var r in t)this.on(r,e,t[r]);return this}return l(e)&&(n=e,e=null),"ready"===t?(m(n),this):(e&&(o=n,n=function(t){for(var n=t.target;!k(n,e);){if(n===this||null===n)return!1;n=n.parentNode}n&&o.call(n,t)}),this.each((function(e){var o=n;i&&(o=function(){n.apply(this,arguments),j(e,t,o)}),N(e,t,o)})))},one:function(t,e,n){return this.on(t,e,n,!0)},ready:m,trigger:function(t,e){if(document.createEvent){var n=document.createEvent("HTMLEvents");return n.initEvent(t,!0,!1),n=this.extend(n,e),this.each((function(t){return t.dispatchEvent(n)}))}}}),y.extend({serialize:function(){var t="";return b(this[0].elements||this,(function(e){if(!e.disabled&&"FIELDSET"!==e.tagName){var n=e.name;switch(e.type.toLowerCase()){case"file":case"reset":case"submit":case"button":break;case"select-multiple":var i=G(e);null!==i&&b(i,(function(e){t+=F(n,e)}));break;default:var o=G(e);null!==o&&(t+=F(n,o))}}})),t.substr(1)},val:function(t){return void 0===t?G(this[0]):this.each((function(e){return e.value=t}))}}),y.extend({after:function(t){return v(t).insertAfter(this),this},append:function(t){return U(this,t),this},appendTo:function(t){return U(v(t),this),this},before:function(t){return v(t).insertBefore(this),this},clone:function(){return v(this.map((function(t){return t.cloneNode(!0)})))},empty:function(){return this.html(""),this},html:function(t){if(void 0===t)return this[0].innerHTML;var e=t.nodeType?t[0].outerHTML:t;return this.each((function(t){return t.innerHTML=e}))},insertAfter:function(t){var e=this;return v(t).each((function(t,n){var i=t.parentNode,o=t.nextSibling;e.each((function(t){i.insertBefore(0===n?t:t.cloneNode(!0),o)}))})),this},insertBefore:function(t){var e=this;return v(t).each((function(t,n){var i=t.parentNode;e.each((function(e){i.insertBefore(0===n?e:e.cloneNode(!0),t)}))})),this},prepend:function(t){return U(this,t,!0),this},prependTo:function(t){return U(v(t),this,!0),this},remove:function(){return this.each((function(t){if(t.parentNode)return t.parentNode.removeChild(t)}))},text:function(t){return void 0===t?this[0].textContent:this.each((function(e){return e.textContent=t}))}});var q=e.documentElement;return y.extend({position:function(){var t=this[0];return{left:t.offsetLeft,top:t.offsetTop}},offset:function(){var t=this[0].getBoundingClientRect();return{top:t.top+n.pageYOffset-q.clientTop,left:t.left+n.pageXOffset-q.clientLeft}},offsetParent:function(){return v(this[0].offsetParent)}}),y.extend({children:function(t){var e=[];return this.each((function(t){s.apply(e,t.children)})),e=x(e),t?e.filter((function(e){return k(e,t)})):e},closest:function(t){return!t||this.length<1?v():this.is(t)?this.filter(t):this.parent().closest(t)},is:function(t){if(!t)return!1;var e=!1,n=w(t);return this.each((function(i){return!(e=n(i,t))})),e},find:function(t){if(!t||t.nodeType)return v(t&&this.has(t).length?t:null);var e=[];return this.each((function(n){s.apply(e,_(t,n))})),x(e)},has:function(t){var e=c(t)?function(e){return 0!==_(t,e).length}:function(e){return e.contains(t)};return this.filter(e)},next:function(){return v(this[0].nextElementSibling)},not:function(t){if(!t)return this;var e=w(t);return this.filter((function(n){return!e(n,t)}))},parent:function(){var t=[];return this.each((function(e){e&&e.parentNode&&t.push(e.parentNode)})),x(t)},parents:function(t){var n,i=[];return this.each((function(o){for(n=o;n&&n.parentNode&&n!==e.body.parentNode;)n=n.parentNode,(!t||t&&k(n,t))&&i.push(n)})),x(i)},prev:function(){return v(this[0].previousElementSibling)},siblings:function(t){var e=this.parent().children(t),n=this[0];return e.filter((function(t){return t!==n}))}}),v}();var a=function(){function t(e,n,i){s(this,t),n instanceof Element||console.error(Error(n+" is not an HTML Element"));var o=e.getInstance(n);o&&o.destroy(),this.el=n,this.$el=cash(n)}return i(t,null,[{key:"init",value:function(t,e,n){var i=null;if(e instanceof Element)i=new t(e,n);else if(e&&(e.jquery||e.cash||e instanceof NodeList)){for(var o=[],r=0;r<e.length;r++)o.push(new t(e[r],n));i=o}return i}}]),t}();!function(t){t.Package?M={}:t.M={},M.jQueryLoaded=!!t.jQuery}(window),e.nodeType||(!t.nodeType&&t.exports&&(e=t.exports=M),e.default=M),M.version="1.0.0",M.keys={TAB:9,ENTER:13,ESC:27,ARROW_UP:38,ARROW_DOWN:40},M.tabPressed=!1,M.keyDown=!1;document.addEventListener("keydown",(function(t){M.keyDown=!0,t.which!==M.keys.TAB&&t.which!==M.keys.ARROW_DOWN&&t.which!==M.keys.ARROW_UP||(M.tabPressed=!0)}),!0),document.addEventListener("keyup",(function(t){M.keyDown=!1,t.which!==M.keys.TAB&&t.which!==M.keys.ARROW_DOWN&&t.which!==M.keys.ARROW_UP||(M.tabPressed=!1)}),!0),document.addEventListener("focus",(function(t){M.keyDown&&document.body.classList.add("keyboard-focused")}),!0),document.addEventListener("blur",(function(t){document.body.classList.remove("keyboard-focused")}),!0),M.initializeJqueryWrapper=function(t,e,n){jQuery.fn[e]=function(i){if(t.prototype[i]){var o=Array.prototype.slice.call(arguments,1);if("get"===i.slice(0,3)){var r=this.first()[0][n];return r[i].apply(r,o)}return this.each((function(){var t=this[n];t[i].apply(t,o)}))}if("object"==typeof i||!i)return t.init(this,arguments[0]),this;jQuery.error("Method "+i+" does not exist on jQuery."+e)}},M.AutoInit=function(t){var e=t||document.body,n={Autocomplete:e.querySelectorAll(".autocomplete:not(.no-autoinit)"),Carousel:e.querySelectorAll(".carousel:not(.no-autoinit)"),Chips:e.querySelectorAll(".chips:not(.no-autoinit)"),Collapsible:e.querySelectorAll(".collapsible:not(.no-autoinit)"),Datepicker:e.querySelectorAll(".datepicker:not(.no-autoinit)"),Dropdown:e.querySelectorAll(".dropdown-trigger:not(.no-autoinit)"),Materialbox:e.querySelectorAll(".materialboxed:not(.no-autoinit)"),Modal:e.querySelectorAll(".modal:not(.no-autoinit)"),Parallax:e.querySelectorAll(".parallax:not(.no-autoinit)"),Pushpin:e.querySelectorAll(".pushpin:not(.no-autoinit)"),ScrollSpy:e.querySelectorAll(".scrollspy:not(.no-autoinit)"),FormSelect:e.querySelectorAll("select:not(.no-autoinit)"),Sidenav:e.querySelectorAll(".sidenav:not(.no-autoinit)"),Tabs:e.querySelectorAll(".tabs:not(.no-autoinit)"),TapTarget:e.querySelectorAll(".tap-target:not(.no-autoinit)"),Timepicker:e.querySelectorAll(".timepicker:not(.no-autoinit)"),Tooltip:e.querySelectorAll(".tooltipped:not(.no-autoinit)"),FloatingActionButton:e.querySelectorAll(".fixed-action-btn:not(.no-autoinit)")};for(var i in n){M[i].init(n[i])}},M.objectSelectorString=function(t){return((t.prop("tagName")||"")+(t.attr("id")||"")+(t.attr("class")||"")).replace(/\s/g,"")},M.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(),M.escapeHash=function(t){return t.replace(/(:|\.|\[|\]|,|=|\/)/g,"\\$1")},M.elementOrParentIsFixed=function(t){var e=$(t),n=e.add(e.parents()),i=!1;return n.each((function(){if("fixed"===$(this).css("position"))return i=!0,!1})),i},M.checkWithinContainer=function(t,e,n){var i={top:!1,right:!1,bottom:!1,left:!1},o=t.getBoundingClientRect(),r=t===document.body?Math.max(o.bottom,window.innerHeight):o.bottom,s=t.scrollLeft,a=t.scrollTop,l=e.left-s,c=e.top-a;return(l<o.left+n||l<n)&&(i.left=!0),(l+e.width>o.right-n||l+e.width>window.innerWidth-n)&&(i.right=!0),(c<o.top+n||c<n)&&(i.top=!0),(c+e.height>r-n||c+e.height>window.innerHeight-n)&&(i.bottom=!0),i},M.checkPossibleAlignments=function(t,e,n,i){var o={top:!0,right:!0,bottom:!0,left:!0,spaceOnTop:null,spaceOnRight:null,spaceOnBottom:null,spaceOnLeft:null},r="visible"===getComputedStyle(e).overflow,s=e.getBoundingClientRect(),a=Math.min(s.height,window.innerHeight),l=Math.min(s.width,window.innerWidth),c=t.getBoundingClientRect(),h=e.scrollLeft,u=e.scrollTop,d=n.left-h,p=n.top-u,_=n.top+c.height-u;return o.spaceOnRight=r?window.innerWidth-(c.left+n.width):l-(d+n.width),o.spaceOnRight<0&&(o.left=!1),o.spaceOnLeft=r?c.right-n.width:d-n.width+c.width,o.spaceOnLeft<0&&(o.right=!1),o.spaceOnBottom=r?window.innerHeight-(c.top+n.height+i):a-(p+n.height+i),o.spaceOnBottom<0&&(o.top=!1),o.spaceOnTop=r?c.bottom-(n.height+i):_-(n.height-i),o.spaceOnTop<0&&(o.bottom=!1),o},M.getOverflowParent=function(t){return null==t?null:t===document.body||"visible"!==getComputedStyle(t).overflow?t:M.getOverflowParent(t.parentElement)},M.getIdFromTrigger=function(t){var e=t.getAttribute("data-target");return e||(e=(e=t.getAttribute("href"))?e.slice(1):""),e},M.getDocumentScrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},M.getDocumentScrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0};
/**
     * Get time in ms
     * @license https://raw.github.com/jashkenas/underscore/master/LICENSE
     * @type {function}
     * @return {number}
     */
var l=Date.now||function(){return(new Date).getTime()};
/**
     * Returns a function, that, when invoked, will only be triggered at most once
     * during a given window of time. Normally, the throttled function will run
     * as much as it can, without ever going more than once per `wait` duration;
     * but if you'd like to disable the execution on the leading edge, pass
     * `{leading: false}`. To disable execution on the trailing edge, ditto.
     * @license https://raw.github.com/jashkenas/underscore/master/LICENSE
     * @param {function} func
     * @param {number} wait
     * @param {Object=} options
     * @returns {Function}
     */M.throttle=function(t,e,n){var i=void 0,o=void 0,r=void 0,s=null,a=0;n||(n={});var c=function(){a=!1===n.leading?0:l(),s=null,r=t.apply(i,o),i=o=null};return function(){var h=l();a||!1!==n.leading||(a=h);var u=e-(h-a);return i=this,o=arguments,u<=0?(clearTimeout(s),s=null,a=h,r=t.apply(i,o),i=o=null):s||!1===n.trailing||(s=setTimeout(c,u)),r}};var c={scope:{}};c.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){if(n.get||n.set)throw new TypeError("ES3 does not support getters and setters.");t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},c.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:void 0!==commonjsGlobal&&null!=commonjsGlobal?commonjsGlobal:t},c.global=c.getGlobal(commonjsGlobal),c.SYMBOL_PREFIX="jscomp_symbol_",c.initSymbol=function(){c.initSymbol=function(){},c.global.Symbol||(c.global.Symbol=c.Symbol)},c.symbolCounter_=0,c.Symbol=function(t){return c.SYMBOL_PREFIX+(t||"")+c.symbolCounter_++},c.initSymbolIterator=function(){c.initSymbol();var t=c.global.Symbol.iterator;t||(t=c.global.Symbol.iterator=c.global.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&c.defineProperty(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return c.arrayIterator(this)}}),c.initSymbolIterator=function(){}},c.arrayIterator=function(t){var e=0;return c.iteratorPrototype((function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}))},c.iteratorPrototype=function(t){return c.initSymbolIterator(),(t={next:t})[c.global.Symbol.iterator]=function(){return this},t},c.array=c.array||{},c.iteratorFromArray=function(t,e){c.initSymbolIterator(),t instanceof String&&(t+="");var n=0,i={next:function(){if(n<t.length){var o=n++;return{value:e(o,t[o]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i},c.polyfill=function(t,e,n,i){if(e){for(n=c.global,t=t.split("."),i=0;i<t.length-1;i++){var o=t[i];o in n||(n[o]={}),n=n[o]}(e=e(i=n[t=t[t.length-1]]))!=i&&null!=e&&c.defineProperty(n,t,{configurable:!0,writable:!0,value:e})}},c.polyfill("Array.prototype.keys",(function(t){return t||function(){return c.iteratorFromArray(this,(function(t){return t}))}}),"es6-impl","es3");var h=commonjsGlobal;M.anime=function(){function t(t){if(!z.col(t))try{return document.querySelectorAll(t)}catch(t){}}function e(t,e){for(var n=t.length,i=2<=arguments.length?arguments[1]:void 0,o=[],r=0;r<n;r++)if(r in t){var s=t[r];e.call(i,s,r,t)&&o.push(s)}return o}function n(t){return t.reduce((function(t,e){return t.concat(z.arr(e)?n(e):e)}),[])}function i(e){return z.arr(e)?e:(z.str(e)&&(e=t(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function o(t,e){return t.some((function(t){return t===e}))}function r(t){var e,n={};for(e in t)n[e]=t[e];return n}function s(t,e){var n,i=r(t);for(n in t)i[n]=e.hasOwnProperty(n)?e[n]:t[n];return i}function a(t,e){var n,i=r(t);for(n in e)i[n]=z.und(t[n])?e[n]:t[n];return i}function l(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n,i){return e+e+n+n+i+i}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+(t=parseInt(e[1],16))+","+parseInt(e[2],16)+","+(e=parseInt(e[3],16))+",1)"}function c(t){function e(t,e,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:.5>n?e:n<2/3?t+(e-t)*(2/3-n)*6:t}var n=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t);t=parseInt(n[1])/360;var i=parseInt(n[2])/100,o=parseInt(n[3])/100;if(n=n[4]||1,0==i)o=i=t=o;else{var r=.5>o?o*(1+i):o+i-o*i,s=2*o-r;o=e(s,r,t+1/3),i=e(s,r,t),t=e(s,r,t-1/3)}return"rgba("+255*o+","+255*i+","+255*t+","+n+")"}function u(t){if(t=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t))return t[2]}function d(t){return-1<t.indexOf("translate")||"perspective"===t?"px":-1<t.indexOf("rotate")||-1<t.indexOf("skew")?"deg":void 0}function p(t,e){return z.fnc(t)?t(e.target,e.id,e.total):t}function _(t,e){if(e in t.style)return getComputedStyle(t).getPropertyValue(e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())||"0"}function f(t,e){return z.dom(t)&&o(B,e)?"transform":z.dom(t)&&(t.getAttribute(e)||z.svg(t)&&t[e])?"attribute":z.dom(t)&&"transform"!==e&&_(t,e)?"css":null!=t[e]?"object":void 0}function m(t,n){var i=d(n);if(i=-1<n.indexOf("scale")?1:0+i,!(t=t.style.transform))return i;for(var o=[],r=[],s=[],a=/(\w+)\((.+?)\)/g;o=a.exec(t);)r.push(o[1]),s.push(o[2]);return t=e(s,(function(t,e){return r[e]===n})),t.length?t[0]:i}function g(t,e){switch(f(t,e)){case"transform":return m(t,e);case"css":return _(t,e);case"attribute":return t.getAttribute(e)}return t[e]||0}function v(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var i=u(t)||0;switch(e=parseFloat(e),t=parseFloat(t.replace(n[0],"")),n[0][0]){case"+":return e+t+i;case"-":return e-t+i;case"*":return e*t+i}}function y(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function b(t){t=t.points;for(var e,n=0,i=0;i<t.numberOfItems;i++){var o=t.getItem(i);0<i&&(n+=y(e,o)),e=o}return n}function k(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return 2*Math.PI*t.getAttribute("r");case"rect":return 2*t.getAttribute("width")+2*t.getAttribute("height");case"line":return y({x:t.getAttribute("x1"),y:t.getAttribute("y1")},{x:t.getAttribute("x2"),y:t.getAttribute("y2")});case"polyline":return b(t);case"polygon":var e=t.points;return b(t)+y(e.getItem(e.numberOfItems-1),e.getItem(0))}}function w(t,e){function n(n){return n=void 0===n?0:n,t.el.getPointAtLength(1<=e+n?e+n:0)}var i=n(),o=n(-1),r=n(1);switch(t.property){case"x":return i.x;case"y":return i.y;case"angle":return 180*Math.atan2(r.y-o.y,r.x-o.x)/Math.PI}}function x(t,e){var n,i=/-?\d*\.?\d+/g;if(n=z.pth(t)?t.totalLength:t,z.col(n))if(z.rgb(n)){var o=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(n);n=o?"rgba("+o[1]+",1)":n}else n=z.hex(n)?l(n):z.hsl(n)?c(n):void 0;else o=(o=u(n))?n.substr(0,n.length-o.length):n,n=e&&!/\s/g.test(n)?o+e:o;return{original:n+="",numbers:n.match(i)?n.match(i).map(Number):[0],strings:z.str(t)||e?n.split(i):[]}}function L(t){return e(t=t?n(z.arr(t)?t.map(i):i(t)):[],(function(t,e,n){return n.indexOf(t)===e}))}function $(t){var e=L(t);return e.map((function(t,n){return{target:t,id:n,total:e.length}}))}function M(t,e){var n=r(e);if(z.arr(t)){var o=t.length;2!==o||z.obj(t[0])?z.fnc(e.duration)||(n.duration=e.duration/o):t={value:t}}return i(t).map((function(t,n){return n=n?0:e.delay,t=z.obj(t)&&!z.pth(t)?t:{value:t},z.und(t.delay)&&(t.delay=n),t})).map((function(t){return a(t,n)}))}function C(t,e){var n,i={};for(n in t){var o=p(t[n],e);z.arr(o)&&(o=o.map((function(t){return p(t,e)})),1===o.length&&(o=o[0])),i[n]=o}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function E(t){return z.arr(t)?N.apply(this,t):j[t]}function P(t,e){var n;return t.tweens.map((function(i){var o=(i=C(i,e)).value,r=g(e.target,t.name),s=n?n.to.original:r,a=(s=z.arr(o)?o[0]:s,v(z.arr(o)?o[1]:o,s));return r=u(a)||u(s)||u(r),i.from=x(s,r),i.to=x(a,r),i.start=n?n.end:t.offset,i.end=i.start+i.delay+i.duration,i.easing=E(i.easing),i.elasticity=(1e3-Math.min(Math.max(i.elasticity,1),999))/1e3,i.isPath=z.pth(o),i.isColor=z.col(i.from.original),i.isColor&&(i.round=1),n=i}))}function T(t,i){return e(n(t.map((function(t){return i.map((function(e){var n=f(t.target,e.name);if(n){var i=P(e,t);e={type:n,property:e.name,animatable:t,tweens:i,duration:i[i.length-1].end,delay:i[0].delay}}else e=void 0;return e}))}))),(function(t){return!z.und(t)}))}function S(t,e,n,i){var o="delay"===t;return e.length?(o?Math.min:Math.max).apply(Math,e.map((function(e){return e[t]}))):o?i.delay:n.offset+i.delay+i.duration}function O(t){var e,n=s(R,t),i=s(A,t),o=$(t.targets),r=[],l=a(n,i);for(e in t)l.hasOwnProperty(e)||"targets"===e||r.push({name:e,offset:l.offset,tweens:M(t[e],i)});return a(n,{children:[],animatables:o,animations:t=T(o,r),duration:S("duration",t,n,i),delay:S("delay",t,n,i)})}function D(t){function n(){return window.Promise&&new Promise((function(t){return u=t}))}function i(t){return p.reversed?p.duration-t:t}function o(t){for(var n=0,i={},o=p.animations,r=o.length;n<r;){var s=o[n],a=s.animatable,l=(c=s.tweens)[d=c.length-1];d&&(l=e(c,(function(e){return t<e.end}))[0]||l);for(var c=Math.min(Math.max(t-l.start-l.delay,0),l.duration)/l.duration,h=isNaN(c)?1:l.easing(c,l.elasticity),u=(c=l.to.strings,l.round),d=[],f=void 0,m=(f=l.to.numbers.length,0);m<f;m++){var g=void 0,v=(g=l.to.numbers[m],l.from.numbers[m]);g=l.isPath?w(l.value,h*g):v+h*(g-v),u&&(l.isColor&&2<m||(g=Math.round(g*u)/u)),d.push(g)}if(l=c.length)for(f=c[0],h=0;h<l;h++)u=c[h+1],m=d[h],isNaN(m)||(f=u?f+(m+u):f+(m+" "));else f=d[0];F[s.type](a.target,s.property,f,i,a.id),s.currentValue=f,n++}if(n=Object.keys(i).length)for(o=0;o<n;o++)I||(I=_(document.body,"transform")?"transform":"-webkit-transform"),p.animatables[o].target.style[I]=i[o].join(" ");p.currentTime=t,p.progress=t/p.duration*100}function r(t){p[t]&&p[t](p)}function s(){p.remaining&&!0!==p.remaining&&p.remaining--}function a(t){var e=p.duration,a=p.offset,_=a+p.delay,f=p.currentTime,m=p.reversed,g=i(t);if(p.children.length){var v=p.children,y=v.length;if(g>=p.currentTime)for(var b=0;b<y;b++)v[b].seek(g);else for(;y--;)v[y].seek(g)}(g>=_||!e)&&(p.began||(p.began=!0,r("begin")),r("run")),g>a&&g<e?o(g):(g<=a&&0!==f&&(o(0),m&&s()),(g>=e&&f!==e||!e)&&(o(e),m||s())),r("update"),t>=e&&(p.remaining?(c=l,"alternate"===p.direction&&(p.reversed=!p.reversed)):(p.pause(),p.completed||(p.completed=!0,r("complete"),"Promise"in window&&(u(),d=n()))),h=0)}t=void 0===t?{}:t;var l,c,h=0,u=null,d=n(),p=O(t);return p.reset=function(){var t=p.direction,e=p.loop;for(p.currentTime=0,p.progress=0,p.paused=!0,p.began=!1,p.completed=!1,p.reversed="reverse"===t,p.remaining="alternate"===t&&1===e?2:e,o(0),t=p.children.length;t--;)p.children[t].reset()},p.tick=function(t){l=t,c||(c=l),a((h+l-c)*D.speed)},p.seek=function(t){a(i(t))},p.pause=function(){var t=W.indexOf(p);-1<t&&W.splice(t,1),p.paused=!0},p.play=function(){p.paused&&(p.paused=!1,c=0,h=i(p.currentTime),W.push(p),H||G())},p.reverse=function(){p.reversed=!p.reversed,c=0,h=i(p.currentTime)},p.restart=function(){p.pause(),p.reset(),p.play()},p.finished=d,p.reset(),p.autoplay&&p.play(),p}var I,R={update:void 0,begin:void 0,run:void 0,complete:void 0,loop:1,direction:"normal",autoplay:!0,offset:0},A={duration:1e3,delay:0,easing:"easeOutElastic",elasticity:500,round:0},B="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY perspective".split(" "),z={arr:function(t){return Array.isArray(t)},obj:function(t){return-1<Object.prototype.toString.call(t).indexOf("Object")},pth:function(t){return z.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},dom:function(t){return t.nodeType||z.svg(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return z.hex(t)||z.rgb(t)||z.hsl(t)}},N=function(){function t(t,e,n){return(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t}return function(e,n,i,o){if(0<=e&&1>=e&&0<=i&&1>=i){var r=new Float32Array(11);if(e!==n||i!==o)for(var s=0;11>s;++s)r[s]=t(.1*s,e,i);return function(s){if(e===n&&i===o)return s;if(0===s)return 0;if(1===s)return 1;for(var a=0,l=1;10!==l&&r[l]<=s;++l)a+=.1;--l,l=a+(s-r[l])/(r[l+1]-r[l])*.1;var c=3*(1-3*i+3*e)*l*l+2*(3*i-6*e)*l+3*e;if(.001<=c){for(a=0;4>a&&0!=(c=3*(1-3*i+3*e)*l*l+2*(3*i-6*e)*l+3*e);++a){var h=t(l,e,i)-s;l-=h/c}s=l}else if(0===c)s=l;else{l=a,a+=.1;var u=0;do{0<(c=t(h=l+(a-l)/2,e,i)-s)?a=h:l=h}while(1e-7<Math.abs(c)&&10>++u);s=h}return t(s,n,o)}}}}(),j=function(){function t(t,e){return 0===t||1===t?t:-Math.pow(2,10*(t-1))*Math.sin(2*(t-1-e/(2*Math.PI)*Math.asin(1))*Math.PI/e)}var e,n="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),i={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],t],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(e,n){return 1-t(1-e,n)}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(e,n){return.5>e?t(2*e,n)/2:1-t(-2*e+2,n)/2}]},o={linear:N(.25,.25,.75,.75)},r={};for(e in i)r.type=e,i[r.type].forEach(function(t){return function(e,i){o["ease"+t.type+n[i]]=z.fnc(e)?e:N.apply(h,e)}}(r)),r={type:r.type};return o}(),F={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,i,o){i[o]||(i[o]=[]),i[o].push(e+"("+n+")")}},W=[],H=0,G=function(){function t(){H=requestAnimationFrame(e)}function e(e){var n=W.length;if(n){for(var i=0;i<n;)W[i]&&W[i].tick(e),i++;t()}else cancelAnimationFrame(H),H=0}return t}();return D.version="2.2.0",D.speed=1,D.running=W,D.remove=function(t){t=L(t);for(var e=W.length;e--;)for(var n=W[e],i=n.animations,r=i.length;r--;)o(t,i[r].animatable.target)&&(i.splice(r,1),i.length||n.pause())},D.getValue=g,D.path=function(e,n){var i=z.str(e)?t(e)[0]:e,o=n||100;return function(t){return{el:i,property:t,totalLength:k(i)*(o/100)}}},D.setDashoffset=function(t){var e=k(t);return t.setAttribute("stroke-dasharray",e),e},D.bezier=N,D.easings=j,D.timeline=function(t){var e=D(t);return e.pause(),e.duration=0,e.add=function(n){return e.children.forEach((function(t){t.began=!0,t.completed=!0})),i(n).forEach((function(n){var i=a(n,s(A,t||{}));i.targets=i.targets||t.targets,n=e.duration;var o=i.offset;i.autoplay=!1,i.direction=e.direction,i.offset=z.und(o)?n:v(o,n),e.began=!0,e.completed=!0,e.seek(i.offset),(i=D(i)).began=!0,i.completed=!0,i.duration>n&&(e.duration=i.duration),e.children.push(i)})),e.seek(0),e.reset(),e.autoplay&&e.restart(),e},e},D.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},D}(),function(t,e){var l={accordion:!0,onOpenStart:void 0,onOpenEnd:void 0,onCloseStart:void 0,onCloseEnd:void 0,inDuration:300,outDuration:300},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));i.el.M_Collapsible=i,i.options=t.extend({},c.defaults,n),i.$headers=i.$el.children("li").children(".collapsible-header"),i.$headers.attr("tabindex",0),i._setupEventHandlers();var r=i.$el.children("li.active").children(".collapsible-body");return i.options.accordion?r.first().css("display","block"):r.css("display","block"),i}return r(c,a),i(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_Collapsible=void 0}},{key:"_setupEventHandlers",value:function(){var t=this;this._handleCollapsibleClickBound=this._handleCollapsibleClick.bind(this),this._handleCollapsibleKeydownBound=this._handleCollapsibleKeydown.bind(this),this.el.addEventListener("click",this._handleCollapsibleClickBound),this.$headers.each((function(e){e.addEventListener("keydown",t._handleCollapsibleKeydownBound)}))}},{key:"_removeEventHandlers",value:function(){var t=this;this.el.removeEventListener("click",this._handleCollapsibleClickBound),this.$headers.each((function(e){e.removeEventListener("keydown",t._handleCollapsibleKeydownBound)}))}},{key:"_handleCollapsibleClick",value:function(e){var n=t(e.target).closest(".collapsible-header");if(e.target&&n.length){var i=n.closest(".collapsible");if(i[0]===this.el){var o=n.closest("li"),r=i.children("li"),s=o[0].classList.contains("active"),a=r.index(o);s?this.close(a):this.open(a)}}}},{key:"_handleCollapsibleKeydown",value:function(t){13===t.keyCode&&this._handleCollapsibleClickBound(t)}},{key:"_animateIn",value:function(t){var n=this,i=this.$el.children("li").eq(t);if(i.length){var o=i.children(".collapsible-body");e.remove(o[0]),o.css({display:"block",overflow:"hidden",height:0,paddingTop:"",paddingBottom:""});var r=o.css("padding-top"),s=o.css("padding-bottom"),a=o[0].scrollHeight;o.css({paddingTop:0,paddingBottom:0}),e({targets:o[0],height:a,paddingTop:r,paddingBottom:s,duration:this.options.inDuration,easing:"easeInOutCubic",complete:function(t){o.css({overflow:"",paddingTop:"",paddingBottom:"",height:""}),"function"==typeof n.options.onOpenEnd&&n.options.onOpenEnd.call(n,i[0])}})}}},{key:"_animateOut",value:function(t){var n=this,i=this.$el.children("li").eq(t);if(i.length){var o=i.children(".collapsible-body");e.remove(o[0]),o.css("overflow","hidden"),e({targets:o[0],height:0,paddingTop:0,paddingBottom:0,duration:this.options.outDuration,easing:"easeInOutCubic",complete:function(){o.css({height:"",overflow:"",padding:"",display:""}),"function"==typeof n.options.onCloseEnd&&n.options.onCloseEnd.call(n,i[0])}})}}},{key:"open",value:function(e){var n=this,i=this.$el.children("li").eq(e);if(i.length&&!i[0].classList.contains("active")){if("function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,i[0]),this.options.accordion){var o=this.$el.children("li");this.$el.children("li.active").each((function(e){var i=o.index(t(e));n.close(i)}))}i[0].classList.add("active"),this._animateIn(e)}}},{key:"close",value:function(t){var e=this.$el.children("li").eq(t);e.length&&e[0].classList.contains("active")&&("function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,e[0]),e[0].classList.remove("active"),this._animateOut(t))}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Collapsible}},{key:"defaults",get:function(){return l}}]),c}(a);M.Collapsible=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"collapsible","M_Collapsible")}(cash,M.anime),function(t,e){var l={alignment:"left",autoFocus:!0,constrainWidth:!0,container:null,coverTrigger:!0,closeOnClick:!0,hover:!1,inDuration:150,outDuration:250,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,onItemClick:null},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_Dropdown=i,c._dropdowns.push(i),i.id=M.getIdFromTrigger(e),i.dropdownEl=document.getElementById(i.id),i.$dropdownEl=t(i.dropdownEl),i.options=t.extend({},c.defaults,n),i.isOpen=!1,i.isScrollable=!1,i.isTouchMoving=!1,i.focusedIndex=-1,i.filterQuery=[],i.options.container?t(i.options.container).append(i.dropdownEl):i.$el.after(i.dropdownEl),i._makeDropdownFocusable(),i._resetFilterQueryBound=i._resetFilterQuery.bind(i),i._handleDocumentClickBound=i._handleDocumentClick.bind(i),i._handleDocumentTouchmoveBound=i._handleDocumentTouchmove.bind(i),i._handleDropdownClickBound=i._handleDropdownClick.bind(i),i._handleDropdownKeydownBound=i._handleDropdownKeydown.bind(i),i._handleTriggerKeydownBound=i._handleTriggerKeydown.bind(i),i._setupEventHandlers(),i}return r(c,a),i(c,[{key:"destroy",value:function(){this._resetDropdownStyles(),this._removeEventHandlers(),c._dropdowns.splice(c._dropdowns.indexOf(this),1),this.el.M_Dropdown=void 0}},{key:"_setupEventHandlers",value:function(){this.el.addEventListener("keydown",this._handleTriggerKeydownBound),this.dropdownEl.addEventListener("click",this._handleDropdownClickBound),this.options.hover?(this._handleMouseEnterBound=this._handleMouseEnter.bind(this),this.el.addEventListener("mouseenter",this._handleMouseEnterBound),this._handleMouseLeaveBound=this._handleMouseLeave.bind(this),this.el.addEventListener("mouseleave",this._handleMouseLeaveBound),this.dropdownEl.addEventListener("mouseleave",this._handleMouseLeaveBound)):(this._handleClickBound=this._handleClick.bind(this),this.el.addEventListener("click",this._handleClickBound))}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("keydown",this._handleTriggerKeydownBound),this.dropdownEl.removeEventListener("click",this._handleDropdownClickBound),this.options.hover?(this.el.removeEventListener("mouseenter",this._handleMouseEnterBound),this.el.removeEventListener("mouseleave",this._handleMouseLeaveBound),this.dropdownEl.removeEventListener("mouseleave",this._handleMouseLeaveBound)):this.el.removeEventListener("click",this._handleClickBound)}},{key:"_setupTemporaryEventHandlers",value:function(){document.body.addEventListener("click",this._handleDocumentClickBound,!0),document.body.addEventListener("touchend",this._handleDocumentClickBound),document.body.addEventListener("touchmove",this._handleDocumentTouchmoveBound),this.dropdownEl.addEventListener("keydown",this._handleDropdownKeydownBound)}},{key:"_removeTemporaryEventHandlers",value:function(){document.body.removeEventListener("click",this._handleDocumentClickBound,!0),document.body.removeEventListener("touchend",this._handleDocumentClickBound),document.body.removeEventListener("touchmove",this._handleDocumentTouchmoveBound),this.dropdownEl.removeEventListener("keydown",this._handleDropdownKeydownBound)}},{key:"_handleClick",value:function(t){t.preventDefault(),this.open()}},{key:"_handleMouseEnter",value:function(){this.open()}},{key:"_handleMouseLeave",value:function(e){var n=e.toElement||e.relatedTarget,i=!!t(n).closest(".dropdown-content").length,o=!1,r=t(n).closest(".dropdown-trigger");r.length&&r[0].M_Dropdown&&r[0].M_Dropdown.isOpen&&(o=!0),o||i||this.close()}},{key:"_handleDocumentClick",value:function(e){var n=this,i=t(e.target);this.options.closeOnClick&&i.closest(".dropdown-content").length&&!this.isTouchMoving?setTimeout((function(){n.close()}),0):!i.closest(".dropdown-trigger").length&&i.closest(".dropdown-content").length||setTimeout((function(){n.close()}),0),this.isTouchMoving=!1}},{key:"_handleTriggerKeydown",value:function(t){t.which!==M.keys.ARROW_DOWN&&t.which!==M.keys.ENTER||this.isOpen||(t.preventDefault(),this.open())}},{key:"_handleDocumentTouchmove",value:function(e){t(e.target).closest(".dropdown-content").length&&(this.isTouchMoving=!0)}},{key:"_handleDropdownClick",value:function(e){if("function"==typeof this.options.onItemClick){var n=t(e.target).closest("li")[0];this.options.onItemClick.call(this,n)}}},{key:"_handleDropdownKeydown",value:function(e){if(e.which===M.keys.TAB)e.preventDefault(),this.close();else if(e.which!==M.keys.ARROW_DOWN&&e.which!==M.keys.ARROW_UP||!this.isOpen)if(e.which===M.keys.ENTER&&this.isOpen){var n=this.dropdownEl.children[this.focusedIndex],i=t(n).find("a, button").first();i.length?i[0].click():n&&n.click()}else e.which===M.keys.ESC&&this.isOpen&&(e.preventDefault(),this.close());else{e.preventDefault();var o=e.which===M.keys.ARROW_DOWN?1:-1,r=this.focusedIndex,s=!1;do{if(r+=o,this.dropdownEl.children[r]&&-1!==this.dropdownEl.children[r].tabIndex){s=!0;break}}while(r<this.dropdownEl.children.length&&r>=0);s&&(this.focusedIndex=r,this._focusFocusedItem())}var a=String.fromCharCode(e.which).toLowerCase();if(a&&-1===[9,13,27,38,40].indexOf(e.which)){this.filterQuery.push(a);var l=this.filterQuery.join(""),c=t(this.dropdownEl).find("li").filter((function(e){return 0===t(e).text().toLowerCase().indexOf(l)}))[0];c&&(this.focusedIndex=t(c).index(),this._focusFocusedItem())}this.filterTimeout=setTimeout(this._resetFilterQueryBound,1e3)}},{key:"_resetFilterQuery",value:function(){this.filterQuery=[]}},{key:"_resetDropdownStyles",value:function(){this.$dropdownEl.css({display:"",width:"",height:"",left:"",top:"","transform-origin":"",transform:"",opacity:""})}},{key:"_makeDropdownFocusable",value:function(){this.dropdownEl.tabIndex=0,t(this.dropdownEl).children().each((function(t){t.getAttribute("tabindex")||t.setAttribute("tabindex",0)}))}},{key:"_focusFocusedItem",value:function(){this.focusedIndex>=0&&this.focusedIndex<this.dropdownEl.children.length&&this.options.autoFocus&&this.dropdownEl.children[this.focusedIndex].focus()}},{key:"_getDropdownPosition",value:function(){this.el.offsetParent.getBoundingClientRect();var t=this.el.getBoundingClientRect(),e=this.dropdownEl.getBoundingClientRect(),n=e.height,i=e.width,o=t.left-e.left,r=t.top-e.top,s={left:o,top:r,height:n,width:i},a=this.dropdownEl.offsetParent?this.dropdownEl.offsetParent:this.dropdownEl.parentNode,l=M.checkPossibleAlignments(this.el,a,s,this.options.coverTrigger?0:t.height),c="top",h=this.options.alignment;if(r+=this.options.coverTrigger?0:t.height,this.isScrollable=!1,l.top||(l.bottom?c="bottom":(this.isScrollable=!0,l.spaceOnTop>l.spaceOnBottom?(c="bottom",n+=l.spaceOnTop,r-=l.spaceOnTop):n+=l.spaceOnBottom)),!l[h]){var u="left"===h?"right":"left";l[u]?h=u:l.spaceOnLeft>l.spaceOnRight?(h="right",i+=l.spaceOnLeft,o-=l.spaceOnLeft):(h="left",i+=l.spaceOnRight)}return"bottom"===c&&(r=r-e.height+(this.options.coverTrigger?t.height:0)),"right"===h&&(o=o-e.width+t.width),{x:o,y:r,verticalAlignment:c,horizontalAlignment:h,height:n,width:i}}},{key:"_animateIn",value:function(){var t=this;e.remove(this.dropdownEl),e({targets:this.dropdownEl,opacity:{value:[0,1],easing:"easeOutQuad"},scaleX:[.3,1],scaleY:[.3,1],duration:this.options.inDuration,easing:"easeOutQuint",complete:function(e){t.options.autoFocus&&t.dropdownEl.focus(),"function"==typeof t.options.onOpenEnd&&t.options.onOpenEnd.call(t,t.el)}})}},{key:"_animateOut",value:function(){var t=this;e.remove(this.dropdownEl),e({targets:this.dropdownEl,opacity:{value:0,easing:"easeOutQuint"},scaleX:.3,scaleY:.3,duration:this.options.outDuration,easing:"easeOutQuint",complete:function(e){t._resetDropdownStyles(),"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t,t.el)}})}},{key:"_placeDropdown",value:function(){var t=this.options.constrainWidth?this.el.getBoundingClientRect().width:this.dropdownEl.getBoundingClientRect().width;this.dropdownEl.style.width=t+"px";var e=this._getDropdownPosition();this.dropdownEl.style.left=e.x+"px",this.dropdownEl.style.top=e.y+"px",this.dropdownEl.style.height=e.height+"px",this.dropdownEl.style.width=e.width+"px",this.dropdownEl.style.transformOrigin=("left"===e.horizontalAlignment?"0":"100%")+" "+("top"===e.verticalAlignment?"0":"100%")}},{key:"open",value:function(){this.isOpen||(this.isOpen=!0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el),this._resetDropdownStyles(),this.dropdownEl.style.display="block",this._placeDropdown(),this._animateIn(),this._setupTemporaryEventHandlers())}},{key:"close",value:function(){this.isOpen&&(this.isOpen=!1,this.focusedIndex=-1,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),this._animateOut(),this._removeTemporaryEventHandlers(),this.options.autoFocus&&this.el.focus())}},{key:"recalculateDimensions",value:function(){this.isOpen&&(this.$dropdownEl.css({width:"",height:"",left:"",top:"","transform-origin":""}),this._placeDropdown())}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Dropdown}},{key:"defaults",get:function(){return l}}]),c}(a);c._dropdowns=[],M.Dropdown=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"dropdown","M_Dropdown")}(cash,M.anime),function(t,e){var l={opacity:.5,inDuration:250,outDuration:250,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,preventScrolling:!0,dismissible:!0,startingTop:"4%",endingTop:"10%"},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_Modal=i,i.options=t.extend({},c.defaults,n),i.isOpen=!1,i.id=i.$el.attr("id"),i._openingTrigger=void 0,i.$overlay=t('<div class="modal-overlay"></div>'),i.el.tabIndex=0,i._nthModalOpened=0,c._count++,i._setupEventHandlers(),i}return r(c,a),i(c,[{key:"destroy",value:function(){c._count--,this._removeEventHandlers(),this.el.removeAttribute("style"),this.$overlay.remove(),this.el.M_Modal=void 0}},{key:"_setupEventHandlers",value:function(){this._handleOverlayClickBound=this._handleOverlayClick.bind(this),this._handleModalCloseClickBound=this._handleModalCloseClick.bind(this),1===c._count&&document.body.addEventListener("click",this._handleTriggerClick),this.$overlay[0].addEventListener("click",this._handleOverlayClickBound),this.el.addEventListener("click",this._handleModalCloseClickBound)}},{key:"_removeEventHandlers",value:function(){0===c._count&&document.body.removeEventListener("click",this._handleTriggerClick),this.$overlay[0].removeEventListener("click",this._handleOverlayClickBound),this.el.removeEventListener("click",this._handleModalCloseClickBound)}},{key:"_handleTriggerClick",value:function(e){var n=t(e.target).closest(".modal-trigger");if(n.length){var i=M.getIdFromTrigger(n[0]),o=document.getElementById(i).M_Modal;o&&o.open(n),e.preventDefault()}}},{key:"_handleOverlayClick",value:function(){this.options.dismissible&&this.close()}},{key:"_handleModalCloseClick",value:function(e){t(e.target).closest(".modal-close").length&&this.close()}},{key:"_handleKeydown",value:function(t){27===t.keyCode&&this.options.dismissible&&this.close()}},{key:"_handleFocus",value:function(t){this.el.contains(t.target)||this._nthModalOpened!==c._modalsOpen||this.el.focus()}},{key:"_animateIn",value:function(){var n=this;t.extend(this.el.style,{display:"block",opacity:0}),t.extend(this.$overlay[0].style,{display:"block",opacity:0}),e({targets:this.$overlay[0],opacity:this.options.opacity,duration:this.options.inDuration,easing:"easeOutQuad"});var i={targets:this.el,duration:this.options.inDuration,easing:"easeOutCubic",complete:function(){"function"==typeof n.options.onOpenEnd&&n.options.onOpenEnd.call(n,n.el,n._openingTrigger)}};this.el.classList.contains("bottom-sheet")?(t.extend(i,{bottom:0,opacity:1}),e(i)):(t.extend(i,{top:[this.options.startingTop,this.options.endingTop],opacity:1,scaleX:[.8,1],scaleY:[.8,1]}),e(i))}},{key:"_animateOut",value:function(){var n=this;e({targets:this.$overlay[0],opacity:0,duration:this.options.outDuration,easing:"easeOutQuart"});var i={targets:this.el,duration:this.options.outDuration,easing:"easeOutCubic",complete:function(){n.el.style.display="none",n.$overlay.remove(),"function"==typeof n.options.onCloseEnd&&n.options.onCloseEnd.call(n,n.el)}};this.el.classList.contains("bottom-sheet")?(t.extend(i,{bottom:"-100%",opacity:0}),e(i)):(t.extend(i,{top:[this.options.endingTop,this.options.startingTop],opacity:0,scaleX:.8,scaleY:.8}),e(i))}},{key:"open",value:function(t){if(!this.isOpen)return this.isOpen=!0,c._modalsOpen++,this._nthModalOpened=c._modalsOpen,this.$overlay[0].style.zIndex=1e3+2*c._modalsOpen,this.el.style.zIndex=1e3+2*c._modalsOpen+1,this._openingTrigger=t?t[0]:void 0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el,this._openingTrigger),this.options.preventScrolling&&(document.body.style.overflow="hidden"),this.el.classList.add("open"),this.el.insertAdjacentElement("afterend",this.$overlay[0]),this.options.dismissible&&(this._handleKeydownBound=this._handleKeydown.bind(this),this._handleFocusBound=this._handleFocus.bind(this),document.addEventListener("keydown",this._handleKeydownBound),document.addEventListener("focus",this._handleFocusBound,!0)),e.remove(this.el),e.remove(this.$overlay[0]),this._animateIn(),this.el.focus(),this}},{key:"close",value:function(){if(this.isOpen)return this.isOpen=!1,c._modalsOpen--,this._nthModalOpened=0,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),this.el.classList.remove("open"),0===c._modalsOpen&&(document.body.style.overflow=""),this.options.dismissible&&(document.removeEventListener("keydown",this._handleKeydownBound),document.removeEventListener("focus",this._handleFocusBound,!0)),e.remove(this.el),e.remove(this.$overlay[0]),this._animateOut(),this}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Modal}},{key:"defaults",get:function(){return l}}]),c}(a);c._modalsOpen=0,c._count=0,M.Modal=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"modal","M_Modal")}(cash,M.anime),function(t,e){var l={inDuration:275,outDuration:200,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_Materialbox=i,i.options=t.extend({},c.defaults,n),i.overlayActive=!1,i.doneAnimating=!0,i.placeholder=t("<div></div>").addClass("material-placeholder"),i.originalWidth=0,i.originalHeight=0,i.originInlineStyles=i.$el.attr("style"),i.caption=i.el.getAttribute("data-caption")||"",i.$el.before(i.placeholder),i.placeholder.append(i.$el),i._setupEventHandlers(),i}return r(c,a),i(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_Materialbox=void 0,t(this.placeholder).after(this.el).remove(),this.$el.removeAttr("style")}},{key:"_setupEventHandlers",value:function(){this._handleMaterialboxClickBound=this._handleMaterialboxClick.bind(this),this.el.addEventListener("click",this._handleMaterialboxClickBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleMaterialboxClickBound)}},{key:"_handleMaterialboxClick",value:function(t){!1===this.doneAnimating||this.overlayActive&&this.doneAnimating?this.close():this.open()}},{key:"_handleWindowScroll",value:function(){this.overlayActive&&this.close()}},{key:"_handleWindowResize",value:function(){this.overlayActive&&this.close()}},{key:"_handleWindowEscape",value:function(t){27===t.keyCode&&this.doneAnimating&&this.overlayActive&&this.close()}},{key:"_makeAncestorsOverflowVisible",value:function(){this.ancestorsChanged=t();for(var e=this.placeholder[0].parentNode;null!==e&&!t(e).is(document);){var n=t(e);"visible"!==n.css("overflow")&&(n.css("overflow","visible"),void 0===this.ancestorsChanged?this.ancestorsChanged=n:this.ancestorsChanged=this.ancestorsChanged.add(n)),e=e.parentNode}}},{key:"_animateImageIn",value:function(){var t=this,n={targets:this.el,height:[this.originalHeight,this.newHeight],width:[this.originalWidth,this.newWidth],left:M.getDocumentScrollLeft()+this.windowWidth/2-this.placeholder.offset().left-this.newWidth/2,top:M.getDocumentScrollTop()+this.windowHeight/2-this.placeholder.offset().top-this.newHeight/2,duration:this.options.inDuration,easing:"easeOutQuad",complete:function(){t.doneAnimating=!0,"function"==typeof t.options.onOpenEnd&&t.options.onOpenEnd.call(t,t.el)}};this.maxWidth=this.$el.css("max-width"),this.maxHeight=this.$el.css("max-height"),"none"!==this.maxWidth&&(n.maxWidth=this.newWidth),"none"!==this.maxHeight&&(n.maxHeight=this.newHeight),e(n)}},{key:"_animateImageOut",value:function(){var t=this,n={targets:this.el,width:this.originalWidth,height:this.originalHeight,left:0,top:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t.placeholder.css({height:"",width:"",position:"",top:"",left:""}),t.attrWidth&&t.$el.attr("width",t.attrWidth),t.attrHeight&&t.$el.attr("height",t.attrHeight),t.$el.removeAttr("style"),t.originInlineStyles&&t.$el.attr("style",t.originInlineStyles),t.$el.removeClass("active"),t.doneAnimating=!0,t.ancestorsChanged.length&&t.ancestorsChanged.css("overflow",""),"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t,t.el)}};e(n)}},{key:"_updateVars",value:function(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.caption=this.el.getAttribute("data-caption")||""}},{key:"open",value:function(){var n=this;this._updateVars(),this.originalWidth=this.el.getBoundingClientRect().width,this.originalHeight=this.el.getBoundingClientRect().height,this.doneAnimating=!1,this.$el.addClass("active"),this.overlayActive=!0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el),this.placeholder.css({width:this.placeholder[0].getBoundingClientRect().width+"px",height:this.placeholder[0].getBoundingClientRect().height+"px",position:"relative",top:0,left:0}),this._makeAncestorsOverflowVisible(),this.$el.css({position:"absolute","z-index":1e3,"will-change":"left, top, width, height"}),this.attrWidth=this.$el.attr("width"),this.attrHeight=this.$el.attr("height"),this.attrWidth&&(this.$el.css("width",this.attrWidth+"px"),this.$el.removeAttr("width")),this.attrHeight&&(this.$el.css("width",this.attrHeight+"px"),this.$el.removeAttr("height")),this.$overlay=t('<div id="materialbox-overlay"></div>').css({opacity:0}).one("click",(function(){n.doneAnimating&&n.close()})),this.$el.before(this.$overlay);var i=this.$overlay[0].getBoundingClientRect();this.$overlay.css({width:this.windowWidth+"px",height:this.windowHeight+"px",left:-1*i.left+"px",top:-1*i.top+"px"}),e.remove(this.el),e.remove(this.$overlay[0]),e({targets:this.$overlay[0],opacity:1,duration:this.options.inDuration,easing:"easeOutQuad"}),""!==this.caption&&(this.$photocaption&&e.remove(this.$photoCaption[0]),this.$photoCaption=t('<div class="materialbox-caption"></div>'),this.$photoCaption.text(this.caption),t("body").append(this.$photoCaption),this.$photoCaption.css({display:"inline"}),e({targets:this.$photoCaption[0],opacity:1,duration:this.options.inDuration,easing:"easeOutQuad"}));var o=0,r=this.originalWidth/this.windowWidth,s=this.originalHeight/this.windowHeight;this.newWidth=0,this.newHeight=0,r>s?(o=this.originalHeight/this.originalWidth,this.newWidth=.9*this.windowWidth,this.newHeight=.9*this.windowWidth*o):(o=this.originalWidth/this.originalHeight,this.newWidth=.9*this.windowHeight*o,this.newHeight=.9*this.windowHeight),this._animateImageIn(),this._handleWindowScrollBound=this._handleWindowScroll.bind(this),this._handleWindowResizeBound=this._handleWindowResize.bind(this),this._handleWindowEscapeBound=this._handleWindowEscape.bind(this),window.addEventListener("scroll",this._handleWindowScrollBound),window.addEventListener("resize",this._handleWindowResizeBound),window.addEventListener("keyup",this._handleWindowEscapeBound)}},{key:"close",value:function(){var t=this;this._updateVars(),this.doneAnimating=!1,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),e.remove(this.el),e.remove(this.$overlay[0]),""!==this.caption&&e.remove(this.$photoCaption[0]),window.removeEventListener("scroll",this._handleWindowScrollBound),window.removeEventListener("resize",this._handleWindowResizeBound),window.removeEventListener("keyup",this._handleWindowEscapeBound),e({targets:this.$overlay[0],opacity:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t.overlayActive=!1,t.$overlay.remove()}}),this._animateImageOut(),""!==this.caption&&e({targets:this.$photoCaption[0],opacity:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t.$photoCaption.remove()}})}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Materialbox}},{key:"defaults",get:function(){return l}}]),c}(a);M.Materialbox=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"materialbox","M_Materialbox")}(cash,M.anime),function(t){var e={responsiveThreshold:0},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_Parallax=i,i.options=t.extend({},l.defaults,n),i._enabled=window.innerWidth>i.options.responsiveThreshold,i.$img=i.$el.find("img").first(),i.$img.each((function(){this.complete&&t(this).trigger("load")})),i._updateParallax(),i._setupEventHandlers(),i._setupStyles(),l._parallaxes.push(i),i}return r(l,a),i(l,[{key:"destroy",value:function(){l._parallaxes.splice(l._parallaxes.indexOf(this),1),this.$img[0].style.transform="",this._removeEventHandlers(),this.$el[0].M_Parallax=void 0}},{key:"_setupEventHandlers",value:function(){this._handleImageLoadBound=this._handleImageLoad.bind(this),this.$img[0].addEventListener("load",this._handleImageLoadBound),0===l._parallaxes.length&&(l._handleScrollThrottled=M.throttle(l._handleScroll,5),window.addEventListener("scroll",l._handleScrollThrottled),l._handleWindowResizeThrottled=M.throttle(l._handleWindowResize,5),window.addEventListener("resize",l._handleWindowResizeThrottled))}},{key:"_removeEventHandlers",value:function(){this.$img[0].removeEventListener("load",this._handleImageLoadBound),0===l._parallaxes.length&&(window.removeEventListener("scroll",l._handleScrollThrottled),window.removeEventListener("resize",l._handleWindowResizeThrottled))}},{key:"_setupStyles",value:function(){this.$img[0].style.opacity=1}},{key:"_handleImageLoad",value:function(){this._updateParallax()}},{key:"_updateParallax",value:function(){var t=this.$el.height()>0?this.el.parentNode.offsetHeight:500,e=this.$img[0].offsetHeight-t,n=this.$el.offset().top+t,i=this.$el.offset().top,o=M.getDocumentScrollTop(),r=window.innerHeight,s=e*((o+r-i)/(t+r));this._enabled?n>o&&i<o+r&&(this.$img[0].style.transform="translate3D(-50%, "+s+"px, 0)"):this.$img[0].style.transform=""}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Parallax}},{key:"_handleScroll",value:function(){for(var t=0;t<l._parallaxes.length;t++){var e=l._parallaxes[t];e._updateParallax.call(e)}}},{key:"_handleWindowResize",value:function(){for(var t=0;t<l._parallaxes.length;t++){var e=l._parallaxes[t];e._enabled=window.innerWidth>e.options.responsiveThreshold}}},{key:"defaults",get:function(){return e}}]),l}(a);l._parallaxes=[],M.Parallax=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"parallax","M_Parallax")}(cash),function(t,e){var l={duration:300,onShow:null,swipeable:!1,responsiveThreshold:1/0},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_Tabs=i,i.options=t.extend({},c.defaults,n),i.$tabLinks=i.$el.children("li.tab").children("a"),i.index=0,i._setupActiveTabLink(),i.options.swipeable?i._setupSwipeableTabs():i._setupNormalTabs(),i._setTabsAndTabWidth(),i._createIndicator(),i._setupEventHandlers(),i}return r(c,a),i(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this._indicator.parentNode.removeChild(this._indicator),this.options.swipeable?this._teardownSwipeableTabs():this._teardownNormalTabs(),this.$el[0].M_Tabs=void 0}},{key:"_setupEventHandlers",value:function(){this._handleWindowResizeBound=this._handleWindowResize.bind(this),window.addEventListener("resize",this._handleWindowResizeBound),this._handleTabClickBound=this._handleTabClick.bind(this),this.el.addEventListener("click",this._handleTabClickBound)}},{key:"_removeEventHandlers",value:function(){window.removeEventListener("resize",this._handleWindowResizeBound),this.el.removeEventListener("click",this._handleTabClickBound)}},{key:"_handleWindowResize",value:function(){this._setTabsAndTabWidth(),0!==this.tabWidth&&0!==this.tabsWidth&&(this._indicator.style.left=this._calcLeftPos(this.$activeTabLink)+"px",this._indicator.style.right=this._calcRightPos(this.$activeTabLink)+"px")}},{key:"_handleTabClick",value:function(e){var n=this,i=t(e.target).closest("li.tab"),o=t(e.target).closest("a");if(o.length&&o.parent().hasClass("tab"))if(i.hasClass("disabled"))e.preventDefault();else if(!o.attr("target")){this.$activeTabLink.removeClass("active");var r=this.$content;this.$activeTabLink=o,this.$content=t(M.escapeHash(o[0].hash)),this.$tabLinks=this.$el.children("li.tab").children("a"),this.$activeTabLink.addClass("active");var s=this.index;this.index=Math.max(this.$tabLinks.index(o),0),this.options.swipeable?this._tabsCarousel&&this._tabsCarousel.set(this.index,(function(){"function"==typeof n.options.onShow&&n.options.onShow.call(n,n.$content[0])})):this.$content.length&&(this.$content[0].style.display="block",this.$content.addClass("active"),"function"==typeof this.options.onShow&&this.options.onShow.call(this,this.$content[0]),r.length&&!r.is(this.$content)&&(r[0].style.display="none",r.removeClass("active"))),this._setTabsAndTabWidth(),this._animateIndicator(s),e.preventDefault()}}},{key:"_createIndicator",value:function(){var t=this,e=document.createElement("li");e.classList.add("indicator"),this.el.appendChild(e),this._indicator=e,setTimeout((function(){t._indicator.style.left=t._calcLeftPos(t.$activeTabLink)+"px",t._indicator.style.right=t._calcRightPos(t.$activeTabLink)+"px"}),0)}},{key:"_setupActiveTabLink",value:function(){this.$activeTabLink=t(this.$tabLinks.filter('[href="'+location.hash+'"]')),0===this.$activeTabLink.length&&(this.$activeTabLink=this.$el.children("li.tab").children("a.active").first()),0===this.$activeTabLink.length&&(this.$activeTabLink=this.$el.children("li.tab").children("a").first()),this.$tabLinks.removeClass("active"),this.$activeTabLink[0].classList.add("active"),this.index=Math.max(this.$tabLinks.index(this.$activeTabLink),0),this.$activeTabLink.length&&(this.$content=t(M.escapeHash(this.$activeTabLink[0].hash)),this.$content.addClass("active"))}},{key:"_setupSwipeableTabs",value:function(){var e=this;window.innerWidth>this.options.responsiveThreshold&&(this.options.swipeable=!1);var n=t();this.$tabLinks.each((function(e){var i=t(M.escapeHash(e.hash));i.addClass("carousel-item"),n=n.add(i)}));var i=t('<div class="tabs-content carousel carousel-slider"></div>');n.first().before(i),i.append(n),n[0].style.display="";var o=this.$activeTabLink.closest(".tab").index();this._tabsCarousel=M.Carousel.init(i[0],{fullWidth:!0,noWrap:!0,onCycleTo:function(n){var i=e.index;e.index=t(n).index(),e.$activeTabLink.removeClass("active"),e.$activeTabLink=e.$tabLinks.eq(e.index),e.$activeTabLink.addClass("active"),e._animateIndicator(i),"function"==typeof e.options.onShow&&e.options.onShow.call(e,e.$content[0])}}),this._tabsCarousel.set(o)}},{key:"_teardownSwipeableTabs",value:function(){var t=this._tabsCarousel.$el;this._tabsCarousel.destroy(),t.after(t.children()),t.remove()}},{key:"_setupNormalTabs",value:function(){this.$tabLinks.not(this.$activeTabLink).each((function(e){if(e.hash){var n=t(M.escapeHash(e.hash));n.length&&(n[0].style.display="none")}}))}},{key:"_teardownNormalTabs",value:function(){this.$tabLinks.each((function(e){if(e.hash){var n=t(M.escapeHash(e.hash));n.length&&(n[0].style.display="")}}))}},{key:"_setTabsAndTabWidth",value:function(){this.tabsWidth=this.$el.width(),this.tabWidth=Math.max(this.tabsWidth,this.el.scrollWidth)/this.$tabLinks.length}},{key:"_calcRightPos",value:function(t){return Math.ceil(this.tabsWidth-t.position().left-t[0].getBoundingClientRect().width)}},{key:"_calcLeftPos",value:function(t){return Math.floor(t.position().left)}},{key:"updateTabIndicator",value:function(){this._setTabsAndTabWidth(),this._animateIndicator(this.index)}},{key:"_animateIndicator",value:function(t){var n=0,i=0;this.index-t>=0?n=90:i=90;var o={targets:this._indicator,left:{value:this._calcLeftPos(this.$activeTabLink),delay:n},right:{value:this._calcRightPos(this.$activeTabLink),delay:i},duration:this.options.duration,easing:"easeOutQuad"};e.remove(this._indicator),e(o)}},{key:"select",value:function(t){var e=this.$tabLinks.filter('[href="#'+t+'"]');e.length&&e.trigger("click")}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Tabs}},{key:"defaults",get:function(){return l}}]),c}(a);M.Tabs=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"tabs","M_Tabs")}(cash,M.anime),function(t,e){var l={exitDelay:200,enterDelay:0,html:null,margin:5,inDuration:250,outDuration:200,position:"bottom",transitionMovement:10},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_Tooltip=i,i.options=t.extend({},c.defaults,n),i.isOpen=!1,i.isHovered=!1,i.isFocused=!1,i._appendTooltipEl(),i._setupEventHandlers(),i}return r(c,a),i(c,[{key:"destroy",value:function(){t(this.tooltipEl).remove(),this._removeEventHandlers(),this.el.M_Tooltip=void 0}},{key:"_appendTooltipEl",value:function(){var t=document.createElement("div");t.classList.add("material-tooltip"),this.tooltipEl=t;var e=document.createElement("div");e.classList.add("tooltip-content"),e.innerHTML=this.options.html,t.appendChild(e),document.body.appendChild(t)}},{key:"_updateTooltipContent",value:function(){this.tooltipEl.querySelector(".tooltip-content").innerHTML=this.options.html}},{key:"_setupEventHandlers",value:function(){this._handleMouseEnterBound=this._handleMouseEnter.bind(this),this._handleMouseLeaveBound=this._handleMouseLeave.bind(this),this._handleFocusBound=this._handleFocus.bind(this),this._handleBlurBound=this._handleBlur.bind(this),this.el.addEventListener("mouseenter",this._handleMouseEnterBound),this.el.addEventListener("mouseleave",this._handleMouseLeaveBound),this.el.addEventListener("focus",this._handleFocusBound,!0),this.el.addEventListener("blur",this._handleBlurBound,!0)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("mouseenter",this._handleMouseEnterBound),this.el.removeEventListener("mouseleave",this._handleMouseLeaveBound),this.el.removeEventListener("focus",this._handleFocusBound,!0),this.el.removeEventListener("blur",this._handleBlurBound,!0)}},{key:"open",value:function(e){this.isOpen||(e=void 0===e||void 0,this.isOpen=!0,this.options=t.extend({},this.options,this._getAttributeOptions()),this._updateTooltipContent(),this._setEnterDelayTimeout(e))}},{key:"close",value:function(){this.isOpen&&(this.isHovered=!1,this.isFocused=!1,this.isOpen=!1,this._setExitDelayTimeout())}},{key:"_setExitDelayTimeout",value:function(){var t=this;clearTimeout(this._exitDelayTimeout),this._exitDelayTimeout=setTimeout((function(){t.isHovered||t.isFocused||t._animateOut()}),this.options.exitDelay)}},{key:"_setEnterDelayTimeout",value:function(t){var e=this;clearTimeout(this._enterDelayTimeout),this._enterDelayTimeout=setTimeout((function(){(e.isHovered||e.isFocused||t)&&e._animateIn()}),this.options.enterDelay)}},{key:"_positionTooltip",value:function(){var e,n=this.el,i=this.tooltipEl,o=n.offsetHeight,r=n.offsetWidth,s=i.offsetHeight,a=i.offsetWidth,l=this.options.margin,c=void 0,h=void 0;this.xMovement=0,this.yMovement=0,c=n.getBoundingClientRect().top+M.getDocumentScrollTop(),h=n.getBoundingClientRect().left+M.getDocumentScrollLeft(),"top"===this.options.position?(c+=-s-l,h+=r/2-a/2,this.yMovement=-this.options.transitionMovement):"right"===this.options.position?(c+=o/2-s/2,h+=r+l,this.xMovement=this.options.transitionMovement):"left"===this.options.position?(c+=o/2-s/2,h+=-a-l,this.xMovement=-this.options.transitionMovement):(c+=o+l,h+=r/2-a/2,this.yMovement=this.options.transitionMovement),e=this._repositionWithinScreen(h,c,a,s),t(i).css({top:e.y+"px",left:e.x+"px"})}},{key:"_repositionWithinScreen",value:function(t,e,n,i){var o=M.getDocumentScrollLeft(),r=M.getDocumentScrollTop(),s=t-o,a=e-r,l={left:s,top:a,width:n,height:i},c=this.options.margin+this.options.transitionMovement,h=M.checkWithinContainer(document.body,l,c);return h.left?s=c:h.right&&(s-=s+n-window.innerWidth),h.top?a=c:h.bottom&&(a-=a+i-window.innerHeight),{x:s+o,y:a+r}}},{key:"_animateIn",value:function(){this._positionTooltip(),this.tooltipEl.style.visibility="visible",e.remove(this.tooltipEl),e({targets:this.tooltipEl,opacity:1,translateX:this.xMovement,translateY:this.yMovement,duration:this.options.inDuration,easing:"easeOutCubic"})}},{key:"_animateOut",value:function(){e.remove(this.tooltipEl),e({targets:this.tooltipEl,opacity:0,translateX:0,translateY:0,duration:this.options.outDuration,easing:"easeOutCubic"})}},{key:"_handleMouseEnter",value:function(){this.isHovered=!0,this.isFocused=!1,this.open(!1)}},{key:"_handleMouseLeave",value:function(){this.isHovered=!1,this.isFocused=!1,this.close()}},{key:"_handleFocus",value:function(){M.tabPressed&&(this.isFocused=!0,this.open(!1))}},{key:"_handleBlur",value:function(){this.isFocused=!1,this.close()}},{key:"_getAttributeOptions",value:function(){var t={},e=this.el.getAttribute("data-tooltip"),n=this.el.getAttribute("data-position");return e&&(t.html=e),n&&(t.position=n),t}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Tooltip}},{key:"defaults",get:function(){return l}}]),c}(a);M.Tooltip=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"tooltip","M_Tooltip")}(cash,M.anime),function(t){var e=e||{},n=document.querySelectorAll.bind(document);function i(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e+=n+":"+t[n]+";");return e}var o={duration:750,show:function(t,e){if(2===t.button)return!1;var n=e||this,r=document.createElement("div");r.className="waves-ripple",n.appendChild(r);var s,a,l,c,h,u=(c={top:0,left:0},h=(s=n)&&s.ownerDocument,a=h.documentElement,void 0!==s.getBoundingClientRect&&(c=s.getBoundingClientRect()),l=function(t){return null!==(e=t)&&e===e.window?t:9===t.nodeType&&t.defaultView;var e}(h),{top:c.top+l.pageYOffset-a.clientTop,left:c.left+l.pageXOffset-a.clientLeft}),d=t.pageY-u.top,p=t.pageX-u.left,_="scale("+n.clientWidth/100*10+")";"touches"in t&&(d=t.touches[0].pageY-u.top,p=t.touches[0].pageX-u.left),r.setAttribute("data-hold",Date.now()),r.setAttribute("data-scale",_),r.setAttribute("data-x",p),r.setAttribute("data-y",d);var f={top:d+"px",left:p+"px"};r.className=r.className+" waves-notransition",r.setAttribute("style",i(f)),r.className=r.className.replace("waves-notransition",""),f["-webkit-transform"]=_,f["-moz-transform"]=_,f["-ms-transform"]=_,f["-o-transform"]=_,f.transform=_,f.opacity="1",f["-webkit-transition-duration"]=o.duration+"ms",f["-moz-transition-duration"]=o.duration+"ms",f["-o-transition-duration"]=o.duration+"ms",f["transition-duration"]=o.duration+"ms",f["-webkit-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",f["-moz-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",f["-o-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",f["transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",r.setAttribute("style",i(f))},hide:function(t){r.touchup(t);var e=this;e.clientWidth;var n=null,s=e.getElementsByClassName("waves-ripple");if(!(s.length>0))return!1;var a=(n=s[s.length-1]).getAttribute("data-x"),l=n.getAttribute("data-y"),c=n.getAttribute("data-scale"),h=350-(Date.now()-Number(n.getAttribute("data-hold")));h<0&&(h=0),setTimeout((function(){var t={top:l+"px",left:a+"px",opacity:"0","-webkit-transition-duration":o.duration+"ms","-moz-transition-duration":o.duration+"ms","-o-transition-duration":o.duration+"ms","transition-duration":o.duration+"ms","-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,"-o-transform":c,transform:c};n.setAttribute("style",i(t)),setTimeout((function(){try{e.removeChild(n)}catch(t){return!1}}),o.duration)}),h)},wrapInput:function(t){for(var e=0;e<t.length;e++){var n=t[e];if("input"===n.tagName.toLowerCase()){var i=n.parentNode;if("i"===i.tagName.toLowerCase()&&-1!==i.className.indexOf("waves-effect"))continue;var o=document.createElement("i");o.className=n.className+" waves-input-wrapper";var r=n.getAttribute("style");r||(r=""),o.setAttribute("style",r),n.className="waves-button-input",n.removeAttribute("style"),i.replaceChild(o,n),o.appendChild(n)}}}},r={touches:0,allowEvent:function(t){var e=!0;return"touchstart"===t.type?r.touches+=1:"touchend"===t.type||"touchcancel"===t.type?setTimeout((function(){r.touches>0&&(r.touches-=1)}),500):"mousedown"===t.type&&r.touches>0&&(e=!1),e},touchup:function(t){r.allowEvent(t)}};function s(e){var n=function(t){if(!1===r.allowEvent(t))return null;for(var e=null,n=t.target||t.srcElement;null!==n.parentNode;){if(!(n instanceof SVGElement)&&-1!==n.className.indexOf("waves-effect")){e=n;break}n=n.parentNode}return e}(e);null!==n&&(o.show(e,n),"ontouchstart"in t&&(n.addEventListener("touchend",o.hide,!1),n.addEventListener("touchcancel",o.hide,!1)),n.addEventListener("mouseup",o.hide,!1),n.addEventListener("mouseleave",o.hide,!1),n.addEventListener("dragend",o.hide,!1))}e.displayEffect=function(e){"duration"in(e=e||{})&&(o.duration=e.duration),o.wrapInput(n(".waves-effect")),"ontouchstart"in t&&document.body.addEventListener("touchstart",s,!1),document.body.addEventListener("mousedown",s,!1)},e.attach=function(e){"input"===e.tagName.toLowerCase()&&(o.wrapInput([e]),e=e.parentNode),"ontouchstart"in t&&e.addEventListener("touchstart",s,!1),e.addEventListener("mousedown",s,!1)},t.Waves=e,document.addEventListener("DOMContentLoaded",(function(){e.displayEffect()}),!1)}(window),function(t,e){var n={html:"",displayLength:4e3,inDuration:300,outDuration:375,classes:"",completeCallback:null,activationPercent:.8},o=function(){function o(e){s(this,o),this.options=t.extend({},o.defaults,e),this.message=this.options.html,this.panning=!1,this.timeRemaining=this.options.displayLength,0===o._toasts.length&&o._createContainer(),o._toasts.push(this);var n=this._createToast();n.M_Toast=this,this.el=n,this.$el=t(n),this._animateIn(),this._setTimer()}return i(o,[{key:"_createToast",value:function(){var e=document.createElement("div");return e.classList.add("toast"),this.options.classes.length&&t(e).addClass(this.options.classes),("object"==typeof HTMLElement?this.message instanceof HTMLElement:this.message&&"object"==typeof this.message&&null!==this.message&&1===this.message.nodeType&&"string"==typeof this.message.nodeName)?e.appendChild(this.message):this.message.jquery?t(e).append(this.message[0]):e.innerHTML=this.message,o._container.appendChild(e),e}},{key:"_animateIn",value:function(){e({targets:this.el,top:0,opacity:1,duration:this.options.inDuration,easing:"easeOutCubic"})}},{key:"_setTimer",value:function(){var t=this;this.timeRemaining!==1/0&&(this.counterInterval=setInterval((function(){t.panning||(t.timeRemaining-=20),t.timeRemaining<=0&&t.dismiss()}),20))}},{key:"dismiss",value:function(){var t=this;window.clearInterval(this.counterInterval);var n=this.el.offsetWidth*this.options.activationPercent;this.wasSwiped&&(this.el.style.transition="transform .05s, opacity .05s",this.el.style.transform="translateX("+n+"px)",this.el.style.opacity=0),e({targets:this.el,opacity:0,marginTop:-40,duration:this.options.outDuration,easing:"easeOutExpo",complete:function(){"function"==typeof t.options.completeCallback&&t.options.completeCallback(),t.$el.remove(),o._toasts.splice(o._toasts.indexOf(t),1),0===o._toasts.length&&o._removeContainer()}})}}],[{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Toast}},{key:"_createContainer",value:function(){var t=document.createElement("div");t.setAttribute("id","toast-container"),t.addEventListener("touchstart",o._onDragStart),t.addEventListener("touchmove",o._onDragMove),t.addEventListener("touchend",o._onDragEnd),t.addEventListener("mousedown",o._onDragStart),document.addEventListener("mousemove",o._onDragMove),document.addEventListener("mouseup",o._onDragEnd),document.body.appendChild(t),o._container=t}},{key:"_removeContainer",value:function(){document.removeEventListener("mousemove",o._onDragMove),document.removeEventListener("mouseup",o._onDragEnd),t(o._container).remove(),o._container=null}},{key:"_onDragStart",value:function(e){if(e.target&&t(e.target).closest(".toast").length){var n=t(e.target).closest(".toast")[0].M_Toast;n.panning=!0,o._draggedToast=n,n.el.classList.add("panning"),n.el.style.transition="",n.startingXPos=o._xPos(e),n.time=Date.now(),n.xPos=o._xPos(e)}}},{key:"_onDragMove",value:function(t){if(o._draggedToast){t.preventDefault();var e=o._draggedToast;e.deltaX=Math.abs(e.xPos-o._xPos(t)),e.xPos=o._xPos(t),e.velocityX=e.deltaX/(Date.now()-e.time),e.time=Date.now();var n=e.xPos-e.startingXPos,i=e.el.offsetWidth*e.options.activationPercent;e.el.style.transform="translateX("+n+"px)",e.el.style.opacity=1-Math.abs(n/i)}}},{key:"_onDragEnd",value:function(){if(o._draggedToast){var t=o._draggedToast;t.panning=!1,t.el.classList.remove("panning");var e=t.xPos-t.startingXPos,n=t.el.offsetWidth*t.options.activationPercent;Math.abs(e)>n||t.velocityX>1?(t.wasSwiped=!0,t.dismiss()):(t.el.style.transition="transform .2s, opacity .2s",t.el.style.transform="",t.el.style.opacity=""),o._draggedToast=null}}},{key:"_xPos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}},{key:"dismissAll",value:function(){for(var t in o._toasts)o._toasts[t].dismiss()}},{key:"defaults",get:function(){return n}}]),o}();o._toasts=[],o._container=null,o._draggedToast=null,M.Toast=o,M.toast=function(t){return new o(t)}}(cash,M.anime),function(t,e){var l={edge:"left",draggable:!0,inDuration:250,outDuration:200,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,preventScrolling:!0},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_Sidenav=i,i.id=i.$el.attr("id"),i.options=t.extend({},c.defaults,n),i.isOpen=!1,i.isFixed=i.el.classList.contains("sidenav-fixed"),i.isDragged=!1,i.lastWindowWidth=window.innerWidth,i.lastWindowHeight=window.innerHeight,i._createOverlay(),i._createDragTarget(),i._setupEventHandlers(),i._setupClasses(),i._setupFixed(),c._sidenavs.push(i),i}return r(c,a),i(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this._enableBodyScrolling(),this._overlay.parentNode.removeChild(this._overlay),this.dragTarget.parentNode.removeChild(this.dragTarget),this.el.M_Sidenav=void 0,this.el.style.transform="";var t=c._sidenavs.indexOf(this);t>=0&&c._sidenavs.splice(t,1)}},{key:"_createOverlay",value:function(){var t=document.createElement("div");this._closeBound=this.close.bind(this),t.classList.add("sidenav-overlay"),t.addEventListener("click",this._closeBound),document.body.appendChild(t),this._overlay=t}},{key:"_setupEventHandlers",value:function(){0===c._sidenavs.length&&document.body.addEventListener("click",this._handleTriggerClick),this._handleDragTargetDragBound=this._handleDragTargetDrag.bind(this),this._handleDragTargetReleaseBound=this._handleDragTargetRelease.bind(this),this._handleCloseDragBound=this._handleCloseDrag.bind(this),this._handleCloseReleaseBound=this._handleCloseRelease.bind(this),this._handleCloseTriggerClickBound=this._handleCloseTriggerClick.bind(this),this.dragTarget.addEventListener("touchmove",this._handleDragTargetDragBound),this.dragTarget.addEventListener("touchend",this._handleDragTargetReleaseBound),this._overlay.addEventListener("touchmove",this._handleCloseDragBound),this._overlay.addEventListener("touchend",this._handleCloseReleaseBound),this.el.addEventListener("touchmove",this._handleCloseDragBound),this.el.addEventListener("touchend",this._handleCloseReleaseBound),this.el.addEventListener("click",this._handleCloseTriggerClickBound),this.isFixed&&(this._handleWindowResizeBound=this._handleWindowResize.bind(this),window.addEventListener("resize",this._handleWindowResizeBound))}},{key:"_removeEventHandlers",value:function(){1===c._sidenavs.length&&document.body.removeEventListener("click",this._handleTriggerClick),this.dragTarget.removeEventListener("touchmove",this._handleDragTargetDragBound),this.dragTarget.removeEventListener("touchend",this._handleDragTargetReleaseBound),this._overlay.removeEventListener("touchmove",this._handleCloseDragBound),this._overlay.removeEventListener("touchend",this._handleCloseReleaseBound),this.el.removeEventListener("touchmove",this._handleCloseDragBound),this.el.removeEventListener("touchend",this._handleCloseReleaseBound),this.el.removeEventListener("click",this._handleCloseTriggerClickBound),this.isFixed&&window.removeEventListener("resize",this._handleWindowResizeBound)}},{key:"_handleTriggerClick",value:function(e){var n=t(e.target).closest(".sidenav-trigger");if(e.target&&n.length){var i=M.getIdFromTrigger(n[0]),o=document.getElementById(i).M_Sidenav;o&&o.open(n),e.preventDefault()}}},{key:"_startDrag",value:function(t){var n=t.targetTouches[0].clientX;this.isDragged=!0,this._startingXpos=n,this._xPos=this._startingXpos,this._time=Date.now(),this._width=this.el.getBoundingClientRect().width,this._overlay.style.display="block",this._initialScrollTop=this.isOpen?this.el.scrollTop:M.getDocumentScrollTop(),this._verticallyScrolling=!1,e.remove(this.el),e.remove(this._overlay)}},{key:"_dragMoveUpdate",value:function(t){var e=t.targetTouches[0].clientX,n=this.isOpen?this.el.scrollTop:M.getDocumentScrollTop();this.deltaX=Math.abs(this._xPos-e),this._xPos=e,this.velocityX=this.deltaX/(Date.now()-this._time),this._time=Date.now(),this._initialScrollTop!==n&&(this._verticallyScrolling=!0)}},{key:"_handleDragTargetDrag",value:function(t){if(this.options.draggable&&!this._isCurrentlyFixed()&&!this._verticallyScrolling){this.isDragged||this._startDrag(t),this._dragMoveUpdate(t);var e=this._xPos-this._startingXpos,n=e>0?"right":"left";e=Math.min(this._width,Math.abs(e)),this.options.edge===n&&(e=0);var i=e,o="translateX(-100%)";"right"===this.options.edge&&(o="translateX(100%)",i=-i),this.percentOpen=Math.min(1,e/this._width),this.el.style.transform=o+" translateX("+i+"px)",this._overlay.style.opacity=this.percentOpen}}},{key:"_handleDragTargetRelease",value:function(){this.isDragged&&(this.percentOpen>.2?this.open():this._animateOut(),this.isDragged=!1,this._verticallyScrolling=!1)}},{key:"_handleCloseDrag",value:function(t){if(this.isOpen){if(!this.options.draggable||this._isCurrentlyFixed()||this._verticallyScrolling)return;this.isDragged||this._startDrag(t),this._dragMoveUpdate(t);var e=this._xPos-this._startingXpos,n=e>0?"right":"left";e=Math.min(this._width,Math.abs(e)),this.options.edge!==n&&(e=0);var i=-e;"right"===this.options.edge&&(i=-i),this.percentOpen=Math.min(1,1-e/this._width),this.el.style.transform="translateX("+i+"px)",this._overlay.style.opacity=this.percentOpen}}},{key:"_handleCloseRelease",value:function(){this.isOpen&&this.isDragged&&(this.percentOpen>.8?this._animateIn():this.close(),this.isDragged=!1,this._verticallyScrolling=!1)}},{key:"_handleCloseTriggerClick",value:function(e){t(e.target).closest(".sidenav-close").length&&!this._isCurrentlyFixed()&&this.close()}},{key:"_handleWindowResize",value:function(){this.lastWindowWidth!==window.innerWidth&&(window.innerWidth>992?this.open():this.close()),this.lastWindowWidth=window.innerWidth,this.lastWindowHeight=window.innerHeight}},{key:"_setupClasses",value:function(){"right"===this.options.edge&&(this.el.classList.add("right-aligned"),this.dragTarget.classList.add("right-aligned"))}},{key:"_removeClasses",value:function(){this.el.classList.remove("right-aligned"),this.dragTarget.classList.remove("right-aligned")}},{key:"_setupFixed",value:function(){this._isCurrentlyFixed()&&this.open()}},{key:"_isCurrentlyFixed",value:function(){return this.isFixed&&window.innerWidth>992}},{key:"_createDragTarget",value:function(){var t=document.createElement("div");t.classList.add("drag-target"),document.body.appendChild(t),this.dragTarget=t}},{key:"_preventBodyScrolling",value:function(){document.body.style.overflow="hidden"}},{key:"_enableBodyScrolling",value:function(){document.body.style.overflow=""}},{key:"open",value:function(){!0!==this.isOpen&&(this.isOpen=!0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el),this._isCurrentlyFixed()?(e.remove(this.el),e({targets:this.el,translateX:0,duration:0,easing:"easeOutQuad"}),this._enableBodyScrolling(),this._overlay.style.display="none"):(this.options.preventScrolling&&this._preventBodyScrolling(),this.isDragged&&1==this.percentOpen||this._animateIn()))}},{key:"close",value:function(){if(!1!==this.isOpen)if(this.isOpen=!1,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),this._isCurrentlyFixed()){var t="left"===this.options.edge?"-105%":"105%";this.el.style.transform="translateX("+t+")"}else this._enableBodyScrolling(),this.isDragged&&0==this.percentOpen?this._overlay.style.display="none":this._animateOut()}},{key:"_animateIn",value:function(){this._animateSidenavIn(),this._animateOverlayIn()}},{key:"_animateSidenavIn",value:function(){var t=this,n="left"===this.options.edge?-1:1;this.isDragged&&(n="left"===this.options.edge?n+this.percentOpen:n-this.percentOpen),e.remove(this.el),e({targets:this.el,translateX:[100*n+"%",0],duration:this.options.inDuration,easing:"easeOutQuad",complete:function(){"function"==typeof t.options.onOpenEnd&&t.options.onOpenEnd.call(t,t.el)}})}},{key:"_animateOverlayIn",value:function(){var n=0;this.isDragged?n=this.percentOpen:t(this._overlay).css({display:"block"}),e.remove(this._overlay),e({targets:this._overlay,opacity:[n,1],duration:this.options.inDuration,easing:"easeOutQuad"})}},{key:"_animateOut",value:function(){this._animateSidenavOut(),this._animateOverlayOut()}},{key:"_animateSidenavOut",value:function(){var t=this,n="left"===this.options.edge?-1:1,i=0;this.isDragged&&(i="left"===this.options.edge?n+this.percentOpen:n-this.percentOpen),e.remove(this.el),e({targets:this.el,translateX:[100*i+"%",105*n+"%"],duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t,t.el)}})}},{key:"_animateOverlayOut",value:function(){var n=this;e.remove(this._overlay),e({targets:this._overlay,opacity:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t(n._overlay).css("display","none")}})}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Sidenav}},{key:"defaults",get:function(){return l}}]),c}(a);c._sidenavs=[],M.Sidenav=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"sidenav","M_Sidenav")}(cash,M.anime),function(t,e){var l={throttle:100,scrollOffset:200,activeClass:"active",getActiveElement:function(t){return'a[href="#'+t+'"]'}},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_ScrollSpy=i,i.options=t.extend({},c.defaults,n),c._elements.push(i),c._count++,c._increment++,i.tickId=-1,i.id=c._increment,i._setupEventHandlers(),i._handleWindowScroll(),i}return r(c,a),i(c,[{key:"destroy",value:function(){c._elements.splice(c._elements.indexOf(this),1),c._elementsInView.splice(c._elementsInView.indexOf(this),1),c._visibleElements.splice(c._visibleElements.indexOf(this.$el),1),c._count--,this._removeEventHandlers(),t(this.options.getActiveElement(this.$el.attr("id"))).removeClass(this.options.activeClass),this.el.M_ScrollSpy=void 0}},{key:"_setupEventHandlers",value:function(){var t=M.throttle(this._handleWindowScroll,200);this._handleThrottledResizeBound=t.bind(this),this._handleWindowScrollBound=this._handleWindowScroll.bind(this),1===c._count&&(window.addEventListener("scroll",this._handleWindowScrollBound),window.addEventListener("resize",this._handleThrottledResizeBound),document.body.addEventListener("click",this._handleTriggerClick))}},{key:"_removeEventHandlers",value:function(){0===c._count&&(window.removeEventListener("scroll",this._handleWindowScrollBound),window.removeEventListener("resize",this._handleThrottledResizeBound),document.body.removeEventListener("click",this._handleTriggerClick))}},{key:"_handleTriggerClick",value:function(n){for(var i=t(n.target),o=c._elements.length-1;o>=0;o--){var r=c._elements[o];if(i.is('a[href="#'+r.$el.attr("id")+'"]')){n.preventDefault();var s=r.$el.offset().top+1;e({targets:[document.documentElement,document.body],scrollTop:s-r.options.scrollOffset,duration:400,easing:"easeOutCubic"});break}}}},{key:"_handleWindowScroll",value:function(){c._ticks++;for(var t=M.getDocumentScrollTop(),e=M.getDocumentScrollLeft(),n=e+window.innerWidth,i=t+window.innerHeight,o=c._findElements(t,n,i,e),r=0;r<o.length;r++){var s=o[r];s.tickId<0&&s._enter(),s.tickId=c._ticks}for(var a=0;a<c._elementsInView.length;a++){var l=c._elementsInView[a],h=l.tickId;h>=0&&h!==c._ticks&&(l._exit(),l.tickId=-1)}c._elementsInView=o}},{key:"_enter",value:function(){c._visibleElements=c._visibleElements.filter((function(t){return 0!=t.height()})),c._visibleElements[0]?(t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).removeClass(this.options.activeClass),c._visibleElements[0][0].M_ScrollSpy&&this.id<c._visibleElements[0][0].M_ScrollSpy.id?c._visibleElements.unshift(this.$el):c._visibleElements.push(this.$el)):c._visibleElements.push(this.$el),t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).addClass(this.options.activeClass)}},{key:"_exit",value:function(){var e=this;c._visibleElements=c._visibleElements.filter((function(t){return 0!=t.height()})),c._visibleElements[0]&&(t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).removeClass(this.options.activeClass),c._visibleElements=c._visibleElements.filter((function(t){return t.attr("id")!=e.$el.attr("id")})),c._visibleElements[0]&&t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).addClass(this.options.activeClass))}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_ScrollSpy}},{key:"_findElements",value:function(t,e,n,i){for(var o=[],r=0;r<c._elements.length;r++){var s=c._elements[r],a=t+s.options.scrollOffset||200;if(s.$el.height()>0){var l=s.$el.offset().top,h=s.$el.offset().left,u=h+s.$el.width(),d=l+s.$el.height();!(h>e||u<i||l>n||d<a)&&o.push(s)}}return o}},{key:"defaults",get:function(){return l}}]),c}(a);c._elements=[],c._elementsInView=[],c._visibleElements=[],c._count=0,c._increment=0,c._ticks=0,M.ScrollSpy=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"scrollSpy","M_ScrollSpy")}(cash,M.anime),function(t){var e={data:{},limit:1/0,onAutocomplete:null,minLength:1,sortFunction:function(t,e,n){return t.indexOf(n)-e.indexOf(n)}},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_Autocomplete=i,i.options=t.extend({},l.defaults,n),i.isOpen=!1,i.count=0,i.activeIndex=-1,i.oldVal,i.$inputField=i.$el.closest(".input-field"),i.$active=t(),i._mousedown=!1,i._setupDropdown(),i._setupEventHandlers(),i}return r(l,a),i(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this._removeDropdown(),this.el.M_Autocomplete=void 0}},{key:"_setupEventHandlers",value:function(){this._handleInputBlurBound=this._handleInputBlur.bind(this),this._handleInputKeyupAndFocusBound=this._handleInputKeyupAndFocus.bind(this),this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),this._handleContainerMousedownAndTouchstartBound=this._handleContainerMousedownAndTouchstart.bind(this),this._handleContainerMouseupAndTouchendBound=this._handleContainerMouseupAndTouchend.bind(this),this.el.addEventListener("blur",this._handleInputBlurBound),this.el.addEventListener("keyup",this._handleInputKeyupAndFocusBound),this.el.addEventListener("focus",this._handleInputKeyupAndFocusBound),this.el.addEventListener("keydown",this._handleInputKeydownBound),this.el.addEventListener("click",this._handleInputClickBound),this.container.addEventListener("mousedown",this._handleContainerMousedownAndTouchstartBound),this.container.addEventListener("mouseup",this._handleContainerMouseupAndTouchendBound),void 0!==window.ontouchstart&&(this.container.addEventListener("touchstart",this._handleContainerMousedownAndTouchstartBound),this.container.addEventListener("touchend",this._handleContainerMouseupAndTouchendBound))}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("blur",this._handleInputBlurBound),this.el.removeEventListener("keyup",this._handleInputKeyupAndFocusBound),this.el.removeEventListener("focus",this._handleInputKeyupAndFocusBound),this.el.removeEventListener("keydown",this._handleInputKeydownBound),this.el.removeEventListener("click",this._handleInputClickBound),this.container.removeEventListener("mousedown",this._handleContainerMousedownAndTouchstartBound),this.container.removeEventListener("mouseup",this._handleContainerMouseupAndTouchendBound),void 0!==window.ontouchstart&&(this.container.removeEventListener("touchstart",this._handleContainerMousedownAndTouchstartBound),this.container.removeEventListener("touchend",this._handleContainerMouseupAndTouchendBound))}},{key:"_setupDropdown",value:function(){var e=this;this.container=document.createElement("ul"),this.container.id="autocomplete-options-"+M.guid(),t(this.container).addClass("autocomplete-content dropdown-content"),this.$inputField.append(this.container),this.el.setAttribute("data-target",this.container.id),this.dropdown=M.Dropdown.init(this.el,{autoFocus:!1,closeOnClick:!1,coverTrigger:!1,onItemClick:function(n){e.selectOption(t(n))}}),this.el.removeEventListener("click",this.dropdown._handleClickBound)}},{key:"_removeDropdown",value:function(){this.container.parentNode.removeChild(this.container)}},{key:"_handleInputBlur",value:function(){this._mousedown||(this.close(),this._resetAutocomplete())}},{key:"_handleInputKeyupAndFocus",value:function(t){"keyup"===t.type&&(l._keydown=!1),this.count=0;var e=this.el.value.toLowerCase();13!==t.keyCode&&38!==t.keyCode&&40!==t.keyCode&&(this.oldVal===e||!M.tabPressed&&"focus"===t.type||this.open(),this.oldVal=e)}},{key:"_handleInputKeydown",value:function(e){l._keydown=!0;var n=e.keyCode,i=void 0,o=t(this.container).children("li").length;n===M.keys.ENTER&&this.activeIndex>=0?(i=t(this.container).children("li").eq(this.activeIndex)).length&&(this.selectOption(i),e.preventDefault()):n!==M.keys.ARROW_UP&&n!==M.keys.ARROW_DOWN||(e.preventDefault(),n===M.keys.ARROW_UP&&this.activeIndex>0&&this.activeIndex--,n===M.keys.ARROW_DOWN&&this.activeIndex<o-1&&this.activeIndex++,this.$active.removeClass("active"),this.activeIndex>=0&&(this.$active=t(this.container).children("li").eq(this.activeIndex),this.$active.addClass("active")))}},{key:"_handleInputClick",value:function(t){this.open()}},{key:"_handleContainerMousedownAndTouchstart",value:function(t){this._mousedown=!0}},{key:"_handleContainerMouseupAndTouchend",value:function(t){this._mousedown=!1}},{key:"_highlight",value:function(t,e){var n=e.find("img"),i=e.text().toLowerCase().indexOf(""+t.toLowerCase()),o=i+t.length-1,r=e.text().slice(0,i),s=e.text().slice(i,o+1),a=e.text().slice(o+1);e.html("<span>"+r+"<span class='highlight'>"+s+"</span>"+a+"</span>"),n.length&&e.prepend(n)}},{key:"_resetCurrentElement",value:function(){this.activeIndex=-1,this.$active.removeClass("active")}},{key:"_resetAutocomplete",value:function(){t(this.container).empty(),this._resetCurrentElement(),this.oldVal=null,this.isOpen=!1,this._mousedown=!1}},{key:"selectOption",value:function(t){var e=t.text().trim();this.el.value=e,this.$el.trigger("change"),this._resetAutocomplete(),this.close(),"function"==typeof this.options.onAutocomplete&&this.options.onAutocomplete.call(this,e)}},{key:"_renderDropdown",value:function(e,n){var i=this;this._resetAutocomplete();var o=[];for(var r in e)if(e.hasOwnProperty(r)&&-1!==r.toLowerCase().indexOf(n)){if(this.count>=this.options.limit)break;var s={data:e[r],key:r};o.push(s),this.count++}if(this.options.sortFunction){o.sort((function(t,e){return i.options.sortFunction(t.key.toLowerCase(),e.key.toLowerCase(),n.toLowerCase())}))}for(var a=0;a<o.length;a++){var l=o[a],c=t("<li></li>");l.data?c.append('<img src="'+l.data+'" class="right circle"><span>'+l.key+"</span>"):c.append("<span>"+l.key+"</span>"),t(this.container).append(c),this._highlight(n,c)}}},{key:"open",value:function(){var t=this.el.value.toLowerCase();this._resetAutocomplete(),t.length>=this.options.minLength&&(this.isOpen=!0,this._renderDropdown(this.options.data,t)),this.dropdown.isOpen?this.dropdown.recalculateDimensions():this.dropdown.open()}},{key:"close",value:function(){this.dropdown.close()}},{key:"updateData",value:function(t){var e=this.el.value.toLowerCase();this.options.data=t,this.isOpen&&this._renderDropdown(t,e)}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Autocomplete}},{key:"defaults",get:function(){return e}}]),l}(a);l._keydown=!1,M.Autocomplete=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"autocomplete","M_Autocomplete")}(cash),function(t){M.updateTextFields=function(){t("input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], input[type=date], input[type=time], textarea").each((function(e,n){var i=t(this);e.value.length>0||t(e).is(":focus")||e.autofocus||null!==i.attr("placeholder")?i.siblings("label").addClass("active"):e.validity?i.siblings("label").toggleClass("active",!0===e.validity.badInput):i.siblings("label").removeClass("active")}))},M.validate_field=function(t){var e=null!==t.attr("data-length"),n=parseInt(t.attr("data-length")),i=t[0].value.length;0!==i||!1!==t[0].validity.badInput||t.is(":required")?t.hasClass("validate")&&(t.is(":valid")&&e&&i<=n||t.is(":valid")&&!e?(t.removeClass("invalid"),t.addClass("valid")):(t.removeClass("valid"),t.addClass("invalid"))):t.hasClass("validate")&&(t.removeClass("valid"),t.removeClass("invalid"))},M.textareaAutoResize=function(e){if(e instanceof Element&&(e=t(e)),e.length){var n=t(".hiddendiv").first();n.length||(n=t('<div class="hiddendiv common"></div>'),t("body").append(n));var i=e.css("font-family"),o=e.css("font-size"),r=e.css("line-height"),s=e.css("padding-top"),a=e.css("padding-right"),l=e.css("padding-bottom"),c=e.css("padding-left");o&&n.css("font-size",o),i&&n.css("font-family",i),r&&n.css("line-height",r),s&&n.css("padding-top",s),a&&n.css("padding-right",a),l&&n.css("padding-bottom",l),c&&n.css("padding-left",c),e.data("original-height")||e.data("original-height",e.height()),"off"===e.attr("wrap")&&n.css("overflow-wrap","normal").css("white-space","pre"),n.text(e[0].value+"\n");var h=n.html().replace(/\n/g,"<br>");n.html(h),e[0].offsetWidth>0&&e[0].offsetHeight>0?n.css("width",e.width()+"px"):n.css("width",window.innerWidth/2+"px"),e.data("original-height")<=n.innerHeight()?e.css("height",n.innerHeight()+"px"):e[0].value.length<e.data("previous-length")&&e.css("height",e.data("original-height")+"px"),e.data("previous-length",e[0].value.length)}else console.error("No textarea element found")},t(document).ready((function(){var e="input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], input[type=date], input[type=time], textarea";t(document).on("change",e,(function(){0===this.value.length&&null===t(this).attr("placeholder")||t(this).siblings("label").addClass("active"),M.validate_field(t(this))})),t(document).ready((function(){M.updateTextFields()})),t(document).on("reset",(function(n){var i=t(n.target);i.is("form")&&(i.find(e).removeClass("valid").removeClass("invalid"),i.find(e).each((function(e){this.value.length&&t(this).siblings("label").removeClass("active")})),setTimeout((function(){i.find("select").each((function(){this.M_FormSelect&&t(this).trigger("change")}))}),0))})),document.addEventListener("focus",(function(n){t(n.target).is(e)&&t(n.target).siblings("label, .prefix").addClass("active")}),!0),document.addEventListener("blur",(function(n){var i=t(n.target);if(i.is(e)){var o=".prefix";0===i[0].value.length&&!0!==i[0].validity.badInput&&null===i.attr("placeholder")&&(o+=", label"),i.siblings(o).removeClass("active"),M.validate_field(i)}}),!0);t(document).on("keyup","input[type=radio], input[type=checkbox]",(function(e){if(e.which===M.keys.TAB)return t(this).addClass("tabbed"),void t(this).one("blur",(function(e){t(this).removeClass("tabbed")}))}));var n=".materialize-textarea";t(n).each((function(){var e=t(this);e.data("original-height",e.height()),e.data("previous-length",this.value.length),M.textareaAutoResize(e)})),t(document).on("keyup",n,(function(){M.textareaAutoResize(t(this))})),t(document).on("keydown",n,(function(){M.textareaAutoResize(t(this))})),t(document).on("change",'.file-field input[type="file"]',(function(){for(var e=t(this).closest(".file-field").find("input.file-path"),n=t(this)[0].files,i=[],o=0;o<n.length;o++)i.push(n[o].name);e[0].value=i.join(", "),e.trigger("change")}))}))}(cash),function(t,e){var l={indicators:!0,height:400,duration:500,interval:6e3},c=function(a){function c(n,i){s(this,c);var r=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,n,i));return r.el.M_Slider=r,r.options=t.extend({},c.defaults,i),r.$slider=r.$el.find(".slides"),r.$slides=r.$slider.children("li"),r.activeIndex=r.$slides.filter((function(e){return t(e).hasClass("active")})).first().index(),-1!=r.activeIndex&&(r.$active=r.$slides.eq(r.activeIndex)),r._setSliderHeight(),r.$slides.find(".caption").each((function(t){r._animateCaptionIn(t,0)})),r.$slides.find("img").each((function(e){var n="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";t(e).attr("src")!==n&&(t(e).css("background-image",'url("'+t(e).attr("src")+'")'),t(e).attr("src",n))})),r._setupIndicators(),r.$active?r.$active.css("display","block"):(r.$slides.first().addClass("active"),e({targets:r.$slides.first()[0],opacity:1,duration:r.options.duration,easing:"easeOutQuad"}),r.activeIndex=0,r.$active=r.$slides.eq(r.activeIndex),r.options.indicators&&r.$indicators.eq(r.activeIndex).addClass("active")),r.$active.find("img").each((function(t){e({targets:r.$active.find(".caption")[0],opacity:1,translateX:0,translateY:0,duration:r.options.duration,easing:"easeOutQuad"})})),r._setupEventHandlers(),r.start(),r}return r(c,a),i(c,[{key:"destroy",value:function(){this.pause(),this._removeIndicators(),this._removeEventHandlers(),this.el.M_Slider=void 0}},{key:"_setupEventHandlers",value:function(){var t=this;this._handleIntervalBound=this._handleInterval.bind(this),this._handleIndicatorClickBound=this._handleIndicatorClick.bind(this),this.options.indicators&&this.$indicators.each((function(e){e.addEventListener("click",t._handleIndicatorClickBound)}))}},{key:"_removeEventHandlers",value:function(){var t=this;this.options.indicators&&this.$indicators.each((function(e){e.removeEventListener("click",t._handleIndicatorClickBound)}))}},{key:"_handleIndicatorClick",value:function(e){var n=t(e.target).index();this.set(n)}},{key:"_handleInterval",value:function(){var t=this.$slider.find(".active").index();this.$slides.length===t+1?t=0:t+=1,this.set(t)}},{key:"_animateCaptionIn",value:function(n,i){var o={targets:n,opacity:0,duration:i,easing:"easeOutQuad"};t(n).hasClass("center-align")?o.translateY=-100:t(n).hasClass("right-align")?o.translateX=100:t(n).hasClass("left-align")&&(o.translateX=-100),e(o)}},{key:"_setSliderHeight",value:function(){this.$el.hasClass("fullscreen")||(this.options.indicators?this.$el.css("height",this.options.height+40+"px"):this.$el.css("height",this.options.height+"px"),this.$slider.css("height",this.options.height+"px"))}},{key:"_setupIndicators",value:function(){var e=this;this.options.indicators&&(this.$indicators=t('<ul class="indicators"></ul>'),this.$slides.each((function(n,i){var o=t('<li class="indicator-item"></li>');e.$indicators.append(o[0])})),this.$el.append(this.$indicators[0]),this.$indicators=this.$indicators.children("li.indicator-item"))}},{key:"_removeIndicators",value:function(){this.$el.find("ul.indicators").remove()}},{key:"set",value:function(t){var n=this;if(t>=this.$slides.length?t=0:t<0&&(t=this.$slides.length-1),this.activeIndex!=t){this.$active=this.$slides.eq(this.activeIndex);var i=this.$active.find(".caption");this.$active.removeClass("active"),e({targets:this.$active[0],opacity:0,duration:this.options.duration,easing:"easeOutQuad",complete:function(){n.$slides.not(".active").each((function(t){e({targets:t,opacity:0,translateX:0,translateY:0,duration:0,easing:"easeOutQuad"})}))}}),this._animateCaptionIn(i[0],this.options.duration),this.options.indicators&&(this.$indicators.eq(this.activeIndex).removeClass("active"),this.$indicators.eq(t).addClass("active")),e({targets:this.$slides.eq(t)[0],opacity:1,duration:this.options.duration,easing:"easeOutQuad"}),e({targets:this.$slides.eq(t).find(".caption")[0],opacity:1,translateX:0,translateY:0,duration:this.options.duration,delay:this.options.duration,easing:"easeOutQuad"}),this.$slides.eq(t).addClass("active"),this.activeIndex=t,this.start()}}},{key:"pause",value:function(){clearInterval(this.interval)}},{key:"start",value:function(){clearInterval(this.interval),this.interval=setInterval(this._handleIntervalBound,this.options.duration+this.options.interval)}},{key:"next",value:function(){var t=this.activeIndex+1;t>=this.$slides.length?t=0:t<0&&(t=this.$slides.length-1),this.set(t)}},{key:"prev",value:function(){var t=this.activeIndex-1;t>=this.$slides.length?t=0:t<0&&(t=this.$slides.length-1),this.set(t)}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Slider}},{key:"defaults",get:function(){return l}}]),c}(a);M.Slider=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"slider","M_Slider")}(cash,M.anime),function(t,e){t(document).on("click",".card",(function(n){if(t(this).children(".card-reveal").length){var i=t(n.target).closest(".card");void 0===i.data("initialOverflow")&&i.data("initialOverflow",void 0===i.css("overflow")?"":i.css("overflow"));var o=t(this).find(".card-reveal");t(n.target).is(t(".card-reveal .card-title"))||t(n.target).is(t(".card-reveal .card-title i"))?e({targets:o[0],translateY:0,duration:225,easing:"easeInOutQuad",complete:function(e){var n=e.animatables[0].target;t(n).css({display:"none"}),i.css("overflow",i.data("initialOverflow"))}}):(t(n.target).is(t(".card .activator"))||t(n.target).is(t(".card .activator i")))&&(i.css("overflow","hidden"),o.css({display:"block"}),e({targets:o[0],translateY:"-100%",duration:300,easing:"easeInOutQuad"}))}}))}(cash,M.anime),function(t){var e={data:[],placeholder:"",secondaryPlaceholder:"",autocompleteOptions:{},limit:1/0,onChipAdd:null,onChipSelect:null,onChipDelete:null},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_Chips=i,i.options=t.extend({},l.defaults,n),i.$el.addClass("chips input-field"),i.chipsData=[],i.$chips=t(),i._setupInput(),i.hasAutocomplete=Object.keys(i.options.autocompleteOptions).length>0,i.$input.attr("id")||i.$input.attr("id",M.guid()),i.options.data.length&&(i.chipsData=i.options.data,i._renderChips(i.chipsData)),i.hasAutocomplete&&i._setupAutocomplete(),i._setPlaceholder(),i._setupLabel(),i._setupEventHandlers(),i}return r(l,a),i(l,[{key:"getData",value:function(){return this.chipsData}},{key:"destroy",value:function(){this._removeEventHandlers(),this.$chips.remove(),this.el.M_Chips=void 0}},{key:"_setupEventHandlers",value:function(){this._handleChipClickBound=this._handleChipClick.bind(this),this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputFocusBound=this._handleInputFocus.bind(this),this._handleInputBlurBound=this._handleInputBlur.bind(this),this.el.addEventListener("click",this._handleChipClickBound),document.addEventListener("keydown",l._handleChipsKeydown),document.addEventListener("keyup",l._handleChipsKeyup),this.el.addEventListener("blur",l._handleChipsBlur,!0),this.$input[0].addEventListener("focus",this._handleInputFocusBound),this.$input[0].addEventListener("blur",this._handleInputBlurBound),this.$input[0].addEventListener("keydown",this._handleInputKeydownBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleChipClickBound),document.removeEventListener("keydown",l._handleChipsKeydown),document.removeEventListener("keyup",l._handleChipsKeyup),this.el.removeEventListener("blur",l._handleChipsBlur,!0),this.$input[0].removeEventListener("focus",this._handleInputFocusBound),this.$input[0].removeEventListener("blur",this._handleInputBlurBound),this.$input[0].removeEventListener("keydown",this._handleInputKeydownBound)}},{key:"_handleChipClick",value:function(e){var n=t(e.target).closest(".chip"),i=t(e.target).is(".close");if(n.length){var o=n.index();i?(this.deleteChip(o),this.$input[0].focus()):this.selectChip(o)}else this.$input[0].focus()}},{key:"_handleInputFocus",value:function(){this.$el.addClass("focus")}},{key:"_handleInputBlur",value:function(){this.$el.removeClass("focus")}},{key:"_handleInputKeydown",value:function(t){if(l._keydown=!0,13===t.keyCode){if(this.hasAutocomplete&&this.autocomplete&&this.autocomplete.isOpen)return;t.preventDefault(),this.addChip({tag:this.$input[0].value}),this.$input[0].value=""}else 8!==t.keyCode&&37!==t.keyCode||""!==this.$input[0].value||!this.chipsData.length||(t.preventDefault(),this.selectChip(this.chipsData.length-1))}},{key:"_renderChip",value:function(e){if(e.tag){var n=document.createElement("div"),i=document.createElement("i");if(n.classList.add("chip"),n.textContent=e.tag,n.setAttribute("tabindex",0),t(i).addClass("material-icons close"),i.textContent="close",e.image){var o=document.createElement("img");o.setAttribute("src",e.image),n.insertBefore(o,n.firstChild)}return n.appendChild(i),n}}},{key:"_renderChips",value:function(){this.$chips.remove();for(var t=0;t<this.chipsData.length;t++){var e=this._renderChip(this.chipsData[t]);this.$el.append(e),this.$chips.add(e)}this.$el.append(this.$input[0])}},{key:"_setupAutocomplete",value:function(){var t=this;this.options.autocompleteOptions.onAutocomplete=function(e){t.addChip({tag:e}),t.$input[0].value="",t.$input[0].focus()},this.autocomplete=M.Autocomplete.init(this.$input[0],this.options.autocompleteOptions)}},{key:"_setupInput",value:function(){this.$input=this.$el.find("input"),this.$input.length||(this.$input=t("<input></input>"),this.$el.append(this.$input)),this.$input.addClass("input")}},{key:"_setupLabel",value:function(){this.$label=this.$el.find("label"),this.$label.length&&this.$label.setAttribute("for",this.$input.attr("id"))}},{key:"_setPlaceholder",value:function(){void 0!==this.chipsData&&!this.chipsData.length&&this.options.placeholder?t(this.$input).prop("placeholder",this.options.placeholder):(void 0===this.chipsData||this.chipsData.length)&&this.options.secondaryPlaceholder&&t(this.$input).prop("placeholder",this.options.secondaryPlaceholder)}},{key:"_isValid",value:function(t){if(t.hasOwnProperty("tag")&&""!==t.tag){for(var e=!1,n=0;n<this.chipsData.length;n++)if(this.chipsData[n].tag===t.tag){e=!0;break}return!e}return!1}},{key:"addChip",value:function(e){if(this._isValid(e)&&!(this.chipsData.length>=this.options.limit)){var n=this._renderChip(e);this.$chips.add(n),this.chipsData.push(e),t(this.$input).before(n),this._setPlaceholder(),"function"==typeof this.options.onChipAdd&&this.options.onChipAdd.call(this,this.$el,n)}}},{key:"deleteChip",value:function(e){var n=this.$chips.eq(e);this.$chips.eq(e).remove(),this.$chips=this.$chips.filter((function(e){return t(e).index()>=0})),this.chipsData.splice(e,1),this._setPlaceholder(),"function"==typeof this.options.onChipDelete&&this.options.onChipDelete.call(this,this.$el,n[0])}},{key:"selectChip",value:function(t){var e=this.$chips.eq(t);this._selectedChip=e,e[0].focus(),"function"==typeof this.options.onChipSelect&&this.options.onChipSelect.call(this,this.$el,e[0])}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Chips}},{key:"_handleChipsKeydown",value:function(e){l._keydown=!0;var n=t(e.target).closest(".chips"),i=e.target&&n.length;if(!t(e.target).is("input, textarea")&&i){var o=n[0].M_Chips;if(8===e.keyCode||46===e.keyCode){e.preventDefault();var r=o.chipsData.length;if(o._selectedChip){var s=o._selectedChip.index();o.deleteChip(s),o._selectedChip=null,r=Math.max(s-1,0)}o.chipsData.length&&o.selectChip(r)}else if(37===e.keyCode){if(o._selectedChip){var a=o._selectedChip.index()-1;if(a<0)return;o.selectChip(a)}}else if(39===e.keyCode&&o._selectedChip){var c=o._selectedChip.index()+1;c>=o.chipsData.length?o.$input[0].focus():o.selectChip(c)}}}},{key:"_handleChipsKeyup",value:function(t){l._keydown=!1}},{key:"_handleChipsBlur",value:function(e){l._keydown||(t(e.target).closest(".chips")[0].M_Chips._selectedChip=null)}},{key:"defaults",get:function(){return e}}]),l}(a);l._keydown=!1,M.Chips=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"chips","M_Chips"),t(document).ready((function(){t(document.body).on("click",".chip .close",(function(){var e=t(this).closest(".chips");e.length&&e[0].M_Chips||t(this).closest(".chip").remove()}))}))}(cash),function(t){var e={top:0,bottom:1/0,offset:0,onPositionChange:null},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_Pushpin=i,i.options=t.extend({},l.defaults,n),i.originalOffset=i.el.offsetTop,l._pushpins.push(i),i._setupEventHandlers(),i._updatePosition(),i}return r(l,a),i(l,[{key:"destroy",value:function(){this.el.style.top=null,this._removePinClasses(),this._removeEventHandlers();var t=l._pushpins.indexOf(this);l._pushpins.splice(t,1)}},{key:"_setupEventHandlers",value:function(){document.addEventListener("scroll",l._updateElements)}},{key:"_removeEventHandlers",value:function(){document.removeEventListener("scroll",l._updateElements)}},{key:"_updatePosition",value:function(){var t=M.getDocumentScrollTop()+this.options.offset;this.options.top<=t&&this.options.bottom>=t&&!this.el.classList.contains("pinned")&&(this._removePinClasses(),this.el.style.top=this.options.offset+"px",this.el.classList.add("pinned"),"function"==typeof this.options.onPositionChange&&this.options.onPositionChange.call(this,"pinned")),t<this.options.top&&!this.el.classList.contains("pin-top")&&(this._removePinClasses(),this.el.style.top=0,this.el.classList.add("pin-top"),"function"==typeof this.options.onPositionChange&&this.options.onPositionChange.call(this,"pin-top")),t>this.options.bottom&&!this.el.classList.contains("pin-bottom")&&(this._removePinClasses(),this.el.classList.add("pin-bottom"),this.el.style.top=this.options.bottom-this.originalOffset+"px","function"==typeof this.options.onPositionChange&&this.options.onPositionChange.call(this,"pin-bottom"))}},{key:"_removePinClasses",value:function(){this.el.classList.remove("pin-top"),this.el.classList.remove("pinned"),this.el.classList.remove("pin-bottom")}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Pushpin}},{key:"_updateElements",value:function(){for(var t in l._pushpins){l._pushpins[t]._updatePosition()}}},{key:"defaults",get:function(){return e}}]),l}(a);l._pushpins=[],M.Pushpin=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"pushpin","M_Pushpin")}(cash),function(t,e){var l={direction:"top",hoverEnabled:!0,toolbarEnabled:!1};t.fn.reverse=[].reverse;var c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_FloatingActionButton=i,i.options=t.extend({},c.defaults,n),i.isOpen=!1,i.$anchor=i.$el.children("a").first(),i.$menu=i.$el.children("ul").first(),i.$floatingBtns=i.$el.find("ul .btn-floating"),i.$floatingBtnsReverse=i.$el.find("ul .btn-floating").reverse(),i.offsetY=0,i.offsetX=0,i.$el.addClass("direction-"+i.options.direction),"top"===i.options.direction?i.offsetY=40:"right"===i.options.direction?i.offsetX=-40:"bottom"===i.options.direction?i.offsetY=-40:i.offsetX=40,i._setupEventHandlers(),i}return r(c,a),i(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_FloatingActionButton=void 0}},{key:"_setupEventHandlers",value:function(){this._handleFABClickBound=this._handleFABClick.bind(this),this._handleOpenBound=this.open.bind(this),this._handleCloseBound=this.close.bind(this),this.options.hoverEnabled&&!this.options.toolbarEnabled?(this.el.addEventListener("mouseenter",this._handleOpenBound),this.el.addEventListener("mouseleave",this._handleCloseBound)):this.el.addEventListener("click",this._handleFABClickBound)}},{key:"_removeEventHandlers",value:function(){this.options.hoverEnabled&&!this.options.toolbarEnabled?(this.el.removeEventListener("mouseenter",this._handleOpenBound),this.el.removeEventListener("mouseleave",this._handleCloseBound)):this.el.removeEventListener("click",this._handleFABClickBound)}},{key:"_handleFABClick",value:function(){this.isOpen?this.close():this.open()}},{key:"_handleDocumentClick",value:function(e){t(e.target).closest(this.$menu).length||this.close()}},{key:"open",value:function(){this.isOpen||(this.options.toolbarEnabled?this._animateInToolbar():this._animateInFAB(),this.isOpen=!0)}},{key:"close",value:function(){this.isOpen&&(this.options.toolbarEnabled?(window.removeEventListener("scroll",this._handleCloseBound,!0),document.body.removeEventListener("click",this._handleDocumentClickBound,!0),this._animateOutToolbar()):this._animateOutFAB(),this.isOpen=!1)}},{key:"_animateInFAB",value:function(){var t=this;this.$el.addClass("active");var n=0;this.$floatingBtnsReverse.each((function(i){e({targets:i,opacity:1,scale:[.4,1],translateY:[t.offsetY,0],translateX:[t.offsetX,0],duration:275,delay:n,easing:"easeInOutQuad"}),n+=40}))}},{key:"_animateOutFAB",value:function(){var t=this;this.$floatingBtnsReverse.each((function(n){e.remove(n),e({targets:n,opacity:0,scale:.4,translateY:t.offsetY,translateX:t.offsetX,duration:175,easing:"easeOutQuad",complete:function(){t.$el.removeClass("active")}})}))}},{key:"_animateInToolbar",value:function(){var e,n=this,i=window.innerWidth,o=window.innerHeight,r=this.el.getBoundingClientRect(),s=t('<div class="fab-backdrop"></div>'),a=this.$anchor.css("background-color");this.$anchor.append(s),this.offsetX=r.left-i/2+r.width/2,this.offsetY=o-r.bottom,e=i/s[0].clientWidth,this.btnBottom=r.bottom,this.btnLeft=r.left,this.btnWidth=r.width,this.$el.addClass("active"),this.$el.css({"text-align":"center",width:"100%",bottom:0,left:0,transform:"translateX("+this.offsetX+"px)",transition:"none"}),this.$anchor.css({transform:"translateY("+-this.offsetY+"px)",transition:"none"}),s.css({"background-color":a}),setTimeout((function(){n.$el.css({transform:"",transition:"transform .2s cubic-bezier(0.550, 0.085, 0.680, 0.530), background-color 0s linear .2s"}),n.$anchor.css({overflow:"visible",transform:"",transition:"transform .2s"}),setTimeout((function(){n.$el.css({overflow:"hidden","background-color":a}),s.css({transform:"scale("+e+")",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"}),n.$menu.children("li").children("a").css({opacity:1}),n._handleDocumentClickBound=n._handleDocumentClick.bind(n),window.addEventListener("scroll",n._handleCloseBound,!0),document.body.addEventListener("click",n._handleDocumentClickBound,!0)}),100)}),0)}},{key:"_animateOutToolbar",value:function(){var t=this,e=window.innerWidth,n=window.innerHeight,i=this.$el.find(".fab-backdrop"),o=this.$anchor.css("background-color");this.offsetX=this.btnLeft-e/2+this.btnWidth/2,this.offsetY=n-this.btnBottom,this.$el.removeClass("active"),this.$el.css({"background-color":"transparent",transition:"none"}),this.$anchor.css({transition:"none"}),i.css({transform:"scale(0)","background-color":o}),this.$menu.children("li").children("a").css({opacity:""}),setTimeout((function(){i.remove(),t.$el.css({"text-align":"",width:"",bottom:"",left:"",overflow:"","background-color":"",transform:"translate3d("+-t.offsetX+"px,0,0)"}),t.$anchor.css({overflow:"",transform:"translate3d(0,"+t.offsetY+"px,0)"}),setTimeout((function(){t.$el.css({transform:"translate3d(0,0,0)",transition:"transform .2s"}),t.$anchor.css({transform:"translate3d(0,0,0)",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"})}),20)}),200)}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_FloatingActionButton}},{key:"defaults",get:function(){return l}}]),c}(a);M.FloatingActionButton=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"floatingActionButton","M_FloatingActionButton")}(cash,M.anime),function(t){var e={autoClose:!1,format:"mmm dd, yyyy",parse:null,defaultDate:null,setDefaultDate:!1,disableWeekends:!1,disableDayFn:null,firstDay:0,minDate:null,maxDate:null,yearRange:10,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,container:null,showClearBtn:!1,i18n:{cancel:"Cancel",clear:"Clear",done:"Ok",previousMonth:"‹",nextMonth:"›",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysAbbrev:["S","M","T","W","T","F","S"]},events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));i.el.M_Datepicker=i,i.options=t.extend({},l.defaults,n),n&&n.hasOwnProperty("i18n")&&"object"==typeof n.i18n&&(i.options.i18n=t.extend({},l.defaults.i18n,n.i18n)),i.options.minDate&&i.options.minDate.setHours(0,0,0,0),i.options.maxDate&&i.options.maxDate.setHours(0,0,0,0),i.id=M.guid(),i._setupVariables(),i._insertHTMLIntoDOM(),i._setupModal(),i._setupEventHandlers(),i.options.defaultDate||(i.options.defaultDate=new Date(Date.parse(i.el.value)));var r=i.options.defaultDate;return l._isDate(r)?i.options.setDefaultDate?(i.setDate(r,!0),i.setInputValue()):i.gotoDate(r):i.gotoDate(new Date),i.isOpen=!1,i}return r(l,a),i(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.modal.destroy(),t(this.modalEl).remove(),this.destroySelects(),this.el.M_Datepicker=void 0}},{key:"destroySelects",value:function(){var t=this.calendarEl.querySelector(".orig-select-year");t&&M.FormSelect.getInstance(t).destroy();var e=this.calendarEl.querySelector(".orig-select-month");e&&M.FormSelect.getInstance(e).destroy()}},{key:"_insertHTMLIntoDOM",value:function(){this.options.showClearBtn&&(t(this.clearBtn).css({visibility:""}),this.clearBtn.innerHTML=this.options.i18n.clear),this.doneBtn.innerHTML=this.options.i18n.done,this.cancelBtn.innerHTML=this.options.i18n.cancel,this.options.container?this.$modalEl.appendTo(this.options.container):this.$modalEl.insertBefore(this.el)}},{key:"_setupModal",value:function(){var t=this;this.modalEl.id="modal-"+this.id,this.modal=M.Modal.init(this.modalEl,{onCloseEnd:function(){t.isOpen=!1}})}},{key:"toString",value:function(t){var e=this;return t=t||this.options.format,l._isDate(this.date)?t.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g).map((function(t){return e.formats[t]?e.formats[t]():t})).join(""):""}},{key:"setDate",value:function(t,e){if(!t)return this.date=null,this._renderDateDisplay(),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),l._isDate(t)){var n=this.options.minDate,i=this.options.maxDate;l._isDate(n)&&t<n?t=n:l._isDate(i)&&t>i&&(t=i),this.date=new Date(t.getTime()),this._renderDateDisplay(),l._setToStartOfDay(this.date),this.gotoDate(this.date),e||"function"!=typeof this.options.onSelect||this.options.onSelect.call(this,this.date)}}},{key:"setInputValue",value:function(){this.el.value=this.toString(),this.$el.trigger("change",{firedBy:this})}},{key:"_renderDateDisplay",value:function(){var t=l._isDate(this.date)?this.date:new Date,e=this.options.i18n,n=e.weekdaysShort[t.getDay()],i=e.monthsShort[t.getMonth()],o=t.getDate();this.yearTextEl.innerHTML=t.getFullYear(),this.dateTextEl.innerHTML=n+", "+i+" "+o}},{key:"gotoDate",value:function(t){var e=!0;if(l._isDate(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=o<n.getTime()||i.getTime()<o}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}]),this.adjustCalendars()}}},{key:"adjustCalendars",value:function(){this.calendars[0]=this.adjustCalendar(this.calendars[0]),this.draw()}},{key:"adjustCalendar",value:function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t}},{key:"nextMonth",value:function(){this.calendars[0].month++,this.adjustCalendars()}},{key:"prevMonth",value:function(){this.calendars[0].month--,this.adjustCalendars()}},{key:"render",value:function(t,e,n){var i=this.options,o=new Date,r=l._getDaysInMonth(t,e),s=new Date(t,e,1).getDay(),a=[],c=[];l._setToStartOfDay(o),i.firstDay>0&&(s-=i.firstDay)<0&&(s+=7);for(var h=0===e?11:e-1,u=11===e?0:e+1,d=0===e?t-1:t,p=11===e?t+1:t,_=l._getDaysInMonth(d,h),f=r+s,m=f;m>7;)m-=7;f+=7-m;for(var g=!1,v=0,y=0;v<f;v++){var b=new Date(t,e,v-s+1),k=!!l._isDate(this.date)&&l._compareDates(b,this.date),w=l._compareDates(b,o),x=-1!==i.events.indexOf(b.toDateString()),L=v<s||v>=r+s,$=v-s+1,M=e,C=t,E=i.startRange&&l._compareDates(i.startRange,b),P=i.endRange&&l._compareDates(i.endRange,b),T=i.startRange&&i.endRange&&i.startRange<b&&b<i.endRange;L&&(v<s?($=_+$,M=h,C=d):($-=r,M=u,C=p));var S={day:$,month:M,year:C,hasEvent:x,isSelected:k,isToday:w,isDisabled:i.minDate&&b<i.minDate||i.maxDate&&b>i.maxDate||i.disableWeekends&&l._isWeekend(b)||i.disableDayFn&&i.disableDayFn(b),isEmpty:L,isStartRange:E,isEndRange:P,isInRange:T,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths};c.push(this.renderDay(S)),7==++y&&(a.push(this.renderRow(c,i.isRTL,g)),c=[],y=0,g=!1)}return this.renderTable(i,a,n)}},{key:"renderDay",value:function(t){var e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="datepicker-day-button" type="button" data-year="'+t.year+'" data-month="'+t.month+'" data-day="'+t.day+'">'+t.day+"</button></td>"}},{key:"renderRow",value:function(t,e,n){return'<tr class="datepicker-row'+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"}},{key:"renderTable",value:function(t,e,n){return'<div class="datepicker-table-wrapper"><table cellpadding="0" cellspacing="0" class="datepicker-table" role="grid" aria-labelledby="'+n+'">'+this.renderHead(t)+this.renderBody(e)+"</table></div>"}},{key:"renderHead",value:function(t){var e=void 0,n=[];for(e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+this.renderDayName(t,e)+'">'+this.renderDayName(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"}},{key:"renderBody",value:function(t){return"<tbody>"+t.join("")+"</tbody>"}},{key:"renderTitle",value:function(e,n,i,o,r,s){var a,l,c=void 0,h=void 0,u=void 0,d=this.options,p=i===d.minYear,_=i===d.maxYear,f='<div id="'+s+'" class="datepicker-controls" role="heading" aria-live="assertive">',m=!0,g=!0;for(u=[],c=0;c<12;c++)u.push('<option value="'+(i===r?c-n:12+c-n)+'"'+(c===o?' selected="selected"':"")+(p&&c<d.minMonth||_&&c>d.maxMonth?'disabled="disabled"':"")+">"+d.i18n.months[c]+"</option>");for(a='<select class="datepicker-select orig-select-month" tabindex="-1">'+u.join("")+"</select>",t.isArray(d.yearRange)?(c=d.yearRange[0],h=d.yearRange[1]+1):(c=i-d.yearRange,h=1+i+d.yearRange),u=[];c<h&&c<=d.maxYear;c++)c>=d.minYear&&u.push('<option value="'+c+'" '+(c===i?'selected="selected"':"")+">"+c+"</option>");l='<select class="datepicker-select orig-select-year" tabindex="-1">'+u.join("")+"</select>";f+='<button class="month-prev'+(m?"":" is-disabled")+'" type="button"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"/><path d="M0-.5h24v24H0z" fill="none"/></svg></button>',f+='<div class="selects-container">',d.showMonthAfterYear?f+=l+a:f+=a+l,f+="</div>",p&&(0===o||d.minMonth>=o)&&(m=!1),_&&(11===o||d.maxMonth<=o)&&(g=!1);return(f+='<button class="month-next'+(g?"":" is-disabled")+'" type="button"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"/><path d="M0-.25h24v24H0z" fill="none"/></svg></button>')+"</div>"}},{key:"draw",value:function(t){if(this.isOpen||t){var e,n=this.options,i=n.minYear,o=n.maxYear,r=n.minMonth,s=n.maxMonth,a="";this._y<=i&&(this._y=i,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=o&&(this._y=o,!isNaN(s)&&this._m>s&&(this._m=s)),e="datepicker-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var l=0;l<1;l++)this._renderDateDisplay(),a+=this.renderTitle(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,e)+this.render(this.calendars[l].year,this.calendars[l].month,e);this.destroySelects(),this.calendarEl.innerHTML=a;var c=this.calendarEl.querySelector(".orig-select-year"),h=this.calendarEl.querySelector(".orig-select-month");M.FormSelect.init(c,{classes:"select-year",dropdownOptions:{container:document.body,constrainWidth:!1}}),M.FormSelect.init(h,{classes:"select-month",dropdownOptions:{container:document.body,constrainWidth:!1}}),c.addEventListener("change",this._handleYearChange.bind(this)),h.addEventListener("change",this._handleMonthChange.bind(this)),"function"==typeof this.options.onDraw&&this.options.onDraw(this)}}},{key:"_setupEventHandlers",value:function(){this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),this._handleInputChangeBound=this._handleInputChange.bind(this),this._handleCalendarClickBound=this._handleCalendarClick.bind(this),this._finishSelectionBound=this._finishSelection.bind(this),this._handleMonthChange=this._handleMonthChange.bind(this),this._closeBound=this.close.bind(this),this.el.addEventListener("click",this._handleInputClickBound),this.el.addEventListener("keydown",this._handleInputKeydownBound),this.el.addEventListener("change",this._handleInputChangeBound),this.calendarEl.addEventListener("click",this._handleCalendarClickBound),this.doneBtn.addEventListener("click",this._finishSelectionBound),this.cancelBtn.addEventListener("click",this._closeBound),this.options.showClearBtn&&(this._handleClearClickBound=this._handleClearClick.bind(this),this.clearBtn.addEventListener("click",this._handleClearClickBound))}},{key:"_setupVariables",value:function(){var e=this;this.$modalEl=t(l._template),this.modalEl=this.$modalEl[0],this.calendarEl=this.modalEl.querySelector(".datepicker-calendar"),this.yearTextEl=this.modalEl.querySelector(".year-text"),this.dateTextEl=this.modalEl.querySelector(".date-text"),this.options.showClearBtn&&(this.clearBtn=this.modalEl.querySelector(".datepicker-clear")),this.doneBtn=this.modalEl.querySelector(".datepicker-done"),this.cancelBtn=this.modalEl.querySelector(".datepicker-cancel"),this.formats={d:function(){return e.date.getDate()},dd:function(){var t=e.date.getDate();return(t<10?"0":"")+t},ddd:function(){return e.options.i18n.weekdaysShort[e.date.getDay()]},dddd:function(){return e.options.i18n.weekdays[e.date.getDay()]},m:function(){return e.date.getMonth()+1},mm:function(){var t=e.date.getMonth()+1;return(t<10?"0":"")+t},mmm:function(){return e.options.i18n.monthsShort[e.date.getMonth()]},mmmm:function(){return e.options.i18n.months[e.date.getMonth()]},yy:function(){return(""+e.date.getFullYear()).slice(2)},yyyy:function(){return e.date.getFullYear()}}}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleInputClickBound),this.el.removeEventListener("keydown",this._handleInputKeydownBound),this.el.removeEventListener("change",this._handleInputChangeBound),this.calendarEl.removeEventListener("click",this._handleCalendarClickBound)}},{key:"_handleInputClick",value:function(){this.open()}},{key:"_handleInputKeydown",value:function(t){t.which===M.keys.ENTER&&(t.preventDefault(),this.open())}},{key:"_handleCalendarClick",value:function(e){if(this.isOpen){var n=t(e.target);n.hasClass("is-disabled")||(!n.hasClass("datepicker-day-button")||n.hasClass("is-empty")||n.parent().hasClass("is-disabled")?n.closest(".month-prev").length?this.prevMonth():n.closest(".month-next").length&&this.nextMonth():(this.setDate(new Date(e.target.getAttribute("data-year"),e.target.getAttribute("data-month"),e.target.getAttribute("data-day"))),this.options.autoClose&&this._finishSelection()))}}},{key:"_handleClearClick",value:function(){this.date=null,this.setInputValue(),this.close()}},{key:"_handleMonthChange",value:function(t){this.gotoMonth(t.target.value)}},{key:"_handleYearChange",value:function(t){this.gotoYear(t.target.value)}},{key:"gotoMonth",value:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())}},{key:"gotoYear",value:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())}},{key:"_handleInputChange",value:function(t){var e=void 0;t.firedBy!==this&&(e=this.options.parse?this.options.parse(this.el.value,this.options.format):new Date(Date.parse(this.el.value)),l._isDate(e)&&this.setDate(e))}},{key:"renderDayName",value:function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysAbbrev[e]:t.i18n.weekdays[e]}},{key:"_finishSelection",value:function(){this.setInputValue(),this.close()}},{key:"open",value:function(){if(!this.isOpen)return this.isOpen=!0,"function"==typeof this.options.onOpen&&this.options.onOpen.call(this),this.draw(),this.modal.open(),this}},{key:"close",value:function(){if(this.isOpen)return this.isOpen=!1,"function"==typeof this.options.onClose&&this.options.onClose.call(this),this.modal.close(),this}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"_isDate",value:function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())}},{key:"_isWeekend",value:function(t){var e=t.getDay();return 0===e||6===e}},{key:"_setToStartOfDay",value:function(t){l._isDate(t)&&t.setHours(0,0,0,0)}},{key:"_getDaysInMonth",value:function(t,e){return[31,l._isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]}},{key:"_isLeapYear",value:function(t){return t%4==0&&t%100!=0||t%400==0}},{key:"_compareDates",value:function(t,e){return t.getTime()===e.getTime()}},{key:"_setToStartOfDay",value:function(t){l._isDate(t)&&t.setHours(0,0,0,0)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Datepicker}},{key:"defaults",get:function(){return e}}]),l}(a);l._template=['<div class= "modal datepicker-modal">','<div class="modal-content datepicker-container">','<div class="datepicker-date-display">','<span class="year-text"></span>','<span class="date-text"></span>',"</div>",'<div class="datepicker-calendar-container">','<div class="datepicker-calendar"></div>','<div class="datepicker-footer">','<button class="btn-flat datepicker-clear waves-effect" style="visibility: hidden;" type="button"></button>','<div class="confirmation-btns">','<button class="btn-flat datepicker-cancel waves-effect" type="button"></button>','<button class="btn-flat datepicker-done waves-effect" type="button"></button>',"</div>","</div>","</div>","</div>","</div>"].join(""),M.Datepicker=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"datepicker","M_Datepicker")}(cash),function(t){var e={dialRadius:135,outerRadius:105,innerRadius:70,tickRadius:20,duration:350,container:null,defaultTime:"now",fromNow:0,showClearBtn:!1,i18n:{cancel:"Cancel",clear:"Clear",done:"Ok"},autoClose:!1,twelveHour:!0,vibrate:!0,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,onSelect:null},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_Timepicker=i,i.options=t.extend({},l.defaults,n),i.id=M.guid(),i._insertHTMLIntoDOM(),i._setupModal(),i._setupVariables(),i._setupEventHandlers(),i._clockSetup(),i._pickerSetup(),i}return r(l,a),i(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.modal.destroy(),t(this.modalEl).remove(),this.el.M_Timepicker=void 0}},{key:"_setupEventHandlers",value:function(){this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),this._handleClockClickStartBound=this._handleClockClickStart.bind(this),this._handleDocumentClickMoveBound=this._handleDocumentClickMove.bind(this),this._handleDocumentClickEndBound=this._handleDocumentClickEnd.bind(this),this.el.addEventListener("click",this._handleInputClickBound),this.el.addEventListener("keydown",this._handleInputKeydownBound),this.plate.addEventListener("mousedown",this._handleClockClickStartBound),this.plate.addEventListener("touchstart",this._handleClockClickStartBound),t(this.spanHours).on("click",this.showView.bind(this,"hours")),t(this.spanMinutes).on("click",this.showView.bind(this,"minutes"))}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleInputClickBound),this.el.removeEventListener("keydown",this._handleInputKeydownBound)}},{key:"_handleInputClick",value:function(){this.open()}},{key:"_handleInputKeydown",value:function(t){t.which===M.keys.ENTER&&(t.preventDefault(),this.open())}},{key:"_handleClockClickStart",value:function(t){t.preventDefault();var e=this.plate.getBoundingClientRect(),n=e.left,i=e.top;this.x0=n+this.options.dialRadius,this.y0=i+this.options.dialRadius,this.moved=!1;var o=l._Pos(t);this.dx=o.x-this.x0,this.dy=o.y-this.y0,this.setHand(this.dx,this.dy,!1),document.addEventListener("mousemove",this._handleDocumentClickMoveBound),document.addEventListener("touchmove",this._handleDocumentClickMoveBound),document.addEventListener("mouseup",this._handleDocumentClickEndBound),document.addEventListener("touchend",this._handleDocumentClickEndBound)}},{key:"_handleDocumentClickMove",value:function(t){t.preventDefault();var e=l._Pos(t),n=e.x-this.x0,i=e.y-this.y0;this.moved=!0,this.setHand(n,i,!1,!0)}},{key:"_handleDocumentClickEnd",value:function(e){var n=this;e.preventDefault(),document.removeEventListener("mouseup",this._handleDocumentClickEndBound),document.removeEventListener("touchend",this._handleDocumentClickEndBound);var i=l._Pos(e),o=i.x-this.x0,r=i.y-this.y0;this.moved&&o===this.dx&&r===this.dy&&this.setHand(o,r),"hours"===this.currentView?this.showView("minutes",this.options.duration/2):this.options.autoClose&&(t(this.minutesView).addClass("timepicker-dial-out"),setTimeout((function(){n.done()}),this.options.duration/2)),"function"==typeof this.options.onSelect&&this.options.onSelect.call(this,this.hours,this.minutes),document.removeEventListener("mousemove",this._handleDocumentClickMoveBound),document.removeEventListener("touchmove",this._handleDocumentClickMoveBound)}},{key:"_insertHTMLIntoDOM",value:function(){this.$modalEl=t(l._template),this.modalEl=this.$modalEl[0],this.modalEl.id="modal-"+this.id;var e=document.querySelector(this.options.container);this.options.container&&e?this.$modalEl.appendTo(e):this.$modalEl.insertBefore(this.el)}},{key:"_setupModal",value:function(){var t=this;this.modal=M.Modal.init(this.modalEl,{onOpenStart:this.options.onOpenStart,onOpenEnd:this.options.onOpenEnd,onCloseStart:this.options.onCloseStart,onCloseEnd:function(){"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t),t.isOpen=!1}})}},{key:"_setupVariables",value:function(){this.currentView="hours",this.vibrate=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,this._canvas=this.modalEl.querySelector(".timepicker-canvas"),this.plate=this.modalEl.querySelector(".timepicker-plate"),this.hoursView=this.modalEl.querySelector(".timepicker-hours"),this.minutesView=this.modalEl.querySelector(".timepicker-minutes"),this.spanHours=this.modalEl.querySelector(".timepicker-span-hours"),this.spanMinutes=this.modalEl.querySelector(".timepicker-span-minutes"),this.spanAmPm=this.modalEl.querySelector(".timepicker-span-am-pm"),this.footer=this.modalEl.querySelector(".timepicker-footer"),this.amOrPm="PM"}},{key:"_pickerSetup",value:function(){var e=t('<button class="btn-flat timepicker-clear waves-effect" style="visibility: hidden;" type="button" tabindex="'+(this.options.twelveHour?"3":"1")+'">'+this.options.i18n.clear+"</button>").appendTo(this.footer).on("click",this.clear.bind(this));this.options.showClearBtn&&e.css({visibility:""});var n=t('<div class="confirmation-btns"></div>');t('<button class="btn-flat timepicker-close waves-effect" type="button" tabindex="'+(this.options.twelveHour?"3":"1")+'">'+this.options.i18n.cancel+"</button>").appendTo(n).on("click",this.close.bind(this)),t('<button class="btn-flat timepicker-close waves-effect" type="button" tabindex="'+(this.options.twelveHour?"3":"1")+'">'+this.options.i18n.done+"</button>").appendTo(n).on("click",this.done.bind(this)),n.appendTo(this.footer)}},{key:"_clockSetup",value:function(){this.options.twelveHour&&(this.$amBtn=t('<div class="am-btn">AM</div>'),this.$pmBtn=t('<div class="pm-btn">PM</div>'),this.$amBtn.on("click",this._handleAmPmClick.bind(this)).appendTo(this.spanAmPm),this.$pmBtn.on("click",this._handleAmPmClick.bind(this)).appendTo(this.spanAmPm)),this._buildHoursView(),this._buildMinutesView(),this._buildSVGClock()}},{key:"_buildSVGClock",value:function(){var t=this.options.dialRadius,e=this.options.tickRadius,n=2*t,i=l._createSVGEl("svg");i.setAttribute("class","timepicker-svg"),i.setAttribute("width",n),i.setAttribute("height",n);var o=l._createSVGEl("g");o.setAttribute("transform","translate("+t+","+t+")");var r=l._createSVGEl("circle");r.setAttribute("class","timepicker-canvas-bearing"),r.setAttribute("cx",0),r.setAttribute("cy",0),r.setAttribute("r",4);var s=l._createSVGEl("line");s.setAttribute("x1",0),s.setAttribute("y1",0);var a=l._createSVGEl("circle");a.setAttribute("class","timepicker-canvas-bg"),a.setAttribute("r",e),o.appendChild(s),o.appendChild(a),o.appendChild(r),i.appendChild(o),this._canvas.appendChild(i),this.hand=s,this.bg=a,this.bearing=r,this.g=o}},{key:"_buildHoursView",value:function(){var e=t('<div class="timepicker-tick"></div>');if(this.options.twelveHour)for(var n=1;n<13;n+=1){var i=e.clone(),o=n/6*Math.PI,r=this.options.outerRadius;i.css({left:this.options.dialRadius+Math.sin(o)*r-this.options.tickRadius+"px",top:this.options.dialRadius-Math.cos(o)*r-this.options.tickRadius+"px"}),i.html(0===n?"00":n),this.hoursView.appendChild(i[0])}else for(var s=0;s<24;s+=1){var a=e.clone(),l=s/6*Math.PI,c=s>0&&s<13?this.options.innerRadius:this.options.outerRadius;a.css({left:this.options.dialRadius+Math.sin(l)*c-this.options.tickRadius+"px",top:this.options.dialRadius-Math.cos(l)*c-this.options.tickRadius+"px"}),a.html(0===s?"00":s),this.hoursView.appendChild(a[0])}}},{key:"_buildMinutesView",value:function(){for(var e=t('<div class="timepicker-tick"></div>'),n=0;n<60;n+=5){var i=e.clone(),o=n/30*Math.PI;i.css({left:this.options.dialRadius+Math.sin(o)*this.options.outerRadius-this.options.tickRadius+"px",top:this.options.dialRadius-Math.cos(o)*this.options.outerRadius-this.options.tickRadius+"px"}),i.html(l._addLeadingZero(n)),this.minutesView.appendChild(i[0])}}},{key:"_handleAmPmClick",value:function(e){var n=t(e.target);this.amOrPm=n.hasClass("am-btn")?"AM":"PM",this._updateAmPmView()}},{key:"_updateAmPmView",value:function(){this.options.twelveHour&&(this.$amBtn.toggleClass("text-primary","AM"===this.amOrPm),this.$pmBtn.toggleClass("text-primary","PM"===this.amOrPm))}},{key:"_updateTimeFromInput",value:function(){var t=((this.el.value||this.options.defaultTime||"")+"").split(":");if(this.options.twelveHour&&void 0!==t[1]&&(t[1].toUpperCase().indexOf("AM")>0?this.amOrPm="AM":this.amOrPm="PM",t[1]=t[1].replace("AM","").replace("PM","")),"now"===t[0]){var e=new Date(+new Date+this.options.fromNow);t=[e.getHours(),e.getMinutes()],this.options.twelveHour&&(this.amOrPm=t[0]>=12&&t[0]<24?"PM":"AM")}this.hours=+t[0]||0,this.minutes=+t[1]||0,this.spanHours.innerHTML=this.hours,this.spanMinutes.innerHTML=l._addLeadingZero(this.minutes),this._updateAmPmView()}},{key:"showView",value:function(e,n){"minutes"===e&&t(this.hoursView).css("visibility");var i="hours"===e,o=i?this.hoursView:this.minutesView,r=i?this.minutesView:this.hoursView;this.currentView=e,t(this.spanHours).toggleClass("text-primary",i),t(this.spanMinutes).toggleClass("text-primary",!i),r.classList.add("timepicker-dial-out"),t(o).css("visibility","visible").removeClass("timepicker-dial-out"),this.resetClock(n),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout((function(){t(r).css("visibility","hidden")}),this.options.duration)}},{key:"resetClock",value:function(e){var n=this.currentView,i=this[n],o="hours"===n,r=i*(Math.PI/(o?6:30)),s=o&&i>0&&i<13?this.options.innerRadius:this.options.outerRadius,a=Math.sin(r)*s,l=-Math.cos(r)*s,c=this;e?(t(this.canvas).addClass("timepicker-canvas-out"),setTimeout((function(){t(c.canvas).removeClass("timepicker-canvas-out"),c.setHand(a,l)}),e)):this.setHand(a,l)}},{key:"setHand",value:function(t,e,n){var i=this,o=Math.atan2(t,-e),r="hours"===this.currentView,s=Math.PI/(r||n?6:30),a=Math.sqrt(t*t+e*e),c=r&&a<(this.options.outerRadius+this.options.innerRadius)/2,h=c?this.options.innerRadius:this.options.outerRadius;this.options.twelveHour&&(h=this.options.outerRadius),o<0&&(o=2*Math.PI+o);var u=Math.round(o/s);o=u*s,this.options.twelveHour?r?0===u&&(u=12):(n&&(u*=5),60===u&&(u=0)):r?(12===u&&(u=0),u=c?0===u?12:u:0===u?0:u+12):(n&&(u*=5),60===u&&(u=0)),this[this.currentView]!==u&&this.vibrate&&this.options.vibrate&&(this.vibrateTimer||(navigator[this.vibrate](10),this.vibrateTimer=setTimeout((function(){i.vibrateTimer=null}),100))),this[this.currentView]=u,r?this.spanHours.innerHTML=u:this.spanMinutes.innerHTML=l._addLeadingZero(u);var d=Math.sin(o)*(h-this.options.tickRadius),p=-Math.cos(o)*(h-this.options.tickRadius),_=Math.sin(o)*h,f=-Math.cos(o)*h;this.hand.setAttribute("x2",d),this.hand.setAttribute("y2",p),this.bg.setAttribute("cx",_),this.bg.setAttribute("cy",f)}},{key:"open",value:function(){this.isOpen||(this.isOpen=!0,this._updateTimeFromInput(),this.showView("hours"),this.modal.open())}},{key:"close",value:function(){this.isOpen&&(this.isOpen=!1,this.modal.close())}},{key:"done",value:function(t,e){var n=this.el.value,i=e?"":l._addLeadingZero(this.hours)+":"+l._addLeadingZero(this.minutes);this.time=i,!e&&this.options.twelveHour&&(i=i+" "+this.amOrPm),this.el.value=i,i!==n&&this.$el.trigger("change"),this.close(),this.el.focus()}},{key:"clear",value:function(){this.done(null,!0)}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"_addLeadingZero",value:function(t){return(t<10?"0":"")+t}},{key:"_createSVGEl",value:function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}},{key:"_Pos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?{x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY}:{x:t.clientX,y:t.clientY}}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Timepicker}},{key:"defaults",get:function(){return e}}]),l}(a);l._template=['<div class= "modal timepicker-modal">','<div class="modal-content timepicker-container">','<div class="timepicker-digital-display">','<div class="timepicker-text-container">','<div class="timepicker-display-column">','<span class="timepicker-span-hours text-primary"></span>',":",'<span class="timepicker-span-minutes"></span>',"</div>",'<div class="timepicker-display-column timepicker-display-am-pm">','<div class="timepicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="timepicker-analog-display">','<div class="timepicker-plate">','<div class="timepicker-canvas"></div>','<div class="timepicker-dial timepicker-hours"></div>','<div class="timepicker-dial timepicker-minutes timepicker-dial-out"></div>',"</div>",'<div class="timepicker-footer"></div>',"</div>","</div>","</div>"].join(""),M.Timepicker=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"timepicker","M_Timepicker")}(cash),function(t){var e={},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_CharacterCounter=i,i.options=t.extend({},l.defaults,n),i.isInvalid=!1,i.isValidLength=!1,i._setupCounter(),i._setupEventHandlers(),i}return r(l,a),i(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.CharacterCounter=void 0,this._removeCounter()}},{key:"_setupEventHandlers",value:function(){this._handleUpdateCounterBound=this.updateCounter.bind(this),this.el.addEventListener("focus",this._handleUpdateCounterBound,!0),this.el.addEventListener("input",this._handleUpdateCounterBound,!0)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("focus",this._handleUpdateCounterBound,!0),this.el.removeEventListener("input",this._handleUpdateCounterBound,!0)}},{key:"_setupCounter",value:function(){this.counterEl=document.createElement("span"),t(this.counterEl).addClass("character-counter").css({float:"right","font-size":"12px",height:1}),this.$el.parent().append(this.counterEl)}},{key:"_removeCounter",value:function(){t(this.counterEl).remove()}},{key:"updateCounter",value:function(){var e=+this.$el.attr("data-length"),n=this.el.value.length;this.isValidLength=n<=e;var i=n;e&&(i+="/"+e,this._validateInput()),t(this.counterEl).html(i)}},{key:"_validateInput",value:function(){this.isValidLength&&this.isInvalid?(this.isInvalid=!1,this.$el.removeClass("invalid")):this.isValidLength||this.isInvalid||(this.isInvalid=!0,this.$el.removeClass("valid"),this.$el.addClass("invalid"))}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_CharacterCounter}},{key:"defaults",get:function(){return e}}]),l}(a);M.CharacterCounter=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"characterCounter","M_CharacterCounter")}(cash),function(t){var e={duration:200,dist:-100,shift:0,padding:0,numVisible:5,fullWidth:!1,indicators:!1,noWrap:!1,onCycleTo:null},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_Carousel=i,i.options=t.extend({},l.defaults,n),i.hasMultipleSlides=i.$el.find(".carousel-item").length>1,i.showIndicators=i.options.indicators&&i.hasMultipleSlides,i.noWrap=i.options.noWrap||!i.hasMultipleSlides,i.pressed=!1,i.dragged=!1,i.offset=i.target=0,i.images=[],i.itemWidth=i.$el.find(".carousel-item").first().innerWidth(),i.itemHeight=i.$el.find(".carousel-item").first().innerHeight(),i.dim=2*i.itemWidth+i.options.padding||1,i._autoScrollBound=i._autoScroll.bind(i),i._trackBound=i._track.bind(i),i.options.fullWidth&&(i.options.dist=0,i._setCarouselHeight(),i.showIndicators&&i.$el.find(".carousel-fixed-item").addClass("with-indicators")),i.$indicators=t('<ul class="indicators"></ul>'),i.$el.find(".carousel-item").each((function(e,n){if(i.images.push(e),i.showIndicators){var o=t('<li class="indicator-item"></li>');0===n&&o[0].classList.add("active"),i.$indicators.append(o)}})),i.showIndicators&&i.$el.append(i.$indicators),i.count=i.images.length,i.options.numVisible=Math.min(i.count,i.options.numVisible),i.xform="transform",["webkit","Moz","O","ms"].every((function(t){var e=t+"Transform";return void 0===document.body.style[e]||(i.xform=e,!1)})),i._setupEventHandlers(),i._scroll(i.offset),i}return r(l,a),i(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_Carousel=void 0}},{key:"_setupEventHandlers",value:function(){var t=this;this._handleCarouselTapBound=this._handleCarouselTap.bind(this),this._handleCarouselDragBound=this._handleCarouselDrag.bind(this),this._handleCarouselReleaseBound=this._handleCarouselRelease.bind(this),this._handleCarouselClickBound=this._handleCarouselClick.bind(this),void 0!==window.ontouchstart&&(this.el.addEventListener("touchstart",this._handleCarouselTapBound),this.el.addEventListener("touchmove",this._handleCarouselDragBound),this.el.addEventListener("touchend",this._handleCarouselReleaseBound)),this.el.addEventListener("mousedown",this._handleCarouselTapBound),this.el.addEventListener("mousemove",this._handleCarouselDragBound),this.el.addEventListener("mouseup",this._handleCarouselReleaseBound),this.el.addEventListener("mouseleave",this._handleCarouselReleaseBound),this.el.addEventListener("click",this._handleCarouselClickBound),this.showIndicators&&this.$indicators&&(this._handleIndicatorClickBound=this._handleIndicatorClick.bind(this),this.$indicators.find(".indicator-item").each((function(e,n){e.addEventListener("click",t._handleIndicatorClickBound)})));var e=M.throttle(this._handleResize,200);this._handleThrottledResizeBound=e.bind(this),window.addEventListener("resize",this._handleThrottledResizeBound)}},{key:"_removeEventHandlers",value:function(){var t=this;void 0!==window.ontouchstart&&(this.el.removeEventListener("touchstart",this._handleCarouselTapBound),this.el.removeEventListener("touchmove",this._handleCarouselDragBound),this.el.removeEventListener("touchend",this._handleCarouselReleaseBound)),this.el.removeEventListener("mousedown",this._handleCarouselTapBound),this.el.removeEventListener("mousemove",this._handleCarouselDragBound),this.el.removeEventListener("mouseup",this._handleCarouselReleaseBound),this.el.removeEventListener("mouseleave",this._handleCarouselReleaseBound),this.el.removeEventListener("click",this._handleCarouselClickBound),this.showIndicators&&this.$indicators&&this.$indicators.find(".indicator-item").each((function(e,n){e.removeEventListener("click",t._handleIndicatorClickBound)})),window.removeEventListener("resize",this._handleThrottledResizeBound)}},{key:"_handleCarouselTap",value:function(e){"mousedown"===e.type&&t(e.target).is("img")&&e.preventDefault(),this.pressed=!0,this.dragged=!1,this.verticalDragged=!1,this.reference=this._xpos(e),this.referenceY=this._ypos(e),this.velocity=this.amplitude=0,this.frame=this.offset,this.timestamp=Date.now(),clearInterval(this.ticker),this.ticker=setInterval(this._trackBound,100)}},{key:"_handleCarouselDrag",value:function(t){var e=void 0,n=void 0,i=void 0;if(this.pressed)if(e=this._xpos(t),n=this._ypos(t),i=this.reference-e,Math.abs(this.referenceY-n)<30&&!this.verticalDragged)(i>2||i<-2)&&(this.dragged=!0,this.reference=e,this._scroll(this.offset+i));else{if(this.dragged)return t.preventDefault(),t.stopPropagation(),!1;this.verticalDragged=!0}if(this.dragged)return t.preventDefault(),t.stopPropagation(),!1}},{key:"_handleCarouselRelease",value:function(t){if(this.pressed)return this.pressed=!1,clearInterval(this.ticker),this.target=this.offset,(this.velocity>10||this.velocity<-10)&&(this.amplitude=.9*this.velocity,this.target=this.offset+this.amplitude),this.target=Math.round(this.target/this.dim)*this.dim,this.noWrap&&(this.target>=this.dim*(this.count-1)?this.target=this.dim*(this.count-1):this.target<0&&(this.target=0)),this.amplitude=this.target-this.offset,this.timestamp=Date.now(),requestAnimationFrame(this._autoScrollBound),this.dragged&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"_handleCarouselClick",value:function(e){if(this.dragged)return e.preventDefault(),e.stopPropagation(),!1;if(!this.options.fullWidth){var n=t(e.target).closest(".carousel-item").index();0!==this._wrap(this.center)-n&&(e.preventDefault(),e.stopPropagation()),this._cycleTo(n)}}},{key:"_handleIndicatorClick",value:function(e){e.stopPropagation();var n=t(e.target).closest(".indicator-item");n.length&&this._cycleTo(n.index())}},{key:"_handleResize",value:function(t){this.options.fullWidth?(this.itemWidth=this.$el.find(".carousel-item").first().innerWidth(),this.imageHeight=this.$el.find(".carousel-item.active").height(),this.dim=2*this.itemWidth+this.options.padding,this.offset=2*this.center*this.itemWidth,this.target=this.offset,this._setCarouselHeight(!0)):this._scroll()}},{key:"_setCarouselHeight",value:function(t){var e=this,n=this.$el.find(".carousel-item.active").length?this.$el.find(".carousel-item.active").first():this.$el.find(".carousel-item").first(),i=n.find("img").first();if(i.length)if(i[0].complete){var o=i.height();if(o>0)this.$el.css("height",o+"px");else{var r=i[0].naturalWidth,s=i[0].naturalHeight,a=this.$el.width()/r*s;this.$el.css("height",a+"px")}}else i.one("load",(function(t,n){e.$el.css("height",t.offsetHeight+"px")}));else if(!t){var l=n.height();this.$el.css("height",l+"px")}}},{key:"_xpos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}},{key:"_ypos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}},{key:"_wrap",value:function(t){return t>=this.count?t%this.count:t<0?this._wrap(this.count+t%this.count):t}},{key:"_track",value:function(){var t,e,n,i;e=(t=Date.now())-this.timestamp,this.timestamp=t,n=this.offset-this.frame,this.frame=this.offset,i=1e3*n/(1+e),this.velocity=.8*i+.2*this.velocity}},{key:"_autoScroll",value:function(){var t=void 0,e=void 0;this.amplitude&&(t=Date.now()-this.timestamp,(e=this.amplitude*Math.exp(-t/this.options.duration))>2||e<-2?(this._scroll(this.target-e),requestAnimationFrame(this._autoScrollBound)):this._scroll(this.target))}},{key:"_scroll",value:function(e){var n=this;this.$el.hasClass("scrolling")||this.el.classList.add("scrolling"),null!=this.scrollingTimeout&&window.clearTimeout(this.scrollingTimeout),this.scrollingTimeout=window.setTimeout((function(){n.$el.removeClass("scrolling")}),this.options.duration);var i,o,r,s,a=void 0,l=void 0,c=void 0,h=void 0,u=void 0,d=void 0,p=this.center,_=1/this.options.numVisible;if(this.offset="number"==typeof e?e:this.offset,this.center=Math.floor((this.offset+this.dim/2)/this.dim),s=-(r=(o=this.offset-this.center*this.dim)<0?1:-1)*o*2/this.dim,i=this.count>>1,this.options.fullWidth?(c="translateX(0)",d=1):(c="translateX("+(this.el.clientWidth-this.itemWidth)/2+"px) ",c+="translateY("+(this.el.clientHeight-this.itemHeight)/2+"px)",d=1-_*s),this.showIndicators){var f=this.center%this.count,m=this.$indicators.find(".indicator-item.active");m.index()!==f&&(m.removeClass("active"),this.$indicators.find(".indicator-item").eq(f)[0].classList.add("active"))}if(!this.noWrap||this.center>=0&&this.center<this.count){l=this.images[this._wrap(this.center)],t(l).hasClass("active")||(this.$el.find(".carousel-item").removeClass("active"),l.classList.add("active"));var g=c+" translateX("+-o/2+"px) translateX("+r*this.options.shift*s*a+"px) translateZ("+this.options.dist*s+"px)";this._updateItemStyle(l,d,0,g)}for(a=1;a<=i;++a){if(this.options.fullWidth?(h=this.options.dist,u=a===i&&o<0?1-s:1):(h=this.options.dist*(2*a+s*r),u=1-_*(2*a+s*r)),!this.noWrap||this.center+a<this.count){l=this.images[this._wrap(this.center+a)];var v=c+" translateX("+(this.options.shift+(this.dim*a-o)/2)+"px) translateZ("+h+"px)";this._updateItemStyle(l,u,-a,v)}if(this.options.fullWidth?(h=this.options.dist,u=a===i&&o>0?1-s:1):(h=this.options.dist*(2*a-s*r),u=1-_*(2*a-s*r)),!this.noWrap||this.center-a>=0){l=this.images[this._wrap(this.center-a)];var y=c+" translateX("+(-this.options.shift+(-this.dim*a-o)/2)+"px) translateZ("+h+"px)";this._updateItemStyle(l,u,-a,y)}}if(!this.noWrap||this.center>=0&&this.center<this.count){l=this.images[this._wrap(this.center)];var b=c+" translateX("+-o/2+"px) translateX("+r*this.options.shift*s+"px) translateZ("+this.options.dist*s+"px)";this._updateItemStyle(l,d,0,b)}var k=this.$el.find(".carousel-item").eq(this._wrap(this.center));p!==this.center&&"function"==typeof this.options.onCycleTo&&this.options.onCycleTo.call(this,k[0],this.dragged),"function"==typeof this.oneTimeCallback&&(this.oneTimeCallback.call(this,k[0],this.dragged),this.oneTimeCallback=null)}},{key:"_updateItemStyle",value:function(t,e,n,i){t.style[this.xform]=i,t.style.zIndex=n,t.style.opacity=e,t.style.visibility="visible"}},{key:"_cycleTo",value:function(t,e){var n=this.center%this.count-t;this.noWrap||(n<0?Math.abs(n+this.count)<Math.abs(n)&&(n+=this.count):n>0&&Math.abs(n-this.count)<n&&(n-=this.count)),this.target=this.dim*Math.round(this.offset/this.dim),n<0?this.target+=this.dim*Math.abs(n):n>0&&(this.target-=this.dim*n),"function"==typeof e&&(this.oneTimeCallback=e),this.offset!==this.target&&(this.amplitude=this.target-this.offset,this.timestamp=Date.now(),requestAnimationFrame(this._autoScrollBound))}},{key:"next",value:function(t){(void 0===t||isNaN(t))&&(t=1);var e=this.center+t;if(e>=this.count||e<0){if(this.noWrap)return;e=this._wrap(e)}this._cycleTo(e)}},{key:"prev",value:function(t){(void 0===t||isNaN(t))&&(t=1);var e=this.center-t;if(e>=this.count||e<0){if(this.noWrap)return;e=this._wrap(e)}this._cycleTo(e)}},{key:"set",value:function(t,e){if((void 0===t||isNaN(t))&&(t=0),t>this.count||t<0){if(this.noWrap)return;t=this._wrap(t)}this._cycleTo(t,e)}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Carousel}},{key:"defaults",get:function(){return e}}]),l}(a);M.Carousel=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"carousel","M_Carousel")}(cash),function(t){var e={onOpen:void 0,onClose:void 0},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.el.M_TapTarget=i,i.options=t.extend({},l.defaults,n),i.isOpen=!1,i.$origin=t("#"+i.$el.attr("data-target")),i._setup(),i._calculatePositioning(),i._setupEventHandlers(),i}return r(l,a),i(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.TapTarget=void 0}},{key:"_setupEventHandlers",value:function(){this._handleDocumentClickBound=this._handleDocumentClick.bind(this),this._handleTargetClickBound=this._handleTargetClick.bind(this),this._handleOriginClickBound=this._handleOriginClick.bind(this),this.el.addEventListener("click",this._handleTargetClickBound),this.originEl.addEventListener("click",this._handleOriginClickBound);var t=M.throttle(this._handleResize,200);this._handleThrottledResizeBound=t.bind(this),window.addEventListener("resize",this._handleThrottledResizeBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleTargetClickBound),this.originEl.removeEventListener("click",this._handleOriginClickBound),window.removeEventListener("resize",this._handleThrottledResizeBound)}},{key:"_handleTargetClick",value:function(t){this.open()}},{key:"_handleOriginClick",value:function(t){this.close()}},{key:"_handleResize",value:function(t){this._calculatePositioning()}},{key:"_handleDocumentClick",value:function(e){t(e.target).closest(".tap-target-wrapper").length||(this.close(),e.preventDefault(),e.stopPropagation())}},{key:"_setup",value:function(){this.wrapper=this.$el.parent()[0],this.waveEl=t(this.wrapper).find(".tap-target-wave")[0],this.originEl=t(this.wrapper).find(".tap-target-origin")[0],this.contentEl=this.$el.find(".tap-target-content")[0],t(this.wrapper).hasClass(".tap-target-wrapper")||(this.wrapper=document.createElement("div"),this.wrapper.classList.add("tap-target-wrapper"),this.$el.before(t(this.wrapper)),this.wrapper.append(this.el)),this.contentEl||(this.contentEl=document.createElement("div"),this.contentEl.classList.add("tap-target-content"),this.$el.append(this.contentEl)),this.waveEl||(this.waveEl=document.createElement("div"),this.waveEl.classList.add("tap-target-wave"),this.originEl||(this.originEl=this.$origin.clone(!0,!0),this.originEl.addClass("tap-target-origin"),this.originEl.removeAttr("id"),this.originEl.removeAttr("style"),this.originEl=this.originEl[0],this.waveEl.append(this.originEl)),this.wrapper.append(this.waveEl))}},{key:"_calculatePositioning",value:function(){var e="fixed"===this.$origin.css("position");if(!e)for(var n=this.$origin.parents(),i=0;i<n.length&&!(e="fixed"==t(n[i]).css("position"));i++);var o=this.$origin.outerWidth(),r=this.$origin.outerHeight(),s=e?this.$origin.offset().top-M.getDocumentScrollTop():this.$origin.offset().top,a=e?this.$origin.offset().left-M.getDocumentScrollLeft():this.$origin.offset().left,l=window.innerWidth,c=window.innerHeight,h=l/2,u=c/2,d=a<=h,p=a>h,_=s<=u,f=s>u,m=a>=.25*l&&a<=.75*l,g=this.$el.outerWidth(),v=this.$el.outerHeight(),y=s+r/2-v/2,b=a+o/2-g/2,k=e?"fixed":"absolute",w=m?g:g/2+o,x=v/2,L=_?v/2:0,$=d&&!m?g/2-o:0,C=o,E=f?"bottom":"top",P=2*o,T=P,S=v/2-T/2,O=g/2-P/2,D={};D.top=_?y+"px":"",D.right=p?l-b-g+"px":"",D.bottom=f?c-y-v+"px":"",D.left=d?b+"px":"",D.position=k,t(this.wrapper).css(D),t(this.contentEl).css({width:w+"px",height:x+"px",top:L+"px",right:"0px",bottom:"0px",left:$+"px",padding:C+"px",verticalAlign:E}),t(this.waveEl).css({top:S+"px",left:O+"px",width:P+"px",height:T+"px"})}},{key:"open",value:function(){this.isOpen||("function"==typeof this.options.onOpen&&this.options.onOpen.call(this,this.$origin[0]),this.isOpen=!0,this.wrapper.classList.add("open"),document.body.addEventListener("click",this._handleDocumentClickBound,!0),document.body.addEventListener("touchend",this._handleDocumentClickBound))}},{key:"close",value:function(){this.isOpen&&("function"==typeof this.options.onClose&&this.options.onClose.call(this,this.$origin[0]),this.isOpen=!1,this.wrapper.classList.remove("open"),document.body.removeEventListener("click",this._handleDocumentClickBound,!0),document.body.removeEventListener("touchend",this._handleDocumentClickBound))}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_TapTarget}},{key:"defaults",get:function(){return e}}]),l}(a);M.TapTarget=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"tapTarget","M_TapTarget")}(cash),function(t){var e={classes:"",dropdownOptions:{}},l=function(a){function l(e,n){s(this,l);var i=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,n));return i.$el.hasClass("browser-default")?o(i):(i.el.M_FormSelect=i,i.options=t.extend({},l.defaults,n),i.isMultiple=i.$el.prop("multiple"),i.el.tabIndex=-1,i._keysSelected={},i._valueDict={},i._setupDropdown(),i._setupEventHandlers(),i)}return r(l,a),i(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this._removeDropdown(),this.el.M_FormSelect=void 0}},{key:"_setupEventHandlers",value:function(){var e=this;this._handleSelectChangeBound=this._handleSelectChange.bind(this),this._handleOptionClickBound=this._handleOptionClick.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),t(this.dropdownOptions).find("li:not(.optgroup)").each((function(t){t.addEventListener("click",e._handleOptionClickBound)})),this.el.addEventListener("change",this._handleSelectChangeBound),this.input.addEventListener("click",this._handleInputClickBound)}},{key:"_removeEventHandlers",value:function(){var e=this;t(this.dropdownOptions).find("li:not(.optgroup)").each((function(t){t.removeEventListener("click",e._handleOptionClickBound)})),this.el.removeEventListener("change",this._handleSelectChangeBound),this.input.removeEventListener("click",this._handleInputClickBound)}},{key:"_handleSelectChange",value:function(t){this._setValueToInput()}},{key:"_handleOptionClick",value:function(e){e.preventDefault();var n=t(e.target).closest("li")[0],i=n.id;if(!t(n).hasClass("disabled")&&!t(n).hasClass("optgroup")&&i.length){var o=!0;if(this.isMultiple){var r=t(this.dropdownOptions).find("li.disabled.selected");r.length&&(r.removeClass("selected"),r.find('input[type="checkbox"]').prop("checked",!1),this._toggleEntryFromArray(r[0].id)),o=this._toggleEntryFromArray(i)}else t(this.dropdownOptions).find("li").removeClass("selected"),t(n).toggleClass("selected",o);t(this._valueDict[i].el).prop("selected")!==o&&(t(this._valueDict[i].el).prop("selected",o),this.$el.trigger("change"))}e.stopPropagation()}},{key:"_handleInputClick",value:function(){this.dropdown&&this.dropdown.isOpen&&(this._setValueToInput(),this._setSelectedStates())}},{key:"_setupDropdown",value:function(){var e=this;this.wrapper=document.createElement("div"),t(this.wrapper).addClass("select-wrapper "+this.options.classes),this.$el.before(t(this.wrapper)),this.wrapper.appendChild(this.el),this.el.disabled&&this.wrapper.classList.add("disabled"),this.$selectOptions=this.$el.children("option, optgroup"),this.dropdownOptions=document.createElement("ul"),this.dropdownOptions.id="select-options-"+M.guid(),t(this.dropdownOptions).addClass("dropdown-content select-dropdown "+(this.isMultiple?"multiple-select-dropdown":"")),this.$selectOptions.length&&this.$selectOptions.each((function(n){if(t(n).is("option")){var i=void 0;i=e.isMultiple?e._appendOptionWithIcon(e.$el,n,"multiple"):e._appendOptionWithIcon(e.$el,n),e._addOptionToValueDict(n,i)}else if(t(n).is("optgroup")){var o=t(n).children("option");t(e.dropdownOptions).append(t('<li class="optgroup"><span>'+n.getAttribute("label")+"</span></li>")[0]),o.each((function(t){var n=e._appendOptionWithIcon(e.$el,t,"optgroup-option");e._addOptionToValueDict(t,n)}))}})),this.$el.after(this.dropdownOptions),this.input=document.createElement("input"),t(this.input).addClass("select-dropdown dropdown-trigger"),this.input.setAttribute("type","text"),this.input.setAttribute("readonly","true"),this.input.setAttribute("data-target",this.dropdownOptions.id),this.el.disabled&&t(this.input).prop("disabled","true"),this.$el.before(this.input),this._setValueToInput();var n=t('<svg class="caret" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');if(this.$el.before(n[0]),!this.el.disabled){var i=t.extend({},this.options.dropdownOptions);i.onOpenEnd=function(n){var i=t(e.dropdownOptions).find(".selected").first();if(i.length&&(M.keyDown=!0,e.dropdown.focusedIndex=i.index(),e.dropdown._focusFocusedItem(),M.keyDown=!1,e.dropdown.isScrollable)){var o=i[0].getBoundingClientRect().top-e.dropdownOptions.getBoundingClientRect().top;o-=e.dropdownOptions.clientHeight/2,e.dropdownOptions.scrollTop=o}},this.isMultiple&&(i.closeOnClick=!1),this.dropdown=M.Dropdown.init(this.input,i)}this._setSelectedStates()}},{key:"_addOptionToValueDict",value:function(t,e){var n=Object.keys(this._valueDict).length,i=this.dropdownOptions.id+n,o={};e.id=i,o.el=t,o.optionEl=e,this._valueDict[i]=o}},{key:"_removeDropdown",value:function(){t(this.wrapper).find(".caret").remove(),t(this.input).remove(),t(this.dropdownOptions).remove(),t(this.wrapper).before(this.$el),t(this.wrapper).remove()}},{key:"_appendOptionWithIcon",value:function(e,n,i){var o=n.disabled?"disabled ":"",r="optgroup-option"===i?"optgroup-option ":"",s=this.isMultiple?'<label><input type="checkbox"'+o+'"/><span>'+n.innerHTML+"</span></label>":n.innerHTML,a=t("<li></li>"),l=t("<span></span>");l.html(s),a.addClass(o+" "+r),a.append(l);var c=n.getAttribute("data-icon");if(c){var h=t('<img alt="" src="'+c+'">');a.prepend(h)}return t(this.dropdownOptions).append(a[0]),a[0]}},{key:"_toggleEntryFromArray",value:function(e){var n=!this._keysSelected.hasOwnProperty(e),i=t(this._valueDict[e].optionEl);return n?this._keysSelected[e]=!0:delete this._keysSelected[e],i.toggleClass("selected",n),i.find('input[type="checkbox"]').prop("checked",n),i.prop("selected",n),n}},{key:"_setValueToInput",value:function(){var e=[];if(this.$el.find("option").each((function(n){if(t(n).prop("selected")){var i=t(n).text();e.push(i)}})),!e.length){var n=this.$el.find("option:disabled").eq(0);n.length&&""===n[0].value&&e.push(n.text())}this.input.value=e.join(", ")}},{key:"_setSelectedStates",value:function(){for(var e in this._keysSelected={},this._valueDict){var n=this._valueDict[e],i=t(n.el).prop("selected");t(n.optionEl).find('input[type="checkbox"]').prop("checked",i),i?(this._activateOption(t(this.dropdownOptions),t(n.optionEl)),this._keysSelected[e]=!0):t(n.optionEl).removeClass("selected")}}},{key:"_activateOption",value:function(e,n){n&&(this.isMultiple||e.find("li.selected").removeClass("selected"),t(n).addClass("selected"))}},{key:"getSelectedValues",value:function(){var t=[];for(var e in this._keysSelected)t.push(this._valueDict[e].el.value);return t}}],[{key:"init",value:function(t,e){return n(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_FormSelect}},{key:"defaults",get:function(){return e}}]),l}(a);M.FormSelect=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"formSelect","M_FormSelect")}(cash),function(t,e){var l={},c=function(a){function c(e,n){s(this,c);var i=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,n));return i.el.M_Range=i,i.options=t.extend({},c.defaults,n),i._mousedown=!1,i._setupThumb(),i._setupEventHandlers(),i}return r(c,a),i(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this._removeThumb(),this.el.M_Range=void 0}},{key:"_setupEventHandlers",value:function(){this._handleRangeChangeBound=this._handleRangeChange.bind(this),this._handleRangeMousedownTouchstartBound=this._handleRangeMousedownTouchstart.bind(this),this._handleRangeInputMousemoveTouchmoveBound=this._handleRangeInputMousemoveTouchmove.bind(this),this._handleRangeMouseupTouchendBound=this._handleRangeMouseupTouchend.bind(this),this._handleRangeBlurMouseoutTouchleaveBound=this._handleRangeBlurMouseoutTouchleave.bind(this),this.el.addEventListener("change",this._handleRangeChangeBound),this.el.addEventListener("mousedown",this._handleRangeMousedownTouchstartBound),this.el.addEventListener("touchstart",this._handleRangeMousedownTouchstartBound),this.el.addEventListener("input",this._handleRangeInputMousemoveTouchmoveBound),this.el.addEventListener("mousemove",this._handleRangeInputMousemoveTouchmoveBound),this.el.addEventListener("touchmove",this._handleRangeInputMousemoveTouchmoveBound),this.el.addEventListener("mouseup",this._handleRangeMouseupTouchendBound),this.el.addEventListener("touchend",this._handleRangeMouseupTouchendBound),this.el.addEventListener("blur",this._handleRangeBlurMouseoutTouchleaveBound),this.el.addEventListener("mouseout",this._handleRangeBlurMouseoutTouchleaveBound),this.el.addEventListener("touchleave",this._handleRangeBlurMouseoutTouchleaveBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("change",this._handleRangeChangeBound),this.el.removeEventListener("mousedown",this._handleRangeMousedownTouchstartBound),this.el.removeEventListener("touchstart",this._handleRangeMousedownTouchstartBound),this.el.removeEventListener("input",this._handleRangeInputMousemoveTouchmoveBound),this.el.removeEventListener("mousemove",this._handleRangeInputMousemoveTouchmoveBound),this.el.removeEventListener("touchmove",this._handleRangeInputMousemoveTouchmoveBound),this.el.removeEventListener("mouseup",this._handleRangeMouseupTouchendBound),this.el.removeEventListener("touchend",this._handleRangeMouseupTouchendBound),this.el.removeEventListener("blur",this._handleRangeBlurMouseoutTouchleaveBound),this.el.removeEventListener("mouseout",this._handleRangeBlurMouseoutTouchleaveBound),this.el.removeEventListener("touchleave",this._handleRangeBlurMouseoutTouchleaveBound)}},{key:"_handleRangeChange",value:function(){t(this.value).html(this.$el.val()),t(this.thumb).hasClass("active")||this._showRangeBubble();var e=this._calcRangeOffset();t(this.thumb).addClass("active").css("left",e+"px")}},{key:"_handleRangeMousedownTouchstart",value:function(e){if(t(this.value).html(this.$el.val()),this._mousedown=!0,this.$el.addClass("active"),t(this.thumb).hasClass("active")||this._showRangeBubble(),"input"!==e.type){var n=this._calcRangeOffset();t(this.thumb).addClass("active").css("left",n+"px")}}},{key:"_handleRangeInputMousemoveTouchmove",value:function(){if(this._mousedown){t(this.thumb).hasClass("active")||this._showRangeBubble();var e=this._calcRangeOffset();t(this.thumb).addClass("active").css("left",e+"px"),t(this.value).html(this.$el.val())}}},{key:"_handleRangeMouseupTouchend",value:function(){this._mousedown=!1,this.$el.removeClass("active")}},{key:"_handleRangeBlurMouseoutTouchleave",value:function(){if(!this._mousedown){var n=7+parseInt(this.$el.css("padding-left"))+"px";t(this.thumb).hasClass("active")&&(e.remove(this.thumb),e({targets:this.thumb,height:0,width:0,top:10,easing:"easeOutQuad",marginLeft:n,duration:100})),t(this.thumb).removeClass("active")}}},{key:"_setupThumb",value:function(){this.thumb=document.createElement("span"),this.value=document.createElement("span"),t(this.thumb).addClass("thumb"),t(this.value).addClass("value"),t(this.thumb).append(this.value),this.$el.after(this.thumb)}},{key:"_removeThumb",value:function(){t(this.thumb).remove()}},{key:"_showRangeBubble",value:function(){var n=-7+parseInt(t(this.thumb).parent().css("padding-left"))+"px";e.remove(this.thumb),e({targets:this.thumb,height:30,width:30,top:-30,marginLeft:n,duration:300,easing:"easeOutQuint"})}},{key:"_calcRangeOffset",value:function(){var t=this.$el.width()-15,e=parseFloat(this.$el.attr("max"))||100,n=parseFloat(this.$el.attr("min"))||0;return(parseFloat(this.$el.val())-n)/(e-n)*t}}],[{key:"init",value:function(t,e){return n(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Range}},{key:"defaults",get:function(){return l}}]),c}(a);M.Range=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"range","M_Range"),c.init(t("input[type=range]"))}(cash,M.anime)}));class PreloadBox extends SvelteComponent{constructor(t){super(),init(this,t,instance$x,create_fragment$y,safe_not_equal,{})}}function create_fragment$x(t){let e,n;return{c(){e=element("i"),n=text(t[1]),attr(e,"class","material-icons svelte-fs63yz"),set_style(e,"font-size",t[0])},m(t,i){insert(t,e,i),append(e,n)},p(t,[i]){2&i&&set_data(n,t[1]),1&i&&set_style(e,"font-size",t[0])},i:noop,o:noop,d(t){t&&detach(e)}}}function instance$w(t,e,n){let{name:i="person"}=e,{size:o=24}=e;if(isNaN(o))switch(o){case"tiny":o="1rem";break;case"small":o="2rem";break;case"medium":o="4rem";break;case"large":o="6rem"}else o+="px";return t.$$set=t=>{"name"in t&&n(1,i=t.name),"size"in t&&n(0,o=t.size)},[o,i]}class Icon extends SvelteComponent{constructor(t){super(),init(this,t,instance$w,create_fragment$x,safe_not_equal,{name:1,size:0})}get name(){return this.$$.ctx[1]}set name(t){this.$$set({name:t}),flush()}get size(){return this.$$.ctx[0]}set size(t){this.$$set({size:t}),flush()}}function create_if_block_1$g(t){let e;return{c(){e=element("div"),attr(e,"id","vertical_divider"),attr(e,"class","svelte-awq91h")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_if_block$j(t){let e;return{c(){e=element("hr"),attr(e,"id","horizontal_divider"),attr(e,"class","svelte-awq91h")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_fragment$w(t){let e;function n(t,e){return"horizontal"==t[0]?create_if_block$j:"vertical"==t[0]?create_if_block_1$g:void 0}let i=n(t),o=i&&i(t);return{c(){o&&o.c(),e=empty()},m(t,n){o&&o.m(t,n),insert(t,e,n)},p(t,[r]){i!==(i=n(t))&&(o&&o.d(1),o=i&&i(t),o&&(o.c(),o.m(e.parentNode,e)))},i:noop,o:noop,d(t){o&&o.d(t),t&&detach(e)}}}function instance$v(t,e,n){let{direction:i="horizontal"}=e;return t.$$set=t=>{"direction"in t&&n(0,i=t.direction)},[i]}class Divider extends SvelteComponent{constructor(t){super(),init(this,t,instance$v,create_fragment$w,safe_not_equal,{direction:0})}get direction(){return this.$$.ctx[0]}set direction(t){this.$$set({direction:t}),flush()}}function create_default_slot$7(t){let e,n,i,o,r,s,a,l,c,h,u,d,p;return n=new Icon({props:{name:"error",size:"medium"}}),c=new Divider({props:{direction:"horizontal"}}),{c(){e=element("span"),create_component(n.$$.fragment),i=element("br"),o=space(),r=element("b"),r.textContent="Something went wrong.",s=space(),a=element("p"),l=space(),create_component(c.$$.fragment),h=space(),u=element("p"),d=text(t[0]),set_style(r,"margin-bottom","10px"),attr(e,"class","error_title svelte-1962d2f"),attr(u,"id","error_box_reason")},m(t,_){insert(t,e,_),mount_component(n,e,null),append(e,i),append(e,o),append(e,r),insert(t,s,_),insert(t,a,_),insert(t,l,_),mount_component(c,t,_),insert(t,h,_),insert(t,u,_),append(u,d),p=!0},p(t,e){(!p||1&e)&&set_data(d,t[0])},i(t){p||(transition_in(n.$$.fragment,t),transition_in(c.$$.fragment,t),p=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(c.$$.fragment,t),p=!1},d(t){t&&detach(e),destroy_component(n),t&&detach(s),t&&detach(a),t&&detach(l),destroy_component(c,t),t&&detach(h),t&&detach(u)}}}function create_fragment$v(t){let e,n;return e=new PreloadBox({props:{$$slots:{default:[create_default_slot$7]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,[n]){const i={};3&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function instance$u(t,e,n){let{reason:i="Try refreshing and try again."}=e;return t.$$set=t=>{"reason"in t&&n(0,i=t.reason)},[i]}class ErrorBox extends SvelteComponent{constructor(t){super(),init(this,t,instance$u,create_fragment$v,safe_not_equal,{reason:0})}get reason(){return this.$$.ctx[0]}set reason(t){this.$$set({reason:t}),flush()}}function cubicInOut(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1}function cubicOut(t){const e=t-1;return e*e*e+1}function fade(t,{delay:e=0,duration:n=400,easing:i=identity}={}){const o=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:i,css:t=>"opacity: "+t*o}}function fly(t,{delay:e=0,duration:n=400,easing:i=cubicOut,x:o=0,y:r=0,opacity:s=0}={}){const a=getComputedStyle(t),l=+a.opacity,c="none"===a.transform?"":a.transform,h=l*(1-s),[u,d]=split_css_unit(o),[p,_]=split_css_unit(r);return{delay:e,duration:n,easing:i,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*u}${d}, ${(1-t)*p}${_});\n\t\t\topacity: ${l-h*e}`}}function slide(t,{delay:e=0,duration:n=400,easing:i=cubicOut,axis:o="y"}={}){const r=getComputedStyle(t),s=+r.opacity,a="y"===o?"height":"width",l=parseFloat(r[a]),c="y"===o?["top","bottom"]:["left","right"],h=c.map((t=>`${t[0].toUpperCase()}${t.slice(1)}`)),u=parseFloat(r[`padding${h[0]}`]),d=parseFloat(r[`padding${h[1]}`]),p=parseFloat(r[`margin${h[0]}`]),_=parseFloat(r[`margin${h[1]}`]),f=parseFloat(r[`border${h[0]}Width`]),m=parseFloat(r[`border${h[1]}Width`]);return{delay:e,duration:n,easing:i,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*s};${a}: ${t*l}px;padding-${c[0]}: ${t*u}px;padding-${c[1]}: ${t*d}px;margin-${c[0]}: ${t*p}px;margin-${c[1]}: ${t*_}px;border-${c[0]}-width: ${t*f}px;border-${c[1]}-width: ${t*m}px;`}}function scale(t,{delay:e=0,duration:n=400,easing:i=cubicOut,start:o=0,opacity:r=0}={}){const s=getComputedStyle(t),a=+s.opacity,l="none"===s.transform?"":s.transform,c=1-o,h=a*(1-r);return{delay:e,duration:n,easing:i,css:(t,e)=>`\n\t\t\ttransform: ${l} scale(${1-c*e});\n\t\t\topacity: ${a-h*e}\n\t\t`}}function create_fragment$u(t){let e,n,i;return{c(){e=element("div"),e.innerHTML='<div class="progress svelte-mcnasa"><div class="indeterminate svelte-mcnasa"></div></div>',attr(e,"class","progress_bar svelte-mcnasa")},m(t,n){insert(t,e,n),i=!0},p:noop,i(t){i||(n&&n.end(1),i=!0)},o(t){n=create_out_transition(e,fade,{duration:100}),i=!1},d(t){t&&detach(e),t&&n&&n.end()}}}class ProgressBar extends SvelteComponent{constructor(t){super(),init(this,t,null,create_fragment$u,safe_not_equal,{})}}function create_fragment$t(t){let e,n,i;return{c(){e=element("div"),n=svg_element("svg"),i=svg_element("circle"),attr(i,"cx","50"),attr(i,"cy","50"),attr(i,"r","20"),attr(i,"class","svelte-i4e2xa"),attr(n,"viewBox","0 0 100 100"),attr(n,"class","svelte-i4e2xa"),attr(e,"class","spinner svelte-i4e2xa"),set_style(e,"height",t[0])},m(t,o){insert(t,e,o),append(e,n),append(n,i)},p(t,[n]){1&n&&set_style(e,"height",t[0])},i:noop,o:noop,d(t){t&&detach(e)}}}function instance$t(t,e,n){let{size:i="140px"}=e;return t.$$set=t=>{"size"in t&&n(0,i=t.size)},[i]}class LoadingSpinner extends SvelteComponent{constructor(t){super(),init(this,t,instance$t,create_fragment$t,safe_not_equal,{size:0})}get size(){return this.$$.ctx[0]}set size(t){this.$$set({size:t}),flush()}}function create_default_slot$6(t){let e,n,i,o,r;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment),n=space(),i=element("p"),o=text(t[0]),attr(i,"id","loading_reason"),attr(i,"class","svelte-1kw42f5")},m(t,s){mount_component(e,t,s),insert(t,n,s),insert(t,i,s),append(i,o),r=!0},p(t,e){(!r||1&e)&&set_data(o,t[0])},i(t){r||(transition_in(e.$$.fragment,t),r=!0)},o(t){transition_out(e.$$.fragment,t),r=!1},d(t){destroy_component(e,t),t&&detach(n),t&&detach(i)}}}function create_fragment$s(t){let e,n;return e=new PreloadBox({props:{$$slots:{default:[create_default_slot$6]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,[n]){const i={};3&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function instance$s(t,e,n){let{reason:i="Loading..."}=e;return t.$$set=t=>{"reason"in t&&n(0,i=t.reason)},[i]}class LoadingBox extends SvelteComponent{constructor(t){super(),init(this,t,instance$s,create_fragment$s,safe_not_equal,{reason:0})}get reason(){return this.$$.ctx[0]}set reason(t){this.$$set({reason:t}),flush()}}
/*!
     * long-press-event - v@version@
     * Pure JavaScript long-press-event
     * https://github.com/john-doherty/long-press-event
     * @author John Doherty <www.johndoherty.info>
     * @license MIT
     */function create_fragment$r(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f;return i=new Icon({props:{name:"add"}}),s=new Divider({}),c=new Icon({props:{name:"remove"}}),{c(){e=element("div"),n=element("button"),create_component(i.$$.fragment),r=space(),create_component(s.$$.fragment),a=space(),l=element("button"),create_component(c.$$.fragment),attr(n,"class","btn_zoom waves-effect long-press svelte-10357b6"),attr(n,"id","btn_zoom_in"),attr(n,"tabindex","-1"),attr(n,"title","Zoom in"),n.disabled=o=!t[2],attr(n,"data-long-press-delay","600"),attr(l,"class","btn_zoom waves-effect long-press svelte-10357b6"),attr(l,"id","btn_zoom_out"),attr(l,"tabindex","-1"),attr(l,"title","Zoom out"),l.disabled=h=!t[1],attr(l,"data-long-press-delay","600"),attr(e,"id","zoom_widget"),attr(e,"class","svelte-10357b6"),toggle_class(e,"lock",t[0]==MAPLOCK.FULL),toggle_class(e,"disabled",t[0]==MAPLOCK.FULL)},m(o,h){insert(o,e,h),append(e,n),mount_component(i,n,null),append(e,r),mount_component(s,e,null),append(e,a),append(e,l),mount_component(c,l,null),p=!0,_||(f=[listen(n,"click",t[4]),listen(l,"click",t[5]),listen(e,"contextmenu",contextmenu_handler$8)],_=!0)},p(t,[i]){(!p||4&i&&o!==(o=!t[2]))&&(n.disabled=o),(!p||2&i&&h!==(h=!t[1]))&&(l.disabled=h),(!p||1&i)&&toggle_class(e,"lock",t[0]==MAPLOCK.FULL),(!p||1&i)&&toggle_class(e,"disabled",t[0]==MAPLOCK.FULL)},i(t){p||(transition_in(i.$$.fragment,t),transition_in(s.$$.fragment,t),transition_in(c.$$.fragment,t),add_render_callback((()=>{p&&(d&&d.end(1),u=create_in_transition(e,fly,{x:5,duration:250}),u.start())})),p=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(s.$$.fragment,t),transition_out(c.$$.fragment,t),u&&u.invalidate(),d=create_out_transition(e,fade,{duration:75}),p=!1},d(t){t&&detach(e),destroy_component(i),destroy_component(s),destroy_component(c),t&&d&&d.end(),_=!1,run_all(f)}}}function zoom(t){let e,n=!0;"string"==typeof t?"out"==t?gamemap.getCurrentZoom()>gamemap.getMaxBoundsZoom()?(n=!1,gamemap.reset(!0)):e=gamemap.getMinZoom():"in"==t&&(gamemap.getCurrentZoom()<gamemap.getMaxBoundsZoom()?(n=!1,gamemap.reset(!0)):e=gamemap.getMaxZoom()):e=gamemap.getCurrentZoom()+t,n&&gamemap.setZoomTo(e)}!function(t,e){var n=null,i="PointerEvent"in t||t.navigator&&"msPointerEnabled"in t.navigator,o="ontouchstart"in t||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,r=i?"pointerdown":o?"touchstart":"mousedown",s=i?"pointerup":o?"touchend":"mouseup",a=i?"pointermove":o?"touchmove":"mousemove",l=i?"pointerleave":o?"touchleave":"mouseleave",c=0,h=0;function u(t){p(),t=function(t){if(void 0!==t.changedTouches)return t.changedTouches[0];return t}(t),this.dispatchEvent(new CustomEvent("long-press",{bubbles:!0,cancelable:!0,detail:{clientX:t.clientX,clientY:t.clientY,offsetX:t.offsetX,offsetY:t.offsetY,pageX:t.pageX,pageY:t.pageY},clientX:t.clientX,clientY:t.clientY,offsetX:t.offsetX,offsetY:t.offsetY,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY}))||e.addEventListener("click",(function t(n){e.removeEventListener("click",t,!0),function(t){t.stopImmediatePropagation(),t.preventDefault(),t.stopPropagation()}(n)}),!0)}function d(i){p();var o=i.target,r=parseInt(function(t,n,i){for(;t&&t!==e.documentElement;){var o=t.getAttribute(n);if(o)return o;t=t.parentNode}return i}(o,"data-long-press-delay","1500"),10);n=function(e,n){if(!(t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame&&t.mozCancelRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame))return t.setTimeout(e,n);var i=(new Date).getTime(),o={},r=function(){(new Date).getTime()-i>=n?e.call():o.value=requestAnimFrame(r)};return o.value=requestAnimFrame(r),o}(u.bind(o,i),r)}function p(e){var i;(i=n)&&(t.cancelAnimationFrame?t.cancelAnimationFrame(i.value):t.webkitCancelAnimationFrame?t.webkitCancelAnimationFrame(i.value):t.webkitCancelRequestAnimationFrame?t.webkitCancelRequestAnimationFrame(i.value):t.mozCancelRequestAnimationFrame?t.mozCancelRequestAnimationFrame(i.value):t.oCancelRequestAnimationFrame?t.oCancelRequestAnimationFrame(i.value):t.msCancelRequestAnimationFrame?t.msCancelRequestAnimationFrame(i.value):clearTimeout(i)),n=null}"function"!=typeof t.CustomEvent&&(t.CustomEvent=function(t,n){n=n||{bubbles:!1,cancelable:!1,detail:void 0};var i=e.createEvent("CustomEvent");return i.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),i},t.CustomEvent.prototype=t.Event.prototype),t.requestAnimFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},e.addEventListener(s,p,!0),e.addEventListener(l,p,!0),e.addEventListener(a,(function(t){var e=Math.abs(c-t.clientX),n=Math.abs(h-t.clientY);(e>=10||n>=10)&&p()}),!0),e.addEventListener("wheel",p,!0),e.addEventListener("scroll",p,!0),e.addEventListener(r,(function(t){c=t.clientX,h=t.clientY,d(t)}),!0)}(window,document);const contextmenu_handler$8=t=>t.stopPropagation();function instance$r(t,e,n){let i,o,{currentZoom:r}=e,{lock:s}=e;createEventDispatcher(),document.addEventListener("long-press",(function(t){if(t.target.closest(".btn_zoom")){zoom(t.target.closest(".btn_zoom").id.replace("btn_zoom_",""))}}));return t.$$set=t=>{"currentZoom"in t&&n(3,r=t.currentZoom),"lock"in t&&n(0,s=t.lock)},t.$$.update=()=>{8&t.$$.dirty&&n(2,i=r<gamemap.getMaxZoom()),8&t.$$.dirty&&n(1,o=r>gamemap.getMinZoom())},[s,o,i,r,()=>zoom(gamemap.getMapObject().options.zoomDelta),()=>zoom(-gamemap.getMapObject().options.zoomDelta)]}class ZoomWidget extends SvelteComponent{constructor(t){super(),init(this,t,instance$r,create_fragment$r,safe_not_equal,{currentZoom:3,lock:0})}get currentZoom(){return this.$$.ctx[3]}set currentZoom(t){this.$$set({currentZoom:t}),flush()}get lock(){return this.$$.ctx[0]}set lock(t){this.$$set({lock:t}),flush()}}function create_if_block$i(t){let e;let n=function(t,e){return t[9]?create_if_block_1$f:create_else_block$9}(t),i=n(t);return{c(){i.c(),e=empty()},m(t,n){i.m(t,n),insert(t,e,n)},p(t,e){i.p(t,e)},d(t){i.d(t),t&&detach(e)}}}function create_else_block$9(t){let e,n;return{c(){e=element("i"),n=text(t[3]),attr(e,"class","material-icons svelte-1am9y2a")},m(t,i){insert(t,e,i),append(e,n)},p(t,e){8&e&&set_data(n,t[3])},d(t){t&&detach(e)}}}function create_if_block_1$f(t){let e,n,i;return{c(){e=element("div"),n=element("img"),attr(n,"class","icon-img svelte-1am9y2a"),src_url_equal(n.src,i=t[3])||attr(n,"src",i),attr(n,"width","32"),attr(n,"height","32"),set_style(e,"width","100%"),set_style(e,"height","100%")},m(t,i){insert(t,e,i),append(e,n)},p(t,e){8&e&&!src_url_equal(n.src,i=t[3])&&attr(n,"src",i)},d(t){t&&detach(e)}}}function create_fragment$q(t){let e,n,i,o,r,s,a=t[8]&&create_if_block$i(t);return{c(){e=element("div"),a&&a.c(),n=space(),i=element("p"),o=text(t[2]),attr(i,"class","layer-name svelte-1am9y2a"),attr(e,"id","btn_toggle_grid"),attr(e,"class","btn_layer_toggle layer-button waves-effect svelte-1am9y2a"),attr(e,"title",t[1]),set_style(e,"background-image","url("+(t[4]??"assets/images/transparent.png")+")"),toggle_class(e,"hasImage",!t[8]),toggle_class(e,"dark",t[5]),toggle_class(e,"isChecked",t[0]),toggle_class(e,"big",t[6]),toggle_class(e,"disabled",t[7])},m(l,c){insert(l,e,c),a&&a.m(e,null),append(e,n),append(e,i),append(i,o),r||(s=[listen(e,"click",t[10]),listen(e,"contextmenu",contextmenu_handler$7)],r=!0)},p(t,[n]){t[8]&&a.p(t,n),4&n&&set_data(o,t[2]),2&n&&attr(e,"title",t[1]),16&n&&set_style(e,"background-image","url("+(t[4]??"assets/images/transparent.png")+")"),32&n&&toggle_class(e,"dark",t[5]),1&n&&toggle_class(e,"isChecked",t[0]),64&n&&toggle_class(e,"big",t[6]),128&n&&toggle_class(e,"disabled",t[7])},i:noop,o:noop,d(t){t&&detach(e),a&&a.d(),r=!1,run_all(s)}}}const contextmenu_handler$7=t=>t.stopPropagation();function instance$q(t,e,n){let{tooltip:i=""}=e,{label:o="layer"}=e,{icon:r=null}=e,{image:s=null}=e,{checked:a}=e,{dark:l=!1}=e,{big:c}=e,{disabled:h}=e;const u=createEventDispatcher();let d=null!=r&&!s,p=d&&r.includes("/");return t.$$set=t=>{"tooltip"in t&&n(1,i=t.tooltip),"label"in t&&n(2,o=t.label),"icon"in t&&n(3,r=t.icon),"image"in t&&n(4,s=t.image),"checked"in t&&n(0,a=t.checked),"dark"in t&&n(5,l=t.dark),"big"in t&&n(6,c=t.big),"disabled"in t&&n(7,h=t.disabled)},[a,i,o,r,s,l,c,h,d,p,function(){null!=a?(n(0,a=!a),u("onClick",a)):u("onClick",o.toLowerCase())}]}class LayerButton extends SvelteComponent{constructor(t){super(),init(this,t,instance$q,create_fragment$q,safe_not_equal,{tooltip:1,label:2,icon:3,image:4,checked:0,dark:5,big:6,disabled:7})}get tooltip(){return this.$$.ctx[1]}set tooltip(t){this.$$set({tooltip:t}),flush()}get label(){return this.$$.ctx[2]}set label(t){this.$$set({label:t}),flush()}get icon(){return this.$$.ctx[3]}set icon(t){this.$$set({icon:t}),flush()}get image(){return this.$$.ctx[4]}set image(t){this.$$set({image:t}),flush()}get checked(){return this.$$.ctx[0]}set checked(t){this.$$set({checked:t}),flush()}get dark(){return this.$$.ctx[5]}set dark(t){this.$$set({dark:t}),flush()}get big(){return this.$$.ctx[6]}set big(t){this.$$set({big:t}),flush()}get disabled(){return this.$$.ctx[7]}set disabled(t){this.$$set({disabled:t}),flush()}}function create_fragment$p(t){let e,n,i,o,r,s;const a=t[1].default,l=create_slot(a,t,t[0],null);return{c(){e=element("div"),l&&l.c(),attr(e,"class","svelte-1uzi7o8")},m(t,n){insert(t,e,n),l&&l.m(e,null),o=!0,r||(s=listen(e,"contextmenu",contextmenu_handler$6),r=!0)},p(t,[e]){l&&l.p&&(!o||1&e)&&update_slot_base(l,a,t,t[0],o?get_slot_changes(a,t[0],e,null):get_all_dirty_from_scope(t[0]),null)},i(t){o||(transition_in(l,t),add_render_callback((()=>{o&&(i&&i.end(1),n=create_in_transition(e,fly,{y:5,duration:250}),n.start())})),o=!0)},o(t){transition_out(l,t),n&&n.invalidate(),i=create_out_transition(e,fade,{duration:100}),o=!1},d(t){t&&detach(e),l&&l.d(t),t&&i&&i.end(),r=!1,s()}}}const contextmenu_handler$6=t=>t.stopPropagation();function instance$p(t,e,n){let{$$slots:i={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,i]}class LayerOptionsContainer extends SvelteComponent{constructor(t){super(),init(this,t,instance$p,create_fragment$p,safe_not_equal,{})}}function create_if_block$h(t){let e,n,i,o;const r=t[5].default,s=create_slot(r,t,t[4],null);return{c(){e=element("div"),s&&s.c(),attr(e,"class","optional-component")},m(t,n){insert(t,e,n),s&&s.m(e,null),o=!0},p(t,e){s&&s.p&&(!o||16&e)&&update_slot_base(s,r,t,t[4],o?get_slot_changes(r,t[4],e,null):get_all_dirty_from_scope(t[4]),null)},i(t){o||(transition_in(s,t),t&&add_render_callback((()=>{o&&(i&&i.end(1),n=create_in_transition(e,slide,{}),n.start())})),o=!0)},o(t){transition_out(s,t),n&&n.invalidate(),t&&(i=create_out_transition(e,slide,{})),o=!1},d(t){t&&detach(e),s&&s.d(t),t&&i&&i.end()}}}function create_fragment$o(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_=!t[0]&&create_if_block$h(t);return{c(){e=element("div"),n=element("label"),i=element("p"),o=text(t[1]),r=space(),s=element("input"),a=space(),l=element("span"),c=space(),_&&_.c(),h=empty(),attr(i,"class","label svelte-4whjpe"),attr(i,"title",t[2]),attr(s,"type","checkbox"),s.checked=t[0],attr(l,"class","lever svelte-4whjpe"),attr(e,"class","switch svelte-4whjpe")},m(f,m){insert(f,e,m),append(e,n),append(n,i),append(i,o),append(n,r),append(n,s),append(n,a),append(n,l),insert(f,c,m),_&&_.m(f,m),insert(f,h,m),u=!0,d||(p=listen(s,"change",t[3]),d=!0)},p(t,[e]){(!u||2&e)&&set_data(o,t[1]),(!u||4&e)&&attr(i,"title",t[2]),(!u||1&e)&&(s.checked=t[0]),t[0]?_&&(group_outros(),transition_out(_,1,1,(()=>{_=null})),check_outros()):_?(_.p(t,e),1&e&&transition_in(_,1)):(_=create_if_block$h(t),_.c(),transition_in(_,1),_.m(h.parentNode,h))},i(t){u||(transition_in(_),u=!0)},o(t){transition_out(_),u=!1},d(t){t&&detach(e),t&&detach(c),_&&_.d(t),t&&detach(h),d=!1,p()}}}function instance$o(t,e,n){let{$$slots:i={},$$scope:o}=e,{label:r}=e,{enabled:s=!1}=e,{tooltip:a}=e;const l=createEventDispatcher();return t.$$set=t=>{"label"in t&&n(1,r=t.label),"enabled"in t&&n(0,s=t.enabled),"tooltip"in t&&n(2,a=t.tooltip),"$$scope"in t&&n(4,o=t.$$scope)},[s,r,a,function(t){n(0,s=!s),l("change",s)},o,i]}class Switch extends SvelteComponent{constructor(t){super(),init(this,t,instance$o,create_fragment$o,safe_not_equal,{label:1,enabled:0,tooltip:2})}get label(){return this.$$.ctx[1]}set label(t){this.$$set({label:t}),flush()}get enabled(){return this.$$.ctx[0]}set enabled(t){this.$$set({enabled:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}}function create_if_block_2$d(t){let e,n;return{c(){e=element("label"),n=text(t[0]),attr(e,"class","label truncate svelte-1a8fbbf"),attr(e,"title",t[2]),attr(e,"for","form-select-"+t[7])},m(t,i){insert(t,e,i),append(e,n)},p(t,i){1&i&&set_data(n,t[0]),4&i&&attr(e,"title",t[2])},d(t){t&&detach(e)}}}function create_if_block_1$e(t){let e,n;return{c(){e=element("option"),n=text(t[1]),e.__value="",e.value=e.__value,e.disabled=!0},m(t,i){insert(t,e,i),append(e,n)},p(t,e){2&e&&set_data(n,t[1])},d(t){t&&detach(e)}}}function create_if_block$g(t){let e,n;return{c(){e=element("img"),attr(e,"class","selected-icon svelte-1a8fbbf"),src_url_equal(e.src,n=t[6])||attr(e,"src",n)},m(t,n){insert(t,e,n)},p(t,i){64&i&&!src_url_equal(e.src,n=t[6])&&attr(e,"src",n)},d(t){t&&detach(e)}}}function create_fragment$n(t){let e,n,i,o,r,s,a,l,c=t[0]&&create_if_block_2$d(t),h=t[1]&&create_if_block_1$e(t);const u=t[12].default,d=create_slot(u,t,t[11],null);let p=t[6]&&!t[3]&&create_if_block$g(t);return{c(){e=element("div"),c&&c.c(),n=space(),i=element("select"),h&&h.c(),o=empty(),d&&d.c(),r=space(),p&&p.c(),attr(i,"id","form-select-"+t[7]),attr(e,"class","input-field col s12 svelte-1a8fbbf"),toggle_class(e,"invisible",t[3])},m(u,_){insert(u,e,_),c&&c.m(e,null),append(e,n),append(e,i),h&&h.m(i,null),append(i,o),d&&d.m(i,null),t[13](i),append(e,r),p&&p.m(e,null),t[14](e),s=!0,a||(l=[listen(i,"change",t[8]),listen(e,"click",t[8])],a=!0)},p(t,[r]){t[0]?c?c.p(t,r):(c=create_if_block_2$d(t),c.c(),c.m(e,n)):c&&(c.d(1),c=null),t[1]?h?h.p(t,r):(h=create_if_block_1$e(t),h.c(),h.m(i,o)):h&&(h.d(1),h=null),d&&d.p&&(!s||2048&r)&&update_slot_base(d,u,t,t[11],s?get_slot_changes(u,t[11],r,null):get_all_dirty_from_scope(t[11]),null),t[6]&&!t[3]?p?p.p(t,r):(p=create_if_block$g(t),p.c(),p.m(e,null)):p&&(p.d(1),p=null),(!s||8&r)&&toggle_class(e,"invisible",t[3])},i(t){s||(transition_in(d,t),s=!0)},o(t){transition_out(d,t),s=!1},d(n){n&&detach(e),c&&c.d(),h&&h.d(),d&&d.d(n),t[13](null),p&&p.d(),t[14](null),a=!1,run_all(l)}}}function instance$n(t,e,n){let i,o,r,s,{$$slots:a={},$$scope:l}=e,{label:c}=e,{hint:h}=e,{tooltip:u}=e,{align:d="left"}=e,{invisible:p}=e,{selected:_}=e,f=Math.random().toString(36).substr(2,10);const m=createEventDispatcher();function g(t){r&&null!=t&&(n(5,o.value=t,o),r.value=o.querySelector(`[value='${t}']`).innerText)}function v(t){t&&"click"!=t.type&&m("change",t.target.value);let e=i.querySelector(".selected");if(e&&e.querySelector("img")){let t=e.querySelector("img");n(6,s=t.src)}else n(6,s=null)}return onMount((async()=>{M.FormSelect.init(document.querySelectorAll(`#form-select-${f}`),{dropdownOptions:{alignment:d,constrainWidth:!1}}),r=i.querySelector(".select-dropdown.dropdown-trigger"),g(_),v()})),t.$$set=t=>{"label"in t&&n(0,c=t.label),"hint"in t&&n(1,h=t.hint),"tooltip"in t&&n(2,u=t.tooltip),"align"in t&&n(9,d=t.align),"invisible"in t&&n(3,p=t.invisible),"selected"in t&&n(10,_=t.selected),"$$scope"in t&&n(11,l=t.$$scope)},t.$$.update=()=>{1024&t.$$.dirty&&g(_)},[c,h,u,p,i,o,s,f,v,d,_,l,a,function(t){binding_callbacks[t?"unshift":"push"]((()=>{o=t,n(5,o)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{i=t,n(4,i)}))}]}class DropdownMenu extends SvelteComponent{constructor(t){super(),init(this,t,instance$n,create_fragment$n,safe_not_equal,{label:0,hint:1,tooltip:2,align:9,invisible:3,selected:10})}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),flush()}get hint(){return this.$$.ctx[1]}set hint(t){this.$$set({hint:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}get align(){return this.$$.ctx[9]}set align(t){this.$$set({align:t}),flush()}get invisible(){return this.$$.ctx[3]}set invisible(t){this.$$set({invisible:t}),flush()}get selected(){return this.$$.ctx[10]}set selected(t){this.$$set({selected:t}),flush()}}function get_each_context$8(t,e,n){const i=t.slice();i[21]=e[n],i[24]=n;return i[22]=["<2","~5","~10","~20","~40","50+"],i}function get_context$2(t){const e=Object.keys(gamemap.getMapConfig().cellResources);t[25]=e;const n=Object.values(gamemap.getMapConfig().cellResources);t[26]=n}function get_each_context_1$2(t,e,n){const i=t.slice();return i[27]=e[n],i[24]=n,i}function get_each_context_2(t,e,n){const i=t.slice();return i[29]=e[n],i}function create_if_block_7$4(t){let e,n,i=t[1].toSentenceCase()+"";return{c(){e=element("p"),n=text(i),attr(e,"id","layer-name"),attr(e,"class","layer-name svelte-nsre66"),set_style(e,"bottom","12px")},m(t,i){insert(t,e,i),append(e,n)},p(t,e){2&e[0]&&i!==(i=t[1].toSentenceCase()+"")&&set_data(n,i)},d(t){t&&detach(e)}}}function create_if_block_3$a(t){let e,n,i,o,r,s,a,l,c=t[2].hasGrid(),h=t[3]&&create_if_block_5$5(t),u=c&&create_if_block_4$6(t);return{c(){e=element("div"),n=element("span"),i=space(),o=element("div"),h&&h.c(),r=space(),u&&u.c(),attr(n,"id","pip"),attr(n,"class","svelte-nsre66"),attr(o,"class","layer_widget_options svelte-nsre66"),attr(e,"id","layer_options_container"),attr(e,"class","svelte-nsre66")},m(t,s){insert(t,e,s),append(e,n),append(e,i),append(e,o),h&&h.m(o,null),append(o,r),u&&u.m(o,null),l=!0},p(t,e){t[3]?h?(h.p(t,e),8&e[0]&&transition_in(h,1)):(h=create_if_block_5$5(t),h.c(),transition_in(h,1),h.m(o,r)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros()),4&e[0]&&(c=t[2].hasGrid()),c?u?(u.p(t,e),4&e[0]&&transition_in(u,1)):(u=create_if_block_4$6(t),u.c(),transition_in(u,1),u.m(o,null)):u&&(group_outros(),transition_out(u,1,1,(()=>{u=null})),check_outros())},i(t){l||(transition_in(h),transition_in(u),add_render_callback((()=>{l&&(a&&a.end(1),s=create_in_transition(e,fly,{x:-15,duration:200}),s.start())})),l=!0)},o(t){transition_out(h),transition_out(u),s&&s.invalidate(),a=create_out_transition(e,fade,{duration:125}),l=!1},d(t){t&&detach(e),h&&h.d(),u&&u.d(),t&&a&&a.end()}}}function create_if_block_5$5(t){let e,n,i,o=t[2].hasGrid(),r=t[8],s=[];for(let e=0;e<r.length;e+=1)s[e]=create_each_block_2(get_each_context_2(t,r,e));const a=t=>transition_out(s[t],1,1,(()=>{s[t]=null}));let l=o&&create_if_block_6$4();return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=space(),l&&l.c(),n=empty()},m(t,o){for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,o);insert(t,e,o),l&&l.m(t,o),insert(t,n,o),i=!0},p(t,i){if(4352&i[0]){let n;for(r=t[8],n=0;n<r.length;n+=1){const o=get_each_context_2(t,r,n);s[n]?(s[n].p(o,i),transition_in(s[n],1)):(s[n]=create_each_block_2(o),s[n].c(),transition_in(s[n],1),s[n].m(e.parentNode,e))}for(group_outros(),n=r.length;n<s.length;n+=1)a(n);check_outros()}4&i[0]&&(o=t[2].hasGrid()),o?l?4&i[0]&&transition_in(l,1):(l=create_if_block_6$4(),l.c(),transition_in(l,1),l.m(n.parentNode,n)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){if(!i){for(let t=0;t<r.length;t+=1)transition_in(s[t]);transition_in(l),i=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)transition_out(s[t]);transition_out(l),i=!1},d(t){destroy_each(s,t),t&&detach(e),l&&l.d(t),t&&detach(n)}}}function create_each_block_2(t){let e,n;return e=new LayerButton({props:{label:t[29].name.toSentenceCase(),image:gamemap.getMapTileImageURL(gamemap.getCurrentWorld(),t[29].name,!0)}}),e.$on("onClick",t[12]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};256&n[0]&&(i.label=t[29].name.toSentenceCase()),256&n[0]&&(i.image=gamemap.getMapTileImageURL(gamemap.getCurrentWorld(),t[29].name,!0)),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_6$4(t){let e,n;return e=new Divider({props:{direction:"vertical"}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_4$6(t){let e,n;return e=new LayerButton({props:{label:"Cell Grid",tooltip:"Toggle cell grid",icon:"grid_on",checked:t[10]}}),e.$on("onClick",t[14]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};1024&n[0]&&(i.checked=t[10]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block$f(t){let e,n;return e=new LayerOptionsContainer({props:{$$slots:{default:[create_default_slot$5]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};1124&n[0]|2&n[1]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$d(t){let e,n,i,o,r,s,a=t[2].hasCellResources();n=new Switch({props:{label:"Show Cell Grid",tooltip:"Toggle cell grid",enabled:t[10]}}),n.$on("change",t[19]);let l=a&&create_if_block_2$c(t);return{c(){e=element("div"),create_component(n.$$.fragment),i=space(),l&&l.c()},m(t,o){insert(t,e,o),mount_component(n,e,null),append(e,i),l&&l.m(e,null),s=!0},p(t,i){const o={};1024&i[0]&&(o.enabled=t[10]),n.$set(o),4&i[0]&&(a=t[2].hasCellResources()),a?l?(l.p(t,i),4&i[0]&&transition_in(l,1)):(l=create_if_block_2$c(t),l.c(),transition_in(l,1),l.m(e,null)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){s||(transition_in(n.$$.fragment,t),transition_in(l),add_render_callback((()=>{s&&(r&&r.end(1),o=create_in_transition(e,slide,{}),o.start())})),s=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(l),o&&o.invalidate(),r=create_out_transition(e,slide,{}),s=!1},d(t){t&&detach(e),destroy_component(n),l&&l.d(),t&&r&&r.end()}}}function create_if_block_2$c(t){let e,n,i,o,r,s;e=new DropdownMenu({props:{label:"Show Resource",hint:"Select resource...",tooltip:"Select cell resource",selected:t[6].cellResource,align:"right",$$slots:{default:[create_default_slot_1$3]},$$scope:{ctx:t}}}),e.$on("change",t[20]);let a=gamemap.getMapConfig().cellResourceColours,l=[];for(let e=0;e<a.length;e+=1)l[e]=create_each_block$8(get_each_context$8(t,a,e));return{c(){create_component(e.$$.fragment),n=space(),i=element("div"),o=element("b"),o.textContent="Key:",r=space();for(let t=0;t<l.length;t+=1)l[t].c();set_style(o,"display","flex"),set_style(o,"padding-right","4px"),attr(o,"title","Cell resource count"),attr(i,"id","cell_resource_key"),attr(i,"class","svelte-nsre66")},m(t,a){mount_component(e,t,a),insert(t,n,a),insert(t,i,a),append(i,o),append(i,r);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(i,null);s=!0},p(t,n){const o={};if(64&n[0]&&(o.selected=t[6].cellResource),64&n[0]|2&n[1]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),0&n){let e;for(a=gamemap.getMapConfig().cellResourceColours,e=0;e<a.length;e+=1){const o=get_each_context$8(t,a,e);l[e]?l[e].p(o,n):(l[e]=create_each_block$8(o),l[e].c(),l[e].m(i,null))}for(;e<l.length;e+=1)l[e].d(1);l.length=a.length}},i(t){s||(transition_in(e.$$.fragment,t),s=!0)},o(t){transition_out(e.$$.fragment,t),s=!1},d(t){destroy_component(e,t),t&&detach(n),t&&detach(i),destroy_each(l,t)}}}function create_each_block_1$2(t){let e,n,i,o=t[26][t[24]]+"";return{c(){e=element("option"),n=text(o),e.__value=t[27].toLowerCase(),e.value=e.__value,e.selected=i=t[6].cellResource==t[27].toLowerCase()},m(t,i){insert(t,e,i),append(e,n)},p(t,n){64&n[0]&&i!==(i=t[6].cellResource==t[27].toLowerCase())&&(e.selected=i)},d(t){t&&detach(e)}}}function create_default_slot_1$3(t){let e;get_context$2(t);let n=t[25],i=[];for(let e=0;e<n.length;e+=1)i[e]=create_each_block_1$2(get_each_context_1$2(t,n,e));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=empty()},m(t,n){for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,n);insert(t,e,n)},p(t,o){if(get_context$2(t),64&o[0]){let r;for(n=t[25],r=0;r<n.length;r+=1){const s=get_each_context_1$2(t,n,r);i[r]?i[r].p(s,o):(i[r]=create_each_block_1$2(s),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){destroy_each(i,t),t&&detach(e)}}}function create_each_block$8(t){let e,n,i=t[22][t[24]]+"";return{c(){e=element("div"),n=text(i),attr(e,"class","cell_resource_key_item svelte-nsre66"),set_style(e,"background-color",t[21])},m(t,i){insert(t,e,i),append(e,n)},p:noop,d(t){t&&detach(e)}}}function create_default_slot$5(t){let e,n,i,o,r,s,a,l,c,h,u;i=new Icon({props:{name:"close",size:"tiny"}}),a=new Icon({props:{name:t[5]?"expand_less":"expand_more",size:"tiny"}});let d=t[5]&&create_if_block_1$d(t);return{c(){e=element("div"),n=element("div"),create_component(i.$$.fragment),o=space(),r=element("b"),s=text("Grid Options "),create_component(a.$$.fragment),l=space(),d&&d.c(),attr(n,"id","close_button"),attr(n,"class","waves-effect svelte-nsre66"),attr(n,"title","Close"),attr(r,"class","waves-effect"),attr(r,"title","Click to show/hide grid options"),set_style(r,"display","-webkit-box"),set_style(r,"width","fit-content"),attr(e,"class","cell_grid_options svelte-nsre66")},m(p,_){insert(p,e,_),append(e,n),mount_component(i,n,null),append(e,o),append(e,r),append(r,s),mount_component(a,r,null),append(e,l),d&&d.m(e,null),c=!0,h||(u=[listen(n,"click",t[17]),listen(r,"click",t[18]),listen(e,"contextmenu",contextmenu_handler_1$1)],h=!0)},p(t,n){const i={};32&n[0]&&(i.name=t[5]?"expand_less":"expand_more"),a.$set(i),t[5]?d?(d.p(t,n),32&n[0]&&transition_in(d,1)):(d=create_if_block_1$d(t),d.c(),transition_in(d,1),d.m(e,null)):d&&(group_outros(),transition_out(d,1,1,(()=>{d=null})),check_outros())},i(t){c||(transition_in(i.$$.fragment,t),transition_in(a.$$.fragment,t),transition_in(d),c=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(a.$$.fragment,t),transition_out(d),c=!1},d(t){t&&detach(e),destroy_component(i),destroy_component(a),d&&d.d(),h=!1,run_all(u)}}}function create_fragment$m(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_=t[3]&&create_if_block_7$4(t),f=t[4]&&create_if_block_3$a(t),m=t[9]&&create_if_block$f(t);return{c(){e=element("div"),n=element("button"),i=text("Layers\n            "),o=element("i"),o.textContent="layers",r=space(),_&&_.c(),s=space(),f&&f.c(),c=space(),m&&m.c(),h=empty(),attr(o,"class","small material-icons svelte-nsre66"),set_style(o,"position","relative"),set_style(o,"bottom","45px"),attr(n,"id","btn_layer_widget_switcher"),attr(n,"class","waves-effect svelte-nsre66"),set_style(n,"background-image","url("+(t[7]??"assets/images/transparent.png")+")"),toggle_class(n,"hasLayerImage",t[3]),attr(e,"class","layer_widget_root svelte-nsre66"),toggle_class(e,"lock",t[0])},m(a,l){insert(a,e,l),append(e,n),append(n,i),append(n,o),append(n,r),_&&_.m(n,null),append(e,s),f&&f.m(e,null),insert(a,c,l),m&&m.m(a,l),insert(a,h,l),u=!0,d||(p=[listen(n,"click",t[12]),listen(e,"mouseenter",t[15]),listen(e,"mouseleave",t[16]),listen(e,"contextmenu",contextmenu_handler$5)],d=!0)},p(t,i){t[3]?_?_.p(t,i):(_=create_if_block_7$4(t),_.c(),_.m(n,null)):_&&(_.d(1),_=null),(!u||128&i[0])&&set_style(n,"background-image","url("+(t[7]??"assets/images/transparent.png")+")"),(!u||8&i[0])&&toggle_class(n,"hasLayerImage",t[3]),t[4]?f?(f.p(t,i),16&i[0]&&transition_in(f,1)):(f=create_if_block_3$a(t),f.c(),transition_in(f,1),f.m(e,null)):f&&(group_outros(),transition_out(f,1,1,(()=>{f=null})),check_outros()),(!u||1&i[0])&&toggle_class(e,"lock",t[0]),t[9]?m?(m.p(t,i),512&i[0]&&transition_in(m,1)):(m=create_if_block$f(t),m.c(),transition_in(m,1),m.m(h.parentNode,h)):m&&(group_outros(),transition_out(m,1,1,(()=>{m=null})),check_outros())},i(t){u||(transition_in(f),add_render_callback((()=>{u&&(l&&l.end(1),a=create_in_transition(e,fly,{x:-5,duration:250}),a.start())})),transition_in(m),u=!0)},o(t){transition_out(f),a&&a.invalidate(),l=create_out_transition(e,fade,{duration:75}),transition_out(m),u=!1},d(t){t&&detach(e),_&&_.d(),f&&f.d(),t&&l&&l.end(),t&&detach(c),m&&m.d(t),t&&detach(h),d=!1,run_all(p)}}}const contextmenu_handler$5=t=>t.stopPropagation(),contextmenu_handler_1$1=t=>t.stopPropagation();function instance$m(t,e,n){let i,o,r,s,a,l,c,h,{mapState:u}=e,{lock:d}=e,p=!1,_=getPrefs("expandgridoptions",!0);function f(t){if(1==t)gamemap.toggleGrid(o);else if(0==t||null==t)gamemap.toggleGrid(null);else{let e={...o,...t};gamemap.toggleGrid(e)}n(4,p=!1)}return t.$$set=t=>{"mapState"in t&&n(13,u=t.mapState),"lock"in t&&n(0,d=t.lock)},t.$$.update=()=>{8192&t.$$.dirty[0]&&n(2,i=u.world),8196&t.$$.dirty[0]&&n(6,o=u.gridData??{gridShown:!0,cellResource:i.hasCellResources()?"none":null}),8192&t.$$.dirty[0]&&n(10,r=u.gridData?.gridShown??u.isGridShown()),8192&t.$$.dirty[0]&&n(9,s=u.isGridEnabled()),4&t.$$.dirty[0]&&n(3,a=i.hasMultipleLayers()),4&t.$$.dirty[0]&&n(8,l=i.layers),8192&t.$$.dirty[0]&&n(1,c=u&&gamemap.getNextTileLayerName()),8206&t.$$.dirty[0]&&n(7,h=u&&a?gamemap.getMapTileImageURL(i,c,!0):null)},[d,c,i,a,p,_,o,h,l,s,r,f,function(t){null==t.target?(isMobile()&&n(4,p=!1),gamemap.setTileLayerTo(t.detail)):gamemap.setTileLayerTo(gamemap.getNextTileLayerIndex()),n(1,c=gamemap.getNextTileLayerName())},u,t=>f(t.detail),()=>n(4,p=!0),()=>n(4,p=!1),()=>f(null),()=>{setPrefs("expandgridoptions",!getPrefs("expandgridoptions")),n(5,_=getPrefs("expandgridoptions"))},t=>{f({gridShown:t.detail})},t=>f({cellResource:t.detail})]}class LayerSwitcher extends SvelteComponent{constructor(t){super(),init(this,t,instance$m,create_fragment$m,safe_not_equal,{mapState:13,lock:0},null,[-1,-1])}get mapState(){return this.$$.ctx[13]}set mapState(t){this.$$set({mapState:t}),flush()}get lock(){return this.$$.ctx[0]}set lock(t){this.$$set({lock:t}),flush()}}function create_else_block_1$1(t){let e,n,i,o,r;return o=new Icon({props:{name:"open_in_new",size:"tiny"}}),{c(){e=element("b"),n=element("span"),n.innerHTML='<a href="//www.uesp.net/wiki/Main_Page" title="Go to UESP home" target="_top" class="svelte-x1o9ar">UESP</a>',i=text(" • View larger map "),create_component(o.$$.fragment),attr(n,"class","wikiTitle")},m(t,s){insert(t,e,s),append(e,n),append(e,i),mount_component(o,e,null),r=!0},p:noop,i(t){r||(transition_in(o.$$.fragment,t),r=!0)},o(t){transition_out(o.$$.fragment,t),r=!1},d(t){t&&detach(e),destroy_component(o)}}}function create_if_block$e(t){let e,n,i,o;const r=[create_if_block_1$c,create_if_block_2$b,create_if_block_3$9,create_else_block$8],s=[];function a(t,e){return t[2]==MAPLOCK.FULL?0:t[2]==MAPLOCK.PARTIAL?1:t[2]>=MAPLOCK.PARTIAL_MARKER?2:3}return e=a(t),n=s[e]=r[e](t),{c(){n.c(),i=empty()},m(t,n){s[e].m(t,n),insert(t,i,n),o=!0},p(t,o){let l=e;e=a(t),e===l?s[e].p(t,o):(group_outros(),transition_out(s[l],1,1,(()=>{s[l]=null})),check_outros(),n=s[e],n?n.p(t,o):(n=s[e]=r[e](t),n.c()),transition_in(n,1),n.m(i.parentNode,i))},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){s[e].d(t),t&&detach(i)}}}function create_else_block$8(t){let e,n,i,o,r;return{c(){e=element("b"),n=element("span"),n.innerHTML='<a href="//www.uesp.net/wiki/Main_Page" title="Go to UESP home" target="_top" class="svelte-x1o9ar">UESP</a>',i=text(" • "),o=element("a"),r=text(t[0]),attr(n,"class","wikiTitle"),attr(o,"title","Reset this map"),attr(o,"href","javascript:void(0);"),attr(o,"onclick","gamemap.reset();"),attr(o,"class","svelte-x1o9ar")},m(t,s){insert(t,e,s),append(e,n),append(e,i),append(e,o),append(o,r)},p(t,e){1&e&&set_data(r,t[0])},i:noop,o:noop,d(t){t&&detach(e)}}}function create_if_block_3$9(t){let e,n,i,o,r,s,a,l,c,h,u;n=new Icon({props:{name:"info",size:16}});let d=t[2]==MAPLOCK.PARTIAL_MARKER&&create_if_block_8$3(),p=t[2]==MAPLOCK.PARTIAL_NEW_MARKER&&create_if_block_7$3(),_=t[2]==MAPLOCK.PARTIAL_POLYGON&&create_if_block_6$3(),f=t[2]==MAPLOCK.PARTIAL_NEW_POLYGON&&create_if_block_5$4(),m=t[2]==MAPLOCK.PARTIAL_NEW_LINE&&create_if_block_4$5();return{c(){e=element("span"),create_component(n.$$.fragment),i=space(),o=element("small"),o.innerHTML="<b>Editing Tip</b>",r=space(),d&&d.c(),s=space(),p&&p.c(),a=space(),_&&_.c(),l=space(),f&&f.c(),c=space(),m&&m.c(),h=empty(),attr(o,"class","svelte-x1o9ar"),attr(e,"class","highlight svelte-x1o9ar")},m(t,g){insert(t,e,g),mount_component(n,e,null),append(e,i),append(e,o),insert(t,r,g),d&&d.m(t,g),insert(t,s,g),p&&p.m(t,g),insert(t,a,g),_&&_.m(t,g),insert(t,l,g),f&&f.m(t,g),insert(t,c,g),m&&m.m(t,g),insert(t,h,g),u=!0},p(t,e){t[2]==MAPLOCK.PARTIAL_MARKER?d||(d=create_if_block_8$3(),d.c(),d.m(s.parentNode,s)):d&&(d.d(1),d=null),t[2]==MAPLOCK.PARTIAL_NEW_MARKER?p||(p=create_if_block_7$3(),p.c(),p.m(a.parentNode,a)):p&&(p.d(1),p=null),t[2]==MAPLOCK.PARTIAL_POLYGON?_||(_=create_if_block_6$3(),_.c(),_.m(l.parentNode,l)):_&&(_.d(1),_=null),t[2]==MAPLOCK.PARTIAL_NEW_POLYGON?f||(f=create_if_block_5$4(),f.c(),f.m(c.parentNode,c)):f&&(f.d(1),f=null),t[2]==MAPLOCK.PARTIAL_NEW_LINE?m||(m=create_if_block_4$5(),m.c(),m.m(h.parentNode,h)):m&&(m.d(1),m=null)},i(t){u||(transition_in(n.$$.fragment,t),u=!0)},o(t){transition_out(n.$$.fragment,t),u=!1},d(t){t&&detach(e),destroy_component(n),t&&detach(r),d&&d.d(t),t&&detach(s),p&&p.d(t),t&&detach(a),_&&_.d(t),t&&detach(l),f&&f.d(t),t&&detach(c),m&&m.d(t),t&&detach(h)}}}function create_if_block_2$b(t){let e,n,i,o;return e=new Icon({props:{name:"lock",size:16}}),{c(){create_component(e.$$.fragment),n=space(),i=element("b"),i.textContent="Map locked",attr(i,"title","Map is partially locked whilst reverting locations.")},m(t,r){mount_component(e,t,r),insert(t,n,r),insert(t,i,r),o=!0},p:noop,i(t){o||(transition_in(e.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(n),t&&detach(i)}}}function create_if_block_1$c(t){let e,n,i,o;return e=new Icon({props:{name:"lock",size:16}}),{c(){create_component(e.$$.fragment),n=space(),i=element("b"),i.textContent="Map locked",attr(i,"title","Map is locked whilst editing worlds.")},m(t,r){mount_component(e,t,r),insert(t,n,r),insert(t,i,r),o=!0},p:noop,i(t){o||(transition_in(e.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(n),t&&detach(i)}}}function create_if_block_8$3(t){let e;return{c(){e=text("You can drag the selected marker to move it to a new position.")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_if_block_7$3(t){let e;return{c(){e=text("Click to add the new marker to the map.")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_if_block_6$3(t){let e,n,i;return{c(){e=text("Drag handles to move them, right click to remove them."),n=element("br"),i=text("\n                     Click the green plus (+) to add new points.")},m(t,o){insert(t,e,o),insert(t,n,o),insert(t,i,o)},d(t){t&&detach(e),t&&detach(n),t&&detach(i)}}}function create_if_block_5$4(t){let e;return{c(){e=text("Click to add new points. Close the shape when you're done.")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_if_block_4$5(t){let e;return{c(){e=text("Click to add new points. Click any handle again when you're done.")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_fragment$l(t){let e,n,i,o,r,s;const a=[create_if_block$e,create_else_block_1$1],l=[];function c(t,e){return t[1]?1:0}return n=c(t),i=l[n]=a[n](t),{c(){e=element("div"),i.c(),attr(e,"id","watermark"),attr(e,"class","svelte-x1o9ar"),toggle_class(e,"watermark",!t[1]&&!t[2])},m(t,i){insert(t,e,i),l[n].m(e,null),o=!0,r||(s=listen(e,"contextmenu",contextmenu_handler$4),r=!0)},p(t,[r]){let s=n;n=c(t),n===s?l[n].p(t,r):(group_outros(),transition_out(l[s],1,1,(()=>{l[s]=null})),check_outros(),i=l[n],i?i.p(t,r):(i=l[n]=a[n](t),i.c()),transition_in(i,1),i.m(e,null)),(!o||6&r)&&toggle_class(e,"watermark",!t[1]&&!t[2])},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){t&&detach(e),l[n].d(),r=!1,s()}}}const contextmenu_handler$4=t=>t.stopPropagation();function instance$l(t,e,n){let{mapName:i="Gamemap"}=e,{embedded:o=!1}=e,{lock:r}=e;return t.$$set=t=>{"mapName"in t&&n(0,i=t.mapName),"embedded"in t&&n(1,o=t.embedded),"lock"in t&&n(2,r=t.lock)},[i,o,r]}class Infobar extends SvelteComponent{constructor(t){super(),init(this,t,instance$l,create_fragment$l,safe_not_equal,{mapName:0,embedded:1,lock:2})}get mapName(){return this.$$.ctx[0]}set mapName(t){this.$$set({mapName:t}),flush()}get embedded(){return this.$$.ctx[1]}set embedded(t){this.$$set({embedded:t}),flush()}get lock(){return this.$$.ctx[2]}set lock(t){this.$$set({lock:t}),flush()}}function get_each_context$7(t,e,n){const i=t.slice();return i[4]=e[n],i}function get_each_context_1$1(t,e,n){const i=t.slice();return i[4]=e[n],i}function create_else_block$7(t){let e,n;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p:noop,i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block$d(t){let e,n,i,o,r,s,a,l,c=t[0],h=[];for(let e=0;e<c.length;e+=1)h[e]=create_each_block_1$1(get_each_context_1$1(t,c,e));const u=t=>transition_out(h[t],1,1,(()=>{h[t]=null}));o=new Divider({props:{direction:"horizontal"}});let d=t[0],p=[];for(let e=0;e<d.length;e+=1)p[e]=create_each_block$7(get_each_context$7(t,d,e));const _=t=>transition_out(p[t],1,1,(()=>{p[t]=null}));return{c(){e=element("div");for(let t=0;t<h.length;t+=1)h[t].c();n=space(),i=element("div"),create_component(o.$$.fragment),r=element("p"),s=space(),a=element("div");for(let t=0;t<p.length;t+=1)p[t].c();attr(e,"class","options_container"),set_style(i,"margin","10px"),attr(a,"class","options_container")},m(t,c){insert(t,e,c);for(let t=0;t<h.length;t+=1)h[t]&&h[t].m(e,null);insert(t,n,c),insert(t,i,c),mount_component(o,i,null),append(i,r),insert(t,s,c),insert(t,a,c);for(let t=0;t<p.length;t+=1)p[t]&&p[t].m(a,null);l=!0},p(t,n){if(1&n){let i;for(c=t[0],i=0;i<c.length;i+=1){const o=get_each_context_1$1(t,c,i);h[i]?(h[i].p(o,n),transition_in(h[i],1)):(h[i]=create_each_block_1$1(o),h[i].c(),transition_in(h[i],1),h[i].m(e,null))}for(group_outros(),i=c.length;i<h.length;i+=1)u(i);check_outros()}if(1&n){let e;for(d=t[0],e=0;e<d.length;e+=1){const i=get_each_context$7(t,d,e);p[e]?(p[e].p(i,n),transition_in(p[e],1)):(p[e]=create_each_block$7(i),p[e].c(),transition_in(p[e],1),p[e].m(a,null))}for(group_outros(),e=d.length;e<p.length;e+=1)_(e);check_outros()}},i(t){if(!l){for(let t=0;t<c.length;t+=1)transition_in(h[t]);transition_in(o.$$.fragment,t);for(let t=0;t<d.length;t+=1)transition_in(p[t]);l=!0}},o(t){h=h.filter(Boolean);for(let t=0;t<h.length;t+=1)transition_out(h[t]);transition_out(o.$$.fragment,t),p=p.filter(Boolean);for(let t=0;t<p.length;t+=1)transition_out(p[t]);l=!1},d(t){t&&detach(e),destroy_each(h,t),t&&detach(n),t&&detach(i),destroy_component(o),t&&detach(s),t&&detach(a),destroy_each(p,t)}}}function create_if_block_2$a(t){let e,n;return e=new LayerButton({props:{label:t[4].name,icon:"assets/maps/"+t[4].database+"/icons/favicon.png",dark:"true",big:"true",disabled:t[4].disabled}}),e.$on("onClick",(function(){return t[1](t[4])})),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(n,i){t=n;const o={};1&i&&(o.label=t[4].name),1&i&&(o.icon="assets/maps/"+t[4].database+"/icons/favicon.png"),1&i&&(o.disabled=t[4].disabled),e.$set(o)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_each_block_1$1(t){let e,n,i=!t[4].isModded&&create_if_block_2$a(t);return{c(){i&&i.c(),e=empty()},m(t,o){i&&i.m(t,o),insert(t,e,o),n=!0},p(t,n){t[4].isModded?i&&(group_outros(),transition_out(i,1,1,(()=>{i=null})),check_outros()):i?(i.p(t,n),1&n&&transition_in(i,1)):(i=create_if_block_2$a(t),i.c(),transition_in(i,1),i.m(e.parentNode,e))},i(t){n||(transition_in(i),n=!0)},o(t){transition_out(i),n=!1},d(t){i&&i.d(t),t&&detach(e)}}}function create_if_block_1$b(t){let e,n;return e=new LayerButton({props:{label:t[4].name,icon:"assets/maps/"+t[4].database+"/icons/favicon.png",dark:"true",big:"true",disabled:t[4].disabled}}),e.$on("onClick",(function(){return t[2](t[4])})),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(n,i){t=n;const o={};1&i&&(o.label=t[4].name),1&i&&(o.icon="assets/maps/"+t[4].database+"/icons/favicon.png"),1&i&&(o.disabled=t[4].disabled),e.$set(o)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_each_block$7(t){let e,n,i=t[4].isModded&&create_if_block_1$b(t);return{c(){i&&i.c(),e=empty()},m(t,o){i&&i.m(t,o),insert(t,e,o),n=!0},p(t,n){t[4].isModded?i?(i.p(t,n),1&n&&transition_in(i,1)):(i=create_if_block_1$b(t),i.c(),transition_in(i,1),i.m(e.parentNode,e)):i&&(group_outros(),transition_out(i,1,1,(()=>{i=null})),check_outros())},i(t){n||(transition_in(i),n=!0)},o(t){transition_out(i),n=!1},d(t){i&&i.d(t),t&&detach(e)}}}function create_default_slot$4(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m,g,v;n=new Icon({props:{name:"map",size:"medium"}}),c=new Divider({props:{direction:"horizontal"}});const y=[create_if_block$d,create_else_block$7],b=[];function k(t,e){return t[0]?.length>0?0:1}return f=k(t),m=b[f]=y[f](t),{c(){e=element("span"),create_component(n.$$.fragment),i=element("br"),o=space(),r=element("b"),r.textContent="Choose a game map",s=space(),a=element("p"),l=space(),create_component(c.$$.fragment),h=space(),u=element("p"),d=text("\n        Please choose a game from the options below.\n        "),p=element("p"),_=space(),m.c(),g=empty(),set_style(r,"margin-bottom","10px"),attr(e,"class","info_title svelte-ch4cvt")},m(t,m){insert(t,e,m),mount_component(n,e,null),append(e,i),append(e,o),append(e,r),insert(t,s,m),insert(t,a,m),insert(t,l,m),mount_component(c,t,m),insert(t,h,m),insert(t,u,m),insert(t,d,m),insert(t,p,m),insert(t,_,m),b[f].m(t,m),insert(t,g,m),v=!0},p(t,e){let n=f;f=k(t),f===n?b[f].p(t,e):(group_outros(),transition_out(b[n],1,1,(()=>{b[n]=null})),check_outros(),m=b[f],m?m.p(t,e):(m=b[f]=y[f](t),m.c()),transition_in(m,1),m.m(g.parentNode,g))},i(t){v||(transition_in(n.$$.fragment,t),transition_in(c.$$.fragment,t),transition_in(m),v=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(c.$$.fragment,t),transition_out(m),v=!1},d(t){t&&detach(e),destroy_component(n),t&&detach(s),t&&detach(a),t&&detach(l),destroy_component(c,t),t&&detach(h),t&&detach(u),t&&detach(d),t&&detach(p),t&&detach(_),b[f].d(t),t&&detach(g)}}}function create_fragment$k(t){let e,n;return e=new PreloadBox({props:{$$slots:{default:[create_default_slot$4]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,[n]){const i={};513&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function instance$k(t,e,n){let i=null;print("Getting available maps...");let o={action:"get_maps"};getJSON(GAME_DATA_SCRIPT+queryify(o)).then((t=>{n(0,i=[]),t.maps.forEach((e=>{let n={},o=t.mapInfos[e];n.name=o?.mapTitle.replace("Gamemap","").replace("Map","").trim()??e.toUpperCase(),n.database=e,n.disabled=null==o,n.isModded=1==o?.isModded||n.disabled,n.releaseDate=o?Date.parse(new Date(o.releaseDate.split("/")[2],o.releaseDate.split("/")[1]-1,o.releaseDate.split("/")[0])):0,i.push(n)})),i.sort(((t,e)=>new Date(e.releaseDate).getTime()-new Date(t.releaseDate).getTime())),print(i)}));return[i,t=>location.pathname=t.database,t=>location.pathname=t.database]}class MapChooser extends SvelteComponent{constructor(t){super(),init(this,t,instance$k,create_fragment$k,safe_not_equal,{})}}function create_fragment$j(t){let e,n,i,o,r,s,a;return{c(){e=element("label"),n=element("input"),i=space(),o=element("span"),r=text(t[1]),attr(n,"type","checkbox"),attr(n,"class","filled-in"),n.checked=t[0],attr(o,"class","svelte-xt39e3"),attr(e,"class","waves-effect"),set_style(e,"width","100%"),set_style(e,"padding-top","8px"),attr(e,"title",t[2])},m(l,c){insert(l,e,c),append(e,n),append(e,i),append(e,o),append(o,r),s||(a=listen(n,"change",t[3]),s=!0)},p(t,[i]){1&i&&(n.checked=t[0]),2&i&&set_data(r,t[1]),4&i&&attr(e,"title",t[2])},i:noop,o:noop,d(t){t&&detach(e),s=!1,a()}}}function instance$j(t,e,n){let{label:i}=e,{checked:o=!1}=e,{title:r}=e;const s=createEventDispatcher();return t.$$set=t=>{"label"in t&&n(1,i=t.label),"checked"in t&&n(0,o=t.checked),"title"in t&&n(2,r=t.title)},[o,i,r,function(){n(0,o=!o),s("change",o)}]}class Checkbox extends SvelteComponent{constructor(t){super(),init(this,t,instance$j,create_fragment$j,safe_not_equal,{label:1,checked:0,title:2})}get label(){return this.$$.ctx[1]}set label(t){this.$$set({label:t}),flush()}get checked(){return this.$$.ctx[0]}set checked(t){this.$$set({checked:t}),flush()}get title(){return this.$$.ctx[2]}set title(t){this.$$set({title:t}),flush()}}function create_if_block_2$9(t){let e,n;return e=new Icon({props:{name:t[4],size:t[8]}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16&n&&(i.name=t[4]),256&n&&(i.size=t[8]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$a(t){let e,n;return{c(){e=element("b"),n=text(t[0]),attr(e,"class","icon_btn_label nomobile svelte-1xlvi45")},m(t,i){insert(t,e,i),append(e,n)},p(t,e){1&e&&set_data(n,t[0])},d(t){t&&detach(e)}}}function create_if_block$c(t){let e;return{c(){e=element("i"),e.textContent="expand_more",attr(e,"id","dropdown_icon"),attr(e,"class","material-icons nomobile svelte-1xlvi45")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_fragment$i(t){let e,n,i,o,r,s,a,l=t[4]&&create_if_block_2$9(t),c=t[0]&&create_if_block_1$a(t),h=t[6]&&create_if_block$c();const u=t[12].default,d=create_slot(u,t,t[11],null);return{c(){e=element("button"),l&&l.c(),n=space(),c&&c.c(),i=space(),h&&h.c(),o=space(),d&&d.c(),attr(e,"class","btn_icon_button waves-effect mdc-ripple-surface svelte-1xlvi45"),attr(e,"title",t[3]),attr(e,"data-target",t[7]),toggle_class(e,"lock",t[9]),toggle_class(e,"checked",t[2]),toggle_class(e,"hasBackground",t[1]),toggle_class(e,"bgless",!t[1]),toggle_class(e,"nomobile",t[5]),toggle_class(e,"dropdown",t[6]),toggle_class(e,"dropdown-trigger",null!=t[7])},m(u,p){insert(u,e,p),l&&l.m(e,null),append(e,n),c&&c.m(e,null),append(e,i),h&&h.m(e,null),insert(u,o,p),d&&d.m(u,p),r=!0,s||(a=[listen(e,"click",t[10]),listen(e,"auxclick",t[10]),listen(e,"contextmenu",contextmenu_handler$3)],s=!0)},p(t,[o]){t[4]?l?(l.p(t,o),16&o&&transition_in(l,1)):(l=create_if_block_2$9(t),l.c(),transition_in(l,1),l.m(e,n)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros()),t[0]?c?c.p(t,o):(c=create_if_block_1$a(t),c.c(),c.m(e,i)):c&&(c.d(1),c=null),t[6]?h||(h=create_if_block$c(),h.c(),h.m(e,null)):h&&(h.d(1),h=null),(!r||8&o)&&attr(e,"title",t[3]),(!r||128&o)&&attr(e,"data-target",t[7]),(!r||512&o)&&toggle_class(e,"lock",t[9]),(!r||4&o)&&toggle_class(e,"checked",t[2]),(!r||2&o)&&toggle_class(e,"hasBackground",t[1]),(!r||2&o)&&toggle_class(e,"bgless",!t[1]),(!r||32&o)&&toggle_class(e,"nomobile",t[5]),(!r||64&o)&&toggle_class(e,"dropdown",t[6]),(!r||128&o)&&toggle_class(e,"dropdown-trigger",null!=t[7]),d&&d.p&&(!r||2048&o)&&update_slot_base(d,u,t,t[11],r?get_slot_changes(u,t[11],o,null):get_all_dirty_from_scope(t[11]),null)},i(t){r||(transition_in(l),transition_in(d,t),r=!0)},o(t){transition_out(l),transition_out(d,t),r=!1},d(t){t&&detach(e),l&&l.d(),c&&c.d(),h&&h.d(),t&&detach(o),d&&d.d(t),s=!1,run_all(a)}}}const contextmenu_handler$3=t=>t.stopPropagation();function instance$i(t,e,n){let{$$slots:i={},$$scope:o}=e,{tooltip:r}=e,{icon:s}=e,{label:a}=e,{hasBackground:l=!0}=e,{checked:c}=e,{noMobile:h}=e,{dropdown:u}=e,{menu:d}=e,{size:p}=e,{lock:_}=e;c=null!=c?JSON.parse(c):null,l=null!=l?JSON.parse(l):null;const f=createEventDispatcher();return null!=u&&(c=!1),null!=c&&(l=!0),l||(a=null),null==a&&u&&(a="Loading..."),onMount((async()=>{if(null!=d){var t=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(t,{constrainWidth:!1,closeOnClick:!0,alignment:"right"})}})),t.$$set=t=>{"tooltip"in t&&n(3,r=t.tooltip),"icon"in t&&n(4,s=t.icon),"label"in t&&n(0,a=t.label),"hasBackground"in t&&n(1,l=t.hasBackground),"checked"in t&&n(2,c=t.checked),"noMobile"in t&&n(5,h=t.noMobile),"dropdown"in t&&n(6,u=t.dropdown),"menu"in t&&n(7,d=t.menu),"size"in t&&n(8,p=t.size),"lock"in t&&n(9,_=t.lock),"$$scope"in t&&n(11,o=t.$$scope)},[a,l,c,r,s,h,u,d,p,_,function(t){null!=c?(n(2,c=!c),f("checked",{checked:c,shift:t.shiftKey})):t.shiftKey?f("shiftClicked","clicked"):f("click","clicked")},o,i]}class IconButton extends SvelteComponent{constructor(t){super(),init(this,t,instance$i,create_fragment$i,safe_not_equal,{tooltip:3,icon:4,label:0,hasBackground:1,checked:2,noMobile:5,dropdown:6,menu:7,size:8,lock:9})}get tooltip(){return this.$$.ctx[3]}set tooltip(t){this.$$set({tooltip:t}),flush()}get icon(){return this.$$.ctx[4]}set icon(t){this.$$set({icon:t}),flush()}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),flush()}get hasBackground(){return this.$$.ctx[1]}set hasBackground(t){this.$$set({hasBackground:t}),flush()}get checked(){return this.$$.ctx[2]}set checked(t){this.$$set({checked:t}),flush()}get noMobile(){return this.$$.ctx[5]}set noMobile(t){this.$$set({noMobile:t}),flush()}get dropdown(){return this.$$.ctx[6]}set dropdown(t){this.$$set({dropdown:t}),flush()}get menu(){return this.$$.ctx[7]}set menu(t){this.$$set({menu:t}),flush()}get size(){return this.$$.ctx[8]}set size(t){this.$$set({size:t}),flush()}get lock(){return this.$$.ctx[9]}set lock(t){this.$$set({lock:t}),flush()}}function get_if_ctx$2(t){const e=t.slice(),n=new Date(Date.parse(e[5]));e[14]=n;const i=UTCtoLocalDate(e[14]);return e[15]=i,e}function get_if_ctx_1$1(t){const e=t.slice(),n=e[8].includes("edit")?"edit":e[8].includes("delete")?"delete_forever":e[8].includes("add")?"add":e[8].includes("revert")?"history":"add";return e[11]=n,e}function get_if_ctx_2$1(t){const e=t.slice(),n=e[11].includes("/")?gamemap.getMapConfig().icons.get(Number(e[11].replace(/\D/g,""))):e[3]>0?"World":"Location";return e[16]=n,e}function create_if_block_3$8(t){let e,n,i,o;function r(t,n){return 2048&n&&(e=null),null==e&&(e=!!t[11].includes("/")),e?create_if_block_5$3:create_else_block$6}let s=r(t,-1),a=s(t),l=t[8]&&create_if_block_4$4(get_if_ctx_1$1(t));return{c(){a.c(),n=space(),l&&l.c(),i=empty()},m(t,e){a.m(t,e),insert(t,n,e),l&&l.m(t,e),insert(t,i,e),o=!0},p(t,e){s===(s=r(t,e))&&a?a.p(t,e):(a.d(1),a=s(t),a&&(a.c(),a.m(n.parentNode,n))),t[8]?l?(l.p(get_if_ctx_1$1(t),e),256&e&&transition_in(l,1)):(l=create_if_block_4$4(get_if_ctx_1$1(t)),l.c(),transition_in(l,1),l.m(i.parentNode,i)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){o||(transition_in(l),o=!0)},o(t){transition_out(l),o=!1},d(t){a.d(t),t&&detach(n),l&&l.d(t),t&&detach(i)}}}function create_else_block$6(t){let e,n,i;return{c(){e=element("i"),n=text(t[11]),attr(e,"class","material-icons circle svelte-1eqbi2x"),attr(e,"title",i=t[16])},m(t,i){insert(t,e,i),append(e,n)},p(t,o){2048&o&&set_data(n,t[11]),2056&o&&i!==(i=t[16])&&attr(e,"title",i)},d(t){t&&detach(e)}}}function create_if_block_5$3(t){let e,n,i;return{c(){e=element("img"),attr(e,"class","circle svelte-1eqbi2x"),src_url_equal(e.src,n=t[11])||attr(e,"src",n),attr(e,"width",gamemap.getMapConfig().iconSize),attr(e,"height",gamemap.getMapConfig().iconSize),attr(e,"title",i=t[16])},m(t,n){insert(t,e,n)},p(t,o){2048&o&&!src_url_equal(e.src,n=t[11])&&attr(e,"src",n),2056&o&&i!==(i=t[16])&&attr(e,"title",i)},d(t){t&&detach(e)}}}function create_if_block_4$4(t){let e,n,i;return n=new Icon({props:{name:t[11],size:"13"}}),{c(){e=element("div"),create_component(n.$$.fragment),attr(e,"title",t[9]),attr(e,"class","action svelte-1eqbi2x"),toggle_class(e,"add",t[8].includes("add")),toggle_class(e,"delete",t[8].includes("delete")),toggle_class(e,"edit",t[8].includes("edit")),toggle_class(e,"revert",t[8].includes("revert"))},m(t,o){insert(t,e,o),mount_component(n,e,null),i=!0},p(t,o){const r={};256&o&&(r.name=t[11]),n.$set(r),(!i||512&o)&&attr(e,"title",t[9]),(!i||256&o)&&toggle_class(e,"add",t[8].includes("add")),(!i||256&o)&&toggle_class(e,"delete",t[8].includes("delete")),(!i||256&o)&&toggle_class(e,"edit",t[8].includes("edit")),(!i||256&o)&&toggle_class(e,"revert",t[8].includes("revert"))},i(t){i||(transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(n.$$.fragment,t),i=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_if_block_2$8(t){let e,n,i,o=getTimeAgo(Date.parse(t[15]))+"";return{c(){e=element("small"),n=text(o),attr(e,"class","timestamp svelte-1eqbi2x"),attr(e,"title",i=t[15])},m(t,i){insert(t,e,i),append(e,n)},p(t,r){32&r&&o!==(o=getTimeAgo(Date.parse(t[15]))+"")&&set_data(n,o),32&r&&i!==(i=t[15])&&attr(e,"title",i)},d(t){t&&detach(e)}}}function create_if_block_1$9(t){let e,n,i=(t[7]&&!t[1]?"":t[1])+"";return{c(){e=element("small"),n=text(i),attr(e,"class","list_subtitle svelte-1eqbi2x"),set_style(e,"color","var(--text_low_emphasis)")},m(t,i){insert(t,e,i),append(e,n)},p(t,e){130&e&&i!==(i=(t[7]&&!t[1]?"":t[1])+"")&&set_data(n,i)},d(t){t&&detach(e)}}}function create_if_block$b(t){let e,n,i,o,r,s=("bot"==t[7].toLowerCase()?" "+t[7]:t[7])+"";return n=new Icon({props:{name:"bot"==t[7].toLowerCase()?"smart_toy":"person",size:"tiny"}}),{c(){e=element("small"),create_component(n.$$.fragment),i=space(),o=text(s),attr(e,"class","author svelte-1eqbi2x")},m(t,s){insert(t,e,s),mount_component(n,e,null),append(e,i),append(e,o),r=!0},p(t,e){const i={};128&e&&(i.name="bot"==t[7].toLowerCase()?"smart_toy":"person"),n.$set(i),(!r||128&e)&&s!==(s=("bot"==t[7].toLowerCase()?" "+t[7]:t[7])+"")&&set_data(o,s)},i(t){r||(transition_in(n.$$.fragment,t),r=!0)},o(t){transition_out(n.$$.fragment,t),r=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_fragment$h(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f=t[11]&&create_if_block_3$8(get_if_ctx_2$1(t)),m=t[5]&&create_if_block_2$8(get_if_ctx$2(t)),g=(t[1]||t[7])&&create_if_block_1$9(t),v=t[7]&&create_if_block$b(t);return{c(){e=element("div"),n=element("a"),f&&f.c(),i=space(),o=element("div"),r=element("div"),s=element("b"),a=text(t[0]),l=space(),m&&m.c(),c=space(),h=element("div"),g&&g.c(),u=space(),v&&v.c(),attr(s,"class","list_title svelte-1eqbi2x"),attr(s,"title",t[0]),toggle_class(s,"bold",t[2]),attr(r,"class","title svelte-1eqbi2x"),attr(h,"class","subtitle svelte-1eqbi2x"),attr(o,"class","text"),attr(n,"class","collection-item waves-effect mdc-ripple-surface list-item svelte-1eqbi2x"),toggle_class(n,"avatar",null!=t[11]),toggle_class(n,"compact",t[6]),attr(e,"class","collection svelte-1eqbi2x"),attr(e,"title",t[10]),toggle_class(e,"selected",t[4])},m(y,b){insert(y,e,b),append(e,n),f&&f.m(n,null),append(n,i),append(n,o),append(o,r),append(r,s),append(s,a),append(r,l),m&&m.m(r,null),append(o,c),append(o,h),g&&g.m(h,null),append(h,u),v&&v.m(h,null),d=!0,p||(_=[listen(n,"click",t[12]),listen(n,"auxclick",t[12])],p=!0)},p(t,[o]){t[11]?f?(f.p(get_if_ctx_2$1(t),o),2048&o&&transition_in(f,1)):(f=create_if_block_3$8(get_if_ctx_2$1(t)),f.c(),transition_in(f,1),f.m(n,i)):f&&(group_outros(),transition_out(f,1,1,(()=>{f=null})),check_outros()),(!d||1&o)&&set_data(a,t[0]),(!d||1&o)&&attr(s,"title",t[0]),(!d||4&o)&&toggle_class(s,"bold",t[2]),t[5]?m?m.p(get_if_ctx$2(t),o):(m=create_if_block_2$8(get_if_ctx$2(t)),m.c(),m.m(r,null)):m&&(m.d(1),m=null),t[1]||t[7]?g?g.p(t,o):(g=create_if_block_1$9(t),g.c(),g.m(h,u)):g&&(g.d(1),g=null),t[7]?v?(v.p(t,o),128&o&&transition_in(v,1)):(v=create_if_block$b(t),v.c(),transition_in(v,1),v.m(h,null)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros()),(!d||2048&o)&&toggle_class(n,"avatar",null!=t[11]),(!d||64&o)&&toggle_class(n,"compact",t[6]),(!d||1024&o)&&attr(e,"title",t[10]),(!d||16&o)&&toggle_class(e,"selected",t[4])},i(t){d||(transition_in(f),transition_in(v),d=!0)},o(t){transition_out(f),transition_out(v),d=!1},d(t){t&&detach(e),f&&f.d(),m&&m.d(),g&&g.d(),v&&v.d(),p=!1,run_all(_)}}}function instance$h(t,e,n){let{title:i}=e,{subtitle:o}=e,{icon:r}=e,{bold:s}=e,{destinationID:a}=e,{selected:l}=e,{timestamp:c}=e,{compact:h}=e,{user:u}=e,{action:d}=e,{comment:p}=e,{tooltip:_}=e;const f=createEventDispatcher();return t.$$set=t=>{"title"in t&&n(0,i=t.title),"subtitle"in t&&n(1,o=t.subtitle),"icon"in t&&n(11,r=t.icon),"bold"in t&&n(2,s=t.bold),"destinationID"in t&&n(3,a=t.destinationID),"selected"in t&&n(4,l=t.selected),"timestamp"in t&&n(5,c=t.timestamp),"compact"in t&&n(6,h=t.compact),"user"in t&&n(7,u=t.user),"action"in t&&n(8,d=t.action),"comment"in t&&n(9,p=t.comment),"tooltip"in t&&n(10,_=t.tooltip)},[i,o,s,a,l,c,h,u,d,p,_,r,function(t){t.shiftKey?f("shiftClick",a):"auxclick"==t.type?f("middleClick",a):f("click",a)}]}class ListItem extends SvelteComponent{constructor(t){super(),init(this,t,instance$h,create_fragment$h,safe_not_equal,{title:0,subtitle:1,icon:11,bold:2,destinationID:3,selected:4,timestamp:5,compact:6,user:7,action:8,comment:9,tooltip:10})}get title(){return this.$$.ctx[0]}set title(t){this.$$set({title:t}),flush()}get subtitle(){return this.$$.ctx[1]}set subtitle(t){this.$$set({subtitle:t}),flush()}get icon(){return this.$$.ctx[11]}set icon(t){this.$$set({icon:t}),flush()}get bold(){return this.$$.ctx[2]}set bold(t){this.$$set({bold:t}),flush()}get destinationID(){return this.$$.ctx[3]}set destinationID(t){this.$$set({destinationID:t}),flush()}get selected(){return this.$$.ctx[4]}set selected(t){this.$$set({selected:t}),flush()}get timestamp(){return this.$$.ctx[5]}set timestamp(t){this.$$set({timestamp:t}),flush()}get compact(){return this.$$.ctx[6]}set compact(t){this.$$set({compact:t}),flush()}get user(){return this.$$.ctx[7]}set user(t){this.$$set({user:t}),flush()}get action(){return this.$$.ctx[8]}set action(t){this.$$set({action:t}),flush()}get comment(){return this.$$.ctx[9]}set comment(t){this.$$set({comment:t}),flush()}get tooltip(){return this.$$.ctx[10]}set tooltip(t){this.$$set({tooltip:t}),flush()}}const{window:window_1$4}=globals;function get_each_context$6(t,e,n){const i=t.slice();i[30]=e[n];const o=i[30].destinationID>0;return i[31]=o,i}function create_if_block_9$2(t){let e,n;return e=new IconButton({props:{icon:"close",tooltip:"Clear the current search",hasBackground:!1}}),e.$on("click",t[13]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p:noop,i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_8$2(t){let e,n,i;return n=new ProgressBar({}),{c(){e=element("div"),create_component(n.$$.fragment),set_style(e,"top","46px"),set_style(e,"position","absolute"),set_style(e,"left","0px"),set_style(e,"width","100%")},m(t,o){insert(t,e,o),mount_component(n,e,null),i=!0},i(t){i||(transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(n.$$.fragment,t),i=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_if_block$a(t){let e,n,i,o,r,s,a,l,c,h,u,d;r=new Icon({props:{name:t[8]?"expand_less":"expand_more",size:"tiny"}});let p=t[7]&&t[10]&&create_if_block_7$2(),_=t[8]&&create_if_block_5$2(t),f=t[10]&&create_if_block_1$8(t);return{c(){e=element("div"),n=element("div"),i=element("b"),o=text("Search Options "),create_component(r.$$.fragment),s=element("br"),a=space(),p&&p.c(),l=space(),_&&_.c(),c=space(),f&&f.c(),set_style(i,"font-size","1.0rem"),attr(i,"class","waves-effect"),attr(i,"title","Click to show/hide search options"),attr(n,"id","search_options"),attr(n,"class","svelte-14u8ksw"),toggle_class(n,"fullPane",t[10]),attr(e,"id","search_content_container"),attr(e,"class","svelte-14u8ksw"),toggle_class(e,"fullPane",t[10])},m(m,g){insert(m,e,g),append(e,n),append(n,i),append(i,o),mount_component(r,i,null),append(n,s),append(n,a),p&&p.m(n,null),append(n,l),_&&_.m(n,null),append(e,c),f&&f.m(e,null),h=!0,u||(d=listen(i,"click",t[21]),u=!0)},p(t,i){const o={};256&i[0]&&(o.name=t[8]?"expand_less":"expand_more"),r.$set(o),t[7]&&t[10]?p?1152&i[0]&&transition_in(p,1):(p=create_if_block_7$2(),p.c(),transition_in(p,1),p.m(n,l)):p&&(group_outros(),transition_out(p,1,1,(()=>{p=null})),check_outros()),t[8]?_?(_.p(t,i),256&i[0]&&transition_in(_,1)):(_=create_if_block_5$2(t),_.c(),transition_in(_,1),_.m(n,null)):_&&(group_outros(),transition_out(_,1,1,(()=>{_=null})),check_outros()),(!h||1024&i[0])&&toggle_class(n,"fullPane",t[10]),t[10]?f?(f.p(t,i),1024&i[0]&&transition_in(f,1)):(f=create_if_block_1$8(t),f.c(),transition_in(f,1),f.m(e,null)):f&&(group_outros(),transition_out(f,1,1,(()=>{f=null})),check_outros()),(!h||1024&i[0])&&toggle_class(e,"fullPane",t[10])},i(t){h||(transition_in(r.$$.fragment,t),transition_in(p),transition_in(_),transition_in(f),h=!0)},o(t){transition_out(r.$$.fragment,t),transition_out(p),transition_out(_),transition_out(f),h=!1},d(t){t&&detach(e),destroy_component(r),p&&p.d(),_&&_.d(),f&&f.d(),u=!1,d()}}}function create_if_block_7$2(t){let e,n,i;return n=new Icon({props:{name:"push_pin",size:"tiny"}}),{c(){e=element("div"),create_component(n.$$.fragment),attr(e,"id","search_pin_status"),attr(e,"title","Search is pinned"),attr(e,"class","svelte-14u8ksw")},m(t,o){insert(t,e,o),mount_component(n,e,null),i=!0},i(t){i||(transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(n.$$.fragment,t),i=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_if_block_5$2(t){let e,n,i,o=gamemap.hasMultipleWorlds(),r=o&&create_if_block_6$2(t);return n=new Checkbox({props:{label:"Pin search window over map",title:"Toggle to pin the search window over the map",checked:t[7]}}),n.$on("change",t[23]),{c(){r&&r.c(),e=space(),create_component(n.$$.fragment)},m(t,o){r&&r.m(t,o),insert(t,e,o),mount_component(n,t,o),i=!0},p(t,e){o&&r.p(t,e);const i={};128&e[0]&&(i.checked=t[7]),n.$set(i)},i(t){i||(transition_in(r),transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(r),transition_out(n.$$.fragment,t),i=!1},d(t){r&&r.d(t),t&&detach(e),destroy_component(n,t)}}}function create_if_block_6$2(t){let e,n;return e=new Checkbox({props:{label:"Only show results from this map",title:"Toggle to only search locations in the current map",checked:t[6]}}),e.$on("change",t[22]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};64&n[0]&&(i.checked=t[6]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$8(t){let e,n,i,o,r,s=!t[9]&&create_if_block_4$3(),a=null!=t[9]&&create_if_block_2$7(t);return{c(){e=element("hr"),n=space(),s&&s.c(),i=space(),a&&a.c(),o=empty(),attr(e,"id","search_divider")},m(t,l){insert(t,e,l),insert(t,n,l),s&&s.m(t,l),insert(t,i,l),a&&a.m(t,l),insert(t,o,l),r=!0},p(t,e){t[9]?s&&(s.d(1),s=null):s||(s=create_if_block_4$3(),s.c(),s.m(i.parentNode,i)),null!=t[9]?a?(a.p(t,e),512&e[0]&&transition_in(a,1)):(a=create_if_block_2$7(t),a.c(),transition_in(a,1),a.m(o.parentNode,o)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros())},i(t){r||(transition_in(a),r=!0)},o(t){transition_out(a),r=!1},d(t){t&&detach(e),t&&detach(n),s&&s.d(t),t&&detach(i),a&&a.d(t),t&&detach(o)}}}function create_if_block_4$3(t){let e;return{c(){e=element("b"),e.textContent="Searching...",set_style(e,"font-size","1.0rem"),set_style(e,"width","100%"),set_style(e,"text-align","center"),set_style(e,"display","inline-block"),set_style(e,"padding","var(--padding_small) ")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_if_block_2$7(t){let e,n,i,o;const r=[create_if_block_3$7,create_else_block$5],s=[];function a(t,e){return t[9].length>0?0:1}return n=a(t),i=s[n]=r[n](t),{c(){e=element("div"),i.c(),attr(e,"id","search_results"),attr(e,"class","search_results svelte-14u8ksw")},m(t,i){insert(t,e,i),s[n].m(e,null),o=!0},p(t,o){let l=n;n=a(t),n===l?s[n].p(t,o):(group_outros(),transition_out(s[l],1,1,(()=>{s[l]=null})),check_outros(),i=s[n],i?i.p(t,o):(i=s[n]=r[n](t),i.c()),transition_in(i,1),i.m(e,null))},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){t&&detach(e),s[n].d()}}}function create_else_block$5(t){let e;return{c(){e=element("b"),e.textContent="No results found.",set_style(e,"font-size","1.0rem"),set_style(e,"width","100%"),set_style(e,"text-align","center"),set_style(e,"display","inline-block"),set_style(e,"padding","var(--padding_small)")},m(t,n){insert(t,e,n)},p:noop,i:noop,o:noop,d(t){t&&detach(e)}}}function create_if_block_3$7(t){let e,n,i=t[9],o=[];for(let e=0;e<i.length;e+=1)o[e]=create_each_block$6(get_each_context$6(t,i,e));const r=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=empty()},m(t,i){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,i);insert(t,e,i),n=!0},p(t,n){if(16896&n[0]){let s;for(i=t[9],s=0;s<i.length;s+=1){const r=get_each_context$6(t,i,s);o[s]?(o[s].p(r,n),transition_in(o[s],1)):(o[s]=create_each_block$6(r),o[s].c(),transition_in(o[s],1),o[s].m(e.parentNode,e))}for(group_outros(),s=i.length;s<o.length;s+=1)r(s);check_outros()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)transition_in(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);n=!1},d(t){destroy_each(o,t),t&&detach(e)}}}function create_each_block$6(t){let e,n;return e=new ListItem({props:{title:t[30].name,subtitle:!t[31]&&gamemap.hasMultipleWorlds()?t[30].description:null,icon:null!=t[30].icon?gamemap.getMapConfig().iconPath+t[30].icon+".png":t[31]?"public":"location_on",destinationID:t[30].destinationID,bold:t[31]}}),e.$on("click",t[24]),e.$on("middleClick",t[25]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};512&n[0]&&(i.title=t[30].name),512&n[0]&&(i.subtitle=!t[31]&&gamemap.hasMultipleWorlds()?t[30].description:null),512&n[0]&&(i.icon=null!=t[30].icon?gamemap.getMapConfig().iconPath+t[30].icon+".png":t[31]?"public":"location_on"),512&n[0]&&(i.destinationID=t[30].destinationID),512&n[0]&&(i.bold=t[31]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_fragment$g(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m;r=new Icon({props:{name:"search"}});let g=t[0].length>0&&""!=t[3].value&&create_if_block_9$2(t),v=t[10]&&t[5]&&create_if_block_8$2(),y=t[4]&&create_if_block$a(t);return{c(){e=element("div"),n=element("div"),i=element("div"),o=element("div"),create_component(r.$$.fragment),s=space(),a=element("div"),l=element("input"),c=space(),g&&g.c(),h=space(),v&&v.c(),u=space(),y&&y.c(),attr(o,"id","search_icon"),attr(o,"class","svelte-14u8ksw"),attr(l,"id","searchbox"),attr(l,"type","search"),attr(l,"placeholder","Where would you like to go?"),attr(l,"maxlength","100"),set_style(l,"border-bottom","none",1),set_style(l,"box-shadow","none",1),attr(l,"autocomplete","off"),attr(a,"id","searchbox_container"),attr(a,"class","svelte-14u8ksw"),attr(i,"id","searchbar"),attr(i,"title","Type here to search"),attr(i,"class","waves-effect svelte-14u8ksw"),toggle_class(i,"fullPane",t[10]),toggle_class(i,"lockNoFade",t[1]),attr(n,"id","search_container"),attr(n,"class","svelte-14u8ksw"),attr(e,"id","search_pane"),attr(e,"class","svelte-14u8ksw"),toggle_class(e,"lock",t[1])},m(d,p){insert(d,e,p),append(e,n),append(n,i),append(i,o),mount_component(r,o,null),append(i,s),append(i,a),append(a,l),t[17](l),set_input_value(l,t[0]),append(i,c),g&&g.m(i,null),append(i,h),v&&v.m(i,null),append(n,u),y&&y.m(n,null),_=!0,f||(m=[listen(window_1$4,"keydown",t[12]),listen(window_1$4,"mousedown",t[15]),listen(l,"focus",t[16]),listen(l,"input",t[18]),listen(l,"input",t[19]),listen(i,"click",t[20]),listen(e,"contextmenu",contextmenu_handler$2)],f=!0)},p(t,o){1&o[0]&&l.value!==t[0]&&set_input_value(l,t[0]),t[0].length>0&&""!=t[3].value?g?(g.p(t,o),9&o[0]&&transition_in(g,1)):(g=create_if_block_9$2(t),g.c(),transition_in(g,1),g.m(i,h)):g&&(group_outros(),transition_out(g,1,1,(()=>{g=null})),check_outros()),t[10]&&t[5]?v?1056&o[0]&&transition_in(v,1):(v=create_if_block_8$2(),v.c(),transition_in(v,1),v.m(i,null)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros()),(!_||1024&o[0])&&toggle_class(i,"fullPane",t[10]),(!_||2&o[0])&&toggle_class(i,"lockNoFade",t[1]),t[4]?y?(y.p(t,o),16&o[0]&&transition_in(y,1)):(y=create_if_block$a(t),y.c(),transition_in(y,1),y.m(n,null)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros()),(!_||2&o[0])&&toggle_class(e,"lock",t[1])},i(t){_||(transition_in(r.$$.fragment,t),transition_in(g),transition_in(v),transition_in(y),add_render_callback((()=>{_&&(p&&p.end(1),d=create_in_transition(e,fly,{x:-5,duration:250}),d.start())})),_=!0)},o(t){transition_out(r.$$.fragment,t),transition_out(g),transition_out(v),transition_out(y),d&&d.invalidate(),p=create_out_transition(e,fade,{duration:75}),_=!1},d(n){n&&detach(e),destroy_component(r),t[17](null),g&&g.d(),v&&v.d(),y&&y.d(),n&&p&&p.end(),f=!1,run_all(m)}}}const DELAY_AMOUNT=500;function selectSearchResult(t){let e=document.querySelectorAll(".list-item.selected");[].forEach.call(e,(function(t){t.classList.remove("selected")}));let n=document.getElementsByClassName("list-item");n[t].classList.add("selected"),n[t].scrollIntoView({behavior:"auto",block:"nearest"})}const contextmenu_handler$2=t=>t.stopPropagation();function instance$g(t,e,n){let i,o,{lock:r}=e,{searchQuery:s=""}=e,a=null,l=!1,c=!1,h=getPrefs("pinsearch"),u=getPrefs("expandsearchoptions"),d=null,p=null,_=0,f=class{constructor(t,e,n,i){this.name=t,this.description=e,this.icon=n||null,this.destinationID=i}};function m(t,e){n(0,s=t),n(3,a.value=t,a),n(4,p=!0),e=null!=e&&e,null!=t&&t.length>0?(n(9,d=null),_=0,n(5,l=!0),null!=o&&clearTimeout(o),o=setTimeout((()=>function(t,e){let i={action:"search"};i.search=encodeURIComponent(t),print("search query: "+i.search+", search in map: "+e),1==e&&(i.world=gamemap.getCurrentWorldID());if(i.db=gamemap.getMapConfig().database,"type:"===t.substring(0,5)){let e=gamemap.getIconByName(t.substring(5));null!=e&&(i.searchtype=e)}else if("name:"===t.substring(0,5)){null!=(o=t.substring(5).trim())&&""!=o&&(i.searchname=o)}else if("world:"===t.substring(0,6)){var o;null!=(o=t.substring(6).trim())&&""!=o&&(i.searchname=o)}getJSON(GAME_DATA_SCRIPT+queryify(i)).then((t=>{let e=[].concat(t.worlds,t.locations),i=[];for(let t in e){let n=e[t];if(null!=n){let t;if(null!=n.tilesX)t=new f(n.displayName,null,null,n.id);else{let e=gamemap.getWorldFromID(n.worldId);null!=e&&(t=new f(n.name,e.displayName,n.iconType,-n.id))}null!=t&&i.push(t)}}n(9,d=i),n(5,l=!1),print(d)})).catch((t=>print.warn(`There was an error getting search results: ${t}`)))}(t,e)),DELAY_AMOUNT)):v()}function g(t,e){if("focus"!=t.type){let e=document.querySelector("#search_pane"),i=null!=t.relatedTarget?t.relatedTarget:null!=t.explicitOriginalTarget?t.explicitOriginalTarget:document.elementsFromPoint(t.clientX,t.clientY)[0],o=e!==i&&e.contains(i);h?""==s&&n(4,p=o):n(4,p=o)}else n(4,p=e)}function v(){n(3,a.value="",a),_=0,n(5,l=!1),n(9,d=null)}function y(t){gamemap.goto(t),h||n(4,p=!1)}return t.$$set=t=>{"lock"in t&&n(1,r=t.lock),"searchQuery"in t&&n(0,s=t.searchQuery)},t.$$.update=()=>{27&t.$$.dirty[0]&&n(10,i=s.length>0&&""!=s&&p&&""!=a.value&&!r)},[s,r,m,a,p,l,c,h,u,d,i,g,function(t){(t.ctrlKey||t.metaKey)&&70===t.keyCode&&(t.preventDefault(),a.focus()),p&&i&&null!=d&&d.length>0&&("Enter"!=t.key&&13!=t.keyCode||(y(d[_].destinationID),selectSearchResult(_),t.preventDefault()),"ArrowUp"!=t.key&&38!=t.keyCode||(_=_-1>=0?_-1:0,0==_&&document.getElementById("search_content_container").scroll({top:0,behavior:"auto"}),selectSearchResult(_),t.preventDefault()),"ArrowDown"!=t.key&&40!=t.keyCode||(_=_+1!=d.length?_+1:_,selectSearchResult(_),t.preventDefault())),p&&("Escape"!=t.key&&27!=t.keyCode||(n(4,p=!1),gamemap.mapRoot.focus()))},v,y,t=>g(t,null),t=>g(t,!0),function(t){binding_callbacks[t?"unshift":"push"]((()=>{a=t,n(3,a)}))},function(){s=this.value,n(0,s)},()=>m(a.value,c),()=>a.focus(),()=>{setPrefs("expandsearchoptions",!getPrefs("expandsearchoptions")),n(8,u=getPrefs("expandsearchoptions"))},t=>{n(6,c=t.detail),m(s,c)},t=>{setPrefs("pinsearch",t.detail),n(7,h=getPrefs("pinsearch"))},t=>{y(t.detail)},t=>{window.open(`${location.origin}${location.pathname}?${t.detail>0?`world=${t.detail}`:`centeron=${Math.abs(t.detail)}`}`)}]}class SearchPane extends SvelteComponent{constructor(t){super(),init(this,t,instance$g,create_fragment$g,safe_not_equal,{lock:1,searchQuery:0,updateSearch:2},null,[-1,-1])}get lock(){return this.$$.ctx[1]}set lock(t){this.$$set({lock:t}),flush()}get searchQuery(){return this.$$.ctx[0]}set searchQuery(t){this.$$set({searchQuery:t}),flush()}get updateSearch(){return this.$$.ctx[2]}}const ALIGNMENT={AUTO:"auto",START:"start",CENTER:"center",END:"end"},DIRECTION={HORIZONTAL:"horizontal",VERTICAL:"vertical"},SCROLL_CHANGE_REASON={OBSERVED:0,REQUESTED:1},SCROLL_PROP={[DIRECTION.VERTICAL]:"top",[DIRECTION.HORIZONTAL]:"left"},SCROLL_PROP_LEGACY={[DIRECTION.VERTICAL]:"scrollTop",[DIRECTION.HORIZONTAL]:"scrollLeft"};class SizeAndPositionManager{constructor({itemSize:t,itemCount:e,estimatedItemSize:n}){this.itemSize=t,this.itemCount=e,this.estimatedItemSize=n,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return"function"==typeof this.itemSize}updateConfig({itemSize:t,itemCount:e,estimatedItemSize:n}){null!=e&&(this.itemCount=e),null!=n&&(this.estimatedItemSize=n),null!=t&&(this.itemSize=t),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&null!=this.totalSize?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(t){const{itemSize:e}=this;return"function"==typeof e?e(t):Array.isArray(e)?e[t]:e}computeTotalSizeAndPositionData(){let t=0;for(let e=0;e<this.itemCount;e++){const n=this.getSize(e),i=t;t+=n,this.itemSizeAndPositionData[e]={offset:i,size:n}}this.totalSize=t}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(t){if(t<0||t>=this.itemCount)throw Error(`Requested index ${t} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(t):this.itemSizeAndPositionData[t]}getJustInTimeSizeAndPositionForIndex(t){if(t>this.lastMeasuredIndex){const e=this.getSizeAndPositionOfLastMeasuredItem();let n=e.offset+e.size;for(let e=this.lastMeasuredIndex+1;e<=t;e++){const t=this.getSize(e);if(null==t||isNaN(t))throw Error(`Invalid size returned for index ${e} of value ${t}`);this.itemSizeAndPositionData[e]={offset:n,size:t},n+=t}this.lastMeasuredIndex=t}return this.itemSizeAndPositionData[t]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const t=this.getSizeAndPositionOfLastMeasuredItem();return t.offset+t.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:t=ALIGNMENT.START,containerSize:e,currentOffset:n,targetIndex:i}){if(e<=0)return 0;const o=this.getSizeAndPositionForIndex(i),r=o.offset,s=r-e+o.size;let a;switch(t){case ALIGNMENT.END:a=s;break;case ALIGNMENT.CENTER:a=r-(e-o.size)/2;break;case ALIGNMENT.START:a=r;break;default:a=Math.max(s,Math.min(r,n))}const l=this.getTotalSize();return Math.max(0,Math.min(l-e,a))}getVisibleRange({containerSize:t=0,offset:e,overscanCount:n}){if(0===this.getTotalSize())return{};const i=e+t;let o=this.findNearestItem(e);if(void 0===o)throw Error(`Invalid offset ${e} specified`);const r=this.getSizeAndPositionForIndex(o);e=r.offset+r.size;let s=o;for(;e<i&&s<this.itemCount-1;)s++,e+=this.getSizeAndPositionForIndex(s).size;return n&&(o=Math.max(0,o-n),s=Math.min(s+n,this.itemCount-1)),{start:o,stop:s}}resetItem(t){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,t-1)}findNearestItem(t){if(isNaN(t))throw Error(`Invalid offset ${t} specified`);t=Math.max(0,t);const e=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return e.offset>=t?this.binarySearch({high:n,low:0,offset:t}):this.exponentialSearch({index:n,offset:t})}binarySearch({low:t,high:e,offset:n}){let i=0,o=0;for(;t<=e;){if(i=t+Math.floor((e-t)/2),o=this.getSizeAndPositionForIndex(i).offset,o===n)return i;o<n?t=i+1:o>n&&(e=i-1)}return t>0?t-1:0}exponentialSearch({index:t,offset:e}){let n=1;for(;t<this.itemCount&&this.getSizeAndPositionForIndex(t).offset<e;)t+=n,n*=2;return this.binarySearch({high:Math.min(t,this.itemCount-1),low:Math.floor(t/2),offset:e})}}const get_footer_slot_changes=t=>({}),get_footer_slot_context=t=>({});function get_each_context$5(t,e,n){const i=t.slice();return i[37]=e[n],i}const get_item_slot_changes=t=>({style:4&t[0],index:4&t[0]}),get_item_slot_context=t=>({style:t[37].style,index:t[37].index}),get_header_slot_changes=t=>({}),get_header_slot_context=t=>({});function create_each_block$5(t,e){let n,i;const o=e[21].item,r=create_slot(o,e,e[20],get_item_slot_context);return{key:t,first:null,c(){n=empty(),r&&r.c(),this.first=n},m(t,e){insert(t,n,e),r&&r.m(t,e),i=!0},p(t,n){e=t,r&&r.p&&(!i||1048580&n[0])&&update_slot_base(r,o,e,e[20],i?get_slot_changes(o,e[20],n,get_item_slot_changes):get_all_dirty_from_scope(e[20]),get_item_slot_context)},i(t){i||(transition_in(r,t),i=!0)},o(t){transition_out(r,t),i=!1},d(t){t&&detach(n),r&&r.d(t)}}}function create_fragment$f(t){let e,n,i,o,r,s=[],a=new Map;const l=t[21].header,c=create_slot(l,t,t[20],get_header_slot_context);let h=t[2];const u=t=>t[0]?t[0](t[37].index):t[37].index;for(let e=0;e<h.length;e+=1){let n=get_each_context$5(t,h,e),i=u(n);a.set(i,s[e]=create_each_block$5(i,n))}const d=t[21].footer,p=create_slot(d,t,t[20],get_footer_slot_context);return{c(){e=element("div"),c&&c.c(),n=space(),i=element("div");for(let t=0;t<s.length;t+=1)s[t].c();o=space(),p&&p.c(),attr(i,"class","virtual-list-inner svelte-dwpad5"),attr(i,"style",t[4]),attr(e,"class","virtual-list-wrapper svelte-dwpad5"),attr(e,"style",t[3])},m(a,l){insert(a,e,l),c&&c.m(e,null),append(e,n),append(e,i);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(i,null);append(e,o),p&&p.m(e,null),t[22](e),r=!0},p(t,n){c&&c.p&&(!r||1048576&n[0])&&update_slot_base(c,l,t,t[20],r?get_slot_changes(l,t[20],n,get_header_slot_changes):get_all_dirty_from_scope(t[20]),get_header_slot_context),1048581&n[0]&&(h=t[2],group_outros(),s=update_keyed_each(s,n,u,1,t,h,a,i,outro_and_destroy_block,create_each_block$5,null,get_each_context$5),check_outros()),(!r||16&n[0])&&attr(i,"style",t[4]),p&&p.p&&(!r||1048576&n[0])&&update_slot_base(p,d,t,t[20],r?get_slot_changes(d,t[20],n,get_footer_slot_changes):get_all_dirty_from_scope(t[20]),get_footer_slot_context),(!r||8&n[0])&&attr(e,"style",t[3])},i(t){if(!r){transition_in(c,t);for(let t=0;t<h.length;t+=1)transition_in(s[t]);transition_in(p,t),r=!0}},o(t){transition_out(c,t);for(let t=0;t<s.length;t+=1)transition_out(s[t]);transition_out(p,t),r=!1},d(n){n&&detach(e),c&&c.d(n);for(let t=0;t<s.length;t+=1)s[t].d();p&&p.d(n),t[22](null)}}}const thirdEventArg=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get:()=>(t={passive:!0},!0)});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch(t){}return t})();function instance$f(t,e,n){let{$$slots:i={},$$scope:o}=e,{height:r}=e,{width:s="100%"}=e,{itemCount:a}=e,{itemSize:l}=e,{estimatedItemSize:c=null}=e,{stickyIndices:h=null}=e,{getKey:u=null}=e,{scrollDirection:d=DIRECTION.VERTICAL}=e,{scrollOffset:p=null}=e,{scrollToIndex:_=null}=e,{scrollToAlignment:f=null}=e,{scrollToBehaviour:m="instant"}=e,{overscanCount:g=3}=e;const v=createEventDispatcher(),y=new SizeAndPositionManager({itemCount:a,itemSize:l,estimatedItemSize:I()});let b,k=!1,w=[],x={offset:p||null!=_&&w.length&&O(_)||0,scrollChangeReason:SCROLL_CHANGE_REASON.REQUESTED},L=x,$={scrollToIndex:_,scrollToAlignment:f,scrollOffset:p,itemCount:a,itemSize:l,estimatedItemSize:c},M={},C="",E="";function P(){const{offset:t}=x,{start:e,stop:i}=y.getVisibleRange({containerSize:d===DIRECTION.VERTICAL?r:s,offset:t,overscanCount:g});let o=[];const a=y.getTotalSize();d===DIRECTION.VERTICAL?(n(3,C=`height:${r}px;width:${s};`),n(4,E=`flex-direction:column;height:${a}px;`)):(n(3,C=`height:${r};width:${s}px`),n(4,E=`min-height:100%;width:${a}px;`));const l=null!=h&&0!==h.length;if(l)for(let t=0;t<h.length;t++){const e=h[t];o.push({index:e,style:R(e,!0)})}if(void 0!==e&&void 0!==i){for(let t=e;t<=i;t++)l&&h.includes(t)||o.push({index:t,style:R(t,!1)});v("itemsUpdated",{start:e,end:i})}n(2,w=o)}function T(t){"scroll"in b?b.scroll({[SCROLL_PROP[d]]:t,behavior:m}):n(1,b[SCROLL_PROP_LEGACY[d]]=t,b)}function S(t=0){M={},y.resetItem(t),P()}function O(t,e=f,n=a){return(t<0||t>=n)&&(t=0),y.getUpdatedOffsetForIndex({align:e,containerSize:d===DIRECTION.VERTICAL?r:s,currentOffset:x.offset||0,targetIndex:t})}function D(t){const e=b[SCROLL_PROP_LEGACY[d]];e<0||x.offset===e||t.target!==b||(n(19,x={offset:e,scrollChangeReason:SCROLL_CHANGE_REASON.OBSERVED}),v("afterScroll",{offset:e,event:t}))}function I(){return c||"number"==typeof l&&l||50}function R(t,e){if(M[t])return M[t];const{size:n,offset:i}=y.getSizeAndPositionForIndex(t);let o;return d===DIRECTION.VERTICAL?(o=`left:0;width:100%;height:${n}px;`,o+=e?`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${i}px;margin-bottom:${-(i+n)}px;`:`position:absolute;top:${i}px;`):(o=`top:0;width:${n}px;`,o+=e?`position:sticky;z-index:1;left:0;margin-left:${i}px;margin-right:${-(i+n)}px;`:`position:absolute;height:100%;left:${i}px;`),M[t]=o}return P(),onMount((()=>{n(18,k=!0),b.addEventListener("scroll",D,thirdEventArg),null!=p?T(p):null!=_&&T(O(_))})),onDestroy((()=>{k&&b.removeEventListener("scroll",D)})),t.$$set=t=>{"height"in t&&n(5,r=t.height),"width"in t&&n(6,s=t.width),"itemCount"in t&&n(7,a=t.itemCount),"itemSize"in t&&n(8,l=t.itemSize),"estimatedItemSize"in t&&n(9,c=t.estimatedItemSize),"stickyIndices"in t&&n(10,h=t.stickyIndices),"getKey"in t&&n(0,u=t.getKey),"scrollDirection"in t&&n(11,d=t.scrollDirection),"scrollOffset"in t&&n(12,p=t.scrollOffset),"scrollToIndex"in t&&n(13,_=t.scrollToIndex),"scrollToAlignment"in t&&n(14,f=t.scrollToAlignment),"scrollToBehaviour"in t&&n(15,m=t.scrollToBehaviour),"overscanCount"in t&&n(16,g=t.overscanCount),"$$scope"in t&&n(20,o=t.$$scope)},t.$$.update=()=>{29568&t.$$.dirty[0]&&function(){if(!k)return;const t=$.scrollToIndex!==_||$.scrollToAlignment!==f,e=$.itemCount!==a||$.itemSize!==l||$.estimatedItemSize!==c;e&&(y.updateConfig({itemSize:l,itemCount:a,estimatedItemSize:I()}),S()),$.scrollOffset!==p?n(19,x={offset:p||0,scrollChangeReason:SCROLL_CHANGE_REASON.REQUESTED}):"number"==typeof _&&(t||e)&&n(19,x={offset:O(_,f,a),scrollChangeReason:SCROLL_CHANGE_REASON.REQUESTED}),$={scrollToIndex:_,scrollToAlignment:f,scrollOffset:p,itemCount:a,itemSize:l,estimatedItemSize:c}}(),524288&t.$$.dirty[0]&&function(){if(!k)return;const{offset:t,scrollChangeReason:e}=x;L.offset===t&&L.scrollChangeReason===e||P(),L.offset!==t&&e===SCROLL_CHANGE_REASON.REQUESTED&&T(t),L=x}(),263264&t.$$.dirty[0]&&k&&S(0)},[u,b,w,C,E,r,s,a,l,c,h,d,p,_,f,m,g,S,k,x,o,i,function(t){binding_callbacks[t?"unshift":"push"]((()=>{b=t,n(1,b)}))}]}class VirtualList extends SvelteComponent{constructor(t){super(),init(this,t,instance$f,create_fragment$f,safe_not_equal,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(t){this.$$set({height:t}),flush()}get width(){return this.$$.ctx[6]}set width(t){this.$$set({width:t}),flush()}get itemCount(){return this.$$.ctx[7]}set itemCount(t){this.$$set({itemCount:t}),flush()}get itemSize(){return this.$$.ctx[8]}set itemSize(t){this.$$set({itemSize:t}),flush()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(t){this.$$set({estimatedItemSize:t}),flush()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(t){this.$$set({stickyIndices:t}),flush()}get getKey(){return this.$$.ctx[0]}set getKey(t){this.$$set({getKey:t}),flush()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(t){this.$$set({scrollDirection:t}),flush()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(t){this.$$set({scrollOffset:t}),flush()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(t){this.$$set({scrollToIndex:t}),flush()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(t){this.$$set({scrollToAlignment:t}),flush()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(t){this.$$set({scrollToBehaviour:t}),flush()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(t){this.$$set({overscanCount:t}),flush()}get recomputeSizes(){return this.$$.ctx[17]}}function get_if_ctx$1(t){const e=t.slice(),n=e[1].id;e[10]=n;const i=gamemap.getWorldByID(e[10]).displayName;return e[11]=i,e}function get_each_context$4(t,e,n){const i=t.slice();i[9]=e[n],i[13]=n;const o=i[9].id;i[10]=o;const r=gamemap.getWorldByID(i[10]).displayName;return i[11]=r,i}function create_if_block_2$6(t){let e,n,i,o,r,s,a,l,c=t[0]&&create_if_block_3$6(t);return{c(){e=element("div"),n=element("div"),i=text(t[2]),o=element("i"),o.textContent="expand_more",r=space(),c&&c.c(),attr(o,"class","material-icons svelte-jmp7xr"),attr(n,"class","collapsible-header waves-effect svelte-jmp7xr"),toggle_class(n,"expanded",t[0]),attr(e,"class","collapsible svelte-jmp7xr")},m(h,u){insert(h,e,u),append(e,n),append(n,i),append(n,o),append(e,r),c&&c.m(e,null),s=!0,a||(l=listen(n,"click",t[6]),a=!0)},p(t,o){(!s||4&o)&&set_data(i,t[2]),(!s||1&o)&&toggle_class(n,"expanded",t[0]),t[0]?c?(c.p(t,o),1&o&&transition_in(c,1)):(c=create_if_block_3$6(t),c.c(),transition_in(c,1),c.m(e,null)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros())},i(t){s||(transition_in(c),s=!0)},o(t){transition_out(c),s=!1},d(t){t&&detach(e),c&&c.d(),a=!1,l()}}}function create_if_block$9(t){let e,n,i=t[1],o=[];for(let e=0;e<i.length;e+=1)o[e]=create_each_block$4(get_each_context$4(t,i,e));const r=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=empty()},m(t,i){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,i);insert(t,e,i),n=!0},p(t,n){if(2&n){let s;for(i=t[1],s=0;s<i.length;s+=1){const r=get_each_context$4(t,i,s);o[s]?(o[s].p(r,n),transition_in(o[s],1)):(o[s]=create_each_block$4(r),o[s].c(),transition_in(o[s],1),o[s].m(e.parentNode,e))}for(group_outros(),s=i.length;s<o.length;s+=1)r(s);check_outros()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)transition_in(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);n=!1},d(t){destroy_each(o,t),t&&detach(e)}}}function create_if_block_3$6(t){let e,n,i,o,r,s,a=t[1].id>0&&create_if_block_4$2(get_if_ctx$1(t));return i=new LocationCollapsible({props:{data:t[1].children}}),{c(){e=element("div"),a&&a.c(),n=space(),create_component(i.$$.fragment),attr(e,"class","collapsible-body svelte-jmp7xr")},m(t,o){insert(t,e,o),a&&a.m(e,null),append(e,n),mount_component(i,e,null),s=!0},p(t,o){t[1].id>0?a?(a.p(get_if_ctx$1(t),o),2&o&&transition_in(a,1)):(a=create_if_block_4$2(get_if_ctx$1(t)),a.c(),transition_in(a,1),a.m(e,n)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros());const r={};2&o&&(r.data=t[1].children),i.$set(r)},i(t){s||(transition_in(a),transition_in(i.$$.fragment,t),t&&add_render_callback((()=>{s&&(r&&r.end(1),o=create_in_transition(e,slide,{}),o.start())})),s=!0)},o(t){transition_out(a),transition_out(i.$$.fragment,t),o&&o.invalidate(),t&&(r=create_out_transition(e,slide,{})),s=!1},d(t){t&&detach(e),a&&a.d(),destroy_component(i),t&&r&&r.end()}}}function create_if_block_4$2(t){let e,n;return e=new ListItem({props:{title:t[11],selected:gamemap.getCurrentWorld().displayName==t[11]}}),e.$on("click",(function(){return t[7](t[10])})),e.$on("middleClick",(function(){return t[8](t[10])})),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(n,i){t=n;const o={};2&i&&(o.title=t[11]),2&i&&(o.selected=gamemap.getCurrentWorld().displayName==t[11]),e.$set(o)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_else_block$4(t){let e,n;return e=new ListItem({props:{title:t[11],selected:gamemap.getCurrentWorld().displayName==t[11]}}),e.$on("click",(function(){return t[4](t[10])})),e.$on("middleClick",(function(){return t[5](t[10])})),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(n,i){t=n;const o={};2&i&&(o.title=t[11]),2&i&&(o.selected=gamemap.getCurrentWorld().displayName==t[11]),e.$set(o)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$7(t){let e,n;return e=new LocationCollapsible({props:{data:t[1][t[13]],title:t[11]}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.data=t[1][t[13]]),2&n&&(i.title=t[11]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_each_block$4(t){let e,n,i,o;const r=[create_if_block_1$7,create_else_block$4],s=[];function a(t,e){return t[9].children?0:1}return e=a(t),n=s[e]=r[e](t),{c(){n.c(),i=empty()},m(t,n){s[e].m(t,n),insert(t,i,n),o=!0},p(t,o){let l=e;e=a(t),e===l?s[e].p(t,o):(group_outros(),transition_out(s[l],1,1,(()=>{s[l]=null})),check_outros(),n=s[e],n?n.p(t,o):(n=s[e]=r[e](t),n.c()),transition_in(n,1),n.m(i.parentNode,i))},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){s[e].d(t),t&&detach(i)}}}function create_fragment$e(t){let e,n,i,o;const r=[create_if_block$9,create_if_block_2$6],s=[];function a(t,e){return t[3]?0:t[2]?1:-1}return~(e=a(t))&&(n=s[e]=r[e](t)),{c(){n&&n.c(),i=empty()},m(t,n){~e&&s[e].m(t,n),insert(t,i,n),o=!0},p(t,[o]){let l=e;e=a(t),e===l?~e&&s[e].p(t,o):(n&&(group_outros(),transition_out(s[l],1,1,(()=>{s[l]=null})),check_outros()),~e?(n=s[e],n?n.p(t,o):(n=s[e]=r[e](t),n.c()),transition_in(n,1),n.m(i.parentNode,i)):n=null)},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){~e&&s[e].d(t),t&&detach(i)}}}function instance$e(t,e,n){let{data:i}=e,{expanded:o=!1}=e,{title:r}=e,s=Array.isArray(i);return t.$$set=t=>{"data"in t&&n(1,i=t.data),"expanded"in t&&n(0,o=t.expanded),"title"in t&&n(2,r=t.title)},[o,i,r,s,t=>gamemap.goto(t),t=>window.open(`${location.origin}${location.pathname}?world=${t}`),()=>n(0,o=!o),t=>gamemap.goto(t),t=>window.open(`${location.origin}${location.pathname}?world=${t}`)]}class LocationCollapsible extends SvelteComponent{constructor(t){super(),init(this,t,instance$e,create_fragment$e,safe_not_equal,{data:1,expanded:0,title:2})}get data(){return this.$$.ctx[1]}set data(t){this.$$set({data:t}),flush()}get expanded(){return this.$$.ctx[0]}set expanded(t){this.$$set({expanded:t}),flush()}get title(){return this.$$.ctx[2]}set title(t){this.$$set({title:t}),flush()}}const{window:window_1$3}=globals;function get_context$1(t){const e=gamemap.getWorldFromDisplayName(t[7][t[30]]);t[31]=e}function get_each_context$3(t,e,n){const i=t.slice();i[32]=e[n],i[36]=n;const o=i[32].id;i[33]=o;const r=i[33]<0?-1==i[33]?"Orphaned Maps":"Beta Maps":gamemap.getWorldDisplayNameFromID(i[33]);return i[34]=r,i}function create_if_block$8(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m=t[9]?"ABC":"Worlds",g=t[9]&&create_if_block_3$5(t),v=0==t[2]&&create_if_block_2$5(t),y=1==t[2]&&t[4]&&create_if_block_1$6(t);return{c(){e=element("div"),n=element("ul"),g&&g.c(),i=space(),o=element("li"),r=element("a"),s=text(m),a=space(),l=element("div"),v&&v.c(),c=space(),y&&y.c(),attr(r,"href","#tab_alphabetical"),attr(r,"class","svelte-cyjlpd"),toggle_class(r,"active",1==t[2]),attr(o,"id","abc_tab"),attr(o,"class","tab svelte-cyjlpd"),attr(n,"id","location_list_tab_bar"),attr(n,"class","tabs svelte-cyjlpd"),toggle_class(n,"singleTab",!t[9]),attr(l,"id","location_list_content"),attr(l,"class","svelte-cyjlpd"),add_render_callback((()=>t[22].call(l))),attr(e,"id","location_list"),attr(e,"class","svelte-cyjlpd")},m(u,d){insert(u,e,d),append(e,n),g&&g.m(n,null),append(n,i),append(n,o),append(o,r),append(r,s),t[19](n),append(e,a),append(e,l),v&&v.m(l,null),append(l,c),y&&y.m(l,null),h=add_iframe_resize_listener(l,t[22].bind(l)),t[23](e),p=!0,_||(f=[listen(o,"click",t[18]),listen(e,"contextmenu",contextmenu_handler$1)],_=!0)},p(e,o){(t=e)[9]?g?g.p(t,o):(g=create_if_block_3$5(t),g.c(),g.m(n,i)):g&&(g.d(1),g=null),(!p||512&o[0])&&m!==(m=t[9]?"ABC":"Worlds")&&set_data(s,m),(!p||4&o[0])&&toggle_class(r,"active",1==t[2]),(!p||512&o[0])&&toggle_class(n,"singleTab",!t[9]),0==t[2]?v?(v.p(t,o),4&o[0]&&transition_in(v,1)):(v=create_if_block_2$5(t),v.c(),transition_in(v,1),v.m(l,c)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros()),1==t[2]&&t[4]?y?(y.p(t,o),20&o[0]&&transition_in(y,1)):(y=create_if_block_1$6(t),y.c(),transition_in(y,1),y.m(l,null)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros())},i(n){p||(transition_in(v),transition_in(y),add_render_callback((()=>{p&&(d&&d.end(1),u=create_in_transition(e,fly,t[6]?{x:15,duration:150}:{y:-15,duration:200}),u.start())})),p=!0)},o(n){transition_out(v),transition_out(y),u&&u.invalidate(),d=create_out_transition(e,fly,t[6]?{x:5,duration:150}:{y:-5,duration:150}),p=!1},d(n){n&&detach(e),g&&g.d(),t[19](null),v&&v.d(),y&&y.d(),h(),t[23](null),n&&d&&d.end(),_=!1,run_all(f)}}}function create_if_block_3$5(t){let e,n,i,o;return{c(){e=element("li"),n=element("a"),n.textContent="Grouped",attr(n,"href","#tab_categories"),attr(n,"class","svelte-cyjlpd"),toggle_class(n,"active",0==t[2]),attr(e,"id","group_tab"),attr(e,"class","tab svelte-cyjlpd")},m(r,s){insert(r,e,s),append(e,n),i||(o=listen(e,"click",t[17]),i=!0)},p(t,e){4&e[0]&&toggle_class(n,"active",0==t[2])},d(t){t&&detach(e),i=!1,o()}}}function create_if_block_2$5(t){let e,n,i=t[8],o=[];for(let e=0;e<i.length;e+=1)o[e]=create_each_block$3(get_each_context$3(t,i,e));const r=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){e=element("div");for(let t=0;t<o.length;t+=1)o[t].c();attr(e,"id","tab_categories"),attr(e,"class","tab-pane")},m(t,i){insert(t,e,i);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null);n=!0},p(t,n){if(256&n[0]){let s;for(i=t[8],s=0;s<i.length;s+=1){const r=get_each_context$3(t,i,s);o[s]?(o[s].p(r,n),transition_in(o[s],1)):(o[s]=create_each_block$3(r),o[s].c(),transition_in(o[s],1),o[s].m(e,null))}for(group_outros(),s=i.length;s<o.length;s+=1)r(s);check_outros()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)transition_in(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);n=!1},d(t){t&&detach(e),destroy_each(o,t)}}}function create_each_block$3(t){let e,n;return e=new LocationCollapsible({props:{data:t[32],expanded:0==t[36],title:t[34]}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};256&n[0]&&(i.data=t[32]),256&n[0]&&(i.title=t[34]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$6(t){let e,n,i;return n=new VirtualList({props:{height:t[4],itemCount:t[7].length,itemSize:42,scrollToIndex:t[7].indexOf(gamemap.getCurrentWorld().displayName),scrollToAlignment:"center",$$slots:{item:[create_item_slot$1,({style:t,index:e})=>({29:t,30:e}),({style:t,index:e})=>[(t?536870912:0)|(e?1073741824:0)]]},$$scope:{ctx:t}}}),{c(){e=element("div"),create_component(n.$$.fragment),attr(e,"id","tab_alphabetical"),attr(e,"class","tab-pane")},m(t,o){insert(t,e,o),mount_component(n,e,null),i=!0},p(t,e){const i={};16&e[0]&&(i.height=t[4]),128&e[0]&&(i.itemCount=t[7].length),128&e[0]&&(i.scrollToIndex=t[7].indexOf(gamemap.getCurrentWorld().displayName)),1610612864&e[0]|64&e[1]&&(i.$$scope={dirty:e,ctx:t}),n.$set(i)},i(t){i||(transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(n.$$.fragment,t),i=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_item_slot$1(t){let e,n,i,o;return get_context$1(t),n=new ListItem({props:{title:t[31].displayName,destinationID:t[31].id,selected:gamemap.getCurrentWorld().displayName==t[7][t[30]]}}),n.$on("click",t[20]),n.$on("middleClick",t[21]),{c(){e=element("div"),create_component(n.$$.fragment),attr(e,"slot","item"),attr(e,"style",i=t[29])},m(t,i){insert(t,e,i),mount_component(n,e,null),o=!0},p(t,r){get_context$1(t);const s={};1073741952&r[0]&&(s.title=t[31].displayName),1073741952&r[0]&&(s.destinationID=t[31].id),1073741952&r[0]&&(s.selected=gamemap.getCurrentWorld().displayName==t[7][t[30]]),n.$set(s),(!o||536870912&r[0]&&i!==(i=t[29]))&&attr(e,"style",i)},i(t){o||(transition_in(n.$$.fragment,t),o=!0)},o(t){transition_out(n.$$.fragment,t),o=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_fragment$d(t){let e,n,i,o,r=t[0]&&create_if_block$8(t);return{c(){r&&r.c(),e=empty()},m(s,a){r&&r.m(s,a),insert(s,e,a),n=!0,i||(o=[listen(window_1$3,"mousedown",t[16]),listen(window_1$3,"resize",t[10]),listen(window_1$3,"keydown",t[13])],i=!0)},p(t,n){t[0]?r?(r.p(t,n),1&n[0]&&transition_in(r,1)):(r=create_if_block$8(t),r.c(),transition_in(r,1),r.m(e.parentNode,e)):r&&(group_outros(),transition_out(r,1,1,(()=>{r=null})),check_outros())},i(t){n||(transition_in(r),n=!0)},o(t){transition_out(r),n=!1},d(t){r&&r.d(t),t&&detach(e),i=!1,run_all(o)}}}const contextmenu_handler$1=t=>t.stopPropagation();function instance$d(t,e,n){let i,o,{isShown:r=!1}=e,s=0,a=null,l=null,c=isMobile()||window.innerWidth<=670,h=gamemap.getWorlds(),u=[],d=[],p=[],_=!0;const f=createEventDispatcher();function m(t){n(0,r=t),f("toggled",r),r&&setTimeout((()=>{b(s),M.Tabs.init(o,{}),gamemap.hasMultipleWorlds()&&v()}))}function g(t,e,n,i){for(var o in e)if(e.hasOwnProperty(o))if("object"==typeof e[o])g(t,e[o],n+"."+o,i);else if(null!=t[e[o]])g(t,t[e[o]],n+"."+e[o],i);else{let t=(n+"."+e[o]).split(".");if(t.shift(),t[0]==i)for(let e=0;e<t.length;e++){let n;n=0==e?{id:t[e],parentID:null}:{id:t[e],parentID:t[e-1]},p.push(n)}}}function v(){if(l=document.querySelector("#dropdown_icon")?.parentElement,n(6,c=isMobile()||window.innerWidth<=670),!c&&a&&l){let t=l.getBoundingClientRect().left+l.clientWidth/2;n(3,a.style.left=t+"px",a),n(3,a.style.top=a.offsetHeight/2+l.offsetHeight+16+"px",a)}}function y(t){let e=null!=t.relatedTarget?t.relatedTarget:null!=t.explicitOriginalTarget?t.explicitOriginalTarget:document.elementsFromPoint(t.clientX,t.clientY)[0];!(a!==e&&a?.contains(e))&&!l?.contains(e)&&k()}function b(t){n(2,s=_?t:1)}function k(){m(!1)}window.getWorldLists=function(){let t={};let e=gamemap.getMapConfig().rootWorldID||gamemap.getMapConfig().defaultWorldID,i=[e,-1];if("eso"==gamemap.getMapConfig().database&&i.push(-1337),n(7,u=[]),n(8,d=[]),p=[],h.forEach((t=>{"_"!=t.displayName&&t.id>0&&u.push(t.displayName)})),n(7,u=u.sort((function(t,e){return t=t.replace("The ",""),e=e.replace("The ",""),t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))),n(9,_=u.length>5),_){for(let n=0;n<u.length;n++){let i=u[n],o=gamemap.getWorldFromDisplayName(i);if(null!=o&&0!=o.id&&!i.endsWith("(Test)")){let n=o.id,r=o.parentID;r<=0&&(r=0,n!=e&&(r=-1)),(i.endsWith("(Dev)")||i.endsWith("(Beta)"))&&(r=-1337),null!=t[r]?t[r].push(n):t[r]=[n]}}for(let e in i){p=[],g(t,t,"",i[e]),p=getUniqueListFrom(p,"id");const n=p.reduce(((t,e,n)=>(t[e.id]=n,t)),{});let o=t;p.forEach((t=>{if(null===t.parentID)return void(o=t);const e=p[n[t.parentID]];e.children=[...e.children||[],t]})),d.push(o)}}b(s)},onMount((()=>{getWorldLists()}));return t.$$set=t=>{"isShown"in t&&n(0,r=t.isShown)},[r,k,s,a,i,o,c,u,d,_,v,y,b,function(t){"Escape"!=t.key&&27!=t.keyCode||k()},m,function(){m(!r)},t=>y(t),()=>b(0),()=>b(1),function(t){binding_callbacks[t?"unshift":"push"]((()=>{o=t,n(5,o)}))},t=>{gamemap.goto(t.detail),k()},t=>window.open(`${location.origin}${location.pathname}?world=${t.detail}`),function(){i=this.clientHeight,n(4,i)},function(t){binding_callbacks[t?"unshift":"push"]((()=>{a=t,n(3,a)}))}]}class LocationList extends SvelteComponent{constructor(t){super(),init(this,t,instance$d,create_fragment$d,safe_not_equal,{isShown:0,show:14,toggle:15,dismiss:1},null,[-1,-1])}get isShown(){return this.$$.ctx[0]}set isShown(t){this.$$set({isShown:t}),flush()}get show(){return this.$$.ctx[14]}get toggle(){return this.$$.ctx[15]}get dismiss(){return this.$$.ctx[1]}}const{window:window_1$2}=globals,get_secondary_slot_changes=t=>({}),get_secondary_slot_context=t=>({}),get_primary_slot_changes=t=>({}),get_primary_slot_context=t=>({});function create_fragment$c(t){let e,n,i,o,r,s,a,l,c,h;const u=t[4].primary,d=create_slot(u,t,t[3],get_primary_slot_context),p=t[4].secondary,_=create_slot(p,t,t[3],get_secondary_slot_context);return{c(){e=element("div"),d&&d.c(),o=space(),r=element("div"),_&&_.c(),attr(e,"class","icon_bar_primary svelte-14ji8br"),attr(r,"class","icon_bar_secondary svelte-14ji8br")},m(n,i){insert(n,e,i),d&&d.m(e,null),t[5](e),insert(n,o,i),insert(n,r,i),_&&_.m(r,null),t[6](r),l=!0,c||(h=[listen(window_1$2,"resize",t[2]),listen(e,"contextmenu",contextmenu_handler),listen(r,"contextmenu",contextmenu_handler_1)],c=!0)},p(t,[e]){d&&d.p&&(!l||8&e)&&update_slot_base(d,u,t,t[3],l?get_slot_changes(u,t[3],e,get_primary_slot_changes):get_all_dirty_from_scope(t[3]),get_primary_slot_context),_&&_.p&&(!l||8&e)&&update_slot_base(_,p,t,t[3],l?get_slot_changes(p,t[3],e,get_secondary_slot_changes):get_all_dirty_from_scope(t[3]),get_secondary_slot_context)},i(t){l||(transition_in(d,t),add_render_callback((()=>{l&&(i&&i.end(1),n=create_in_transition(e,fly,{x:5,duration:250}),n.start())})),transition_in(_,t),add_render_callback((()=>{l&&(a&&a.end(1),s=create_in_transition(r,fly,{x:5,duration:250}),s.start())})),l=!0)},o(t){transition_out(d,t),n&&n.invalidate(),i=create_out_transition(e,fade,{duration:75}),transition_out(_,t),s&&s.invalidate(),a=create_out_transition(r,fade,{duration:75}),l=!1},d(n){n&&detach(e),d&&d.d(n),t[5](null),n&&i&&i.end(),n&&detach(o),n&&detach(r),_&&_.d(n),t[6](null),n&&a&&a.end(),c=!1,run_all(h)}}}const contextmenu_handler=t=>t.stopPropagation(),contextmenu_handler_1=t=>t.stopPropagation();function instance$c(t,e,n){let i,{$$slots:o={},$$scope:r}=e,s=null,a=null,l=null;function c(){i=window.innerWidth<=670,l=document.querySelector("#search_pane").clientWidth+4;let t=window.innerWidth;if(i?(a.style.removeProperty("left"),n(1,a.style.right="8px",a),n(1,a.style.top=s.clientHeight+8+"px",a)):(n(1,a.style.left=l+"px",a),a.style.removeProperty("right"),n(1,a.style.top="8px",a)),!i){let e=t-(l+(t-s.getBoundingClientRect().left)+19);n(1,a.style.width=e+"px",a)}}return onMount((async()=>{c()})),t.$$set=t=>{"$$scope"in t&&n(3,r=t.$$scope)},i=!1,[s,a,c,r,o,function(t){binding_callbacks[t?"unshift":"push"]((()=>{s=t,n(0,s)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{a=t,n(1,a)}))}]}class IconBar extends SvelteComponent{constructor(t){super(),init(this,t,instance$c,create_fragment$c,safe_not_equal,{})}}function create_if_block_1$5(t){let e,n,i,o;const r=[create_if_block_2$4,create_if_block_3$4],s=[];function a(t,e){return"loading"!=t[1]?0:"loading"==t[1]?1:-1}return~(e=a(t))&&(n=s[e]=r[e](t)),{c(){n&&n.c(),i=empty()},m(t,n){~e&&s[e].m(t,n),insert(t,i,n),o=!0},p(t,o){let l=e;e=a(t),e===l?~e&&s[e].p(t,o):(n&&(group_outros(),transition_out(s[l],1,1,(()=>{s[l]=null})),check_outros()),~e?(n=s[e],n?n.p(t,o):(n=s[e]=r[e](t),n.c()),transition_in(n,1),n.m(i.parentNode,i)):n=null)},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){~e&&s[e].d(t),t&&detach(i)}}}function create_if_block_3$4(t){let e,n,i;return n=new LoadingSpinner({props:{size:"36px"}}),{c(){e=element("div"),create_component(n.$$.fragment),attr(e,"class","spinner svelte-1kncten")},m(t,o){insert(t,e,o),mount_component(n,e,null),i=!0},p:noop,i(t){i||(transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(n.$$.fragment,t),i=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_if_block_2$4(t){let e,n,i;return{c(){e=element("i"),n=text(t[1]),attr(e,"class",i="material-icons "+t[2]+" svelte-1kncten")},m(t,i){insert(t,e,i),append(e,n)},p(t,o){2&o&&set_data(n,t[1]),4&o&&i!==(i="material-icons "+t[2]+" svelte-1kncten")&&attr(e,"class",i)},i:noop,o:noop,d(t){t&&detach(e)}}}function create_else_block$3(t){let e;const n=t[12].default,i=create_slot(n,t,t[11],null);return{c(){i&&i.c()},m(t,n){i&&i.m(t,n),e=!0},p(t,o){i&&i.p&&(!e||2048&o)&&update_slot_base(i,n,t,t[11],e?get_slot_changes(n,t[11],o,null):get_all_dirty_from_scope(t[11]),null)},i(t){e||(transition_in(i,t),e=!0)},o(t){transition_out(i,t),e=!1},d(t){i&&i.d(t)}}}function create_if_block$7(t){let e,n;return{c(){e=element("p"),n=text(t[3]),attr(e,"class","svelte-1kncten")},m(t,i){insert(t,e,i),append(e,n)},p(t,e){8&e&&set_data(n,t[3])},i:noop,o:noop,d(t){t&&detach(e)}}}function create_fragment$b(t){let e,n,i,o,r,s,a,l,c=t[1]&&create_if_block_1$5(t);const h=[create_if_block$7,create_else_block$3],u=[];function d(t,e){return t[3]?0:1}return i=d(t),o=u[i]=h[i](t),{c(){e=element("a"),c&&c.c(),n=space(),o.c(),attr(e,"class",r="waves-effect waves-"+t[9]+" button btn"+(t[4]?"-flat":"")+(t[5]?"-"+{size:t[5]}:"")+" svelte-1kncten"),attr(e,"title",t[8]),toggle_class(e,"disabled",t[0]),toggle_class(e,"error",t[6]&&"warning"==t[1]),toggle_class(e,"light","light"==t[4]),toggle_class(e,"loadingButton","loading"==t[1]),toggle_class(e,"deleteButton","delete"==t[6]),toggle_class(e,"saveButton","save"==t[6]),toggle_class(e,"revertButton","revert"==t[6]),toggle_class(e,"bold",t[7])},m(o,r){insert(o,e,r),c&&c.m(e,null),append(e,n),u[i].m(e,null),s=!0,a||(l=listen(e,"click",t[10]),a=!0)},p(t,[a]){t[1]?c?(c.p(t,a),2&a&&transition_in(c,1)):(c=create_if_block_1$5(t),c.c(),transition_in(c,1),c.m(e,n)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros());let l=i;i=d(t),i===l?u[i].p(t,a):(group_outros(),transition_out(u[l],1,1,(()=>{u[l]=null})),check_outros(),o=u[i],o?o.p(t,a):(o=u[i]=h[i](t),o.c()),transition_in(o,1),o.m(e,null)),(!s||560&a&&r!==(r="waves-effect waves-"+t[9]+" button btn"+(t[4]?"-flat":"")+(t[5]?"-"+{size:t[5]}:"")+" svelte-1kncten"))&&attr(e,"class",r),(!s||256&a)&&attr(e,"title",t[8]),(!s||561&a)&&toggle_class(e,"disabled",t[0]),(!s||626&a)&&toggle_class(e,"error",t[6]&&"warning"==t[1]),(!s||560&a)&&toggle_class(e,"light","light"==t[4]),(!s||562&a)&&toggle_class(e,"loadingButton","loading"==t[1]),(!s||624&a)&&toggle_class(e,"deleteButton","delete"==t[6]),(!s||624&a)&&toggle_class(e,"saveButton","save"==t[6]),(!s||624&a)&&toggle_class(e,"revertButton","revert"==t[6]),(!s||688&a)&&toggle_class(e,"bold",t[7])},i(t){s||(transition_in(c),transition_in(o),s=!0)},o(t){transition_out(c),transition_out(o),s=!1},d(t){t&&detach(e),c&&c.d(),u[i].d(),a=!1,l()}}}function instance$b(t,e,n){let{$$slots:i={},$$scope:o}=e,{icon:r}=e,{iconDirection:s="left"}=e,{text:a}=e,{flat:l}=e,{size:c}=e,{disabled:h}=e,{type:u}=e,{bold:d}=e,{tooltip:p}=e,{ripple:_="light"}=e;h="loading"==r||h;const f=createEventDispatcher();return t.$$set=t=>{"icon"in t&&n(1,r=t.icon),"iconDirection"in t&&n(2,s=t.iconDirection),"text"in t&&n(3,a=t.text),"flat"in t&&n(4,l=t.flat),"size"in t&&n(5,c=t.size),"disabled"in t&&n(0,h=t.disabled),"type"in t&&n(6,u=t.type),"bold"in t&&n(7,d=t.bold),"tooltip"in t&&n(8,p=t.tooltip),"ripple"in t&&n(9,_=t.ripple),"$$scope"in t&&n(11,o=t.$$scope)},[h,r,s,a,l,c,u,d,p,_,function(t){t.shiftKey?f("shiftClick","shift clicked"):f("click","clicked")},o,i]}class Button extends SvelteComponent{constructor(t){super(),init(this,t,instance$b,create_fragment$b,safe_not_equal,{icon:1,iconDirection:2,text:3,flat:4,size:5,disabled:0,type:6,bold:7,tooltip:8,ripple:9})}get icon(){return this.$$.ctx[1]}set icon(t){this.$$set({icon:t}),flush()}get iconDirection(){return this.$$.ctx[2]}set iconDirection(t){this.$$set({iconDirection:t}),flush()}get text(){return this.$$.ctx[3]}set text(t){this.$$set({text:t}),flush()}get flat(){return this.$$.ctx[4]}set flat(t){this.$$set({flat:t}),flush()}get size(){return this.$$.ctx[5]}set size(t){this.$$set({size:t}),flush()}get disabled(){return this.$$.ctx[0]}set disabled(t){this.$$set({disabled:t}),flush()}get type(){return this.$$.ctx[6]}set type(t){this.$$set({type:t}),flush()}get bold(){return this.$$.ctx[7]}set bold(t){this.$$set({bold:t}),flush()}get tooltip(){return this.$$.ctx[8]}set tooltip(t){this.$$set({tooltip:t}),flush()}get ripple(){return this.$$.ctx[9]}set ripple(t){this.$$set({ripple:t}),flush()}}function create_if_block$6(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_;const f=t[12].default,m=create_slot(f,t,t[16],null),g=m||fallback_block();l=new Button({props:{flat:!0,ripple:"dark",$$slots:{default:[create_default_slot_1$2]},$$scope:{ctx:t}}}),l.$on("click",t[13]);let v=t[4]&&create_if_block_1$4(t);return{c(){e=element("dialog"),n=element("div"),i=element("h4"),o=text(t[1]),r=space(),g&&g.c(),s=space(),a=element("div"),create_component(l.$$.fragment),c=space(),v&&v.c(),attr(n,"class","modal-content"),attr(a,"class","modal-footer svelte-iat1fa"),attr(e,"class","modal svelte-iat1fa"),toggle_class(e,"modal-fixed-footer",t[2])},m(h,u){insert(h,e,u),append(e,n),append(n,i),append(i,o),append(n,r),g&&g.m(n,null),append(e,s),append(e,a),mount_component(l,a,null),append(a,c),v&&v.m(a,null),t[15](e),d=!0,p||(_=listen(e,"keyup",t[8]),p=!0)},p(t,n){(!d||2&n)&&set_data(o,t[1]),m&&m.p&&(!d||65536&n)&&update_slot_base(m,f,t,t[16],d?get_slot_changes(f,t[16],n,null):get_all_dirty_from_scope(t[16]),null);const i={};65544&n&&(i.$$scope={dirty:n,ctx:t}),l.$set(i),t[4]?v?(v.p(t,n),16&n&&transition_in(v,1)):(v=create_if_block_1$4(t),v.c(),transition_in(v,1),v.m(a,null)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros()),(!d||4&n)&&toggle_class(e,"modal-fixed-footer",t[2])},i(t){d||(transition_in(g,t),transition_in(l.$$.fragment,t),transition_in(v),add_render_callback((()=>{d&&(u&&u.end(1),h=create_in_transition(e,scale,{}),h.start())})),d=!0)},o(t){transition_out(g,t),transition_out(l.$$.fragment,t),transition_out(v),h&&h.invalidate(),u=create_out_transition(e,scale,{duration:250,opacity:0}),d=!1},d(n){n&&detach(e),g&&g.d(n),destroy_component(l),v&&v.d(),t[15](null),n&&u&&u.end(),p=!1,_()}}}function fallback_block(t){let e;return{c(){e=element("p"),e.textContent="Loading..."},m(t,n){insert(t,e,n)},p:noop,d(t){t&&detach(e)}}}function create_default_slot_1$2(t){let e,n=t[3]?.toSentenceCase()+"";return{c(){e=text(n)},m(t,n){insert(t,e,n)},p(t,i){8&i&&n!==(n=t[3]?.toSentenceCase()+"")&&set_data(e,n)},d(t){t&&detach(e)}}}function create_if_block_1$4(t){let e,n;return e=new Button({props:{$$slots:{default:[create_default_slot$3]},$$scope:{ctx:t}}}),e.$on("click",t[14]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};65536&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_default_slot$3(t){let e;return{c(){e=text("Confirm")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_fragment$a(t){let e,n,i=t[0]&&create_if_block$6(t);return{c(){i&&i.c(),e=empty()},m(t,o){i&&i.m(t,o),insert(t,e,o),n=!0},p(t,[n]){t[0]?i?(i.p(t,n),1&n&&transition_in(i,1)):(i=create_if_block$6(t),i.c(),transition_in(i,1),i.m(e.parentNode,e)):i&&(group_outros(),transition_out(i,1,1,(()=>{i=null})),check_outros())},i(t){n||(transition_in(i),n=!0)},o(t){transition_out(i),n=!1},d(t){i&&i.d(t),t&&detach(e)}}}function instance$a(t,e,n){let i,o,{$$slots:r={},$$scope:s}=e,{title:a="Dialog title"}=e,{fixedFooter:l=!1}=e,{cancel:c="Cancel"}=e,{confirm:h}=e,{dismissible:u=!0}=e,{isShown:d=!1}=e;const p=createEventDispatcher();function _(t){n(0,d=!0),o=t,setTimeout((()=>{i?.showModal(),u&&i.addEventListener("click",(({target:t})=>{"DIALOG"===t.nodeName&&f()}))}),1)}function f(){n(0,d=!1),p("dismiss"),print("going away"),o&&o("dismiss")}function m(){n(0,d=!1),o&&o("confirm"),p("confirm")}return t.$$set=t=>{"title"in t&&n(1,a=t.title),"fixedFooter"in t&&n(2,l=t.fixedFooter),"cancel"in t&&n(3,c=t.cancel),"confirm"in t&&n(4,h=t.confirm),"dismissible"in t&&n(9,u=t.dismissible),"isShown"in t&&n(0,d=t.isShown),"$$scope"in t&&n(16,s=t.$$scope)},[d,a,l,c,h,f,i,m,function(t){"Escape"==t.key&&f()},u,_,function(t){_(t)},r,()=>f(),()=>m(),function(t){binding_callbacks[t?"unshift":"push"]((()=>{i=t,n(6,i)}))},s]}class Dialog extends SvelteComponent{constructor(t){super(),init(this,t,instance$a,create_fragment$a,safe_not_equal,{title:1,fixedFooter:2,cancel:3,confirm:4,dismissible:9,isShown:0,show:10,showWithCallback:11,dismiss:5})}get title(){return this.$$.ctx[1]}set title(t){this.$$set({title:t}),flush()}get fixedFooter(){return this.$$.ctx[2]}set fixedFooter(t){this.$$set({fixedFooter:t}),flush()}get cancel(){return this.$$.ctx[3]}set cancel(t){this.$$set({cancel:t}),flush()}get confirm(){return this.$$.ctx[4]}set confirm(t){this.$$set({confirm:t}),flush()}get dismissible(){return this.$$.ctx[9]}set dismissible(t){this.$$set({dismissible:t}),flush()}get isShown(){return this.$$.ctx[0]}set isShown(t){this.$$set({isShown:t}),flush()}get show(){return this.$$.ctx[10]}get showWithCallback(){return this.$$.ctx[11]}get dismiss(){return this.$$.ctx[5]}}class World{constructor(t){this.displayName=t?.displayName??"",this.name=t?.name?.toLowerCase()??"",this.description=t?.description??"",this.locations=null,this.id=t?.id??0,this.parentID=-1==t?.parentId?null:t?.parentId??null,this.revisionID=t?.revisionId??0,this.revertID=t?.revertId??null,this.wikiPage=t?.wikiPage&&""!=t.wikiPage?t.wikiPage:this.displayName,this.cellSize=t?.cellSize??-1,this.zoomOffset=MAPCONFIG.zoomOffset??t?.zoomOffset,this.defaultZoom=t?.defaultZoom-this.zoomOffset,this.maxZoomLevel=t?.maxZoom-this.zoomOffset,this.minZoomLevel=t?.minZoom-this.zoomOffset??0,this.minX=MAPCONFIG.minX??t.posLeft,this.maxX=MAPCONFIG.maxX??t.posRight,this.minY=MAPCONFIG.minY??t.posBottom,this.maxY=MAPCONFIG.maxY??t.posTop,this.maxRangeX=Math.abs(this.maxX-this.minX),this.maxRangeY=Math.abs(this.maxY-this.minY),this.numTilesX=Math.pow(2,this.maxZoomLevel),this.numTilesY=Math.pow(2,this.maxZoomLevel),this.dbNumTilesX=0!=t?.maxTilesX?t?.maxTilesX:this.numTilesX,this.dbNumTilesY=0!=t?.maxTilesY?t?.maxTilesY:this.numTilesY,this.width=(MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.dbNumTilesX:this.numTilesX*MAPCONFIG.tileSize)*Math.pow(2,0),this.height=(MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.dbNumTilesY:this.numTilesY*MAPCONFIG.tileSize)*Math.pow(2,0),this.legacy=t,this.displayData=t?.displayData?JSON.parse(t.displayData):null,this.layers=this.displayData?.layers??MAPCONFIG.layers,this.gridStart=this.displayData?.gridStart,this.editing=!1}hasGrid(){return this.displayData?.hasGrid&&this.displayData?.gridStart}hasCellResources(){return this.hasGrid()&&this.displayData?.hasCellResource}hasMultipleLayers(){return this.layers.length>1}hasLayerMenu(){return this.hasMultipleLayers()||this.hasGrid()}getWorldDimensions(){return{width:this.width,height:this.height,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY}}getSaveQuery(){var t="action=set_world";return t+="&worldid="+this.id,t+="&db="+MAPCONFIG.database,t+="&parentid="+encodeURI(this.parentID),t+="&revisionid="+this.revisionID,t+="&name="+encodeURI(this.name),t+="&displayname="+encodeURI(this.displayName),t+="&description="+encodeURI(this.description),t+="&wikipage="+encodeURI(this.linkWikiPage()?this.displayName:this.wikiPage),t+="&minzoom="+(+this.minZoomLevel+ +this.zoomOffset),t+="&maxzoom="+(+this.maxZoomLevel+ +this.zoomOffset),t+="&posleft="+this.minX,t+="&posright="+this.maxX,t+="&postop="+this.maxY,t+="&posbottom="+this.minY,t+="&zoomoffset="+this.zoomOffset}getDeleteQuery(){var t="action=enable_world";return t+="&worldid="+this.id,t+="&db="+MAPCONFIG.database,t+="&enabled=0"}getRevertQuery(){return encodeURI(`action=revert_world&db=${MAPCONFIG.db}&worldid=${this.id}&revertid=${this.revertID??this.revisionID}`)}setEditing(t){this.editing=t,gamemap.getElement().classList.add("editing")}linkWikiPage(){return this.wikiPage?.toLowerCase()==this.displayName?.toLowerCase()||null==this.wikiPage}getLocation(t){if(!isNaN(t)||t.id){let e=Math.abs(t?.id??t);if(this.locations?.has(e))return this.locations.get(e)}else{if(!("string"==typeof t||t instanceof String))return null;this.locations?.forEach((e=>{if(e.name.toLowerCase()==t)return e}))}}hasLocation(t){return null!=this.getLocation(t)}getWikiLink(){return`${MAPCONFIG.wikiURL}${MAPCONFIG.wikiNamespace}:${encodeURIComponent(this.wikiPage)}`}}class Location{constructor(t,e){this.locType=t?.locType??LOCTYPES.MARKER,this.id=t.id??-100,this.unsavedLocation=this.id<0,this.name=this.unsavedLocation?this.locType==LOCTYPES.MARKER?"New Marker":this.locType==LOCTYPES.AREA?"New Area":"New Path":t.name,this.revisionID=t.revisionId||0,this.worldID=e?.id??t?.worldId??gamemap.getCurrentWorld().id,this.destinationID=-t?.destinationId||null,this.editing=this.unsavedLocation??!1,this.revertID=t?.revertId,this.wasVisible=this.editing??null!=this.revertID??null,this.legacy=t,this.wikiPage=t?.wikiPage||this.name,this.description=t?.description||null,this.displayData=t?.displayData?JSON.parse(t.displayData):{},this.displayLevel=this.unsavedLocation?Number(Math.floor(gamemap.getCurrentZoom())):parseFloat(t.displayLevel-gamemap.getWorldFromID(this.worldID).zoomOffset||0),this.bounds=null,this.icon=this.unsavedLocation&&this.locType==LOCTYPES.MARKER?Math.min(...Array.from(MAPCONFIG.icons.keys())):t.iconType||null,this.width=this.icon?t.width||MAPCONFIG.iconSize:t.width,this.height=this.icon?t.height||MAPCONFIG.iconSize:t.height,this.coords=(()=>{let e=[],n=this.displayData?.points;if(n?.length>0){let[t,i]=[[],[]];for(let e=0;e<n.length;e++)e%2==0||0==e?t.push(n[e]):i.push(n[e]);for(let n=0;n<i.length;n++){let o=[t[n],i[n]];e.push(this.makePoint(o))}}else e.push(this.makePoint([t.x,t.y]));return t?.coords??e})(),this.labelPos=(()=>{if(this.unsavedLocation){if(this.locType==LOCTYPES.MARKER)return 6;if(this.locType==LOCTYPES.AREA)return 5;if(this.locType==LOCTYPES.LINE)return 0}else switch(this?.displayData?.labelPos){case 0:return 0;case 1:case 4:case 7:return 4;case 2:return 2;case 3:case 6:case 9:return 6;case 5:return 5;case 8:return 8;default:return 10}})(),this.isPolygon()&&(this.displayData?.lineWidth||(this.displayData.lineWidth=0),this.displayData?.hover||(this.displayData.hover=structuredClone(this.displayData)),this.fillColour=this.displayData?.fillStyle??MAPCONFIG.defaultFillColour,this.fillColourHover=this.displayData?.hover.fillStyle??MAPCONFIG.defaultFillColourHover,this.strokeColour=this.displayData?.strokeStyle??MAPCONFIG.defaultStrokeColour,this.strokeColourHover=this.displayData?.hover.strokeStyle??MAPCONFIG.defaultStrokeColourHover,this.strokeWidth=this.unsavedLocation?MAPCONFIG.defaultStrokeWidth:this.displayData?.lineWidth,this.strokeWidthHover=this.unsavedLocation?MAPCONFIG.defaultStrokeWidthHover:this.displayData?.hover?.lineWidth)}getCentre(t){return(t=t??this.coords).length>1?polygonCenter(t):t[0]}makePoint(t){let e=t[0],n=t[1];if(MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED){let t=gamemap.getWorldFromID(this.worldID);e=(e-t.minX)/t.maxRangeX,n=Math.abs((n-t.maxY)/t.maxRangeY),e=(e*nextPowerOfTwo(t.dbNumTilesX)/t.dbNumTilesX).toFixed(3),n=(n*nextPowerOfTwo(t.dbNumTilesY)/t.dbNumTilesY).toFixed(3)}return new Point(e,n,MAPCONFIG.coordType)}getTooltipContent(){return`<span>${this.name} ${this.isClickable()?"<i class='tiny material-icons'>open_in_browser</i>":""}</span>\n\t\t\t\t<div class='tooltip-desc'>\n\t\t\t\t\t${this.description?this.name!=this.wikiPage&&this.wikiPage?this.description+"</br>"+this.wikiPage:this.description:""}\n\t\t\t\t</div>\n\t\t\t\t${this.isClickable()?"<small class='tooltip-tip'>Click to enter</small>":""}\n\t\t\t\t${this.editing&&!this.isPolygon()&&gamemap.getMapLock()!=MAPLOCK.PARTIAL?"<small class='tooltip-tip'>Click to drag</small>":""}`}getPopupContent(){let t=`<div class='popupTitle'><a ${this.createWikiLink()} target='_top'> ${this.name} </a></div>\n\t\t\t\t\t\t\t<div class='popupDesc'>${this.description?this.description:""}</div><hr/>\n\t\t\t\t\t\t\t<div class='popupInfo'><b>Location ID:</b> ${this.id}</div>`;if(1==this.coords.length&&(t+=`<div class='popupInfo'><b>Coords: </b> X: ${this.coords[0].x}, Y: ${this.coords[0].y} </div>`),null!=this.destinationID&&(t+=`<div class='popupInfo'><b>Destination ID:</b> ${this.destinationID} ${this.destinationID<0?" (Location)":" (World)"} </div>`),MAPCONFIG.editingEnabled){t+=`<hr/> <a style='${"text-align: center; height: unset; margin-bottom: -8px; width: inherit; line-height: 26px;"}' class='btn-flat waves-effect' onclick=" gamemap.getLocation(${this.id}).then(location => gamemap.edit(location));">Edit</a>`}return t}openPopup(){let t=gamemap.findMarkers(this)[0];t?t.openPopup():gamemap.getMap().openPopup(this.getPopupContent(),gamemap.getLatLngs(this.getCentre()))}isPolygon(){return this.locType==LOCTYPES.AREA||this.locType==LOCTYPES.PATH}hasIcon(){return null!=this.icon&&this.locType!=LOCTYPES.PATH}hasLabel(){return this.labelPos&&this.labelPos>=1&&""!=this.name&&this.locType!=LOCTYPES.PATH}isLabel(){return!this.hasIcon()&&!this.isPolygon()&&this.hasLabel()}getLabel(){let t=[0,0];const[e,n]=[MAPCONFIG.labelOffset,MAPCONFIG.labelOffset/2];switch(LABEL_POSITIONS[this.labelPos]){case"top":t=[0,-n];break;case"bottom":t=[0,n];break;case"left":t=[-e,0];break;case"right":t=[e,0];break;case"auto":t=[n,0]}return{className:"location-label",permanent:!0,direction:LABEL_POSITIONS[this.labelPos],interactive:!0,offset:t,riseOnHover:!0}}isClickable(){return this.destinationID&&0!=this.destinationID&&!gamemap.mapLock&&this.locType!=LOCTYPES.PATH}createWikiLink(){let t="";return null!=MAPCONFIG.wikiNamespace&&MAPCONFIG.wikiNamespace.length>0?this.wikiPage&&(t=this.wikiPage.indexOf(":")>=0?MAPCONFIG.wikiURL+encodeURIComponent(this.wikiPage).replace("%3A",":").replace("%2F","/"):MAPCONFIG.wikiURL+MAPCONFIG.wikiNamespace+":"+encodeURIComponent(this.wikiPage)):t=MAPCONFIG.wikiURL+encodeURIComponent(this.wikiPage),""!=t&&(t=`href="${t}"`),t}setEditing(t){this.editing=t}getWasVisible(){return this.wasVisible}setWasVisible(t){this.wasVisible=t}isVisible(t){if(this.editing)return!0;if((gamemap.getZoom()+.5>=gamemap.getMaxZoom()?gamemap.getMaxZoom():gamemap.getZoom())+.001<this.displayLevel)return!1;t=t??gamemap.getViewBounds();let[e,n]=[!1,[this.getCentre()].concat(structuredClone(this.coords))];return n.every((n=>!(Number(n.x)>=Number(t.minX)&&Number(n.x)<=Number(t.maxX)&&Number(n.y)>=Number(t.minY)&&Number(n.y)<=Number(t.maxY))||(e=!0,!1))),e}getSaveQuery(){var t="action=set_loc";let e=MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.convPseudoNormalisedCoords(this.coords):this.coords;return t+=`&name=${encodeURI(this.name)}`,t+=`&description=${encodeURI(this.description)}`,t+=`&wikipage=${encodeURI(this.linkWikiPage()?this.name:this.wikiPage)}`,t+=`&loctype=${this.locType}`,t+=`&locid=${this.id}`,t+=`&worldid=${this.worldID}`,t+="&destid="+-this.destinationID,t+=`&revisionid=${this.revisionID}`,t+=`&db=${MAPCONFIG.database}&visible=1`,this.updateDisplayData(e),t+=`&x=${Number(this.isPolygon()?this.getMaxBounds().minX:e[0].x).toFixed(3)}`,t+=`&y=${Number(this.isPolygon()?this.getMaxBounds().maxY:e[0].y).toFixed(3)}`,t+=`&locwidth=${this.width.toFixed(3)}&locheight=${this.height.toFixed(3)}`,t+="&displaylevel="+(+this.displayLevel+ +gamemap.getWorldFromID(this.worldID).zoomOffset),t+=`&displaydata=${encodeURI(JSON.stringify(this.displayData))}`,this.hasIcon()&&(t+=`&icontype=${encodeURI(this.icon)}`),print(objectify(t)),encodeURI(t)}getRevertQuery(){return encodeURI(`action=revert_loc&db=${MAPCONFIG.db}&locid=${this.id}&revertid=${this.revertID??this.revisionID}`)}getDeleteQuery(){var t="action=enable_loc";return t+=`&locid=${this.id}`,t+=`&worldid=${this.worldID}`,t+=`&db=${MAPCONFIG.database}&visible=0`}updateDisplayData(t){if(this.displayData.labelPos=this.labelPos,this.displayData.points=(()=>{let e=[];return t.forEach((t=>{e.push(Number(t.x).toFixed(3),Number(t.y).toFixed(3))})),e})(),this.isPolygon()){this.displayData.fillStyle=this.fillColour,this.displayData.hover.fillStyle=this.fillColourHover,this.displayData.strokeStyle=this.strokeColour,this.displayData.hover.strokeStyle=this.strokeColourHover,this.displayData.lineWidth=this.strokeWidth,this.displayData.hover.lineWidth=this.strokeWidthHover;let t=this.getMaxBounds(!0);this.width=t.maxX-t.minX,this.height=t.maxY-t.minY}}convPseudoNormalisedCoords(t){let e=gamemap.getWorldFromID(this.worldID);return t=Array.isArray(t)?structuredClone(t):[structuredClone(t)],print(e),t.forEach((t=>{t.x=t.x/nextPowerOfTwo(e.dbNumTilesX)*e.dbNumTilesX,t.y=t.y/nextPowerOfTwo(e.dbNumTilesY)*e.dbNumTilesY,t.x=t.x*e.maxRangeX+e.minX,t.y=(1-t.y)*e.maxRangeY+e.minY})),t}getMaxBounds(t){if(t??null==this.bounds){let t=MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.convPseudoNormalisedCoords(this.coords):this.coords,e={};return[e.minX,e.maxX,e.minY,e.maxY]=[t[0].x,t[0].x,t[0].y,t[0].y],t.forEach((t=>{e.minX=t.x<e.minX?t.x:e.minX,e.maxX=t.x>e.maxX?t.x:e.maxX,e.minY=t.y<e.minY?t.y:e.minY,e.maxY=t.y>e.maxY?t.y:e.maxY})),this.bounds=e,e}return this.bounds}linkWikiPage(){return this.wikiPage?.toLowerCase()==this.name.toLowerCase()||null==this.wikiPage}getMarker(){return L.marker(gamemap.getLatLngs(this.getCentre()),{icon:gamemap.getIcon(this.icon),riseOnHover:!0})}}function create_if_block$5(t){let e,n;return{c(){e=element("small"),n=text(t[2]),attr(e,"class","svelte-6vgbo4")},m(t,i){insert(t,e,i),append(e,n)},p(t,e){4&e&&set_data(n,t[2])},d(t){t&&detach(e)}}}function create_fragment$9(t){let e,n,i,o,r,s,a,l,c,h,u=t[5]?" *":"";n=new IconButton({props:{icon:t[0],hasBackground:"false",tooltip:t[4]}}),n.$on("click",t[6]);let d=null!=t[2]&&create_if_block$5(t);return{c(){e=element("div"),create_component(n.$$.fragment),i=space(),o=element("div"),r=element("b"),s=text(t[1]),a=space(),l=text(u),c=space(),d&&d.c(),attr(r,"class","appbar-title svelte-6vgbo4"),attr(r,"title",t[3]),attr(o,"class","title-container svelte-6vgbo4"),attr(e,"class","appbar svelte-6vgbo4")},m(t,u){insert(t,e,u),mount_component(n,e,null),append(e,i),append(e,o),append(o,r),append(r,s),append(r,a),append(r,l),append(o,c),d&&d.m(o,null),h=!0},p(t,[e]){const i={};1&e&&(i.icon=t[0]),16&e&&(i.tooltip=t[4]),n.$set(i),(!h||2&e)&&set_data(s,t[1]),(!h||32&e)&&u!==(u=t[5]?" *":"")&&set_data(l,u),(!h||8&e)&&attr(r,"title",t[3]),null!=t[2]?d?d.p(t,e):(d=create_if_block$5(t),d.c(),d.m(o,null)):d&&(d.d(1),d=null)},i(t){h||(transition_in(n.$$.fragment,t),h=!0)},o(t){transition_out(n.$$.fragment,t),h=!1},d(t){t&&detach(e),destroy_component(n),d&&d.d()}}}function instance$9(t,e,n){let{icon:i="arrow_back"}=e,{title:o="This is an appbar."}=e,{subtitle:r}=e,{tooltip:s}=e,{buttonTooltip:a}=e,{unsavedChanges:l}=e;const c=createEventDispatcher();return t.$$set=t=>{"icon"in t&&n(0,i=t.icon),"title"in t&&n(1,o=t.title),"subtitle"in t&&n(2,r=t.subtitle),"tooltip"in t&&n(3,s=t.tooltip),"buttonTooltip"in t&&n(4,a=t.buttonTooltip),"unsavedChanges"in t&&n(5,l=t.unsavedChanges)},[i,o,r,s,a,l,function(){c("back","clicked")}]}class AppBar extends SvelteComponent{constructor(t){super(),init(this,t,instance$9,create_fragment$9,safe_not_equal,{icon:0,title:1,subtitle:2,tooltip:3,buttonTooltip:4,unsavedChanges:5})}get icon(){return this.$$.ctx[0]}set icon(t){this.$$set({icon:t}),flush()}get title(){return this.$$.ctx[1]}set title(t){this.$$set({title:t}),flush()}get subtitle(){return this.$$.ctx[2]}set subtitle(t){this.$$set({subtitle:t}),flush()}get tooltip(){return this.$$.ctx[3]}set tooltip(t){this.$$set({tooltip:t}),flush()}get buttonTooltip(){return this.$$.ctx[4]}set buttonTooltip(t){this.$$set({buttonTooltip:t}),flush()}get unsavedChanges(){return this.$$.ctx[5]}set unsavedChanges(t){this.$$set({unsavedChanges:t}),flush()}}function create_if_block_3$3(t){let e,n;return{c(){e=element("p"),n=text(t[2]),attr(e,"class","label svelte-e8x375"),toggle_class(e,"hasSubtext",t[5])},m(t,i){insert(t,e,i),append(e,n)},p(t,i){4&i&&set_data(n,t[2]),32&i&&toggle_class(e,"hasSubtext",t[5])},d(t){t&&detach(e)}}}function create_else_block$2(t){let e,n,i,o;return{c(){e=element("input"),attr(e,"id",t[14]),attr(e,"placeholder",n=null!=t[4]?t[4]:null),attr(e,"type","text"),attr(e,"class","input svelte-e8x375"),attr(e,"min",t[10]),attr(e,"max",t[11]),e.value=t[6],attr(e,"step","any"),toggle_class(e,"hideSpinner",t[9])},m(n,r){insert(n,e,r),t[20](e),i||(o=[action_destroyer(t[17].call(null,e)),listen(e,"input",t[15])],i=!0)},p(t,i){16&i&&n!==(n=null!=t[4]?t[4]:null)&&attr(e,"placeholder",n),1024&i&&attr(e,"min",t[10]),2048&i&&attr(e,"max",t[11]),64&i&&e.value!==t[6]&&(e.value=t[6]),512&i&&toggle_class(e,"hideSpinner",t[9])},d(n){n&&detach(e),t[20](null),i=!1,run_all(o)}}}function create_if_block_2$3(t){let e,n,i,o;return{c(){e=element("textarea"),attr(e,"id",t[14]),e.value=t[6],attr(e,"placeholder",n=null!=t[4]?t[4]:null),attr(e,"class","materialize-textarea input svelte-e8x375"),set_style(e,"margin-left","-8px"),set_style(e,"padding-left","8px"),set_style(e,"width","calc(100%)"),set_style(e,"padding-right","8px")},m(n,r){insert(n,e,r),t[19](e),i||(o=[listen(e,"input",t[15]),listen(e,"click",t[16])],i=!0)},p(t,i){64&i&&(e.value=t[6]),16&i&&n!==(n=null!=t[4]?t[4]:null)&&attr(e,"placeholder",n)},d(n){n&&detach(e),t[19](null),i=!1,run_all(o)}}}function create_if_block_1$3(t){let e,n;return{c(){e=element("label"),n=text(t[3]),attr(e,"for",t[14]),attr(e,"class","svelte-e8x375"),toggle_class(e,"active",null!=t[6]||null!=t[13]&&t[13]===document.activeElement)},m(t,i){insert(t,e,i),append(e,n)},p(t,i){8&i&&set_data(n,t[3]),8256&i&&toggle_class(e,"active",null!=t[6]||null!=t[13]&&t[13]===document.activeElement)},d(t){t&&detach(e)}}}function create_if_block$4(t){let e,n;return{c(){e=element("span"),n=text(t[5]),attr(e,"class","supporting-text subtext svelte-e8x375"),attr(e,"title",t[5])},m(t,i){insert(t,e,i),append(e,n)},p(t,i){32&i&&set_data(n,t[5]),32&i&&attr(e,"title",t[5])},d(t){t&&detach(e)}}}function create_fragment$8(t){let e,n,i,o,r,s=t[2]&&create_if_block_3$3(t);function a(t,e){return t[7]?create_if_block_2$3:create_else_block$2}let l=a(t),c=l(t),h=!t[4]&&create_if_block_1$3(t),u=t[5]&&create_if_block$4(t);return{c(){e=element("div"),s&&s.c(),n=space(),i=element("div"),c.c(),o=space(),h&&h.c(),r=space(),u&&u.c(),attr(i,"class","input-field svelte-e8x375"),toggle_class(i,"inline",!t[0]),toggle_class(i,"isNumber","number"==t[1]),toggle_class(i,"compact",!t[2]&&"number"==t[1]),attr(e,"class","textbox svelte-e8x375"),attr(e,"title",t[8]),toggle_class(e,"inline",!t[0]),toggle_class(e,"column",t[12])},m(t,a){insert(t,e,a),s&&s.m(e,null),append(e,n),append(e,i),c.m(i,null),append(i,o),h&&h.m(i,null),append(i,r),u&&u.m(i,null)},p(t,[d]){t[2]?s?s.p(t,d):(s=create_if_block_3$3(t),s.c(),s.m(e,n)):s&&(s.d(1),s=null),l===(l=a(t))&&c?c.p(t,d):(c.d(1),c=l(t),c&&(c.c(),c.m(i,o))),t[4]?h&&(h.d(1),h=null):h?h.p(t,d):(h=create_if_block_1$3(t),h.c(),h.m(i,r)),t[5]?u?u.p(t,d):(u=create_if_block$4(t),u.c(),u.m(i,null)):u&&(u.d(1),u=null),1&d&&toggle_class(i,"inline",!t[0]),2&d&&toggle_class(i,"isNumber","number"==t[1]),6&d&&toggle_class(i,"compact",!t[2]&&"number"==t[1]),256&d&&attr(e,"title",t[8]),1&d&&toggle_class(e,"inline",!t[0]),4096&d&&toggle_class(e,"column",t[12])},i:noop,o:noop,d(t){t&&detach(e),s&&s.d(),c.d(),h&&h.d(),u&&u.d()}}}function instance$8(t,e,n){let{label:i}=e,{hint:o="Enter text..."}=e,{placeholder:r}=e,{block:s=!1}=e,{subtext:a}=e,{text:l}=e,{textArea:c}=e,{tooltip:h}=e,{type:u="text"}=e,{hideSpinner:d="float"==u}=e,{min:p}=e,{max:_}=e,{column:f}=e,{focus:m=!1}=e;u="float"==u?"number":u;const g=createEventDispatcher();let v,y=l,b=Math.random().toString(36).substr(2,10);return s=null!=c||s,onMount((async()=>{v&&m&&v.focus()})),t.$$set=t=>{"label"in t&&n(2,i=t.label),"hint"in t&&n(3,o=t.hint),"placeholder"in t&&n(4,r=t.placeholder),"block"in t&&n(0,s=t.block),"subtext"in t&&n(5,a=t.subtext),"text"in t&&n(6,l=t.text),"textArea"in t&&n(7,c=t.textArea),"tooltip"in t&&n(8,h=t.tooltip),"type"in t&&n(1,u=t.type),"hideSpinner"in t&&n(9,d=t.hideSpinner),"min"in t&&n(10,p=t.min),"max"in t&&n(11,_=t.max),"column"in t&&n(12,f=t.column),"focus"in t&&n(18,m=t.focus)},[s,u,i,o,r,a,l,c,h,d,p,_,f,v,b,function(t){y=t.target.value,g("change","number"==u?Number(y):y)},function(){var t=document.createEvent("KeyboardEvent");t[void 0!==t.initKeyboardEvent?"initKeyboardEvent":"initKeyEvent"]("keydown",!0,!0,window,!1,!1,!1,!1,40,0),v.dispatchEvent(t)},function(t){t.type=u},m,function(t){binding_callbacks[t?"unshift":"push"]((()=>{v=t,n(13,v)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{v=t,n(13,v)}))}]}class Textbox extends SvelteComponent{constructor(t){super(),init(this,t,instance$8,create_fragment$8,safe_not_equal,{label:2,hint:3,placeholder:4,block:0,subtext:5,text:6,textArea:7,tooltip:8,type:1,hideSpinner:9,min:10,max:11,column:12,focus:18})}get label(){return this.$$.ctx[2]}set label(t){this.$$set({label:t}),flush()}get hint(){return this.$$.ctx[3]}set hint(t){this.$$set({hint:t}),flush()}get placeholder(){return this.$$.ctx[4]}set placeholder(t){this.$$set({placeholder:t}),flush()}get block(){return this.$$.ctx[0]}set block(t){this.$$set({block:t}),flush()}get subtext(){return this.$$.ctx[5]}set subtext(t){this.$$set({subtext:t}),flush()}get text(){return this.$$.ctx[6]}set text(t){this.$$set({text:t}),flush()}get textArea(){return this.$$.ctx[7]}set textArea(t){this.$$set({textArea:t}),flush()}get tooltip(){return this.$$.ctx[8]}set tooltip(t){this.$$set({tooltip:t}),flush()}get type(){return this.$$.ctx[1]}set type(t){this.$$set({type:t}),flush()}get hideSpinner(){return this.$$.ctx[9]}set hideSpinner(t){this.$$set({hideSpinner:t}),flush()}get min(){return this.$$.ctx[10]}set min(t){this.$$set({min:t}),flush()}get max(){return this.$$.ctx[11]}set max(t){this.$$set({max:t}),flush()}get column(){return this.$$.ctx[12]}set column(t){this.$$set({column:t}),flush()}get focus(){return this.$$.ctx[18]}set focus(t){this.$$set({focus:t}),flush()}}function create_if_block$3(t){let e,n;return e=new Icon({props:{name:t[1],size:"16"}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};2&n&&(i.name=t[1]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_fragment$7(t){let e,n,i,o,r,s,a,l=t[1]&&create_if_block$3(t);const c=t[5].default,h=create_slot(c,t,t[4],null);return{c(){e=element("div"),n=element("span"),l&&l.c(),i=space(),o=element("b"),r=text(t[0]),s=space(),h&&h.c(),attr(n,"class","title svelte-hz3sim"),attr(n,"title",t[2]),attr(e,"class","group svelte-hz3sim"),toggle_class(e,"disabled",t[3])},m(t,c){insert(t,e,c),append(e,n),l&&l.m(n,null),append(n,i),append(n,o),append(o,r),append(e,s),h&&h.m(e,null),a=!0},p(t,[o]){t[1]?l?(l.p(t,o),2&o&&transition_in(l,1)):(l=create_if_block$3(t),l.c(),transition_in(l,1),l.m(n,i)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros()),(!a||1&o)&&set_data(r,t[0]),(!a||4&o)&&attr(n,"title",t[2]),h&&h.p&&(!a||16&o)&&update_slot_base(h,c,t,t[4],a?get_slot_changes(c,t[4],o,null):get_all_dirty_from_scope(t[4]),null),(!a||8&o)&&toggle_class(e,"disabled",t[3])},i(t){a||(transition_in(l),transition_in(h,t),a=!0)},o(t){transition_out(l),transition_out(h,t),a=!1},d(t){t&&detach(e),l&&l.d(),h&&h.d(t)}}}function instance$7(t,e,n){let{$$slots:i={},$$scope:o}=e,{title:r="Form group"}=e,{icon:s}=e,{tooltip:a}=e,{disabled:l}=e;return t.$$set=t=>{"title"in t&&n(0,r=t.title),"icon"in t&&n(1,s=t.icon),"tooltip"in t&&n(2,a=t.tooltip),"disabled"in t&&n(3,l=t.disabled),"$$scope"in t&&n(4,o=t.$$scope)},[r,s,a,l,o,i]}class FormGroup extends SvelteComponent{constructor(t){super(),init(this,t,instance$7,create_fragment$7,safe_not_equal,{title:0,icon:1,tooltip:2,disabled:3})}get title(){return this.$$.ctx[0]}set title(t){this.$$set({title:t}),flush()}get icon(){return this.$$.ctx[1]}set icon(t){this.$$set({icon:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}get disabled(){return this.$$.ctx[3]}set disabled(t){this.$$set({disabled:t}),flush()}}function create_fragment$6(t){let e,n,i,o,r,s,a,l;return{c(){e=element("div"),n=element("span"),i=element("b"),o=text(t[0]),r=text(":"),s=space(),a=element("span"),l=text(t[1]),attr(n,"class","key svelte-rh4r3"),attr(a,"class","value svelte-rh4r3"),attr(e,"title",t[2]),attr(e,"class","svelte-rh4r3")},m(t,c){insert(t,e,c),append(e,n),append(n,i),append(i,o),append(i,r),append(e,s),append(e,a),append(a,l)},p(t,[n]){1&n&&set_data(o,t[0]),2&n&&set_data(l,t[1]),4&n&&attr(e,"title",t[2])},i:noop,o:noop,d(t){t&&detach(e)}}}function instance$6(t,e,n){let{name:i="Info:"}=e,{value:o="Value"}=e,{tooltip:r}=e;return t.$$set=t=>{"name"in t&&n(0,i=t.name),"value"in t&&n(1,o=t.value),"tooltip"in t&&n(2,r=t.tooltip)},[i,o,r]}class InfoTextPair extends SvelteComponent{constructor(t){super(),init(this,t,instance$6,create_fragment$6,safe_not_equal,{name:0,value:1,tooltip:2})}get name(){return this.$$.ctx[0]}set name(t){this.$$set({name:t}),flush()}get value(){return this.$$.ctx[1]}set value(t){this.$$set({value:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}}
/*!
     * vanilla-picker v2.12.2
     * https://vanilla-picker.js.org
     *
     * Copyright 2017-2023 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
     * Released under the ISC license.
     */var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(o)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};String.prototype.startsWith=String.prototype.startsWith||function(t){return 0===this.indexOf(t)},String.prototype.padStart=String.prototype.padStart||function(t,e){for(var n=this;n.length<t;)n=e+n;return n};var colorNames={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function printNum(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e>0?t.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):t.toString())||"0"}var Color=function(){function t(e,n,i,o){classCallCheck(this,t);var r=this;if(void 0===e);else if(Array.isArray(e))this.rgba=e;else if(void 0===i){var s=e&&""+e;s&&function(e){if(e.startsWith("hsl")){var n=e.match(/([\-\d\.e]+)/g).map(Number),i=slicedToArray(n,4),o=i[0],s=i[1],a=i[2],l=i[3];void 0===l&&(l=1),o/=360,s/=100,a/=100,r.hsla=[o,s,a,l]}else if(e.startsWith("rgb")){var c=e.match(/([\-\d\.e]+)/g).map(Number),h=slicedToArray(c,4),u=h[0],d=h[1],p=h[2],_=h[3];void 0===_&&(_=1),r.rgba=[u,d,p,_]}else e.startsWith("#")?r.rgba=t.hexToRgb(e):r.rgba=t.nameToRgb(e)||t.hexToRgb(e)}(s.toLowerCase())}else this.rgba=[e,n,i,void 0===o?1:o]}return createClass(t,[{key:"printRGB",value:function(t){var e=(t?this.rgba:this.rgba.slice(0,3)).map((function(t,e){return printNum(t,3===e?3:0)}));return t?"rgba("+e+")":"rgb("+e+")"}},{key:"printHSL",value:function(t){var e=[360,100,100,1],n=["","%","%",""],i=(t?this.hsla:this.hsla.slice(0,3)).map((function(t,i){return printNum(t*e[i],3===i?3:1)+n[i]}));return t?"hsla("+i+")":"hsl("+i+")"}},{key:"printHex",value:function(t){var e=this.hex;return t?e:e.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=t.hslToRgb(this._hsla)},set:function(t){3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=t.rgbToHsl(this._rgba)},set:function(t){3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map((function(t,e){return e<3?t.toString(16):Math.round(255*t).toString(16)})).map((function(t){return t.padStart(2,"0")})).join("")},set:function(e){this.rgba=t.hexToRgb(e)}}],[{key:"hexToRgb",value:function(t){var e=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!e.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+t);var n=e.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map((function(t){return parseInt(t,16)}));return n[3]=n[3]/255,n}},{key:"nameToRgb",value:function(e){var n=e.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),i=colorNames[n];return void 0===i?i:t.hexToRgb(i.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var e=slicedToArray(t,4),n=e[0],i=e[1],o=e[2],r=e[3];n/=255,i/=255,o/=255;var s=Math.max(n,i,o),a=Math.min(n,i,o),l=void 0,c=void 0,h=(s+a)/2;if(s===a)l=c=0;else{var u=s-a;switch(c=h>.5?u/(2-s-a):u/(s+a),s){case n:l=(i-o)/u+(i<o?6:0);break;case i:l=(o-n)/u+2;break;case o:l=(n-i)/u+4}l/=6}return[l,c,h,r]}},{key:"hslToRgb",value:function(t){var e=slicedToArray(t,4),n=e[0],i=e[1],o=e[2],r=e[3],s=void 0,a=void 0,l=void 0;if(0===i)s=a=l=o;else{var c=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},h=o<.5?o*(1+i):o+i-o*i,u=2*o-h;s=c(u,h,n+1/3),a=c(u,h,n),l=c(u,h,n-1/3)}var d=[255*s,255*a,255*l].map(Math.round);return d[3]=r,d}}]),t}(),EventBucket=function(){function t(){classCallCheck(this,t),this._events=[]}return createClass(t,[{key:"add",value:function(t,e,n){t.addEventListener(e,n,!1),this._events.push({target:t,type:e,handler:n})}},{key:"remove",value:function(e,n,i){this._events=this._events.filter((function(o){var r=!0;return e&&e!==o.target&&(r=!1),n&&n!==o.type&&(r=!1),i&&i!==o.handler&&(r=!1),r&&t._doRemove(o.target,o.type,o.handler),!r}))}},{key:"destroy",value:function(){this._events.forEach((function(e){return t._doRemove(e.target,e.type,e.handler)})),this._events=[]}}],[{key:"_doRemove",value:function(t,e,n){t.removeEventListener(e,n,!1)}}]),t}();function parseHTML(t){var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}function dragTrack(t,e,n){var i=!1;function o(t,e,n){return Math.max(e,Math.min(t,n))}function r(t,r,s){if(s&&(i=!0),i){t.preventDefault();var a=e.getBoundingClientRect(),l=a.width,c=a.height,h=r.clientX,u=r.clientY,d=o(h-a.left,0,l),p=o(u-a.top,0,c);n(d/l,p/c)}}function s(t,e){1===(void 0===t.buttons?t.which:t.buttons)?r(t,t,e):i=!1}function a(t,e){1===t.touches.length?r(t,t.touches[0],e):i=!1}t.add(e,"mousedown",(function(t){s(t,!0)})),t.add(e,"touchstart",(function(t){a(t,!0)})),t.add(window,"mousemove",s),t.add(e,"touchmove",a),t.add(window,"mouseup",(function(t){i=!1})),t.add(e,"touchend",(function(t){i=!1})),t.add(e,"touchcancel",(function(t){i=!1}))}var BG_TRANSP="linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",HUES=360,EVENT_KEY="keydown",EVENT_CLICK_OUTSIDE="mousedown",EVENT_TAB_MOVE="focusin";function $$1(t,e){return(e||document).querySelector(t)}function stopEvent(t){t.preventDefault(),t.stopPropagation()}function onKey(t,e,n,i,o){t.add(e,EVENT_KEY,(function(t){n.indexOf(t.key)>=0&&(o&&stopEvent(t),i(t))}))}var Picker=function(){function t(e){classCallCheck(this,t),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new EventBucket,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}return createClass(t,[{key:"setOptions",value:function(t){var e=this;if(t){var n=this.settings;if(t instanceof HTMLElement)n.parent=t;else{n.parent&&t.parent&&n.parent!==t.parent&&(this._events.remove(n.parent),this._popupInited=!1),function(t,e,n){for(var i in t)n&&n.indexOf(i)>=0||(e[i]=t[i])}(t,n),t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose);var i=t.color||t.colour;i&&this._setColor(i)}var o=n.parent;if(o&&n.popup&&!this._popupInited){var r=function(t){return e.openHandler(t)};this._events.add(o,"click",r),onKey(this._events,o,[" ","Spacebar","Enter"],r),this._popupInited=!0}else t.parent&&!n.popup&&this.show()}}},{key:"openHandler",value:function(t){if(this.show()){t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none";var e=t&&t.type===EVENT_KEY?this._domEdit:this.domElement;setTimeout((function(){return e.focus()}),100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(t){var e=t&&t.type,n=!1;if(t)if(e===EVENT_CLICK_OUTSIDE||e===EVENT_TAB_MOVE){var i=(this.__containedEvent||0)+100;t.timeStamp>i&&(n=!0)}else stopEvent(t),n=!0;else n=!0;n&&this.hide()&&(this.settings.parent.style.pointerEvents="",e!==EVENT_CLICK_OUTSIDE&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(t,e){this.closeHandler(),this.setOptions(t),e&&this.openHandler()}},{key:"setColor",value:function(t,e){this._setColor(t,{silent:e})}},{key:"_setColor",value:function(t,e){if("string"==typeof t&&(t=t.trim()),t){e=e||{};var n=void 0;try{n=new Color(t)}catch(t){if(e.failSilently)return;throw t}if(!this.settings.alpha){var i=n.hsla;i[3]=1,n.hsla=i}this.colour=this.color=n,this._setHSLA(null,null,null,null,e)}}},{key:"setColour",value:function(t,e){this.setColor(t,e)}},{key:"show",value:function(){if(!this.settings.parent)return!1;if(this.domElement){var t=this._toggleDOM(!0);return this._setPosition(),t}var e=parseHTML(this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>');return this.domElement=e,this._domH=$$1(".picker_hue",e),this._domSL=$$1(".picker_sl",e),this._domA=$$1(".picker_alpha",e),this._domEdit=$$1(".picker_editor input",e),this._domSample=$$1(".picker_sample",e),this._domOkay=$$1(".picker_done button",e),this._domCancel=$$1(".picker_cancel button",e),e.classList.add("layout_"+this.settings.layout),this.settings.alpha||e.classList.add("no_alpha"),this.settings.editor||e.classList.add("no_editor"),this.settings.cancelButton||e.classList.add("no_cancel"),this._ifPopup((function(){return e.classList.add("popup")})),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var t=this,e=this,n=this.domElement,i=this._events;function o(t,e,n){i.add(t,e,n)}o(n,"click",(function(t){return t.preventDefault()})),dragTrack(i,this._domH,(function(t,n){return e._setHSLA(t)})),dragTrack(i,this._domSL,(function(t,n){return e._setHSLA(null,t,1-n)})),this.settings.alpha&&dragTrack(i,this._domA,(function(t,n){return e._setHSLA(null,null,null,1-n)}));var r=this._domEdit;o(r,"input",(function(t){e._setColor(this.value,{fromEditor:!0,failSilently:!0})})),o(r,"focus",(function(t){var e=this;e.selectionStart===e.selectionEnd&&e.select()})),this._ifPopup((function(){var e=function(e){return t.closeHandler(e)};o(window,EVENT_CLICK_OUTSIDE,e),o(window,EVENT_TAB_MOVE,e),onKey(i,n,["Esc","Escape"],e);var r=function(e){t.__containedEvent=e.timeStamp};o(n,EVENT_CLICK_OUTSIDE,r),o(n,EVENT_TAB_MOVE,r),o(t._domCancel,"click",e)}));var s=function(e){t._ifPopup((function(){return t.closeHandler(e)})),t.onDone&&t.onDone(t.colour)};o(this._domOkay,"click",s),onKey(i,n,["Enter"],s)}},{key:"_setPosition",value:function(){var t=this.settings.parent,e=this.domElement;t!==e.parentNode&&t.appendChild(e),this._ifPopup((function(n){"static"===getComputedStyle(t).position&&(t.style.position="relative");var i=!0===n?"popup_right":"popup_"+n;["popup_top","popup_bottom","popup_left","popup_right"].forEach((function(t){t===i?e.classList.add(t):e.classList.remove(t)})),e.classList.add(i)}))}},{key:"_setHSLA",value:function(t,e,n,i,o){o=o||{};var r=this.colour,s=r.hsla;[t,e,n,i].forEach((function(t,e){(t||0===t)&&(s[e]=t)})),r.hsla=s,this._updateUI(o),this.onChange&&!o.silent&&this.onChange(r)}},{key:"_updateUI",value:function(t){if(this.domElement){t=t||{};var e=this.colour,n=e.hsla,i="hsl("+n[0]*HUES+", 100%, 50%)",o=e.hslString,r=e.hslaString,s=this._domH,a=this._domSL,l=this._domA,c=$$1(".picker_selector",s),h=$$1(".picker_selector",a),u=$$1(".picker_selector",l);v(0,c,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=i,v(0,h,n[1]),y(0,h,1-n[2]),a.style.color=o,y(0,u,1-n[3]);var d=o,p=d.replace("hsl","hsla").replace(")",", 0)"),_="linear-gradient("+[d,p]+")";if(this._domA.style.background=_+", "+BG_TRANSP,!t.fromEditor){var f=this.settings.editorFormat,m=this.settings.alpha,g=void 0;switch(f){case"rgb":g=e.printRGB(m);break;case"hsl":g=e.printHSL(m);break;default:g=e.printHex(m)}this._domEdit.value=g}this._domSample.style.color=r}function v(t,e,n){e.style.left=100*n+"%"}function y(t,e,n){e.style.top=100*n+"%"}}},{key:"_ifPopup",value:function(t,e){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):e&&e()}},{key:"_toggleDOM",value:function(t){var e=this.domElement;if(!e)return!1;var n=t?"":"none",i=e.style.display!==n;return i&&(e.style.display=n),i}}]),t}(),style=document.createElement("style");function create_if_block$2(t){let e,n,i;function o(e){t[8](e)}let r={placeholder:t[2],block:!0,label:t[1],text:t[0]};return void 0!==t[0]&&(r.value=t[0]),e=new Textbox({props:r}),binding_callbacks.push((()=>bind(e,"value",o))),e.$on("change",t[9]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const o={};4&i&&(o.placeholder=t[2]),2&i&&(o.label=t[1]),1&i&&(o.text=t[0]),!n&&1&i&&(n=!0,o.value=t[0],add_flush_callback((()=>n=!1))),e.$set(o)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_fragment$5(t){let e,n,i,o,r,s,a,l,c,h=t[3]&&create_if_block$2(t);return{c(){e=element("div"),h&&h.c(),n=space(),i=element("div"),o=element("div"),r=space(),s=element("a"),attr(o,"class","colour-preview svelte-188mju9"),attr(i,"class","colour-picker svelte-188mju9"),attr(i,"title","Select colour"),toggle_class(i,"hasTextbox",t[3]),attr(s,"id","colour-picker-anchor"),attr(s,"class","svelte-188mju9"),attr(e,"class","colour-picker-container"),set_style(e,"position","relative"),attr(e,"title",t[4]),toggle_class(e,"isEmpty",null==t[0]||""==t[0]||0==t[0].length)},m(u,d){insert(u,e,d),h&&h.m(e,null),append(e,n),append(e,i),append(i,o),t[10](o),append(e,r),append(e,s),t[12](s),a=!0,l||(c=listen(i,"click",t[11]),l=!0)},p(t,[o]){t[3]?h?(h.p(t,o),8&o&&transition_in(h,1)):(h=create_if_block$2(t),h.c(),transition_in(h,1),h.m(e,n)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros()),(!a||8&o)&&toggle_class(i,"hasTextbox",t[3]),(!a||16&o)&&attr(e,"title",t[4]),(!a||1&o)&&toggle_class(e,"isEmpty",null==t[0]||""==t[0]||0==t[0].length)},i(t){a||(transition_in(h),a=!0)},o(t){transition_out(h),a=!1},d(n){n&&detach(e),h&&h.d(),t[10](null),t[12](null),l=!1,c()}}}function instance$5(t,e,n){let i,o,r,{label:s}=e,{placeholder:a}=e,{showTextBox:l=!0}=e,{colour:c="rgba(0, 0, 0, 0)"}=e,{tooltip:h}=e;const u=createEventDispatcher();onMount((async()=>{n(7,r.style.background=c,r),n(5,i=new Picker({parent:o,popup:"left",editorFormat:"rgb"})),i.setColor(""!=c?c:"rgba(0, 0, 0, 0)"),n(5,i.onChange=function(t){n(7,r.style.background=t.rgbaString,r),n(0,c=t.rgbaString)},i)}));return t.$$set=t=>{"label"in t&&n(1,s=t.label),"placeholder"in t&&n(2,a=t.placeholder),"showTextBox"in t&&n(3,l=t.showTextBox),"colour"in t&&n(0,c=t.colour),"tooltip"in t&&n(4,h=t.tooltip)},t.$$.update=()=>{33&t.$$.dirty&&i&&(i.setColour(c),u("change",c))},[c,s,a,l,h,i,o,r,function(t){c=t,n(0,c)},t=>n(0,c=t.detail),function(t){binding_callbacks[t?"unshift":"push"]((()=>{r=t,n(7,r)}))},()=>i.show(),function(t){binding_callbacks[t?"unshift":"push"]((()=>{o=t,n(6,o)}))}]}style.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(style),Picker.StyleElement=style;class ColourPicker extends SvelteComponent{constructor(t){super(),init(this,t,instance$5,create_fragment$5,safe_not_equal,{label:1,placeholder:2,showTextBox:3,colour:0,tooltip:4})}get label(){return this.$$.ctx[1]}set label(t){this.$$set({label:t}),flush()}get placeholder(){return this.$$.ctx[2]}set placeholder(t){this.$$set({placeholder:t}),flush()}get showTextBox(){return this.$$.ctx[3]}set showTextBox(t){this.$$set({showTextBox:t}),flush()}get colour(){return this.$$.ctx[0]}set colour(t){this.$$set({colour:t}),flush()}get tooltip(){return this.$$.ctx[4]}set tooltip(t){this.$$set({tooltip:t}),flush()}}function get_each_context$2(t,e,n){const i=t.slice();return i[14]=e[n][0],i[15]=e[n][1],i}function create_if_block_2$2(t){let e,n,i,o,r;const s=[create_if_block_3$2,create_else_block$1],a=[];function l(t,n){return 1&n&&(e=null),null==e&&(e=!!t[0].includes("/")),e?0:1}return n=l(t,-1),i=a[n]=s[n](t),{c(){i.c(),o=empty()},m(t,e){a[n].m(t,e),insert(t,o,e),r=!0},p(t,e){let r=n;n=l(t,e),n===r?a[n].p(t,e):(group_outros(),transition_out(a[r],1,1,(()=>{a[r]=null})),check_outros(),i=a[n],i?i.p(t,e):(i=a[n]=s[n](t),i.c()),transition_in(i,1),i.m(o.parentNode,o))},i(t){r||(transition_in(i),r=!0)},o(t){transition_out(i),r=!1},d(t){a[n].d(t),t&&detach(o)}}}function create_else_block$1(t){let e,n;return e=new Icon({props:{size:"medium",name:t[0]}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.name=t[0]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_3$2(t){let e,n;return{c(){e=element("img"),src_url_equal(e.src,n=t[0])||attr(e,"src",n),attr(e,"class","svelte-149pcwa")},m(t,n){insert(t,e,n)},p(t,i){1&i&&!src_url_equal(e.src,n=t[0])&&attr(e,"src",n)},i:noop,o:noop,d(t){t&&detach(e)}}}function create_if_block_1$2(t){let e,n;return e=new DropdownMenu({props:{hint:"Select icon...",invisible:!0,$$slots:{default:[create_default_slot$2]},$$scope:{ctx:t}}}),e.$on("change",t[9]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};4112&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_each_block$2(t){let e,n,i,o=t[15]+"";return{c(){e=element("option"),n=text(o),e.__value=t[14],e.value=e.__value,e.selected=i=t[14]==t[4],attr(e,"data-icon",gamemap.getMapConfig().iconPath+t[14]+".png"),attr(e,"title",t[15])},m(t,i){insert(t,e,i),append(e,n)},p(t,n){16&n&&i!==(i=t[14]==t[4])&&(e.selected=i)},d(t){t&&detach(e)}}}function create_default_slot$2(t){let e,n,i,o,r,s=[...gamemap.getMapConfig().icons],a=[];for(let e=0;e<s.length;e+=1)a[e]=create_each_block$2(get_each_context$2(t,s,e));return{c(){e=element("option"),n=text("None"),o=space();for(let t=0;t<a.length;t+=1)a[t].c();r=empty(),e.__value=null,e.value=e.__value,e.selected=i=null==t[4]},m(t,i){insert(t,e,i),append(e,n),insert(t,o,i);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(t,i);insert(t,r,i)},p(t,n){if(16&n&&i!==(i=null==t[4])&&(e.selected=i),16&n){let e;for(s=[...gamemap.getMapConfig().icons],e=0;e<s.length;e+=1){const i=get_each_context$2(t,s,e);a[e]?a[e].p(i,n):(a[e]=create_each_block$2(i),a[e].c(),a[e].m(r.parentNode,r))}for(;e<a.length;e+=1)a[e].d(1);a.length=s.length}},d(t){t&&detach(e),t&&detach(o),destroy_each(a,t),t&&detach(r)}}}function create_if_block$1(t){let e;return{c(){e=element("div"),e.innerHTML='<b class="overlay-text svelte-149pcwa">Select Icon</b>',attr(e,"class","overlay svelte-149pcwa")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_fragment$4(t){let e,n,i,o,r,s,a,l,c,h=t[0]&&create_if_block_2$2(t),u=t[1]&&create_if_block_1$2(t),d=t[2]&&create_if_block$1();const p=t[8].default,_=create_slot(p,t,t[12],null);return{c(){e=element("div"),n=element("div"),h&&h.c(),i=space(),u&&u.c(),o=space(),d&&d.c(),r=space(),s=element("div"),_&&_.c(),attr(n,"class","avatar circle svelte-149pcwa"),attr(n,"title",t[3]),toggle_class(n,"waves-effect",t[1]),attr(s,"class","form_container svelte-149pcwa"),attr(e,"class","avatar_container svelte-149pcwa")},m(p,f){insert(p,e,f),append(e,n),h&&h.m(n,null),append(n,i),u&&u.m(n,null),append(n,o),d&&d.m(n,null),append(e,r),append(e,s),_&&_.m(s,null),a=!0,l||(c=[listen(n,"mouseover",t[10]),listen(n,"mouseout",t[11])],l=!0)},p(t,[e]){t[0]?h?(h.p(t,e),1&e&&transition_in(h,1)):(h=create_if_block_2$2(t),h.c(),transition_in(h,1),h.m(n,i)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros()),t[1]?u?(u.p(t,e),2&e&&transition_in(u,1)):(u=create_if_block_1$2(t),u.c(),transition_in(u,1),u.m(n,o)):u&&(group_outros(),transition_out(u,1,1,(()=>{u=null})),check_outros()),t[2]?d||(d=create_if_block$1(),d.c(),d.m(n,null)):d&&(d.d(1),d=null),(!a||8&e)&&attr(n,"title",t[3]),(!a||2&e)&&toggle_class(n,"waves-effect",t[1]),_&&_.p&&(!a||4096&e)&&update_slot_base(_,p,t,t[12],a?get_slot_changes(p,t[12],e,null):get_all_dirty_from_scope(t[12]),null)},i(t){a||(transition_in(h),transition_in(u),transition_in(_,t),a=!0)},o(t){transition_out(h),transition_out(u),transition_out(_,t),a=!1},d(t){t&&detach(e),h&&h.d(),u&&u.d(),d&&d.d(),_&&_.d(t),l=!1,run_all(c)}}}function instance$4(t,e,n){let i,o,{$$slots:r={},$$scope:s}=e,{icon:a}=e,{isWorld:l}=e,{locType:c}=e,h=!0,u=!1;const d=createEventDispatcher();function p(t){print(t),"null"!=t||null==t?(d("change",Number(t)),n(0,a=t)):(d("change",null),n(0,a=null))}return t.$$set=t=>{"icon"in t&&n(0,a=t.icon),"isWorld"in t&&n(6,l=t.isWorld),"locType"in t&&n(7,c=t.locType),"$$scope"in t&&n(12,s=t.$$scope)},t.$$.update=()=>{195&t.$$.dirty&&(n(4,o=a),n(0,a=null!=a?n(0,a=gamemap.getMapConfig().iconPath+a+".png"):l?"public":c!=LOCTYPES.PATH?"add":"location_on"),n(1,h=c!=LOCTYPES.PATH&&!l),n(3,i=h?a.includes("/")?gamemap.getMapConfig().icons.get(Number(a.replace(/\D/g,""))):"Add Icon":l?"World":"Location"))},[a,h,u,i,o,p,l,c,r,t=>p(t.detail),()=>{n(2,u=h)},()=>n(2,u=!1),s]}class AvatarComponent extends SvelteComponent{constructor(t){super(),init(this,t,instance$4,create_fragment$4,safe_not_equal,{icon:0,isWorld:6,locType:7})}get icon(){return this.$$.ctx[0]}set icon(t){this.$$set({icon:t}),flush()}get isWorld(){return this.$$.ctx[6]}set isWorld(t){this.$$set({isWorld:t}),flush()}get locType(){return this.$$.ctx[7]}set locType(t){this.$$set({locType:t}),flush()}}function create_fragment$3(t){let e,n,i,o,r,s,a;return{c(){e=element("div"),n=element("div"),i=element("div"),o=space(),r=element("small"),r.textContent="Preview",attr(i,"class","colour-preview svelte-xfbksu"),set_style(i,"--fillColour",t[3]),set_style(i,"--strokeColour",t[2]),set_style(i,"--strokeWidth",t[1]+"px"),attr(n,"class","colour-picker svelte-xfbksu"),attr(n,"title","Colour preview"),attr(r,"class","label svelte-xfbksu"),attr(e,"id","colour-preview-container"),attr(e,"class","svelte-xfbksu")},m(l,c){insert(l,e,c),append(e,n),append(n,i),append(e,o),append(e,r),s||(a=[listen(i,"mouseenter",t[5]),listen(i,"mouseleave",t[6])],s=!0)},p(t,[e]){8&e&&set_style(i,"--fillColour",t[3]),4&e&&set_style(i,"--strokeColour",t[2]),2&e&&set_style(i,"--strokeWidth",t[1]+"px")},i:noop,o:noop,d(t){t&&detach(e),s=!1,run_all(a)}}}function instance$3(t,e,n){let i,o,r,{data:s}=e,a=!1;return t.$$set=t=>{"data"in t&&n(4,s=t.data)},t.$$.update=()=>{17&t.$$.dirty&&n(3,i=a?s.fillColourHover:s.fillColour),17&t.$$.dirty&&n(2,o=a?s.strokeColourHover:s.strokeColour),17&t.$$.dirty&&n(1,r=a?s.strokeWidthHover:s.strokeWidth)},[a,r,o,i,s,()=>n(0,a=!0),()=>n(0,a=!1)]}class ColourPreview extends SvelteComponent{constructor(t){super(),init(this,t,instance$3,create_fragment$3,safe_not_equal,{data:4})}get data(){return this.$$.ctx[4]}set data(t){this.$$set({data:t}),flush()}}function create_fragment$2(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m,g,v,y,b,k;return a=new Icon({props:{name:"emoji_objects"}}),_=new Button({props:{text:"OK",flat:!0}}),_.$on("click",t[1]),{c(){e=element("div"),n=element("hr"),r=space(),s=element("div"),create_component(a.$$.fragment),l=space(),c=element("b"),h=text('Use suggested settings for "'),u=text(t[0]),d=text('"?'),p=space(),create_component(_.$$.fragment),f=space(),m=element("hr"),set_style(n,"margin-top","12px"),attr(n,"class","svelte-12u17ry"),set_style(c,"flex-grow","1"),attr(s,"id","suggestion_container"),attr(s,"class","svelte-12u17ry"),attr(m,"class","svelte-12u17ry"),attr(e,"id","suggestion_bar"),set_style(e,"margin-bottom","6px")},m(t,i){insert(t,e,i),append(e,n),append(e,r),append(e,s),mount_component(a,s,null),append(s,l),append(s,c),append(c,h),append(c,u),append(c,d),append(s,p),mount_component(_,s,null),append(e,f),append(e,m),k=!0},p(t,[e]){(!k||1&e)&&set_data(u,t[0])},i(t){k||(add_render_callback((()=>{k&&(o&&o.end(1),i=create_in_transition(n,scale,{}),i.start())})),transition_in(a.$$.fragment,t),transition_in(_.$$.fragment,t),add_render_callback((()=>{k&&(v&&v.end(1),g=create_in_transition(m,scale,{}),g.start())})),add_render_callback((()=>{k&&(b&&b.end(1),y=create_in_transition(e,slide,{}),y.start())})),k=!0)},o(t){i&&i.invalidate(),o=create_out_transition(n,scale,{}),transition_out(a.$$.fragment,t),transition_out(_.$$.fragment,t),g&&g.invalidate(),v=create_out_transition(m,scale,{}),y&&y.invalidate(),b=create_out_transition(e,slide,{}),k=!1},d(t){t&&detach(e),t&&o&&o.end(),destroy_component(a),destroy_component(_),t&&v&&v.end(),t&&b&&b.end()}}}function instance$2(t,e,n){let{suggestion:i="suggestion"}=e;const o=createEventDispatcher();return t.$$set=t=>{"suggestion"in t&&n(0,i=t.suggestion)},[i,function(){o("confirm")}]}class SuggestionBar extends SvelteComponent{constructor(t){super(),init(this,t,instance$2,create_fragment$2,safe_not_equal,{suggestion:0})}get suggestion(){return this.$$.ctx[0]}set suggestion(t){this.$$set({suggestion:t}),flush()}}const{window:window_1$1}=globals;function get_context_1(t){const e=t[5]?"world":"loc";t[103]=e}function get_each_context$1(t,e,n){const i=t.slice();i[104]=e[n];const o=i[38](i[104]);i[105]=o;const r=i[104].revisionId==i[4].revisionID;return i[106]=r,i}function get_each_context_1(t,e,n){const i=t.slice();return i[111]=e[n],i[113]=n,i}function get_if_ctx(t){const e=t.slice(),n=Object.keys(LABEL_POSITIONS);e[109]=n;const i=Object.values(LABEL_POSITIONS);return e[110]=i,e}function get_if_ctx_1(t){const e=t.slice(),n=MAPCONFIG.editTemplates[e[22]][e[25].toLowerCase()];return e[114]=n,e}function get_context(t){const e=t[18][t[101]];t[102]=e}function get_if_ctx_2(t){const e=t.slice(),n=Object.keys(LOCTYPES).find((t=>LOCTYPES[t]===e[11]));return e[115]=n,e}function create_if_block(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f=t[11]&&create_if_block_19(get_if_ctx_2(t));r=new AppBar({props:{title:t[23]?`${EDIT_TYPES[t[24]].toSentenceCase()} ${t[22].toSentenceCase()}`:"Map Editor",subtitle:t[23]?t[5]?t[4].displayName+" ("+t[4].name+")":t[4].name:null,unsavedChanges:t[2],icon:t[23]&&!t[21]?"arrow_back":"close",tooltip:t[2]?"You have unsaved changes":null,buttonTooltip:t[23]&&!t[21]?"Go back":"Close"}}),r.$on("back",t[45]);const m=[create_if_block_1$1,create_else_block_1],g=[];function v(t,e){return t[23]?1:0}return l=v(t),c=g[l]=m[l](t),{c(){e=element("aside"),f&&f.c(),n=space(),i=element("div"),o=space(),create_component(r.$$.fragment),s=space(),a=element("div"),c.c(),attr(i,"id","window-resizer"),attr(i,"class","svelte-ru701"),attr(a,"id","edit-panel-content"),set_style(a,"max-width","inherit"),set_style(a,"width","inherit"),attr(a,"class","svelte-ru701"),toggle_class(a,"isEditing",t[23]),attr(e,"id","edit-panel"),attr(e,"class","svelte-ru701")},m(c,h){insert(c,e,h),f&&f.m(e,null),append(e,n),append(e,i),append(e,o),mount_component(r,e,null),append(e,s),append(e,a),g[l].m(a,null),t[86](a),t[87](e),d=!0,p||(_=listen(i,"mousedown",t[27]),p=!0)},p(t,i){t[11]?f?(f.p(get_if_ctx_2(t),i),2048&i[0]&&transition_in(f,1)):(f=create_if_block_19(get_if_ctx_2(t)),f.c(),transition_in(f,1),f.m(e,n)):f&&(group_outros(),transition_out(f,1,1,(()=>{f=null})),check_outros());const o={};29360128&i[0]&&(o.title=t[23]?`${EDIT_TYPES[t[24]].toSentenceCase()} ${t[22].toSentenceCase()}`:"Map Editor"),8388656&i[0]&&(o.subtitle=t[23]?t[5]?t[4].displayName+" ("+t[4].name+")":t[4].name:null),4&i[0]&&(o.unsavedChanges=t[2]),10485760&i[0]&&(o.icon=t[23]&&!t[21]?"arrow_back":"close"),4&i[0]&&(o.tooltip=t[2]?"You have unsaved changes":null),10485760&i[0]&&(o.buttonTooltip=t[23]&&!t[21]?"Go back":"Close"),r.$set(o);let s=l;l=v(t),l===s?g[l].p(t,i):(group_outros(),transition_out(g[s],1,1,(()=>{g[s]=null})),check_outros(),c=g[l],c?c.p(t,i):(c=g[l]=m[l](t),c.c()),transition_in(c,1),c.m(a,null)),(!d||8388608&i[0])&&toggle_class(a,"isEditing",t[23])},i(n){d||(transition_in(f),transition_in(r.$$.fragment,n),transition_in(c),add_render_callback((()=>{d&&(u&&u.end(1),h=create_in_transition(e,t[29],{}),h.start())})),d=!0)},o(n){transition_out(f),transition_out(r.$$.fragment,n),transition_out(c),h&&h.invalidate(),u=create_out_transition(e,t[29],{}),d=!1},d(n){n&&detach(e),f&&f.d(),destroy_component(r),g[l].d(),t[86](null),t[87](null),n&&u&&u.end(),p=!1,_()}}}function create_if_block_19(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m,g=t[115].toSentenceCase()+"",v=t[115].toLowerCase()+"";return _=new Button({props:{text:"Cancel",icon:"close",flat:"light",ripple:"light"}}),_.$on("click",t[34]),{c(){e=element("div"),n=element("b"),i=text("Adding "),o=text(g),r=space(),s=element("p"),a=text("Begin adding the new "),l=text(v),c=text(" to the map."),h=space(),u=element("div"),u.innerHTML='<div class="arrow svelte-ru701"><span class="svelte-ru701"></span><span class="svelte-ru701"></span><span class="svelte-ru701"></span></div>',d=space(),p=element("div"),create_component(_.$$.fragment),attr(n,"class","subheading svelte-ru701"),set_style(s,"color","white"),set_style(s,"text-align","center"),set_style(s,"margin","12px"),attr(u,"id","arrow_container"),attr(u,"class","svelte-ru701"),set_style(p,"display","flex"),set_style(p,"gap","var(--padding_medium)"),set_style(p,"padding-top","6px"),attr(e,"id","edit-overlay"),attr(e,"class","svelte-ru701")},m(t,f){insert(t,e,f),append(e,n),append(n,i),append(n,o),append(e,r),append(e,s),append(s,a),append(s,l),append(s,c),append(e,h),append(e,u),append(e,d),append(e,p),mount_component(_,p,null),m=!0},p(t,e){(!m||2048&e[0])&&g!==(g=t[115].toSentenceCase()+"")&&set_data(o,g),(!m||2048&e[0])&&v!==(v=t[115].toLowerCase()+"")&&set_data(l,v)},i(t){m||(transition_in(_.$$.fragment,t),f||add_render_callback((()=>{f=create_in_transition(e,fade,{duration:100}),f.start()})),m=!0)},o(t){transition_out(_.$$.fragment,t),m=!1},d(t){t&&detach(e),destroy_component(_)}}}function create_else_block_1(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m,g,v,y,b,k,w=MAPCONFIG?.editTemplates[t[22]]?.[t[25].toLowerCase()]&&(t[2]||t[4]?.unsavedLocation)&&!t[4]?.acceptedSuggestion&&t[25].toLowerCase()!=(t[5]?t[3].displayName:t[3].name).toLowerCase(),x=w&&create_if_block_18(get_if_ctx_1(t));r=new FormGroup({props:{title:"General",icon:"description",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_8]},$$scope:{ctx:t}}});let L=t[5]&&create_if_block_13$1(t),$=t[5]&&create_if_block_12$1(t),M=t[6]&&create_if_block_9$1(t),C=(t[24]==EDIT_TYPES.EDIT||t[24]==EDIT_TYPES.REVERT)&&create_if_block_4$1(t),E={text:t[24]!=EDIT_TYPES.REVERT?"Save":"Revert",icon:t[24]!=EDIT_TYPES.REVERT?"save":"history",type:t[24]!=EDIT_TYPES.REVERT?"save":"revert",bold:"true",ripple:t[24]==EDIT_TYPES.REVERT?"dark":null};p=new Button({props:E}),t[80](p),p.$on("click",t[81]),m=new Button({props:{text:t[2]||t[4]?.unsavedLocation?"Cancel":"Close",icon:"close"}}),m.$on("click",t[82]);let P=(t[6]&&!t[4].unsavedLocation||t[5]&&MAPCONFIG.isAdmin)&&create_if_block_3$1(t);return{c(){e=element("div"),n=element("div"),x&&x.c(),i=space(),o=element("div"),create_component(r.$$.fragment),s=space(),L&&L.c(),a=space(),$&&$.c(),l=space(),M&&M.c(),c=space(),C&&C.c(),h=space(),u=element("footer"),d=element("div"),create_component(p.$$.fragment),_=space(),f=element("div"),create_component(m.$$.fragment),g=space(),P&&P.c(),attr(o,"id","editor_pane"),set_style(o,"max-width","inherit"),set_style(o,"width","inherit"),attr(o,"class","svelte-ru701"),attr(n,"class","editor_window svelte-ru701"),set_style(n,"max-width","inherit"),set_style(n,"width","inherit"),attr(d,"class","footer-buttons svelte-ru701"),attr(f,"class","footer-buttons svelte-ru701"),attr(u,"id","footer"),attr(u,"class","svelte-ru701"),attr(e,"id","editor"),set_style(e,"max-width","inherit"),set_style(e,"width","inherit"),attr(e,"class","svelte-ru701")},m(v,y){insert(v,e,y),append(e,n),x&&x.m(n,null),append(n,i),append(n,o),mount_component(r,o,null),append(o,s),L&&L.m(o,null),append(o,a),$&&$.m(o,null),append(o,l),M&&M.m(o,null),append(o,c),C&&C.m(o,null),t[79](n),append(e,h),append(e,u),append(u,d),mount_component(p,d,null),append(u,_),append(u,f),mount_component(m,f,null),append(f,g),P&&P.m(f,null),t[85](e),k=!0},p(t,e){37748796&e[0]&&(w=MAPCONFIG?.editTemplates[t[22]]?.[t[25].toLowerCase()]&&(t[2]||t[4]?.unsavedLocation)&&!t[4]?.acceptedSuggestion&&t[25].toLowerCase()!=(t[5]?t[3].displayName:t[3].name).toLowerCase()),w?x?(x.p(get_if_ctx_1(t),e),37748796&e[0]&&transition_in(x,1)):(x=create_if_block_18(get_if_ctx_1(t)),x.c(),transition_in(x,1),x.m(n,i)):x&&(group_outros(),transition_out(x,1,1,(()=>{x=null})),check_outros());const s={};16777216&e[0]&&(s.disabled=t[24]==EDIT_TYPES.REVERT),37748848&e[0]|8388608&e[3]&&(s.$$scope={dirty:e,ctx:t}),r.$set(s),t[5]?L?(L.p(t,e),32&e[0]&&transition_in(L,1)):(L=create_if_block_13$1(t),L.c(),transition_in(L,1),L.m(o,a)):L&&(group_outros(),transition_out(L,1,1,(()=>{L=null})),check_outros()),t[5]?$?($.p(t,e),32&e[0]&&transition_in($,1)):($=create_if_block_12$1(t),$.c(),transition_in($,1),$.m(o,l)):$&&(group_outros(),transition_out($,1,1,(()=>{$=null})),check_outros()),t[6]?M?(M.p(t,e),64&e[0]&&transition_in(M,1)):(M=create_if_block_9$1(t),M.c(),transition_in(M,1),M.m(o,c)):M&&(group_outros(),transition_out(M,1,1,(()=>{M=null})),check_outros()),t[24]==EDIT_TYPES.EDIT||t[24]==EDIT_TYPES.REVERT?C?(C.p(t,e),16777216&e[0]&&transition_in(C,1)):(C=create_if_block_4$1(t),C.c(),transition_in(C,1),C.m(o,null)):C&&(group_outros(),transition_out(C,1,1,(()=>{C=null})),check_outros());const h={};16777216&e[0]&&(h.text=t[24]!=EDIT_TYPES.REVERT?"Save":"Revert"),16777216&e[0]&&(h.icon=t[24]!=EDIT_TYPES.REVERT?"save":"history"),16777216&e[0]&&(h.type=t[24]!=EDIT_TYPES.REVERT?"save":"revert"),16777216&e[0]&&(h.ripple=t[24]==EDIT_TYPES.REVERT?"dark":null),p.$set(h);const u={};20&e[0]&&(u.text=t[2]||t[4]?.unsavedLocation?"Cancel":"Close"),m.$set(u),t[6]&&!t[4].unsavedLocation||t[5]&&MAPCONFIG.isAdmin?P?(P.p(t,e),112&e[0]&&transition_in(P,1)):(P=create_if_block_3$1(t),P.c(),transition_in(P,1),P.m(f,null)):P&&(group_outros(),transition_out(P,1,1,(()=>{P=null})),check_outros())},i(n){k||(transition_in(x),transition_in(r.$$.fragment,n),transition_in(L),transition_in($),transition_in(M),transition_in(C),transition_in(p.$$.fragment,n),transition_in(m.$$.fragment,n),transition_in(P),v||add_render_callback((()=>{v=create_in_transition(u,fly,{y:10,duration:250}),v.start()})),add_render_callback((()=>{k&&(b&&b.end(1),y=create_in_transition(e,t[40],{}),y.start())})),k=!0)},o(n){transition_out(x),transition_out(r.$$.fragment,n),transition_out(L),transition_out($),transition_out(M),transition_out(C),transition_out(p.$$.fragment,n),transition_out(m.$$.fragment,n),transition_out(P),y&&y.invalidate(),b=create_out_transition(e,t[34],{}),k=!1},d(n){n&&detach(e),x&&x.d(),destroy_component(r),L&&L.d(),$&&$.d(),M&&M.d(),C&&C.d(),t[79](null),t[80](null),destroy_component(p),destroy_component(m),P&&P.d(),t[85](null),n&&b&&b.end()}}}function create_if_block_1$1(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m,g,v,y,b,k,w,x=t[18];r=new Button({props:{text:"Add Marker",icon:"add_location_alt"}}),r.$on("click",t[46]),a=new Button({props:{text:"Add Path",icon:"polyline"}}),a.$on("click",t[47]),c=new Button({props:{text:"Add Area",icon:"add_circle"}}),c.$on("click",t[48]),u=new Button({props:{text:"Edit World",icon:"public"}}),u.$on("click",t[49]),g=new Icon({props:{name:"refresh",size:"20"}});let L=create_key_block(t);return{c(){e=element("b"),e.textContent="Actions",n=element("br"),i=space(),o=element("div"),create_component(r.$$.fragment),s=space(),create_component(a.$$.fragment),l=space(),create_component(c.$$.fragment),h=space(),create_component(u.$$.fragment),d=space(),p=element("div"),_=element("b"),_.textContent="Recent Changes",f=space(),m=element("div"),create_component(g.$$.fragment),v=space(),y=element("div"),L.c(),attr(e,"class","svelte-ru701"),attr(o,"id","actions-container"),attr(o,"class","svelte-ru701"),attr(_,"class","svelte-ru701"),attr(m,"id","refresh-button"),attr(m,"title","Refresh the Recent Changes list"),attr(m,"class","waves-effect svelte-ru701"),attr(p,"id","recent-changes-titlebar"),attr(p,"class","svelte-ru701"),attr(y,"id","recent-changes-container"),attr(y,"class","svelte-ru701")},m(x,$){insert(x,e,$),insert(x,n,$),insert(x,i,$),insert(x,o,$),mount_component(r,o,null),append(o,s),mount_component(a,o,null),append(o,l),mount_component(c,o,null),append(o,h),mount_component(u,o,null),insert(x,d,$),insert(x,p,$),append(p,_),append(p,f),append(p,m),mount_component(g,m,null),t[50](p),insert(x,v,$),insert(x,y,$),L.m(y,null),b=!0,k||(w=listen(m,"click",t[37]),k=!0)},p(t,e){262144&e[0]&&safe_not_equal(x,x=t[18])?(group_outros(),transition_out(L,1,1,noop),check_outros(),L=create_key_block(t),L.c(),transition_in(L,1),L.m(y,null)):L.p(t,e)},i(t){b||(transition_in(r.$$.fragment,t),transition_in(a.$$.fragment,t),transition_in(c.$$.fragment,t),transition_in(u.$$.fragment,t),transition_in(g.$$.fragment,t),transition_in(L),b=!0)},o(t){transition_out(r.$$.fragment,t),transition_out(a.$$.fragment,t),transition_out(c.$$.fragment,t),transition_out(u.$$.fragment,t),transition_out(g.$$.fragment,t),transition_out(L),b=!1},d(s){s&&detach(e),s&&detach(n),s&&detach(i),s&&detach(o),destroy_component(r),destroy_component(a),destroy_component(c),destroy_component(u),s&&detach(d),s&&detach(p),destroy_component(g),t[50](null),s&&detach(v),s&&detach(y),L.d(s),k=!1,w()}}}function create_if_block_18(t){let e,n;return e=new SuggestionBar({props:{suggestion:t[25].toTitleCase()}}),e.$on("confirm",(function(){return t[54](t[114])})),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(n,i){t=n;const o={};33554432&i[0]&&(o.suggestion=t[25].toTitleCase()),e.$set(o)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_16(t){let e,n,i=t[4].locType!=LOCTYPES.PATH&&create_if_block_17(t);return{c(){i&&i.c(),e=empty()},m(t,o){i&&i.m(t,o),insert(t,e,o),n=!0},p(t,n){t[4].locType!=LOCTYPES.PATH?i?(i.p(t,n),16&n[0]&&transition_in(i,1)):(i=create_if_block_17(t),i.c(),transition_in(i,1),i.m(e.parentNode,e)):i&&(group_outros(),transition_out(i,1,1,(()=>{i=null})),check_outros())},i(t){n||(transition_in(i),n=!0)},o(t){transition_out(i),n=!1},d(t){i&&i.d(t),t&&detach(e)}}}function create_if_block_15$1(t){let e,n;return e=new Textbox({props:{hint:"Parent ID",text:t[4].parentID,tooltip:"Parent world ID",type:"number",subtext:gamemap.isWorldValid(t[4].parentID)?gamemap.getWorldDisplayNameFromID(t[4].parentID):null!=t[4].parentID&&""!=t[4].parentID?"Invalid World ID!":null}}),e.$on("change",t[56]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16&n[0]&&(i.text=t[4].parentID),16&n[0]&&(i.subtext=gamemap.isWorldValid(t[4].parentID)?gamemap.getWorldDisplayNameFromID(t[4].parentID):null!=t[4].parentID&&""!=t[4].parentID?"Invalid World ID!":null),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_17(t){let e,n;return e=new Textbox({props:{hint:"Destination ID",text:t[4].destinationID,subtext:"+ for world, - for location",tooltip:"Location/world destination ID",type:"number"}}),e.$on("change",t[57]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16&n[0]&&(i.text=t[4].destinationID),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_default_slot_11(t){let e,n,i,o,r,s;e=new Textbox({props:{text:t[5]?t[4].displayName:t[4].name,hint:(t[5]?"Display ":"")+"Name",tooltip:t[22].toSentenceCase()+" name",focus:!0}}),e.$on("change",t[55]);const a=[create_if_block_15$1,create_if_block_16],l=[];function c(t,e){return t[5]?0:t[6]?1:-1}return~(i=c(t))&&(o=l[i]=a[i](t)),{c(){create_component(e.$$.fragment),n=space(),o&&o.c(),r=empty()},m(t,o){mount_component(e,t,o),insert(t,n,o),~i&&l[i].m(t,o),insert(t,r,o),s=!0},p(t,n){const s={};48&n[0]&&(s.text=t[5]?t[4].displayName:t[4].name),32&n[0]&&(s.hint=(t[5]?"Display ":"")+"Name"),4194304&n[0]&&(s.tooltip=t[22].toSentenceCase()+" name"),e.$set(s);let h=i;i=c(t),i===h?~i&&l[i].p(t,n):(o&&(group_outros(),transition_out(l[h],1,1,(()=>{l[h]=null})),check_outros()),~i?(o=l[i],o?o.p(t,n):(o=l[i]=a[i](t),o.c()),transition_in(o,1),o.m(r.parentNode,r)):o=null)},i(t){s||(transition_in(e.$$.fragment,t),transition_in(o),s=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(o),s=!1},d(t){destroy_component(e,t),t&&detach(n),~i&&l[i].d(t),t&&detach(r)}}}function create_default_slot_10(t){let e,n;return e=new Textbox({props:{label:"Wiki Page",text:t[4].wikiPage,placeholder:"Enter wiki page...",tooltip:"Wiki page name"}}),e.$on("change",t[59]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16&n[0]&&(i.text=t[4].wikiPage),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_14$1(t){let e,n;return e=new DropdownMenu({props:{label:"Label Direction",hint:"Select label direction...",align:"right",selected:t[4].labelPos,$$slots:{default:[create_default_slot_9]},$$scope:{ctx:t}}}),e.$on("change",t[61]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16&n[0]&&(i.selected=t[4].labelPos),16&n[0]|8388608&n[3]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_each_block_1(t){let e,n,i,o=t[111].toSentenceCase()+"";return{c(){e=element("option"),n=text(o),e.__value=t[109][t[113]],e.value=e.__value,e.selected=i=t[4].labelPos==t[109][t[113]]},m(t,i){insert(t,e,i),append(e,n)},p(t,n){16&n[0]&&i!==(i=t[4].labelPos==t[109][t[113]])&&(e.selected=i)},d(t){t&&detach(e)}}}function create_default_slot_9(t){let e,n=t[110],i=[];for(let e=0;e<n.length;e+=1)i[e]=create_each_block_1(get_each_context_1(t,n,e));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=empty()},m(t,n){for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,n);insert(t,e,n)},p(t,o){if(16&o[0]){let r;for(n=t[110],r=0;r<n.length;r+=1){const s=get_each_context_1(t,n,r);i[r]?i[r].p(s,o):(i[r]=create_each_block_1(s),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){destroy_each(i,t),t&&detach(e)}}}function create_default_slot_8(t){let e,n,i,o,r,s,a,l;n=new AvatarComponent({props:{icon:t[4].icon,locType:t[4].locType,isWorld:t[5],$$slots:{default:[create_default_slot_11]},$$scope:{ctx:t}}}),n.$on("change",t[58]),o=new Switch({props:{enabled:t[4].linkWikiPage(),label:"Use "+(t[5]?"Display Name":"Name")+" as Wiki Page",tooltip:`Use this ${t[22]}'s ${t[5]?"display name":"name"} as its wiki page`,$$slots:{default:[create_default_slot_10]},$$scope:{ctx:t}}}),o.$on("change",t[60]);let c=t[4].locType!=LOCTYPES.PATH&&t[6]&&create_if_block_14$1(get_if_ctx(t));return a=new Textbox({props:{label:"Description",text:t[4].description,placeholder:"Enter description...",tooltip:"Description of this "+t[22],textArea:"true"}}),a.$on("change",t[62]),{c(){e=element("header"),create_component(n.$$.fragment),i=space(),create_component(o.$$.fragment),r=space(),c&&c.c(),s=space(),create_component(a.$$.fragment),attr(e,"class","header")},m(t,h){insert(t,e,h),mount_component(n,e,null),insert(t,i,h),mount_component(o,t,h),insert(t,r,h),c&&c.m(t,h),insert(t,s,h),mount_component(a,t,h),l=!0},p(t,e){const i={};16&e[0]&&(i.icon=t[4].icon),16&e[0]&&(i.locType=t[4].locType),32&e[0]&&(i.isWorld=t[5]),4194416&e[0]|8388608&e[3]&&(i.$$scope={dirty:e,ctx:t}),n.$set(i);const r={};16&e[0]&&(r.enabled=t[4].linkWikiPage()),32&e[0]&&(r.label="Use "+(t[5]?"Display Name":"Name")+" as Wiki Page"),4194336&e[0]&&(r.tooltip=`Use this ${t[22]}'s ${t[5]?"display name":"name"} as its wiki page`),33554448&e[0]|8388608&e[3]&&(r.$$scope={dirty:e,ctx:t}),o.$set(r),t[4].locType!=LOCTYPES.PATH&&t[6]?c?(c.p(get_if_ctx(t),e),80&e[0]&&transition_in(c,1)):(c=create_if_block_14$1(get_if_ctx(t)),c.c(),transition_in(c,1),c.m(s.parentNode,s)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros());const l={};16&e[0]&&(l.text=t[4].description),4194304&e[0]&&(l.tooltip="Description of this "+t[22]),a.$set(l)},i(t){l||(transition_in(n.$$.fragment,t),transition_in(o.$$.fragment,t),transition_in(c),transition_in(a.$$.fragment,t),l=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(o.$$.fragment,t),transition_out(c),transition_out(a.$$.fragment,t),l=!1},d(t){t&&detach(e),destroy_component(n),t&&detach(i),destroy_component(o,t),t&&detach(r),c&&c.d(t),t&&detach(s),destroy_component(a,t)}}}function create_if_block_13$1(t){let e,n;return e=new FormGroup({props:{title:"Zoom",icon:"zoom_in",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_7]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16777216&n[0]&&(i.disabled=t[24]==EDIT_TYPES.REVERT),16&n[0]|8388608&n[3]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_default_slot_7(t){let e,n,i,o,r;return n=new Textbox({props:{text:t[4].minZoomLevel,type:"number",hint:"Min Zoom",tooltip:"Minimum zoom level for this world",min:"0"}}),n.$on("change",t[63]),o=new Textbox({props:{text:t[4].maxZoomLevel,type:"number",hint:"Max Zoom",tooltip:"Maximum zoom level for this world",min:"0"}}),o.$on("change",t[64]),{c(){e=element("div"),create_component(n.$$.fragment),i=space(),create_component(o.$$.fragment),attr(e,"class","row svelte-ru701")},m(t,s){insert(t,e,s),mount_component(n,e,null),append(e,i),mount_component(o,e,null),r=!0},p(t,e){const i={};16&e[0]&&(i.text=t[4].minZoomLevel),n.$set(i);const r={};16&e[0]&&(r.text=t[4].maxZoomLevel),o.$set(r)},i(t){r||(transition_in(n.$$.fragment,t),transition_in(o.$$.fragment,t),r=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(o.$$.fragment,t),r=!1},d(t){t&&detach(e),destroy_component(n),destroy_component(o)}}}function create_if_block_12$1(t){let e,n;return e=new FormGroup({props:{title:"Bounds",icon:"crop_free",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_6]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16777216&n[0]&&(i.disabled=t[24]==EDIT_TYPES.REVERT),16&n[0]|8388608&n[3]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_default_slot_6(t){let e,n,i,o,r,s,a,l,c,h;return n=new Textbox({props:{text:t[4].minX,hint:"Minimum X",type:"number",hideSpinner:!0,tooltip:"Minimum X bounds for this world"}}),n.$on("change",t[65]),o=new Textbox({props:{text:t[4].maxX,hint:"Maximum X",type:"number",hideSpinner:!0,tooltip:"Maximum X bounds for this world"}}),o.$on("change",t[66]),a=new Textbox({props:{text:t[4].minY,hint:"Minimum Y",type:"number",hideSpinner:!0,tooltip:"Minimum Y bounds for this world"}}),a.$on("change",t[67]),c=new Textbox({props:{text:t[4].maxY,hint:"Maximum Y",type:"number",hideSpinner:!0,tooltip:"Maximum Y bounds for this world"}}),c.$on("change",t[68]),{c(){e=element("div"),create_component(n.$$.fragment),i=space(),create_component(o.$$.fragment),r=space(),s=element("div"),create_component(a.$$.fragment),l=space(),create_component(c.$$.fragment),attr(e,"class","row svelte-ru701"),attr(s,"class","row svelte-ru701")},m(t,u){insert(t,e,u),mount_component(n,e,null),append(e,i),mount_component(o,e,null),insert(t,r,u),insert(t,s,u),mount_component(a,s,null),append(s,l),mount_component(c,s,null),h=!0},p(t,e){const i={};16&e[0]&&(i.text=t[4].minX),n.$set(i);const r={};16&e[0]&&(r.text=t[4].maxX),o.$set(r);const s={};16&e[0]&&(s.text=t[4].minY),a.$set(s);const l={};16&e[0]&&(l.text=t[4].maxY),c.$set(l)},i(t){h||(transition_in(n.$$.fragment,t),transition_in(o.$$.fragment,t),transition_in(a.$$.fragment,t),transition_in(c.$$.fragment,t),h=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(o.$$.fragment,t),transition_out(a.$$.fragment,t),transition_out(c.$$.fragment,t),h=!1},d(t){t&&detach(e),destroy_component(n),destroy_component(o),t&&detach(r),t&&detach(s),destroy_component(a),destroy_component(c)}}}function create_if_block_9$1(t){let e,n;return e=new FormGroup({props:{title:"Display",icon:"light_mode",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_5]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16777216&n[0]&&(i.disabled=t[24]==EDIT_TYPES.REVERT),1048592&n[0]|8388608&n[3]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_10$1(t){let e,n,i,o,r,s,a,l,c,h,u,d;e=new ColourPreview({props:{data:t[4]}});let p=t[4].locType==LOCTYPES.AREA&&create_if_block_11$1(t);return o=new ColourPicker({props:{label:"Stroke Colour",colour:t[4].strokeColour,placeholder:"Enter stroke colour...",tooltip:"Default stroke colour for this location"}}),o.$on("change",t[71]),s=new ColourPicker({props:{label:"Stroke Colour (Hover)",colour:t[4].strokeColourHover,placeholder:"Enter hovered stroke colour...",tooltip:"Hovered stroke colour for this location"}}),s.$on("change",t[72]),c=new Textbox({props:{text:t[4].strokeWidth,label:"Stroke Width",hint:"",column:!0,type:"number",tooltip:"Default stroke width for this location"}}),c.$on("change",t[73]),u=new Textbox({props:{text:t[4].strokeWidthHover,label:"Stroke Width (Hover)",hint:"",column:!0,type:"number",tooltip:"Hovered stroke width for this location"}}),u.$on("change",t[74]),{c(){create_component(e.$$.fragment),n=space(),p&&p.c(),i=space(),create_component(o.$$.fragment),r=space(),create_component(s.$$.fragment),a=space(),l=element("div"),create_component(c.$$.fragment),h=space(),create_component(u.$$.fragment),attr(l,"class","row svelte-ru701")},m(t,_){mount_component(e,t,_),insert(t,n,_),p&&p.m(t,_),insert(t,i,_),mount_component(o,t,_),insert(t,r,_),mount_component(s,t,_),insert(t,a,_),insert(t,l,_),mount_component(c,l,null),append(l,h),mount_component(u,l,null),d=!0},p(t,n){const r={};16&n[0]&&(r.data=t[4]),e.$set(r),t[4].locType==LOCTYPES.AREA?p?(p.p(t,n),16&n[0]&&transition_in(p,1)):(p=create_if_block_11$1(t),p.c(),transition_in(p,1),p.m(i.parentNode,i)):p&&(group_outros(),transition_out(p,1,1,(()=>{p=null})),check_outros());const a={};16&n[0]&&(a.colour=t[4].strokeColour),o.$set(a);const l={};16&n[0]&&(l.colour=t[4].strokeColourHover),s.$set(l);const h={};16&n[0]&&(h.text=t[4].strokeWidth),c.$set(h);const d={};16&n[0]&&(d.text=t[4].strokeWidthHover),u.$set(d)},i(t){d||(transition_in(e.$$.fragment,t),transition_in(p),transition_in(o.$$.fragment,t),transition_in(s.$$.fragment,t),transition_in(c.$$.fragment,t),transition_in(u.$$.fragment,t),d=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(p),transition_out(o.$$.fragment,t),transition_out(s.$$.fragment,t),transition_out(c.$$.fragment,t),transition_out(u.$$.fragment,t),d=!1},d(t){destroy_component(e,t),t&&detach(n),p&&p.d(t),t&&detach(i),destroy_component(o,t),t&&detach(r),destroy_component(s,t),t&&detach(a),t&&detach(l),destroy_component(c),destroy_component(u)}}}function create_if_block_11$1(t){let e,n,i,o;return e=new ColourPicker({props:{label:"Fill Colour",colour:t[4].fillColour,placeholder:"Enter fill colour...",tooltip:"Default fill colour for this location"}}),e.$on("change",t[69]),i=new ColourPicker({props:{label:"Fill Colour (Hover)",colour:t[4].fillColourHover,placeholder:"Enter hovered fill colour...",tooltip:"Hovered fill colour for this location"}}),i.$on("change",t[70]),{c(){create_component(e.$$.fragment),n=space(),create_component(i.$$.fragment)},m(t,r){mount_component(e,t,r),insert(t,n,r),mount_component(i,t,r),o=!0},p(t,n){const o={};16&n[0]&&(o.colour=t[4].fillColour),e.$set(o);const r={};16&n[0]&&(r.colour=t[4].fillColourHover),i.$set(r)},i(t){o||(transition_in(e.$$.fragment,t),transition_in(i.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(i.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(n),destroy_component(i,t)}}}function create_default_slot_5(t){let e,n,i,o=t[4].isPolygon(),r=o&&create_if_block_10$1(t);return n=new Textbox({props:{label:"Display Level",text:t[4].displayLevel,placeholder:"Enter display level...",tooltip:"Zoom level at which this location will appear",type:"number",subtext:"Current zoom is "+t[20],min:gamemap.getCurrentWorld().minZoomLevel,max:gamemap.getCurrentWorld().maxZoomLevel}}),n.$on("change",t[75]),{c(){r&&r.c(),e=space(),create_component(n.$$.fragment)},m(t,o){r&&r.m(t,o),insert(t,e,o),mount_component(n,t,o),i=!0},p(t,i){16&i[0]&&(o=t[4].isPolygon()),o?r?(r.p(t,i),16&i[0]&&transition_in(r,1)):(r=create_if_block_10$1(t),r.c(),transition_in(r,1),r.m(e.parentNode,e)):r&&(group_outros(),transition_out(r,1,1,(()=>{r=null})),check_outros());const s={};16&i[0]&&(s.text=t[4].displayLevel),1048576&i[0]&&(s.subtext="Current zoom is "+t[20]),n.$set(s)},i(t){i||(transition_in(r),transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(r),transition_out(n.$$.fragment,t),i=!1},d(t){r&&r.d(t),t&&detach(e),destroy_component(n,t)}}}function create_if_block_4$1(t){let e,n,i,o=t[3].id>0&&t[3].revisionID>0&&create_if_block_7$1(t);return n=new FormGroup({props:{title:"Info",icon:"info",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_3]},$$scope:{ctx:t}}}),{c(){o&&o.c(),e=space(),create_component(n.$$.fragment)},m(t,r){o&&o.m(t,r),insert(t,e,r),mount_component(n,t,r),i=!0},p(t,i){t[3].id>0&&t[3].revisionID>0?o?(o.p(t,i),8&i[0]&&transition_in(o,1)):(o=create_if_block_7$1(t),o.c(),transition_in(o,1),o.m(e.parentNode,e)):o&&(group_outros(),transition_out(o,1,1,(()=>{o=null})),check_outros());const r={};16777216&i[0]&&(r.disabled=t[24]==EDIT_TYPES.REVERT),4194416&i[0]|8388608&i[3]&&(r.$$scope={dirty:i,ctx:t}),n.$set(r)},i(t){i||(transition_in(o),transition_in(n.$$.fragment,t),i=!0)},o(t){transition_out(o),transition_out(n.$$.fragment,t),i=!1},d(t){o&&o.d(t),t&&detach(e),destroy_component(n,t)}}}function create_if_block_7$1(t){let e,n;return e=new FormGroup({props:{title:"Edit History",icon:"history",tooltip:"Shows the up to 5 of the most recent edits",$$slots:{default:[create_default_slot_4]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};524304&n[0]|8388608&n[3]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_else_block_2(t){let e,n;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p:noop,i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_8$1(t){let e,n,i=t[19],o=[];for(let e=0;e<i.length;e+=1)o[e]=create_each_block$1(get_each_context$1(t,i,e));const r=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=empty()},m(t,i){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,i);insert(t,e,i),n=!0},p(t,n){if(524304&n[0]|129&n[1]){let s;for(i=t[19],s=0;s<i.length;s+=1){const r=get_each_context$1(t,i,s);o[s]?(o[s].p(r,n),transition_in(o[s],1)):(o[s]=create_each_block$1(r),o[s].c(),transition_in(o[s],1),o[s].m(e.parentNode,e))}for(group_outros(),s=i.length;s<o.length;s+=1)r(s);check_outros()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)transition_in(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);n=!1},d(t){destroy_each(o,t),t&&detach(e)}}}function create_each_block$1(t){let e,n;const i=[t[105],{title:t[105].name},{bold:t[105].isWorld},{compact:!0},{selected:t[106]},{tooltip:t[106]?"This is the current revision":""}];let o={};for(let t=0;t<i.length;t+=1)o=assign(o,i[t]);return e=new ListItem({props:o}),e.$on("click",(function(){return t[76](t[105])})),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(n,o){t=n;const r=524304&o[0]|128&o[1]?get_spread_update(i,[524288&o[0]|128&o[1]&&get_spread_object(t[105]),524288&o[0]|128&o[1]&&{title:t[105].name},524288&o[0]|128&o[1]&&{bold:t[105].isWorld},i[3],524304&o[0]&&{selected:t[106]},524304&o[0]&&{tooltip:t[106]?"This is the current revision":""}]):{};e.$set(r)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_default_slot_4(t){let e,n,i,o;get_context_1(t);const r=[create_if_block_8$1,create_else_block_2],s=[];function a(t,e){return t[19].length>0?0:1}return e=a(t),n=s[e]=r[e](t),{c(){n.c(),i=empty()},m(t,n){s[e].m(t,n),insert(t,i,n),o=!0},p(t,o){get_context_1(t);let l=e;e=a(t),e===l?s[e].p(t,o):(group_outros(),transition_out(s[l],1,1,(()=>{s[l]=null})),check_outros(),n=s[e],n?n.p(t,o):(n=s[e]=r[e](t),n.c()),transition_in(n,1),n.m(i.parentNode,i))},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){s[e].d(t),t&&detach(i)}}}function create_if_block_6$1(t){let e,n,i,o;return e=new InfoTextPair({props:{name:"World Name",value:t[4].name,tooltip:"This world's internal name"}}),i=new InfoTextPair({props:{name:"Tiles",value:`${t[4].dbNumTilesX} x ${t[4].dbNumTilesY}`,tooltip:"Number of tiles at full zoom"}}),{c(){create_component(e.$$.fragment),n=space(),create_component(i.$$.fragment)},m(t,r){mount_component(e,t,r),insert(t,n,r),mount_component(i,t,r),o=!0},p(t,n){const o={};16&n[0]&&(o.value=t[4].name),e.$set(o);const r={};16&n[0]&&(r.value=`${t[4].dbNumTilesX} x ${t[4].dbNumTilesY}`),i.$set(r)},i(t){o||(transition_in(e.$$.fragment,t),transition_in(i.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(i.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(n),destroy_component(i,t)}}}function create_if_block_5$1(t){let e,n,i,o,r,s;return e=new InfoTextPair({props:{name:"Location Type",value:Object.keys(LOCTYPES).find(t[77]).toLowerCase(),tooltip:"The type of location this is"}}),i=new InfoTextPair({props:{name:"In World",value:gamemap.getWorldNameFromID(t[4].worldID),tooltip:"The world this location is in"}}),r=new InfoTextPair({props:{name:"Position",value:`X: ${t[4]?.getCentre()?.x}, Y: ${t[4]?.getCentre()?.y}`,tooltip:"This location's coordinates"}}),{c(){create_component(e.$$.fragment),n=space(),create_component(i.$$.fragment),o=space(),create_component(r.$$.fragment)},m(t,a){mount_component(e,t,a),insert(t,n,a),mount_component(i,t,a),insert(t,o,a),mount_component(r,t,a),s=!0},p(t,n){const o={};16&n[0]&&(o.value=Object.keys(LOCTYPES).find(t[77]).toLowerCase()),e.$set(o);const s={};16&n[0]&&(s.value=gamemap.getWorldNameFromID(t[4].worldID)),i.$set(s);const a={};16&n[0]&&(a.value=`X: ${t[4]?.getCentre()?.x}, Y: ${t[4]?.getCentre()?.y}`),r.$set(a)},i(t){s||(transition_in(e.$$.fragment,t),transition_in(i.$$.fragment,t),transition_in(r.$$.fragment,t),s=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(i.$$.fragment,t),transition_out(r.$$.fragment,t),s=!1},d(t){destroy_component(e,t),t&&detach(n),destroy_component(i,t),t&&detach(o),destroy_component(r,t)}}}function create_default_slot_3(t){let e,n,i,o,r,s,a,l;e=new InfoTextPair({props:{name:t[22].toSentenceCase()+" ID",value:t[4].id,tooltip:"This "+t[22]+"'s ID"}});let c=t[5]&&create_if_block_6$1(t),h=t[6]&&create_if_block_5$1(t);return r=new InfoTextPair({props:{name:"Coord Type",value:Object.keys(COORD_TYPES).find(t[78]).toLowerCase(),tooltip:"Coordinate system that this "+t[22]+" is using"}}),a=new InfoTextPair({props:{name:"Revision ID",value:t[4].revisionID,tooltip:"Current revision ID"}}),{c(){create_component(e.$$.fragment),n=space(),c&&c.c(),i=space(),h&&h.c(),o=space(),create_component(r.$$.fragment),s=space(),create_component(a.$$.fragment)},m(t,u){mount_component(e,t,u),insert(t,n,u),c&&c.m(t,u),insert(t,i,u),h&&h.m(t,u),insert(t,o,u),mount_component(r,t,u),insert(t,s,u),mount_component(a,t,u),l=!0},p(t,n){const s={};4194304&n[0]&&(s.name=t[22].toSentenceCase()+" ID"),16&n[0]&&(s.value=t[4].id),4194304&n[0]&&(s.tooltip="This "+t[22]+"'s ID"),e.$set(s),t[5]?c?(c.p(t,n),32&n[0]&&transition_in(c,1)):(c=create_if_block_6$1(t),c.c(),transition_in(c,1),c.m(i.parentNode,i)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros()),t[6]?h?(h.p(t,n),64&n[0]&&transition_in(h,1)):(h=create_if_block_5$1(t),h.c(),transition_in(h,1),h.m(o.parentNode,o)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros());const l={};4194304&n[0]&&(l.tooltip="Coordinate system that this "+t[22]+" is using"),r.$set(l);const u={};16&n[0]&&(u.value=t[4].revisionID),a.$set(u)},i(t){l||(transition_in(e.$$.fragment,t),transition_in(c),transition_in(h),transition_in(r.$$.fragment,t),transition_in(a.$$.fragment,t),l=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(c),transition_out(h),transition_out(r.$$.fragment,t),transition_out(a.$$.fragment,t),l=!1},d(t){destroy_component(e,t),t&&detach(n),c&&c.d(t),t&&detach(i),h&&h.d(t),t&&detach(o),destroy_component(r,t),t&&detach(s),destroy_component(a,t)}}}function create_if_block_3$1(t){let e,n;return e=new Button({props:{text:"Delete",icon:"delete",disabled:t[24]==EDIT_TYPES.REVERT||t[5]&&t[3].id==MAPCONFIG.defaultWorldID,type:"delete"}}),e.$on("click",t[83]),e.$on("shiftClick",t[84]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};16777256&n[0]&&(i.disabled=t[24]==EDIT_TYPES.REVERT||t[5]&&t[3].id==MAPCONFIG.defaultWorldID),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_else_block(t){let e,n;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p:noop,i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_2$1(t){let e,n;return e=new VirtualList({props:{width:"100%",height:t[14]-(t[13]?.getBoundingClientRect()?.bottom+10),itemCount:t[18].length,scrollToIndex:1,itemSize:60,$$slots:{item:[create_item_slot,({style:t,index:e})=>({100:t,101:e}),({style:t,index:e})=>[0,0,0,(t?128:0)|(e?256:0)]]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};24576&n[0]&&(i.height=t[14]-(t[13]?.getBoundingClientRect()?.bottom+10)),262144&n[0]&&(i.itemCount=t[18].length),262144&n[0]|8388992&n[3]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_item_slot(t){let e,n,i,o;get_context(t);const r=[t[102],{title:t[102].name},{bold:t[102].isWorld},{compact:!0}];let s={};for(let t=0;t<r.length;t+=1)s=assign(s,r[t]);return n=new ListItem({props:s}),n.$on("shiftClick",(function(){return t[51](t[102])})),n.$on("click",(function(){return t[52](t[102])})),n.$on("middleClick",t[53]),{c(){e=element("div"),create_component(n.$$.fragment),attr(e,"slot","item"),attr(e,"style",i=t[100])},m(t,i){insert(t,e,i),mount_component(n,e,null),o=!0},p(s,a){get_context(t=s);const l=262144&a[0]|256&a[3]?get_spread_update(r,[get_spread_object(t[102]),{title:t[102].name},{bold:t[102].isWorld},r[3]]):{};n.$set(l),(!o||128&a[3]&&i!==(i=t[100]))&&attr(e,"style",i)},i(t){o||(transition_in(n.$$.fragment,t),o=!0)},o(t){transition_out(n.$$.fragment,t),o=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_key_block(t){let e,n,i,o;const r=[create_if_block_2$1,create_else_block],s=[];function a(t,e){return t[18].length>0?0:1}return e=a(t),n=s[e]=r[e](t),{c(){n.c(),i=empty()},m(t,n){s[e].m(t,n),insert(t,i,n),o=!0},p(t,o){let l=e;e=a(t),e===l?s[e].p(t,o):(group_outros(),transition_out(s[l],1,1,(()=>{s[l]=null})),check_outros(),n=s[e],n?n.p(t,o):(n=s[e]=r[e](t),n.c()),transition_in(n,1),n.m(i.parentNode,i))},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){s[e].d(t),t&&detach(i)}}}function create_default_slot_2$1(t){let e;return{c(){e=text("Are you sure you want to discard your unsaved changes? This can't be undone.")},m(t,n){insert(t,e,n)},d(t){t&&detach(e)}}}function create_default_slot_1$1(t){let e,n,i;return{c(){e=text("Are you sure you want to load an older revision of this "),n=text(t[22]),i=text("? This will replace your current edits.")},m(t,o){insert(t,e,o),insert(t,n,o),insert(t,i,o)},p(t,e){4194304&e[0]&&set_data(n,t[22])},d(t){t&&detach(e),t&&detach(n),t&&detach(i)}}}function create_default_slot$1(t){let e,n,i,o,r,s;return{c(){e=text("Are you sure you want to delete this "),n=text(t[22]),i=text("? This can't be undone.\n        "),o=element("br"),r=space(),s=element("small"),s.innerHTML='<b style="font-size: 0.8rem;" class="svelte-ru701">Tip:</b> Hold <code>Shift</code> while deleting to skip this message.',set_style(s,"color","var(--text_low_emphasis)")},m(t,a){insert(t,e,a),insert(t,n,a),insert(t,i,a),insert(t,o,a),insert(t,r,a),insert(t,s,a)},p(t,e){4194304&e[0]&&set_data(n,t[22])},d(t){t&&detach(e),t&&detach(n),t&&detach(i),t&&detach(o),t&&detach(r),t&&detach(s)}}}function create_fragment$1(t){let e,n,i,o,r,s,a,l,c;add_render_callback(t[44]);let h=t[0]&&create_if_block(t);n=new Dialog({props:{title:"Discard changes?",confirm:!0,$$slots:{default:[create_default_slot_2$1]},$$scope:{ctx:t}}}),t[88](n),o=new Dialog({props:{title:"Load older revision?",dismissible:!1,confirm:!0,$$slots:{default:[create_default_slot_1$1]},$$scope:{ctx:t}}}),t[89](o);let u={title:"Delete "+t[22]+"?",dismissible:!1,confirm:!0,$$slots:{default:[create_default_slot$1]},$$scope:{ctx:t}};return s=new Dialog({props:u}),t[90](s),s.$on("confirm",t[91]),{c(){h&&h.c(),e=space(),create_component(n.$$.fragment),i=space(),create_component(o.$$.fragment),r=space(),create_component(s.$$.fragment)},m(u,d){h&&h.m(u,d),insert(u,e,d),mount_component(n,u,d),insert(u,i,d),mount_component(o,u,d),insert(u,r,d),mount_component(s,u,d),a=!0,l||(c=[listen(window_1$1,"resize",t[43]),listen(window_1$1,"mouseup",t[28]),listen(window_1$1,"keyup",t[39]),listen(window_1$1,"resize",t[44])],l=!0)},p(t,i){t[0]?h?(h.p(t,i),1&i[0]&&transition_in(h,1)):(h=create_if_block(t),h.c(),transition_in(h,1),h.m(e.parentNode,e)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros());const r={};8388608&i[3]&&(r.$$scope={dirty:i,ctx:t}),n.$set(r);const a={};4194304&i[0]|8388608&i[3]&&(a.$$scope={dirty:i,ctx:t}),o.$set(a);const l={};4194304&i[0]&&(l.title="Delete "+t[22]+"?"),4194304&i[0]|8388608&i[3]&&(l.$$scope={dirty:i,ctx:t}),s.$set(l)},i(t){a||(transition_in(h),transition_in(n.$$.fragment,t),transition_in(o.$$.fragment,t),transition_in(s.$$.fragment,t),a=!0)},o(t){transition_out(h),transition_out(n.$$.fragment,t),transition_out(o.$$.fragment,t),transition_out(s.$$.fragment,t),a=!1},d(a){h&&h.d(a),a&&detach(e),t[88](null),destroy_component(n,a),a&&detach(i),t[89](null),destroy_component(o,a),a&&detach(r),t[90](null),destroy_component(s,a),l=!1,run_all(c)}}}const ANIMATION_DURATION=350,MIN_PANEL_WIDTH=350,MAX_PANEL_WIDTH=700,DEBOUNCE_AMOUNT=75;function instance$1($$self,$$props,$$invalidate){let isLocation,isWorld,objectType,isEditing,name,editType,PANEL_WIDTH=getPrefs("editpanelwidth",480);const RESIZE_OBSERVER=new ResizeObserver((()=>{window.dispatchEvent(new Event("resize"))}));let{shown:shown=!1}=$$props,editPanel,editPanelContent,editor,editorWindow,overlay=null,saveButton,refreshTitleBar,innerHeight,discardDialog,deleteDialog,revertDialog,recentChanges=[],editHistory=[],currentZoom=gamemap.getCurrentZoom()?.toFixed(3),liveEdit=!1,directEdit=null,unsavedChanges=!1,editObject=null,modEditObject=null,timer;function edit(t){show(t),$$invalidate(11,overlay=null)}function dismiss(){show(!1),window.onbeforeunload=null}function show(t){(t=null==t||t)?(null==directEdit&&(!shown&&t&&(1==t?$$invalidate(21,directEdit=!1):1!=t&&$$invalidate(21,directEdit=!0)),print("direct edit is: "+directEdit)),$$invalidate(0,shown=!0),setTimeout((function(){RESIZE_OBSERVER.observe(editPanel),0==recentChanges.length&&getRecentChanges()}),1),1!=t&&null==editObject?initEditor(t):1!=t&&editObject&&(unsavedChanges?discardDialog.showWithCallback((e=>{"confirm"==e&&initEditor(t)})):initEditor(t))):($$invalidate(0,shown=!1),$$invalidate(3,editObject=null),$$invalidate(21,directEdit=null))}function back(t){t=null!=t&&t,isEditing?(unsavedChanges&&!t&&discardDialog.showWithCallback((t=>{print(t),"confirm"==t&&back(!0)})),!t&&unsavedChanges||cancel()):dismiss()}function onResizerDown(){document.addEventListener("mousemove",onResizerDrag)}function onResizerUp(){document.removeEventListener("mousemove",onResizerDrag)}function onResizerDrag(t){let e=window.innerWidth-t.pageX;e=e<MIN_PANEL_WIDTH?MIN_PANEL_WIDTH:e,e<MAX_PANEL_WIDTH&&($$invalidate(7,editPanel.style.width=`${e}px`,editPanel),$$invalidate(7,editPanel.style.maxWidth=`${e}px`,editPanel),setPrefs("editpanelwidth",e),PANEL_WIDTH=getPrefs("editpanelwidth",480))}function slide(){return gamemap.getMapObject().invalidateSize(),{duration:ANIMATION_DURATION,easing:cubicInOut,css:t=>(1==t&&$$invalidate(7,editPanel.style.width=`${PANEL_WIDTH}px`,editPanel),`width: ${PANEL_WIDTH*t}px; opacity: ${t};)`)}}function initEditor(t){cleanUp(),$$invalidate(3,editObject=deepClone(t)),$$invalidate(4,modEditObject=deepClone(t)),$$invalidate(6,isLocation=editObject instanceof Location),$$invalidate(5,isWorld=editObject instanceof World),setTimeout((()=>{liveEdit=!0}),10),editObject.unsavedLocation||getEditHistory(editObject),editObject.setEditing(!0),modEditObject.setEditing(!0),isWorld&&editObject.id==gamemap.getCurrentWorld().id?(gamemap.reset(!0,30),gamemap.setMapLock(MAPLOCK.FULL)):isLocation&&(gamemap.setMapLock(modEditObject.isPolygon()?MAPLOCK.PARTIAL_POLYGON:MAPLOCK.PARTIAL_MARKER),gamemap.updateLocation(modEditObject))}function doDelete(t){if(t=null!=t&&t){print(`deleting ${objectType}...`),isLocation&&gamemap.deleteLocation(modEditObject),isWorld&&gamemap.deleteWorld(modEditObject);let t=queryify(objectify(modEditObject.getDeleteQuery()));getJSON(GAME_DATA_SCRIPT+t).then((()=>getRecentChanges())),cancel()}else deleteDialog.show()}function loadRevision(t,e){e=null!=e&&e,t.rev.id=0!=t.rev.locationId?t.rev.locationId:t.rev.worldId,t.rev.revertId=t.rev.revisionId;let n=t.isWorld?new World(t.rev):new Location(t.rev);print(n),n.revisionID!=editObject.revisionID?unsavedChanges&&!e?revertDialog.showWithCallback((e=>{"confirm"==e&&loadRevision(t,!0)})):unsavedChanges&&!e||(gamemap.getMap().pm.disableDraw(),gamemap.getMap().pm.disableGlobalEditMode(),n.editing=!0,$$invalidate(4,modEditObject=deepClone(n)),$$invalidate(2,unsavedChanges=!1),modify()):modEditObject.revisionID==n.revisionID?M.toast({html:"That is the current revision!"}):($$invalidate(4,modEditObject=deepClone(editObject)),$$invalidate(2,unsavedChanges=!1),modify())}function doSave(){let t=null!=modEditObject.revertID;print(`${t?"Reverting":"Saving"} ${objectType}...`);let e=objectify(t?modEditObject.getRevertQuery():modEditObject.getSaveQuery());saveButton.$set({text:""+(t?"Reverting...":"Saving..."),icon:"loading",loading:!0}),print(e),getJSON((GAME_DATA_SCRIPT+queryify(e)).replace(/=\s*$/,"")).then((e=>{e?.isError?(print(e.errorMsg),saveButton.$set({text:e.errorMsg.includes("permissions")?"Insufficient permissions!":e.errorMsg,icon:"warning"})):(modEditObject?.unsavedLocation?(gamemap.deleteLocation(modEditObject),modify("unsavedLocation",!1),modify("id",e.newLocId)):t&&(modify("revertID",null),isLocation&&(gamemap.deleteLocation(modEditObject),modify("wasVisible",modEditObject?.isVisible()))),modify("revisionID",e?.newRevisionId),$$invalidate(3,editObject=deepClone(modEditObject)),isLocation&&gamemap.updateLocation(editObject),isWorld&&(gamemap.updateWorld(editObject),getWorldLists()),getRecentChanges(),$$invalidate(2,unsavedChanges=!1),saveButton.$set({text:"Save",type:"save",icon:"save"}),cancel())})).catch((()=>saveButton.$set({text:`Error saving ${objectType}!`,icon:"warning"})))}function addNewLocation(t){$$invalidate(11,overlay=t),gamemap.addLocation(t)}function cleanUp(){editObject&&(editObject.setEditing(!1),isWorld?(gamemap.reset(!0),gamemap.updateWorld(editObject)):isLocation&&(editObject?.unsavedLocation?gamemap.deleteLocation(editObject):gamemap.getCurrentWorld().locations.get(editObject.id)&&gamemap.updateLocation(editObject))),$$invalidate(19,editHistory=[]),$$invalidate(11,overlay=null),$$invalidate(3,editObject=null),$$invalidate(4,modEditObject=null),liveEdit=!1,$$invalidate(2,unsavedChanges=!1),gamemap.setMapLock(MAPLOCK.NONE),gamemap.getMap().pm.disableDraw(),gamemap.getMap().pm.disableGlobalEditMode(),Array.from(document.querySelectorAll("[class*='editing']")).forEach((t=>{t.classList.remove("editing")})),window.onbeforeunload=null,gamemap.getMap().closePopup()}function cancel(){if(cleanUp(),directEdit)directEdit&&dismiss();else{let t=setInterval((()=>{let e=document.getElementsByClassName("virtual-list-wrapper")?.[0];if(e?.clientHeight>=1e3&&e.children[0].childElementCount<=4){let t=recentChanges;$$invalidate(18,recentChanges=[]),$$invalidate(18,recentChanges=t)}else clearInterval(t)}),1)}}function modify(t,e){liveEdit&&($$invalidate(4,modEditObject),$$invalidate(3,editObject),t&&(print(`editing ${t} with value ${e}`),$$invalidate(4,modEditObject[t]=e,modEditObject),print("before edit"),print(editObject),print("after edit"),print(modEditObject)),$$invalidate(2,unsavedChanges=!modEditObject.revertID&&!modEditObject.unsavedLocation&&!(JSON.stringify(modEditObject)===JSON.stringify(editObject))),gamemap.setMapLock(isWorld?MAPLOCK.FULL:modEditObject.revertID?MAPLOCK.PARTIAL:modEditObject.isPolygon()?MAPLOCK.PARTIAL_POLYGON:MAPLOCK.PARTIAL_MARKER),null!=timer&&clearTimeout(timer),timer=setTimeout((()=>{isLocation&&gamemap.updateLocation(modEditObject),isWorld&&gamemap.updateWorld(modEditObject)}),DEBOUNCE_AMOUNT))}function fillFromTemplate(template){print("printing template"),print(template);for(let[key,value]of Object.entries(template))key?.startsWith("$")||(isNaN(value)&&value.startsWith("$")?modify(key,eval(value.substring(1))):modify(key,value));modify("acceptedSuggestion",!0)}function getRecentChanges(){print("getting recent changes..."),$$invalidate(18,recentChanges=[]);let t={action:"get_fullrc"};t.db=MAPCONFIG.database,getJSON(GAME_DATA_SCRIPT+queryify(t)).then((t=>{print("parsing data...");let e=[];print(t);for(let n=0;n<t.recentChanges.length;n++)e.push(getRCItem(t.recentChanges[n]));$$invalidate(18,recentChanges=e),print("got recent changes: "),print(recentChanges)}))}function getEditHistory(t){$$invalidate(19,editHistory=[]);let e=isWorld?"world":"loc",n=editObject;getJSON(GAME_DATA_SCRIPT+`?db=${MAPCONFIG.database}&action=get_${e}rev&${e}id=${t.id}`).then((t=>{n==editObject&&$$invalidate(19,editHistory=t.revisions?Object.values(t.revisions):[])}))}function getRCItem(t){let e=null!=t.displayName||null!=t.cellSize,n=e?t.worldId:-t.locationId;return{icon:0!=t.iconType&&t.iconType?MAPCONFIG.iconPath+t.iconType+".png":e?"public":"location_on",editID:t.id,user:t.editUserText,timestamp:t.editTimestamp,destinationID:n,name:e?t.worldDisplayName??(t.displayName?t.displayName:gamemap.getWorldDisplayNameFromID(t.worldId)):t.locationName??t.name,comment:t.editComment,action:t.editAction,worldID:t.worldId,isWorld:e,subtitle:e?null:t.worldDisplayName??gamemap.getWorldDisplayNameFromID(t.worldId),rev:t}}function onKeyPressed(t){"Escape"==t.key&&(overlay?cancel():back())}function fixEditor(){$$invalidate(9,editor.style.height=`${editor?.parentElement?.clientHeight}px`,editor),$$invalidate(10,editorWindow.scrollTop=0,editorWindow)}onMount((()=>{window.onpopstate=()=>$$invalidate(20,currentZoom=gamemap.getCurrentZoom().toFixed(3))})),window.updateMarkerCoords=function(t){modify("coords",t)};const resize_handler=()=>{null!=editPanel&&$$invalidate(8,editPanelContent.style.height=document.querySelector(".appbar")?editPanel.clientHeight-document.querySelector(".appbar").clientHeight+"px":null,editPanelContent),editor&&$$invalidate(9,editor.style.height=`${editor?.parentElement?.clientHeight}px`,editor)};function onwindowresize(){$$invalidate(14,innerHeight=window_1$1.innerHeight)}const back_handler=()=>back(),click_handler=()=>addNewLocation(LOCTYPES.MARKER),click_handler_1=()=>addNewLocation(LOCTYPES.PATH),click_handler_2=()=>addNewLocation(LOCTYPES.AREA),click_handler_3=()=>edit(gamemap.getCurrentWorld());function div2_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{refreshTitleBar=t,$$invalidate(13,refreshTitleBar)}))}const shiftClick_handler=t=>gamemap.edit(t.destinationID),click_handler_4=t=>gamemap.goto(t.destinationID),middleClick_handler=t=>{window.open(`${location.origin}${location.pathname}?${t.detail>0?`world=${t.detail}`:`centeron=${Math.abs(t.detail)}`}`)},confirm_handler=t=>fillFromTemplate(t),change_handler=t=>{modEditObject.linkWikiPage()&&modify("wikiPage",t.detail),modify(isWorld?"displayName":"name",t.detail)},change_handler_1=t=>modify("parentID",t.detail),change_handler_2=t=>modify("destinationID",t.detail),change_handler_3=t=>modify("icon",t.detail),change_handler_4=t=>{t.detail==name?modify("wikiPage",`${t.detail} `):modify("wikiPage",t.detail)},change_handler_5=t=>{t.detail?modify("wikiPage",name):modify("wikiPage","")},change_handler_6=t=>{modify("labelPos",Number(t.detail))},change_handler_7=t=>modify("description",t.detail),change_handler_8=t=>modify("minZoomLevel",t.detail),change_handler_9=t=>modify("maxZoomLevel",t.detail),change_handler_10=t=>modify("minX",t.detail),change_handler_11=t=>modify("maxX",t.detail),change_handler_12=t=>modify("minY",t.detail),change_handler_13=t=>modify("maxY",t.detail),change_handler_14=t=>modify("fillColour",t.detail),change_handler_15=t=>modify("fillColourHover",t.detail),change_handler_16=t=>modify("strokeColour",t.detail),change_handler_17=t=>modify("strokeColourHover",t.detail),change_handler_18=t=>modify("strokeWidth",t.detail),change_handler_19=t=>modify("strokeWidthHover",t.detail),change_handler_20=t=>modify("displayLevel",t.detail),click_handler_5=t=>loadRevision(t),func_1=t=>LOCTYPES[t]===modEditObject.locType,func_2=t=>COORD_TYPES[t]===MAPCONFIG.coordType;function div1_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{editorWindow=t,$$invalidate(10,editorWindow)}))}function button0_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{saveButton=t,$$invalidate(12,saveButton)}))}const click_handler_6=()=>doSave(),click_handler_7=()=>back(),click_handler_8=()=>doDelete(),shiftClick_handler_1=()=>doDelete(!0);function div4_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{editor=t,$$invalidate(9,editor)}))}function div1_binding_1(t){binding_callbacks[t?"unshift":"push"]((()=>{editPanelContent=t,$$invalidate(8,editPanelContent)}))}function aside_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{editPanel=t,$$invalidate(7,editPanel)}))}function dialog0_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{discardDialog=t,$$invalidate(15,discardDialog)}))}function dialog1_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{revertDialog=t,$$invalidate(17,revertDialog)}))}function dialog2_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{deleteDialog=t,$$invalidate(16,deleteDialog)}))}const confirm_handler_1=()=>doDelete(!0);return $$self.$$set=t=>{"shown"in t&&$$invalidate(0,shown=t.shown)},$$self.$$.update=()=>{8&$$self.$$.dirty[0]&&$$invalidate(6,isLocation=editObject instanceof Location),8&$$self.$$.dirty[0]&&$$invalidate(5,isWorld=editObject instanceof World),32&$$self.$$.dirty[0]&&$$invalidate(22,objectType=isWorld?"world":"location"),104&$$self.$$.dirty[0]&&$$invalidate(23,isEditing=editObject&&isLocation||isWorld),48&$$self.$$.dirty[0]&&$$invalidate(25,name=isWorld?modEditObject?.displayName:modEditObject?.name),16&$$self.$$.dirty[0]&&$$invalidate(24,editType=modEditObject?.revertID?EDIT_TYPES.REVERT:modEditObject?.id>0?EDIT_TYPES.EDIT:EDIT_TYPES.ADD),12&$$self.$$.dirty[0]&&(window.onbeforeunload=unsavedChanges||editObject?.unsavedLocation?function(){return""}:null)},[shown,edit,unsavedChanges,editObject,modEditObject,isWorld,isLocation,editPanel,editPanelContent,editor,editorWindow,overlay,saveButton,refreshTitleBar,innerHeight,discardDialog,deleteDialog,revertDialog,recentChanges,editHistory,currentZoom,directEdit,objectType,isEditing,editType,name,back,onResizerDown,onResizerUp,slide,doDelete,loadRevision,doSave,addNewLocation,cancel,modify,fillFromTemplate,getRecentChanges,getRCItem,onKeyPressed,fixEditor,dismiss,show,resize_handler,onwindowresize,back_handler,click_handler,click_handler_1,click_handler_2,click_handler_3,div2_binding,shiftClick_handler,click_handler_4,middleClick_handler,confirm_handler,change_handler,change_handler_1,change_handler_2,change_handler_3,change_handler_4,change_handler_5,change_handler_6,change_handler_7,change_handler_8,change_handler_9,change_handler_10,change_handler_11,change_handler_12,change_handler_13,change_handler_14,change_handler_15,change_handler_16,change_handler_17,change_handler_18,change_handler_19,change_handler_20,click_handler_5,func_1,func_2,div1_binding,button0_binding,click_handler_6,click_handler_7,click_handler_8,shiftClick_handler_1,div4_binding,div1_binding_1,aside_binding,dialog0_binding,dialog1_binding,dialog2_binding,confirm_handler_1]}class Editor extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$1,safe_not_equal,{shown:0,edit:1,dismiss:41,show:42},null,[-1,-1,-1,-1])}get shown(){return this.$$.ctx[0]}set shown(t){this.$$set({shown:t}),flush()}get edit(){return this.$$.ctx[1]}get dismiss(){return this.$$.ctx[41]}get show(){return this.$$.ctx[42]}}
/* @preserve
     * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
     * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
     */var leafletSrc=createCommonjsModule((function(t,e){!function(t){var e="1.9.4";function n(t){var e,n,i,o;for(n=1,i=arguments.length;n<i;n++)for(e in o=arguments[n])t[e]=o[e];return t}var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function o(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}var r=0;function s(t){return"_leaflet_id"in t||(t._leaflet_id=++r),t._leaflet_id}function a(t,e,n){var i,o,r,s;return s=function(){i=!1,o&&(r.apply(n,o),o=!1)},r=function(){i?o=arguments:(t.apply(n,arguments),setTimeout(s,e),i=!0)},r}function l(t,e,n){var i=e[1],o=e[0],r=i-o;return t===i&&n?t:((t-o)%r+r)%r+o}function c(){return!1}function h(t,e){if(!1===e)return t;var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function d(t){return u(t).split(/\s+/)}function p(t,e){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?i(t.options):{}),e)t.options[n]=e[n];return t.options}function _(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}var f=/\{ *([\w_ -]+) *\}/g;function m(t,e){return t.replace(f,(function(t,n){var i=e[n];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i}))}var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function v(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function b(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var k=0;function w(t){var e=+new Date,n=Math.max(0,16-(e-k));return k=e+n,window.setTimeout(t,n)}var x=window.requestAnimationFrame||b("RequestAnimationFrame")||w,$=window.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function M(t,e,n){if(!n||x!==w)return x.call(window,o(t,e));t.call(e)}function C(t){t&&$.call(window,t)}var E={__proto__:null,extend:n,create:i,bind:o,get lastId(){return r},stamp:s,throttle:a,wrapNum:l,falseFn:c,formatNum:h,trim:u,splitWords:d,setOptions:p,getParamString:_,template:m,isArray:g,indexOf:v,emptyImageUrl:y,requestFn:x,cancelFn:$,requestAnimFrame:M,cancelAnimFrame:C};function P(){}function T(t){if("undefined"!=typeof L&&L&&L.Mixin){t=g(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}P.extend=function(t){var e=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},o=e.__super__=this.prototype,r=i(o);for(var s in r.constructor=e,e.prototype=r,this)Object.prototype.hasOwnProperty.call(this,s)&&"prototype"!==s&&"__super__"!==s&&(e[s]=this[s]);return t.statics&&n(e,t.statics),t.includes&&(T(t.includes),n.apply(null,[r].concat(t.includes))),n(r,t),delete r.statics,delete r.includes,r.options&&(r.options=o.options?i(o.options):{},n(r.options,t.options)),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},e},P.include=function(t){var e=this.prototype.options;return n(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},P.mergeOptions=function(t){return n(this.prototype.options,t),this},P.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var S={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var o=0,r=(t=d(t)).length;o<r;o++)this._on(t[o],e,n);return this},off:function(t,e,n){if(arguments.length)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else{t=d(t);for(var o=1===arguments.length,r=0,s=t.length;r<s;r++)o?this._off(t[r]):this._off(t[r],e,n)}else delete this._events;return this},_on:function(t,e,n,i){if("function"==typeof e){if(!1===this._listens(t,e,n)){n===this&&(n=void 0);var o={fn:e,ctx:n};i&&(o.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(o)}}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,n){var i,o,r;if(this._events&&(i=this._events[t]))if(1!==arguments.length)if("function"==typeof e){var s=this._listens(t,e,n);if(!1!==s){var a=i[s];this._firingCount&&(a.fn=c,this._events[t]=i=i.slice()),i.splice(s,1)}}else console.warn("wrong listener type: "+typeof e);else{if(this._firingCount)for(o=0,r=i.length;o<r;o++)i[o].fn=c;delete this._events[t]}},fire:function(t,e,i){if(!this.listens(t,i))return this;var o=n({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var r=this._events[t];if(r){this._firingCount=this._firingCount+1||1;for(var s=0,a=r.length;s<a;s++){var l=r[s],c=l.fn;l.once&&this.off(t,c,l.ctx),c.call(l.ctx||this,o)}this._firingCount--}}return i&&this._propagateEvent(o),this},listens:function(t,e,n,i){"string"!=typeof t&&console.warn('"string" type argument expected');var o=e;"function"!=typeof e&&(i=!!e,o=void 0,n=void 0);var r=this._events&&this._events[t];if(r&&r.length&&!1!==this._listens(t,o,n))return!0;if(i)for(var s in this._eventParents)if(this._eventParents[s].listens(t,e,n,i))return!0;return!1},_listens:function(t,e,n){if(!this._events)return!1;var i=this._events[t]||[];if(!e)return!!i.length;n===this&&(n=void 0);for(var o=0,r=i.length;o<r;o++)if(i[o].fn===e&&i[o].ctx===n)return o;return!1},once:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e,!0);else for(var o=0,r=(t=d(t)).length;o<r;o++)this._on(t[o],e,n,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[s(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[s(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};S.addEventListener=S.on,S.removeEventListener=S.clearAllEventListeners=S.off,S.addOneTimeEventListener=S.once,S.fireEvent=S.fire,S.hasEventListeners=S.listens;var O=P.extend(S);function D(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var I=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function R(t,e,n){return t instanceof D?t:g(t)?new D(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new D(t.x,t.y):new D(t,e,n)}function A(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])}function B(t,e){return!t||t instanceof A?t:new A(t,e)}function z(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])}function N(t,e){return t instanceof z?t:new z(t,e)}function j(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function F(t,e,n){return t instanceof j?t:g(t)&&"object"!=typeof t[0]?3===t.length?new j(t[0],t[1],t[2]):2===t.length?new j(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new j(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new j(t,e,n)}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(t){return this.clone()._add(R(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(R(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new D(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new D(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=I(this.x),this.y=I(this.y),this},distanceTo:function(t){var e=(t=R(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=R(t)).x===this.x&&t.y===this.y},contains:function(t){return t=R(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+h(this.x)+", "+h(this.y)+")"}},A.prototype={extend:function(t){var e,n;if(!t)return this;if(t instanceof D||"number"==typeof t[0]||"x"in t)e=n=R(t);else if(e=(t=B(t)).min,n=t.max,!e||!n)return this;return this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=e.clone(),this.max=n.clone()),this},getCenter:function(t){return R((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return R(this.min.x,this.max.y)},getTopRight:function(){return R(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof D?R(t):B(t))instanceof A?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=B(t);var e=this.min,n=this.max,i=t.min,o=t.max,r=o.x>=e.x&&i.x<=n.x,s=o.y>=e.y&&i.y<=n.y;return r&&s},overlaps:function(t){t=B(t);var e=this.min,n=this.max,i=t.min,o=t.max,r=o.x>e.x&&i.x<n.x,s=o.y>e.y&&i.y<n.y;return r&&s},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,n=this.max,i=Math.abs(e.x-n.x)*t,o=Math.abs(e.y-n.y)*t;return B(R(e.x-i,e.y-o),R(n.x+i,n.y+o))},equals:function(t){return!!t&&(t=B(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},z.prototype={extend:function(t){var e,n,i=this._southWest,o=this._northEast;if(t instanceof j)e=t,n=t;else{if(!(t instanceof z))return t?this.extend(F(t)||N(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return i||o?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),o.lat=Math.max(n.lat,o.lat),o.lng=Math.max(n.lng,o.lng)):(this._southWest=new j(e.lat,e.lng),this._northEast=new j(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new z(new j(e.lat-i,e.lng-o),new j(n.lat+i,n.lng+o))},getCenter:function(){return new j((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new j(this.getNorth(),this.getWest())},getSouthEast:function(){return new j(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof j||"lat"in t?F(t):N(t);var e,n,i=this._southWest,o=this._northEast;return t instanceof z?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=o.lat&&e.lng>=i.lng&&n.lng<=o.lng},intersects:function(t){t=N(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&i.lat<=n.lat,s=o.lng>=e.lng&&i.lng<=n.lng;return r&&s},overlaps:function(t){t=N(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>e.lat&&i.lat<n.lat,s=o.lng>e.lng&&i.lng<n.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=N(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},j.prototype={equals:function(t,e){return!!t&&(t=F(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+h(this.lat,t)+", "+h(this.lng,t)+")"},distanceTo:function(t){return G.distance(this,F(t))},wrap:function(){return G.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return N([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new j(this.lat,this.lng,this.alt)}};var W,H={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new A(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new j(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,o=e.lng-n.lng;if(0===i&&0===o)return t;var r=t.getSouthWest(),s=t.getNorthEast();return new z(new j(r.lat-i,r.lng-o),new j(s.lat-i,s.lng-o))}},G=n({},H,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,o=e.lat*n,r=Math.sin((e.lat-t.lat)*n/2),s=Math.sin((e.lng-t.lng)*n/2),a=r*r+Math.cos(i)*Math.cos(o)*s*s,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),Z=6378137,U={R:Z,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=Math.sin(i*e);return new D(this.R*t.lng*e,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var e=180/Math.PI;return new j((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(W=Z*Math.PI,new A([-W,-W],[W,W]))};function q(t,e,n,i){if(g(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function V(t,e,n,i){return new q(t,e,n,i)}q.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new D((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var Y=n({},G,{code:"EPSG:3857",projection:U,transformation:function(){var t=.5/(Math.PI*U.R);return V(t,.5,-t,.5)}()}),K=n({},Y,{code:"EPSG:900913"});function X(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function J(t,e){var n,i,o,r,s,a,l="";for(n=0,o=t.length;n<o;n++){for(i=0,r=(s=t[n]).length;i<r;i++)l+=(i?"L":"M")+(a=s[i]).x+" "+a.y;l+=e?zt.svg?"z":"x":""}return l||"M0 0"}var Q,tt=document.documentElement.style,et="ActiveXObject"in window,nt=et&&!document.addEventListener,it="msLaunchUri"in navigator&&!("documentMode"in document),ot=Bt("webkit"),rt=Bt("android"),st=Bt("android 2")||Bt("android 3"),at=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),lt=rt&&Bt("Google")&&at<537&&!("AudioNode"in window),ct=!!window.opera,ht=!it&&Bt("chrome"),ut=Bt("gecko")&&!ot&&!ct&&!et,dt=!ht&&Bt("safari"),pt=Bt("phantom"),_t="OTransition"in tt,ft=0===navigator.platform.indexOf("Win"),mt=et&&"transition"in tt,gt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!st,vt="MozPerspective"in tt,yt=!window.L_DISABLE_3D&&(mt||gt||vt)&&!_t&&!pt,bt="undefined"!=typeof orientation||Bt("mobile"),kt=bt&&ot,wt=bt&&gt,xt=!window.PointerEvent&&window.MSPointerEvent,Lt=!(!window.PointerEvent&&!xt),$t="ontouchstart"in window||!!window.TouchEvent,Mt=!window.L_NO_TOUCH&&($t||Lt),Ct=bt&&ct,Et=bt&&ut,Pt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Tt=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",c,e),window.removeEventListener("testPassiveEventSupport",c,e)}catch(t){}return t}(),St=!!document.createElement("canvas").getContext,Ot=!(!document.createElementNS||!X("svg").createSVGRect),Dt=!!Ot&&((Q=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(Q.firstChild&&Q.firstChild.namespaceURI)),It=!Ot&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),Rt=0===navigator.platform.indexOf("Mac"),At=0===navigator.platform.indexOf("Linux");function Bt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var zt={ie:et,ielt9:nt,edge:it,webkit:ot,android:rt,android23:st,androidStock:lt,opera:ct,chrome:ht,gecko:ut,safari:dt,phantom:pt,opera12:_t,win:ft,ie3d:mt,webkit3d:gt,gecko3d:vt,any3d:yt,mobile:bt,mobileWebkit:kt,mobileWebkit3d:wt,msPointer:xt,pointer:Lt,touch:Mt,touchNative:$t,mobileOpera:Ct,mobileGecko:Et,retina:Pt,passiveEvents:Tt,canvas:St,svg:Ot,vml:It,inlineSvg:Dt,mac:Rt,linux:At},Nt=zt.msPointer?"MSPointerDown":"pointerdown",jt=zt.msPointer?"MSPointerMove":"pointermove",Ft=zt.msPointer?"MSPointerUp":"pointerup",Wt=zt.msPointer?"MSPointerCancel":"pointercancel",Ht={touchstart:Nt,touchmove:jt,touchend:Ft,touchcancel:Wt},Gt={touchstart:te,touchmove:Qt,touchend:Qt,touchcancel:Qt},Zt={},Ut=!1;function qt(t,e,n){return"touchstart"===e&&Jt(),Gt[e]?(n=Gt[e].bind(this,n),t.addEventListener(Ht[e],n,!1),n):(console.warn("wrong event specified:",e),c)}function Vt(t,e,n){Ht[e]?t.removeEventListener(Ht[e],n,!1):console.warn("wrong event specified:",e)}function Yt(t){Zt[t.pointerId]=t}function Kt(t){Zt[t.pointerId]&&(Zt[t.pointerId]=t)}function Xt(t){delete Zt[t.pointerId]}function Jt(){Ut||(document.addEventListener(Nt,Yt,!0),document.addEventListener(jt,Kt,!0),document.addEventListener(Ft,Xt,!0),document.addEventListener(Wt,Xt,!0),Ut=!0)}function Qt(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in e.touches=[],Zt)e.touches.push(Zt[n]);e.changedTouches=[e],t(e)}}function te(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&Ye(e),Qt(t,e)}function ee(t){var e,n,i={};for(n in t)e=t[n],i[n]=e&&e.bind?e.bind(t):e;return t=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}var ne=200;function ie(t,e){t.addEventListener("dblclick",e);var n,i=0;function o(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var o=Xe(t);if(!o.some((function(t){return t instanceof HTMLLabelElement&&t.attributes.for}))||o.some((function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement}))){var r=Date.now();r-i<=ne?2==++n&&e(ee(t)):n=1,i=r}}}else n=t.detail}return t.addEventListener("click",o),{dblclick:e,simDblclick:o}}function oe(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var re,se,ae,le,ce,he=Ce(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ue=Ce(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),de="webkitTransition"===ue||"OTransition"===ue?ue+"End":"transitionend";function pe(t){return"string"==typeof t?document.getElementById(t):t}function _e(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function fe(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function me(t){var e=t.parentNode;e&&e.removeChild(t)}function ge(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ve(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function ye(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function be(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=Le(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function ke(t,e){if(void 0!==t.classList)for(var n=d(e),i=0,o=n.length;i<o;i++)t.classList.add(n[i]);else if(!be(t,e)){var r=Le(t);xe(t,(r?r+" ":"")+e)}}function we(t,e){void 0!==t.classList?t.classList.remove(e):xe(t,u((" "+Le(t)+" ").replace(" "+e+" "," ")))}function xe(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function Le(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function $e(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&Me(t,e)}function Me(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}function Ce(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function Ee(t,e,n){var i=e||new D(0,0);t.style[he]=(zt.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function Pe(t,e){t._leaflet_pos=e,zt.any3d?Ee(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Te(t){return t._leaflet_pos||new D(0,0)}if("onselectstart"in document)re=function(){Ne(window,"selectstart",Ye)},se=function(){Fe(window,"selectstart",Ye)};else{var Se=Ce(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);re=function(){if(Se){var t=document.documentElement.style;ae=t[Se],t[Se]="none"}},se=function(){Se&&(document.documentElement.style[Se]=ae,ae=void 0)}}function Oe(){Ne(window,"dragstart",Ye)}function De(){Fe(window,"dragstart",Ye)}function Ie(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Re(),le=t,ce=t.style.outlineStyle,t.style.outlineStyle="none",Ne(window,"keydown",Re))}function Re(){le&&(le.style.outlineStyle=ce,le=void 0,ce=void 0,Fe(window,"keydown",Re))}function Ae(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Be(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var ze={__proto__:null,TRANSFORM:he,TRANSITION:ue,TRANSITION_END:de,get:pe,getStyle:_e,create:fe,remove:me,empty:ge,toFront:ve,toBack:ye,hasClass:be,addClass:ke,removeClass:we,setClass:xe,getClass:Le,setOpacity:$e,testProp:Ce,setTransform:Ee,setPosition:Pe,getPosition:Te,get disableTextSelection(){return re},get enableTextSelection(){return se},disableImageDrag:Oe,enableImageDrag:De,preventOutline:Ie,restoreOutline:Re,getSizedParentNode:Ae,getScale:Be};function Ne(t,e,n,i){if(e&&"object"==typeof e)for(var o in e)Ge(t,o,e[o],n);else for(var r=0,s=(e=d(e)).length;r<s;r++)Ge(t,e[r],n,i);return this}var je="_leaflet_events";function Fe(t,e,n,i){if(1===arguments.length)We(t),delete t[je];else if(e&&"object"==typeof e)for(var o in e)Ze(t,o,e[o],n);else if(e=d(e),2===arguments.length)We(t,(function(t){return-1!==v(e,t)}));else for(var r=0,s=e.length;r<s;r++)Ze(t,e[r],n,i);return this}function We(t,e){for(var n in t[je]){var i=n.split(/\d/)[0];e&&!e(i)||Ze(t,i,null,null,n)}}var He={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ge(t,e,n,i){var o=e+s(n)+(i?"_"+s(i):"");if(t[je]&&t[je][o])return this;var r=function(e){return n.call(i||t,e||window.event)},a=r;!zt.touchNative&&zt.pointer&&0===e.indexOf("touch")?r=qt(t,e,r):zt.touch&&"dblclick"===e?r=ie(t,r):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(He[e]||e,r,!!zt.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(r=function(e){e=e||window.event,en(t,e)&&a(e)},t.addEventListener(He[e],r,!1)):t.addEventListener(e,a,!1):t.attachEvent("on"+e,r),t[je]=t[je]||{},t[je][o]=r}function Ze(t,e,n,i,o){o=o||e+s(n)+(i?"_"+s(i):"");var r=t[je]&&t[je][o];if(!r)return this;!zt.touchNative&&zt.pointer&&0===e.indexOf("touch")?Vt(t,e,r):zt.touch&&"dblclick"===e?oe(t,r):"removeEventListener"in t?t.removeEventListener(He[e]||e,r,!1):t.detachEvent("on"+e,r),t[je][o]=null}function Ue(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function qe(t){return Ge(t,"wheel",Ue),this}function Ve(t){return Ne(t,"mousedown touchstart dblclick contextmenu",Ue),t._leaflet_disable_click=!0,this}function Ye(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ke(t){return Ye(t),Ue(t),this}function Xe(t){if(t.composedPath)return t.composedPath();for(var e=[],n=t.target;n;)e.push(n),n=n.parentNode;return e}function Je(t,e){if(!e)return new D(t.clientX,t.clientY);var n=Be(e),i=n.boundingClientRect;return new D((t.clientX-i.left)/n.x-e.clientLeft,(t.clientY-i.top)/n.y-e.clientTop)}var Qe=zt.linux&&zt.chrome?window.devicePixelRatio:zt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function tn(t){return zt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Qe:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function en(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var nn={__proto__:null,on:Ne,off:Fe,stopPropagation:Ue,disableScrollPropagation:qe,disableClickPropagation:Ve,preventDefault:Ye,stop:Ke,getPropagationPath:Xe,getMousePosition:Je,getWheelDelta:tn,isExternalTarget:en,addListener:Ne,removeListener:Fe},on=O.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=Te(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),Pe(this._el,n),this.fire("step")},_complete:function(){C(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),rn=O.extend({options:{crs:Y,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=p(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(F(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ue&&zt.any3d&&!zt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ne(this._proxy,de,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(F(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n({animate:i.animate},i.zoom),i.pan=n({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e,i.pan&&i.pan.noMoveStart),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(zt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(zt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),r=(t instanceof D?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/i),s=this.containerPointToLatLng(o.add(r));return this.setView(s,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():N(t);var n=R(e.paddingTopLeft||e.padding||[0,0]),i=R(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i));if((o="number"==typeof e.maxZoom?Math.min(e.maxZoom,o):o)===1/0)return{center:t.getCenter(),zoom:o};var r=i.subtract(n).divideBy(2),s=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o);return{center:this.unproject(s.add(a).divideBy(2).add(r),o),zoom:o}},fitBounds:function(t,e){if(!(t=N(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=R(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new on,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){ke(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!zt.any3d)return this.setView(t,e,n);this._stop();var i=this.project(this.getCenter()),o=this.project(t),r=this.getSize(),s=this._zoom;t=F(t),e=void 0===e?s:e;var a=Math.max(r.x,r.y),l=a*this.getZoomScale(s,e),c=o.distanceTo(i)||1,h=1.42,u=h*h;function d(t){var e=(l*l-a*a+(t?-1:1)*u*u*c*c)/(2*(t?l:a)*u*c),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function p(t){return(Math.exp(t)-Math.exp(-t))/2}function _(t){return(Math.exp(t)+Math.exp(-t))/2}function f(t){return p(t)/_(t)}var m=d(0);function g(t){return a*(_(m)/_(m+h*t))}function v(t){return a*(_(m)*f(m+h*t)-p(m))/u}function y(t){return 1-Math.pow(1-t,1.5)}var b=Date.now(),k=(d(1)-m)/h,w=n.duration?1e3*n.duration:1e3*k*.8;function x(){var n=(Date.now()-b)/w,r=y(n)*k;n<=1?(this._flyToFrame=M(x,this),this._move(this.unproject(i.add(o.subtract(i).multiplyBy(v(r)/c)),s),this.getScaleZoom(a/g(r),s),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),x.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return t=N(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,N(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=R((e=e||{}).paddingTopLeft||e.padding||[0,0]),i=R(e.paddingBottomRight||e.padding||[0,0]),o=this.project(this.getCenter()),r=this.project(t),s=this.getPixelBounds(),a=B([s.min.add(n),s.max.subtract(i)]),l=a.getSize();if(!a.contains(r)){this._enforcingBounds=!0;var c=r.subtract(a.getCenter()),h=a.extend(r).getSize().subtract(l);o.x+=c.x<0?-h.x:h.x,o.y+=c.y<0?-h.y:h.y,this.panTo(this.unproject(o),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),r=e.divideBy(2).round(),s=i.divideBy(2).round(),a=r.subtract(s);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o(this._handleGeolocationResponse,this),i=o(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new j(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),i=this._locateOptions;if(i.setView){var o=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(o,i.maxZoom):o)}var r={latlng:e,bounds:n,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(r[s]=t.coords[s]);this.fire("locationfound",r)}},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),me(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(C(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)me(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=fe("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new z(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=N(t),n=R(n||[0,0]);var i=this.getZoom()||0,o=this.getMinZoom(),r=this.getMaxZoom(),s=t.getNorthWest(),a=t.getSouthEast(),l=this.getSize().subtract(n),c=B(this.project(a,i),this.project(s,i)).getSize(),h=zt.any3d?this.options.zoomSnap:1,u=l.x/c.x,d=l.y/c.y,p=e?Math.max(u,d):Math.min(u,d);return i=this.getScaleZoom(p,i),h&&(i=Math.round(i/(h/100))*(h/100),i=e?Math.ceil(i/h)*h:Math.floor(i/h)*h),Math.max(o,Math.min(r,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new D(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new A(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?1/0:i},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(F(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(R(t),e)},layerPointToLatLng:function(t){var e=R(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(F(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(F(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(N(t))},distance:function(t,e){return this.options.crs.distance(F(t),F(e))},containerPointToLayerPoint:function(t){return R(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return R(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(R(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(t)))},mouseEventToContainerPoint:function(t){return Je(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=pe(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Ne(e,"scroll",this._onScroll,this),this._containerId=s(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&zt.any3d,ke(t,"leaflet-container"+(zt.touch?" leaflet-touch":"")+(zt.retina?" leaflet-retina":"")+(zt.ielt9?" leaflet-oldie":"")+(zt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=_e(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Pe(this._mapPane,new D(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ke(t.markerPane,"leaflet-zoom-hide"),ke(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,n){Pe(this._mapPane,new D(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var o=this._zoom!==e;this._moveStart(o,n)._move(t,e)._moveEnd(o),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n,i){void 0===e&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),i?n&&n.pinch&&this.fire("zoom",n):((o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return C(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Pe(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[s(this._container)]=this;var e=t?Fe:Ne;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),zt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){C(this._resizeRequest),this._resizeRequest=M((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,i=[],o="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,a=!1;r;){if((n=this._targets[s(r)])&&("click"===e||"preclick"===e)&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)){if(o&&!en(r,t))break;if(i.push(n),o)break}if(r===this._container)break;r=r.parentNode}return i.length||a||o||!this.listens(e,!0)||(i=[this]),i},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var n=t.type;"mousedown"===n&&Ie(e),this._fireDOMEvent(t,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,i){if("click"===t.type){var o=n({},t);o.type="preclick",this._fireDOMEvent(o,o.type,i)}var r=this._findEventTargets(t,e);if(i){for(var s=[],a=0;a<i.length;a++)i[a].listens(e,!0)&&s.push(i[a]);r=s.concat(r)}if(r.length){"contextmenu"===e&&Ye(t);var l=r[0],c={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var h=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=h?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(t),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=h?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(a=0;a<r.length;a++)if(r[a].fire(e,c,!0),c.originalEvent._stopped||!1===r[a].options.bubblingMouseEvents&&-1!==v(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Te(this._mapPane)||new D(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return B([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),r=new A(i.subtract(o),i.add(o)),s=this._getBoundsOffset(r,n,e);return Math.abs(s.x)<=1&&Math.abs(s.y)<=1?t:this.unproject(i.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new A(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=B(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),o=i.min.subtract(t.min),r=i.max.subtract(t.max);return new D(this._rebound(o.x,-r.x),this._rebound(o.y,-r.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=zt.any3d?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){we(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=fe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=he,n=this._proxy.style[e];Ee(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){me(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();Ee(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(o)||(M((function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ke(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:i}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&we(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function sn(t,e){return new rn(t,e)}var an=P.extend({options:{position:"topright"},initialize:function(t){p(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return ke(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(me(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),ln=function(t){return new an(t)};rn.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=fe("div",e+"control-container",this._container);function i(i,o){var r=e+i+" "+e+o;t[i+o]=fe("div",r,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)me(this._controlCorners[t]);me(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var cn=an.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){for(var i in p(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return an.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(s(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ke(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ke(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):we(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return we(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=fe("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Ve(e),qe(e);var i=this._section=fe("section",t+"-list");n&&(this._map.on("click",this.collapse,this),Ne(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var o=this._layersLink=fe("a",t+"-toggle",e);o.href="#",o.title="Layers",o.setAttribute("role","button"),Ne(o,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){Ye(t),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=fe("div",t+"-base",i),this._separator=fe("div",t+"-separator",i),this._overlaysList=fe("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&s(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(o((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ge(this._baseLayersList),ge(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,o=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,o+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&o>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(s(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=document.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers_"+s(this),i),this._layerControlInputs.push(e),e.layerId=s(t.layer),Ne(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var r=document.createElement("span");return n.appendChild(r),r.appendChild(e),r.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var t,e,n=this._layerControlInputs,i=[],o=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,t.checked?i.push(e):t.checked||o.push(e);for(r=0;r<o.length;r++)this._map.hasLayer(o[r])&&this._map.removeLayer(o[r]);for(r=0;r<i.length;r++)this._map.hasLayer(i[r])||this._map.addLayer(i[r]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,i=this._map.getZoom(),o=n.length-1;o>=0;o--)t=n[o],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&i<e.options.minZoom||void 0!==e.options.maxZoom&&i>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Ne(t,"click",Ye),this.expand();var e=this;setTimeout((function(){Fe(t,"click",Ye),e._preventClick=!1}))}}),hn=function(t,e,n){return new cn(t,e,n)},un=an.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=fe("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,o){var r=fe("a",n,i);return r.innerHTML=t,r.href="#",r.title=e,r.setAttribute("role","button"),r.setAttribute("aria-label",e),Ve(r),Ne(r,"click",Ke),Ne(r,"click",o,this),Ne(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";we(this._zoomInButton,e),we(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ke(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ke(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});rn.mergeOptions({zoomControl:!0}),rn.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new un,this.addControl(this.zoomControl))}));var dn=function(t){return new un(t)},pn=an.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=fe("div",e),i=this.options;return this._addScales(i,e+"-line",n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=fe("div",e,n)),t.imperial&&(this._iScale=fe("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,i,o=3.2808399*t;o>5280?(e=o/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(i=this._getRoundNum(o),this._updateScale(this._iScale,i+" ft",i/o))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),_n=function(t){return new pn(t)},fn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',mn=an.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(zt.inlineSvg?fn+" ":"")+"Leaflet</a>"},initialize:function(t){p(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=fe("div","leaflet-control-attribution"),Ve(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",(function(){this.removeAttribution(t.layer.getAttribution())}),this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});rn.mergeOptions({attributionControl:!0}),rn.addInitHook((function(){this.options.attributionControl&&(new mn).addTo(this)}));var gn=function(t){return new mn(t)};an.Layers=cn,an.Zoom=un,an.Scale=pn,an.Attribution=mn,ln.layers=hn,ln.zoom=dn,ln.scale=_n,ln.attribution=gn;var vn=P.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});vn.addTo=function(t,e){return t.addHandler(e,this),this};var yn={Events:S},bn=zt.touch?"touchstart mousedown":"mousedown",kn=O.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){p(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Ne(this._dragStartTarget,bn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(kn._dragging===this&&this.finishDrag(!0),Fe(this._dragStartTarget,bn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!be(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)kn._dragging===this&&this.finishDrag();else if(!(kn._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(kn._dragging=this,this._preventOutline&&Ie(this._element),Oe(),re(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,n=Ae(this._element);this._startPoint=new D(e.clientX,e.clientY),this._startPos=Te(this._element),this._parentScale=Be(n);var i="mousedown"===t.type;Ne(document,i?"mousemove":"touchmove",this._onMove,this),Ne(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new D(e.clientX,e.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Ye(t),this._moved||(this.fire("dragstart"),this._moved=!0,ke(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ke(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Pe(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){we(document.body,"leaflet-dragging"),this._lastTarget&&(we(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Fe(document,"mousemove touchmove",this._onMove,this),Fe(document,"mouseup touchend touchcancel",this._onUp,this),De(),se();var e=this._moved&&this._moving;this._moving=!1,kn._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function wn(t,e,n){var i,o,r,s,a,l,c,h,u,d=[1,4,2,8];for(o=0,c=t.length;o<c;o++)t[o]._code=Rn(t[o],e);for(s=0;s<4;s++){for(h=d[s],i=[],o=0,r=(c=t.length)-1;o<c;r=o++)a=t[o],l=t[r],a._code&h?l._code&h||((u=In(l,a,h,e,n))._code=Rn(u,e),i.push(u)):(l._code&h&&((u=In(l,a,h,e,n))._code=Rn(u,e),i.push(u)),i.push(a));t=i}return t}function xn(t,e){var n,i,o,r,s,a,l,c,h;if(!t||0===t.length)throw new Error("latlngs not passed");zn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var u=F([0,0]),d=N(t);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(u=Ln(t));var p=t.length,_=[];for(n=0;n<p;n++){var f=F(t[n]);_.push(e.project(F([f.lat-u.lat,f.lng-u.lng])))}for(a=l=c=0,n=0,i=p-1;n<p;i=n++)o=_[n],r=_[i],s=o.y*r.x-r.y*o.x,l+=(o.x+r.x)*s,c+=(o.y+r.y)*s,a+=3*s;h=0===a?_[0]:[l/a,c/a];var m=e.unproject(R(h));return F([m.lat+u.lat,m.lng+u.lng])}function Ln(t){for(var e=0,n=0,i=0,o=0;o<t.length;o++){var r=F(t[o]);e+=r.lat,n+=r.lng,i++}return F([e/i,n/i])}var $n,Mn={__proto__:null,clipPolygon:wn,polygonCenter:xn,centroid:Ln};function Cn(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=Tn(t=On(t,n),n)}function En(t,e,n){return Math.sqrt(Bn(t,e,n,!0))}function Pn(t,e,n){return Bn(t,e,n)}function Tn(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,Sn(t,i,e,0,n-1);var o,r=[];for(o=0;o<n;o++)i[o]&&r.push(t[o]);return r}function Sn(t,e,n,i,o){var r,s,a,l=0;for(s=i+1;s<=o-1;s++)(a=Bn(t[s],t[i],t[o],!0))>l&&(r=s,l=a);l>n&&(e[r]=1,Sn(t,e,n,i,r),Sn(t,e,n,r,o))}function On(t,e){for(var n=[t[0]],i=1,o=0,r=t.length;i<r;i++)An(t[i],t[o])>e&&(n.push(t[i]),o=i);return o<r-1&&n.push(t[r-1]),n}function Dn(t,e,n,i,o){var r,s,a,l=i?$n:Rn(t,n),c=Rn(e,n);for($n=c;;){if(!(l|c))return[t,e];if(l&c)return!1;a=Rn(s=In(t,e,r=l||c,n,o),n),r===l?(t=s,l=a):(e=s,c=a)}}function In(t,e,n,i,o){var r,s,a=e.x-t.x,l=e.y-t.y,c=i.min,h=i.max;return 8&n?(r=t.x+a*(h.y-t.y)/l,s=h.y):4&n?(r=t.x+a*(c.y-t.y)/l,s=c.y):2&n?(r=h.x,s=t.y+l*(h.x-t.x)/a):1&n&&(r=c.x,s=t.y+l*(c.x-t.x)/a),new D(r,s,o)}function Rn(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function An(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function Bn(t,e,n,i){var o,r=e.x,s=e.y,a=n.x-r,l=n.y-s,c=a*a+l*l;return c>0&&((o=((t.x-r)*a+(t.y-s)*l)/c)>1?(r=n.x,s=n.y):o>0&&(r+=a*o,s+=l*o)),a=t.x-r,l=t.y-s,i?a*a+l*l:new D(r,s)}function zn(t){return!g(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function Nn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),zn(t)}function jn(t,e){var n,i,o,r,s,a,l,c;if(!t||0===t.length)throw new Error("latlngs not passed");zn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var h=F([0,0]),u=N(t);u.getNorthWest().distanceTo(u.getSouthWest())*u.getNorthEast().distanceTo(u.getNorthWest())<1700&&(h=Ln(t));var d=t.length,p=[];for(n=0;n<d;n++){var _=F(t[n]);p.push(e.project(F([_.lat-h.lat,_.lng-h.lng])))}for(n=0,i=0;n<d-1;n++)i+=p[n].distanceTo(p[n+1])/2;if(0===i)c=p[0];else for(n=0,r=0;n<d-1;n++)if(s=p[n],a=p[n+1],(r+=o=s.distanceTo(a))>i){l=(r-i)/o,c=[a.x-l*(a.x-s.x),a.y-l*(a.y-s.y)];break}var f=e.unproject(R(c));return F([f.lat+h.lat,f.lng+h.lng])}var Fn={__proto__:null,simplify:Cn,pointToSegmentDistance:En,closestPointOnSegment:Pn,clipSegment:Dn,_getEdgeIntersection:In,_getBitCode:Rn,_sqClosestPointOnSegment:Bn,isFlat:zn,_flat:Nn,polylineCenter:jn},Wn={project:function(t){return new D(t.lng,t.lat)},unproject:function(t){return new j(t.y,t.x)},bounds:new A([-180,-90],[180,90])},Hn={R:6378137,R_MINOR:6356752.314245179,bounds:new A([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,o=this.R_MINOR/n,r=Math.sqrt(1-o*o),s=r*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-s)/(1+s),r/2);return i=-n*Math.log(Math.max(a,1e-10)),new D(t.lng*e*n,i)},unproject:function(t){for(var e,n=180/Math.PI,i=this.R,o=this.R_MINOR/i,r=Math.sqrt(1-o*o),s=Math.exp(-t.y/i),a=Math.PI/2-2*Math.atan(s),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),a+=c=Math.PI/2-2*Math.atan(s*e)-a;return new j(a*n,t.x*n/i)}},Gn={__proto__:null,LonLat:Wn,Mercator:Hn,SphericalMercator:U},Zn=n({},G,{code:"EPSG:3395",projection:Hn,transformation:function(){var t=.5/(Math.PI*Hn.R);return V(t,.5,-t,.5)}()}),Un=n({},G,{code:"EPSG:4326",projection:Wn,transformation:V(1/180,1,-1/180,.5)}),qn=n({},H,{projection:Wn,transformation:V(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});H.Earth=G,H.EPSG3395=Zn,H.EPSG3857=Y,H.EPSG900913=K,H.EPSG4326=Un,H.Simple=qn;var Vn=O.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[s(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[s(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});rn.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=s(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=s(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return s(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?g(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[s(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=s(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var o=this._zoomBoundLayers[i].options;t=void 0===o.minZoom?t:Math.min(t,o.minZoom),e=void 0===o.maxZoom?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Yn=Vn.extend({initialize:function(t,e){var n,i;if(p(this,e),this._layers={},t)for(n=0,i=t.length;n<i;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s(t)}}),Kn=function(t,e){return new Yn(t,e)},Xn=Yn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Yn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Yn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new z;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),Jn=function(t,e){return new Xn(t,e)},Qn=P.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){p(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var o=R(i),r=R("shadow"===e&&n.shadowAnchor||n.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return zt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function ti(t){return new Qn(t)}var ei=Qn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof ei.imagePath&&(ei.imagePath=this._detectIconPath()),(this.options.imagePath||ei.imagePath)+Qn.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,n){var i=e.exec(t);return i&&i[n]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=fe("div","leaflet-default-icon-path",document.body),e=_e(t,"background-image")||_e(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),ni=vn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new kn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ke(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&we(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,i=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,r=Te(e._icon),s=n.getPixelBounds(),a=n.getPixelOrigin(),l=B(s.min._subtract(a).add(o),s.max._subtract(a).subtract(o));if(!l.contains(r)){var c=R((Math.max(l.max.x,r.x)-l.max.x)/(s.max.x-l.max.x)-(Math.min(l.min.x,r.x)-l.min.x)/(s.min.x-l.min.x),(Math.max(l.max.y,r.y)-l.max.y)/(s.max.y-l.max.y)-(Math.min(l.min.y,r.y)-l.min.y)/(s.min.y-l.min.y)).multiplyBy(i);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),Pe(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=M(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(C(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,i=Te(e._icon),o=e._map.layerPointToLatLng(i);n&&Pe(n,i),e._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){C(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),ii=Vn.extend({options:{icon:new ei,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){p(this,e),this._latlng=F(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),ke(n,e),t.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ne(n,"focus",this._panOnFocus,this);var o=t.icon.createShadow(this._shadow),r=!1;o!==this._shadow&&(this._removeShadow(),r=!0),o&&(ke(o,e),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&r&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Fe(this._icon,"focus",this._panOnFocus,this),me(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&me(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Pe(this._icon,t),this._shadow&&Pe(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ke(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ni)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ni(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&$e(this._icon,t),this._shadow&&$e(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,n=e.iconSize?R(e.iconSize):R(0,0),i=e.iconAnchor?R(e.iconAnchor):R(0,0);t.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function oi(t,e){return new ii(t,e)}var ri=Vn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return p(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),si=ri.extend({options:{fill:!0,radius:10},initialize:function(t,e){p(this,e),this._latlng=F(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return ri.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new A(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ai(t,e){return new si(t,e)}var li=si.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=n({},i,{radius:e})),p(this,e),this._latlng=F(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new z(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:ri.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===G.distance){var o=Math.PI/180,r=this._mRadius/G.R/o,s=n.project([e+r,t]),a=n.project([e-r,t]),l=s.add(a).divideBy(2),c=n.unproject(l).lat,h=Math.acos((Math.cos(r*o)-Math.sin(e*o)*Math.sin(c*o))/(Math.cos(e*o)*Math.cos(c*o)))/o;(isNaN(h)||0===h)&&(h=r/Math.cos(Math.PI/180*e)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(h)?0:l.x-n.project([c,t-h]).x,this._radiusY=l.y-s.y}else{var u=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(u).x}this._updateBounds()}});function ci(t,e,n){return new li(t,e,n)}var hi=ri.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){p(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=1/0,o=null,r=Bn,s=0,a=this._parts.length;s<a;s++)for(var l=this._parts[s],c=1,h=l.length;c<h;c++){var u=r(t,e=l[c-1],n=l[c],!0);u<i&&(i=u,o=r(t,e,n))}return o&&(o.distance=Math.sqrt(i)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return jn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=F(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new z,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return zn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=zn(t),i=0,o=t.length;i<o;i++)n?(e[i]=F(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new A;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new D(t,t);this._rawPxBounds&&(this._pxBounds=new A([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,n){var i,o,r=t[0]instanceof j,s=t.length;if(r){for(o=[],i=0;i<s;i++)o[i]=this._map.latLngToLayerPoint(t[i]),n.extend(o[i]);e.push(o)}else for(i=0;i<s;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,i,o,r,s,a,l=this._parts;for(e=0,i=0,o=this._rings.length;e<o;e++)for(n=0,r=(a=this._rings[e]).length;n<r-1;n++)(s=Dn(a[n],a[n+1],t,n,!0))&&(l[i]=l[i]||[],l[i].push(s[0]),s[1]===a[n+1]&&n!==r-2||(l[i].push(s[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=Cn(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,o,r,s,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,r=this._parts.length;n<r;n++)for(i=0,o=(s=(a=this._parts[n]).length)-1;i<s;o=i++)if((e||0!==i)&&En(t,a[o],a[i])<=l)return!0;return!1}});function ui(t,e){return new hi(t,e)}hi._flat=Nn;var di=hi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=hi.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof j&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){hi.prototype._setLatLngs.call(this,t),zn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return zn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new D(e,e);if(t=new A(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,o=0,r=this._rings.length;o<r;o++)(i=wn(this._rings[o],t,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,o,r,s,a,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(r=0,s=(l=(e=this._parts[o]).length)-1;r<l;s=r++)n=e[r],i=e[s],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c||hi.prototype._containsPoint.call(this,t,!0)}});function pi(t,e){return new di(t,e)}var _i=Xn.extend({initialize:function(t,e){p(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,o=g(t)?t:t.features;if(o){for(e=0,n=o.length;e<n;e++)((i=o[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var s=fi(t,r);return s?(s.feature=wi(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function fi(t,e){var n,i,o,r,s="Feature"===t.type?t.geometry:t,a=s?s.coordinates:null,l=[],c=e&&e.pointToLayer,h=e&&e.coordsToLatLng||gi;if(!a&&!s)return null;switch(s.type){case"Point":return mi(c,t,n=h(a),e);case"MultiPoint":for(o=0,r=a.length;o<r;o++)n=h(a[o]),l.push(mi(c,t,n,e));return new Xn(l);case"LineString":case"MultiLineString":return i=vi(a,"LineString"===s.type?0:1,h),new hi(i,e);case"Polygon":case"MultiPolygon":return i=vi(a,"Polygon"===s.type?1:2,h),new di(i,e);case"GeometryCollection":for(o=0,r=s.geometries.length;o<r;o++){var u=fi({geometry:s.geometries[o],type:"Feature",properties:t.properties},e);u&&l.push(u)}return new Xn(l);case"FeatureCollection":for(o=0,r=s.features.length;o<r;o++){var d=fi(s.features[o],e);d&&l.push(d)}return new Xn(l);default:throw new Error("Invalid GeoJSON object.")}}function mi(t,e,n,i){return t?t(e,n):new ii(n,i&&i.markersInheritOptions&&i)}function gi(t){return new j(t[1],t[0],t[2])}function vi(t,e,n){for(var i,o=[],r=0,s=t.length;r<s;r++)i=e?vi(t[r],e-1,n):(n||gi)(t[r]),o.push(i);return o}function yi(t,e){return void 0!==(t=F(t)).alt?[h(t.lng,e),h(t.lat,e),h(t.alt,e)]:[h(t.lng,e),h(t.lat,e)]}function bi(t,e,n,i){for(var o=[],r=0,s=t.length;r<s;r++)o.push(e?bi(t[r],zn(t[r])?0:e-1,n,i):yi(t[r],i));return!e&&n&&o.length>0&&o.push(o[0].slice()),o}function ki(t,e){return t.feature?n({},t.feature,{geometry:e}):wi(e)}function wi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var xi={toGeoJSON:function(t){return ki(this,{type:"Point",coordinates:yi(this.getLatLng(),t)})}};function Li(t,e){return new _i(t,e)}ii.include(xi),li.include(xi),si.include(xi),hi.include({toGeoJSON:function(t){var e=!zn(this._latlngs);return ki(this,{type:(e?"Multi":"")+"LineString",coordinates:bi(this._latlngs,e?1:0,!1,t)})}}),di.include({toGeoJSON:function(t){var e=!zn(this._latlngs),n=e&&!zn(this._latlngs[0]),i=bi(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),ki(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),Yn.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),ki(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,i=[];return this.eachLayer((function(e){if(e.toGeoJSON){var o=e.toGeoJSON(t);if(n)i.push(o.geometry);else{var r=wi(o);"FeatureCollection"===r.type?i.push.apply(i,r.features):i.push(r)}}})),n?ki(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var $i=Li,Mi=Vn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=N(e),p(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ke(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){me(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ve(this._image),this},bringToBack:function(){return this._map&&ye(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=N(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:fe("img");ke(e,"leaflet-image-layer"),this._zoomAnimated&&ke(e,"leaflet-zoom-animated"),this.options.className&&ke(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onload=o(this.fire,this,"load"),e.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Ee(this._image,n,e)},_reset:function(){var t=this._image,e=new A(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();Pe(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){$e(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Ci=function(t,e,n){return new Mi(t,e,n)},Ei=Mi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:fe("video");if(ke(e,"leaflet-image-layer"),this._zoomAnimated&&ke(e,"leaflet-zoom-animated"),this.options.className&&ke(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onloadeddata=o(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),i=[],r=0;r<n.length;r++)i.push(n[r].src);this._url=n.length>0?i:[e.src]}else{g(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var s=0;s<this._url.length;s++){var a=fe("source");a.src=this._url[s],e.appendChild(a)}}}});function Pi(t,e,n){return new Ei(t,e,n)}var Ti=Mi.extend({_initImage:function(){var t=this._image=this._url;ke(t,"leaflet-image-layer"),this._zoomAnimated&&ke(t,"leaflet-zoom-animated"),this.options.className&&ke(t,this.options.className),t.onselectstart=c,t.onmousemove=c}});function Si(t,e,n){return new Ti(t,e,n)}var Oi=Vn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof j||g(t))?(this._latlng=F(t),p(this,e)):(p(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&$e(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&$e(this._container,1),this.bringToFront(),this.options.interactive&&(ke(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?($e(this._container,0),this._removeTimeout=setTimeout(o(me,void 0,this._container),200)):me(this._container),this.options.interactive&&(we(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=F(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ve(this._container),this},bringToBack:function(){return this._map&&ye(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof Xn){e=null;var n=this._source._layers;for(var i in n)if(n[i]._map){e=n[i];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=R(this.options.offset),n=this._getAnchor();this._zoomAnimated?Pe(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}});rn.include({_initOverlay:function(t,e,n,i){var o=e;return o instanceof t||(o=new t(i).setContent(e)),n&&o.setLatLng(n),o}}),Vn.include({_initOverlay:function(t,e,n,i){var o=n;return o instanceof t?(p(o,i),o._source=this):(o=e&&!i?e:new t(i,this)).setContent(n),o}});var Di=Oi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Oi.prototype.openOn.call(this,t)},onAdd:function(t){Oi.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ri||this._source.on("preclick",Ue))},onRemove:function(t){Oi.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ri||this._source.off("preclick",Ue))},getEvents:function(){var t=Oi.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=fe("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=fe("div",t+"-content-wrapper",e);if(this._contentNode=fe("div",t+"-content",n),Ve(e),qe(this._contentNode),Ne(e,"contextmenu",Ue),this._tipContainer=fe("div",t+"-tip-container",e),this._tip=fe("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=fe("a",t+"-close-button",e);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',Ne(i,"click",(function(t){Ye(t),this.close()}),this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&i>o?(e.height=o+"px",ke(t,r)):we(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();Pe(this._container,e.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,e=parseInt(_e(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,o=new D(this._containerLeft,-n-this._containerBottom);o._add(Te(this._container));var r=t.layerPointToContainerPoint(o),s=R(this.options.autoPanPadding),a=R(this.options.autoPanPaddingTopLeft||s),l=R(this.options.autoPanPaddingBottomRight||s),c=t.getSize(),h=0,u=0;r.x+i+l.x>c.x&&(h=r.x+i-c.x+l.x),r.x-h-a.x<0&&(h=r.x-a.x),r.y+n+l.y>c.y&&(u=r.y+n-c.y+l.y),r.y-u-a.y<0&&(u=r.y-a.y),(h||u)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([h,u]))}},_getAnchor:function(){return R(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ii=function(t,e){return new Di(t,e)};rn.mergeOptions({closePopupOnClick:!0}),rn.include({openPopup:function(t,e,n){return this._initOverlay(Di,t,e,n).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Vn.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Di,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Xn||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){Ke(t);var e=t.layer||t.target;this._popup._source!==e||e instanceof ri?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Ri=Oi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Oi.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Oi.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Oi.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=fe("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+s(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,n,i=this._map,o=this._container,r=i.latLngToContainerPoint(i.getCenter()),s=i.layerPointToContainerPoint(t),a=this.options.direction,l=o.offsetWidth,c=o.offsetHeight,h=R(this.options.offset),u=this._getAnchor();"top"===a?(e=l/2,n=c):"bottom"===a?(e=l/2,n=0):"center"===a?(e=l/2,n=c/2):"right"===a?(e=0,n=c/2):"left"===a?(e=l,n=c/2):s.x<r.x?(a="right",e=0,n=c/2):(a="left",e=l+2*(h.x+u.x),n=c/2),t=t.subtract(R(e,n,!0)).add(h).add(u),we(o,"leaflet-tooltip-right"),we(o,"leaflet-tooltip-left"),we(o,"leaflet-tooltip-top"),we(o,"leaflet-tooltip-bottom"),ke(o,"leaflet-tooltip-"+a),Pe(o,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&$e(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return R(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ai=function(t,e){return new Ri(t,e)};rn.include({openTooltip:function(t,e,n){return this._initOverlay(Ri,t,e,n).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Vn.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ri,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Xn||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&(Ne(e,"focus",(function(){this._tooltip._source=t,this.openTooltip()}),this),Ne(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",(function(){e._openOnceFlag=!1,e._openTooltip(t)}))}else this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var Bi=Qn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(ge(e),e.appendChild(n.html)):e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=R(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function zi(t){return new Bi(t)}Qn.Default=ei;var Ni=Vn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:zt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){p(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),me(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ve(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ye(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=a(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof D?t:new D(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,i=-t(-1/0,1/0),o=0,r=n.length;o<r;o++)e=n[o].style.zIndex,n[o]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!zt.ielt9){$e(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var o=this._tiles[i];if(o.current&&o.loaded){var r=Math.min(1,(t-o.loaded)/200);$e(o.el,r),r<1?e=!0:(o.active?n=!0:this._onOpaqueTile(o),o.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(C(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=fe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(me(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],o=this._map;return i||((i=this._levels[t]={}).el=fe("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,o.getCenter(),o.getZoom()),c(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)me(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,i){var o=Math.floor(t/2),r=Math.floor(e/2),s=n-1,a=new D(+o,+r);a.z=+s;var l=this._tileCoordsToKey(a),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),s>i&&this._retainParent(o,r,s,i))},_retainChildren:function(t,e,n,i){for(var o=2*t;o<2*t+2;o++)for(var r=2*e;r<2*e+2;r++){var s=new D(o,r);s.z=n+1;var a=this._tileCoordsToKey(s),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<i&&this._retainChildren(o,r,n+1,i))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var o=Math.round(e);o=void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom?void 0:this._clampZoom(o);var r=this.options.updateWhenZooming&&o!==this._tileZoom;i&&!r||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),o=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();zt.any3d?Ee(t.el,o,i):Pe(t.el,o)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),o=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*i);return new A(o.subtract(r),o.add(r))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(i),r=o.getCenter(),s=[],a=this.options.keepBuffer,l=new A(o.getBottomLeft().subtract([a,-a]),o.getTopRight().add([a,-a]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var h=this._tiles[c].coords;h.z===this._tileZoom&&l.contains(new D(h.x,h.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var u=o.min.y;u<=o.max.y;u++)for(var d=o.min.x;d<=o.max.x;d++){var p=new D(d,u);if(p.z=this._tileZoom,this._isValidTile(p)){var _=this._tiles[this._tileCoordsToKey(p)];_?_.current=!0:s.push(p)}}if(s.sort((function(t,e){return t.distanceTo(r)-e.distanceTo(r)})),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var f=document.createDocumentFragment();for(d=0;d<s.length;d++)this._addTile(s[d],f);this._level.el.appendChild(f)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return N(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),o=i.add(n);return[e.unproject(i,t.z),e.unproject(o,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new z(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new D(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(me(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ke(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=c,t.onmousemove=c,zt.ielt9&&this.options.opacity<1&&$e(t,this.options.opacity)},_addTile:function(t,e){var n=this._getTilePos(t),i=this._tileCoordsToKey(t),r=this.createTile(this._wrapCoords(t),o(this._tileReady,this,t));this._initTile(r),this.createTile.length<2&&M(o(this._tileReady,this,t,null,r)),Pe(r,n),this._tiles[i]={el:r,coords:t,current:!0},e.appendChild(r),this.fire("tileloadstart",{tile:r,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var i=this._tileCoordsToKey(t);(n=this._tiles[i])&&(n.loaded=+new Date,this._map._fadeAnimated?($e(n.el,0),C(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(ke(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),zt.ielt9||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new D(this._wrapX?l(t.x,this._wrapX):t.x,this._wrapY?l(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new A(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function ji(t){return new Ni(t)}var Fi=Ni.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=p(this,e)).detectRetina&&zt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Ne(n,"load",o(this._tileOnLoad,this,e,n)),Ne(n,"error",o(this._tileOnError,this,e,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:zt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return m(this._url,n(e,this.options))},_tileOnLoad:function(t,e){zt.ielt9?setTimeout(o(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.getAttribute("src")!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=c,e.onerror=c,!e.complete)){e.src=y;var n=this._tiles[t].coords;me(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:n})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",y),Ni.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==y))return Ni.prototype._tileReady.call(this,t,e,n)}});function Wi(t,e){return new Fi(t,e)}var Hi=Fi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=n({},this.defaultWmsParams);for(var o in e)o in this.options||(i[o]=e[o]);var r=(e=p(this,e)).detectRetina&&zt.retina?2:1,s=this.getTileSize();i.width=s.x*r,i.height=s.y*r,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,Fi.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,i=B(n.project(e[0]),n.project(e[1])),o=i.min,r=i.max,s=(this._wmsVersion>=1.3&&this._crs===Un?[o.y,o.x,r.y,r.x]:[o.x,o.y,r.x,r.y]).join(","),a=Fi.prototype.getTileUrl.call(this,t);return a+_(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,e){return n(this.wmsParams,t),e||this.redraw(),this}});function Gi(t,e){return new Hi(t,e)}Fi.WMS=Hi,Wi.wms=Gi;var Zi=Vn.extend({options:{padding:.1},initialize:function(t){p(this,t),s(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ke(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),r=i.multiplyBy(-n).add(o).subtract(this._map._getNewPixelOrigin(t,e));zt.any3d?Ee(this._container,r,n):Pe(this._container,r)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new A(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ui=Zi.extend({options:{tolerance:0},getEvents:function(){var t=Zi.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Zi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Ne(t,"mousemove",this._onMouseMove,this),Ne(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ne(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){C(this._redrawRequest),delete this._ctx,me(this._container),Fe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Zi.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=zt.retina?2:1;Pe(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",zt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Zi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[s(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[s(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,n,i=t.options.dashArray.split(/[, ]+/),o=[];for(n=0;n<i.length;n++){if(e=Number(i[n]),isNaN(e))return;o.push(e)}t.options._dashArray=o}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new A,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,o,r,s=t._parts,a=s.length,l=this._ctx;if(a){for(l.beginPath(),n=0;n<a;n++){for(i=0,o=s[n].length;i<o;i++)r=s[n][i],l[i?"lineTo":"moveTo"](r.x,r.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=Math.max(Math.round(t._radius),1),o=(Math.max(Math.round(t._radiusY),1)||i)/i;1!==o&&(n.save(),n.scale(1,o)),n.beginPath(),n.arc(e.x,e.y/o,i,0,2*Math.PI,!1),1!==o&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(i)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(n=e);this._fireEvent(!!n&&[n],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(we(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,i,r=this._drawFirst;r;r=r.next)(n=r.layer).options.interactive&&n._containsPoint(e)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(ke(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(o((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function qi(t){return zt.canvas?new Ui(t):null}var Vi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Yi={_initContainer:function(){this._container=fe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Zi.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Vi("shape");ke(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Vi("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;me(e),t.removeInteractiveTarget(e),delete this._layers[s(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,o=t._container;o.stroked=!!i.stroke,o.filled=!!i.fill,i.stroke?(e||(e=t._stroke=Vi("stroke")),o.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=g(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(o.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=Vi("fill")),o.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(o.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ve(t._container)},_bringToBack:function(t){ye(t._container)}},Ki=zt.vml?Vi:X,Xi=Zi.extend({_initContainer:function(){this._container=Ki("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ki("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){me(this._container),Fe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Zi.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),Pe(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Ki("path");t.options.className&&ke(e,t.options.className),t.options.interactive&&ke(e,"leaflet-interactive"),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){me(t._path),t.removeInteractiveTarget(t._path),delete this._layers[s(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,J(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),i="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,o)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ve(t._path)},_bringToBack:function(t){ye(t._path)}});function Ji(t){return zt.svg||zt.vml?new Xi(t):null}zt.vml&&Xi.include(Yi),rn.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&qi(t)||Ji(t)}});var Qi=di.extend({initialize:function(t,e){di.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=N(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function to(t,e){return new Qi(t,e)}Xi.create=Ki,Xi.pointsToPath=J,_i.geometryToLayer=fi,_i.coordsToLatLng=gi,_i.coordsToLatLngs=vi,_i.latLngToCoords=yi,_i.latLngsToCoords=bi,_i.getFeature=ki,_i.asFeature=wi,rn.mergeOptions({boxZoom:!0});var eo=vn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Ne(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Fe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){me(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),re(),Oe(),this._startPoint=this._map.mouseEventToContainerPoint(t),Ne(document,{contextmenu:Ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=fe("div","leaflet-zoom-box",this._container),ke(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new A(this._point,this._startPoint),n=e.getSize();Pe(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(me(this._box),we(this._container,"leaflet-crosshair")),se(),De(),Fe(document,{contextmenu:Ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var e=new z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});rn.addInitHook("addHandler","boxZoom",eo),rn.mergeOptions({doubleClickZoom:!0});var no=vn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,o=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}});rn.addInitHook("addHandler","doubleClickZoom",no),rn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var io=vn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new kn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ke(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){we(this._map._container,"leaflet-grab"),we(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=N(this._map.options.maxBounds);this._offsetLimit=B(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,r=(i+e+n)%t-e-n,s=Math.abs(o+n)<Math.abs(r+n)?o:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{this._prunePositions(+new Date);var o=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,s=n.easeLinearity,a=o.multiplyBy(s/r),l=a.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),h=a.multiplyBy(c/l),u=c/(n.inertiaDeceleration*s),d=h.multiplyBy(-u/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),M((function(){e.panBy(d,{duration:u,easeLinearity:s,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});rn.addInitHook("addHandler","dragging",io),rn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var oo=vn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Ne(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Fe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;e<n;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;e<n;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;e<n;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;e<n;e++)i[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;e<n;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;e<n;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){Ne(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Fe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(e=this._panKeys[n],t.shiftKey&&(e=R(e).multiplyBy(3)),i.options.maxBounds&&(e=i._limitOffset(R(e),i.options.maxBounds)),i.options.worldCopyJump){var o=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(e)));i.panTo(o)}else i.panBy(e)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Ke(t)}}});rn.addInitHook("addHandler","keyboard",oo),rn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ro=vn.extend({addHooks:function(){Ne(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Fe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=tn(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),i),Ke(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,r=n?Math.ceil(o/n)*n:o,s=t._limitZoom(e+(this._delta>0?r:-r))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});rn.addInitHook("addHandler","scrollWheelZoom",ro);var so=600;rn.mergeOptions({tapHold:zt.touchNative&&zt.safari&&zt.mobile,tapTolerance:15});var ao=vn.extend({addHooks:function(){Ne(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Fe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new D(e.clientX,e.clientY),this._holdTimeout=setTimeout(o((function(){this._cancel(),this._isTapValid()&&(Ne(document,"touchend",Ye),Ne(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))}),this),so),Ne(document,"touchend touchcancel contextmenu",this._cancel,this),Ne(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Fe(document,"touchend",Ye),Fe(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Fe(document,"touchend touchcancel contextmenu",this._cancel,this),Fe(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new D(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var n=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});n._simulated=!0,e.target.dispatchEvent(n)}});rn.addInitHook("addHandler","tapHold",ao),rn.mergeOptions({touchZoom:zt.touch,bounceAtZoomLimits:!0});var lo=vn.extend({addHooks:function(){ke(this._map._container,"leaflet-touch-zoom"),Ne(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){we(this._map._container,"leaflet-touch-zoom"),Fe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Ne(document,"touchmove",this._onTouchMove,this),Ne(document,"touchend touchcancel",this._onTouchEnd,this),Ye(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]),r=n.distanceTo(i)/this._startDist;if(this._zoom=e.getScaleZoom(r,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&r<1||this._zoom>e.getMaxZoom()&&r>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{var s=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===r&&0===s.x&&0===s.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),C(this._animRequest);var a=o(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=M(a,this,!0),Ye(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,C(this._animRequest),Fe(document,"touchmove",this._onTouchMove,this),Fe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});rn.addInitHook("addHandler","touchZoom",lo),rn.BoxZoom=eo,rn.DoubleClickZoom=no,rn.Drag=io,rn.Keyboard=oo,rn.ScrollWheelZoom=ro,rn.TapHold=ao,rn.TouchZoom=lo,t.Bounds=A,t.Browser=zt,t.CRS=H,t.Canvas=Ui,t.Circle=li,t.CircleMarker=si,t.Class=P,t.Control=an,t.DivIcon=Bi,t.DivOverlay=Oi,t.DomEvent=nn,t.DomUtil=ze,t.Draggable=kn,t.Evented=O,t.FeatureGroup=Xn,t.GeoJSON=_i,t.GridLayer=Ni,t.Handler=vn,t.Icon=Qn,t.ImageOverlay=Mi,t.LatLng=j,t.LatLngBounds=z,t.Layer=Vn,t.LayerGroup=Yn,t.LineUtil=Fn,t.Map=rn,t.Marker=ii,t.Mixin=yn,t.Path=ri,t.Point=D,t.PolyUtil=Mn,t.Polygon=di,t.Polyline=hi,t.Popup=Di,t.PosAnimation=on,t.Projection=Gn,t.Rectangle=Qi,t.Renderer=Zi,t.SVG=Xi,t.SVGOverlay=Ti,t.TileLayer=Fi,t.Tooltip=Ri,t.Transformation=q,t.Util=E,t.VideoOverlay=Ei,t.bind=o,t.bounds=B,t.canvas=qi,t.circle=ci,t.circleMarker=ai,t.control=ln,t.divIcon=zi,t.extend=n,t.featureGroup=Jn,t.geoJSON=Li,t.geoJson=$i,t.gridLayer=ji,t.icon=ti,t.imageOverlay=Ci,t.latLng=F,t.latLngBounds=N,t.layerGroup=Kn,t.map=sn,t.marker=oi,t.point=R,t.polygon=pi,t.polyline=ui,t.popup=Ii,t.rectangle=to,t.setOptions=p,t.stamp=s,t.svg=Ji,t.svgOverlay=Si,t.tileLayer=Wi,t.tooltip=Ai,t.transformation=V,t.version=e,t.videoOverlay=Pi;var co=window.L;t.noConflict=function(){return window.L=co,this},window.L=t}(e)}));
/**
     * leaflet plugin for plain image map projection
     * @copyright 2016 - commenthol
     * @license MIT
     * @link https://github.com/commenthol/leaflet-rastercoords
     */class RasterCoords{constructor(t,e,n){if(void 0===window.L)throw new Error("Leaflet must be loaded first");this.map=t,this.width=e.width,this.height=e.height,this.tileSize=n||256,this.zoom=this.getZoomLevel(),this.width&&this.height&&this.setMaxBounds()}getZoomLevel(){return Math.ceil(Math.log(Math.max(this.width,this.height)/this.tileSize)/Math.log(2))}unproject(t){return this.map.unproject(t,this.zoom)}project(t){return this.map.project(t,this.zoom)}getMaxBounds(t){let e=this.unproject([0,this.height]),n=this.unproject([this.width,0]);return t&&(e.lng=e.lng-t,e.lat=e.lat-t,n.lng=n.lng+t,n.lat=n.lat+t),new L.LatLngBounds(e,n)}setMaxBounds(){let t=this.getMaxBounds();this.map.setMaxBounds(t)}}(()=>{var t={9705:(t,e,n)=>{var i=n(1540);function o(t){var e=[1/0,1/0,-1/0,-1/0];return i.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}o.default=o,e.Z=o},4102:(t,e)=>{function n(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function i(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!p(t[0])||!p(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,i)}function o(t,e,i){void 0===i&&(i={});for(var o=0,r=t;o<r.length;o++){var s=r[o];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function r(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function l(t,e,i){return void 0===i&&(i={}),n({type:"MultiPoint",coordinates:t},e,i)}function c(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function h(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t*i}function u(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t/i}function d(t){return t%(2*Math.PI)*180/Math.PI}function p(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(t){case"Point":return i(e).geometry;case"LineString":return r(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},e.point=i,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.polygon=o,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.lineString=r,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=c,e.geometryCollection=function(t,e,i){return void 0===i&&(i={}),n({type:"GeometryCollection",geometries:t},e,i)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=h,e.lengthToRadians=u,e.lengthToDegrees=function(t,e){return d(u(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=d,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return h(u(t,e),n)},e.convertArea=function(t,n,i){if(void 0===n&&(n="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var o=e.areaFactors[n];if(!o)throw new Error("invalid original units");var r=e.areaFactors[i];if(!r)throw new Error("invalid final units");return t/o*r},e.isNumber=p,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!p(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},1540:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=n(4102);function o(t,e,n){if(null!==t)for(var i,r,s,a,l,c,h,u,d=0,p=0,_=t.type,f="FeatureCollection"===_,m="Feature"===_,g=f?t.features.length:1,v=0;v<g;v++){l=(u=!!(h=f?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var y=0;y<l;y++){var b=0,k=0;if(null!==(a=u?h.geometries[y]:h)){c=a.coordinates;var w=a.type;switch(d=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(c,p,v,b,k))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<c.length;i++){if(!1===e(c[i],p,v,b,k))return!1;p++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<c.length;i++){for(r=0;r<c[i].length-d;r++){if(!1===e(c[i][r],p,v,b,k))return!1;p++}"MultiLineString"===w&&b++,"Polygon"===w&&k++}"Polygon"===w&&b++;break;case"MultiPolygon":for(i=0;i<c.length;i++){for(k=0,r=0;r<c[i].length;r++){for(s=0;s<c[i][r].length-d;s++){if(!1===e(c[i][r][s],p,v,b,k))return!1;p++}k++}b++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===o(a.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function r(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,i,o,r,s,a,l,c,h,u,d=0,p="FeatureCollection"===t.type,_="Feature"===t.type,f=p?t.features.length:1;for(n=0;n<f;n++){for(a=p?t.features[n].geometry:_?t.geometry:t,c=p?t.features[n].properties:_?t.properties:{},h=p?t.features[n].bbox:_?t.bbox:void 0,u=p?t.features[n].id:_?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<s;o++)if(null!==(r=l?a.geometries[o]:a))switch(r.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(r,d,c,h,u))return!1;break;case"GeometryCollection":for(i=0;i<r.geometries.length;i++)if(!1===e(r.geometries[i],d,c,h,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,c,h,u))return!1;d++}}function l(t,e){a(t,(function(t,n,o,r,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(i.feature(t,o,{bbox:r,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<t.coordinates.length;c++){var h={type:a,coordinates:t.coordinates[c]};if(!1===e(i.feature(h,o),n,c))return!1}}))}function c(t,e){l(t,(function(t,n,r){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,c=0,h=0,u=0;return!1!==o(t,(function(o,a,d,p,_){if(void 0===l||n>c||p>h||_>u)return l=o,c=n,h=p,u=_,void(s=0);var f=i.lineString([l,o],t.properties);if(!1===e(f,n,r,_,s))return!1;s++,l=o}))&&void 0}}}))}function h(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,o){if(null!==t.geometry){var r=t.geometry.type,s=t.geometry.coordinates;switch(r){case"LineString":if(!1===e(t,n,o,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(i.lineString(s[a],t.properties),n,o,a))return!1}}}))}e.coordAll=function(t){var e=[];return o(t,(function(t){e.push(t)})),e},e.coordEach=o,e.coordReduce=function(t,e,n,i){var r=n;return o(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)}),i),r},e.featureEach=s,e.featureReduce=function(t,e,n){var i=n;return s(t,(function(t,o){i=0===o&&void 0===n?t:e(i,t,o)})),i},e.findPoint=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,o=e.featureIndex||0,r=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),l=l||t.features[o].properties,n=t.features[o].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return i.point(c,l,e);case"MultiPoint":return r<0&&(r=c.length+r),i.point(c[r],l,e);case"LineString":return a<0&&(a=c.length+a),i.point(c[a],l,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a),i.point(c[s][a],l,e);case"MultiLineString":return r<0&&(r=c.length+r),a<0&&(a=c[r].length+a),i.point(c[r][a],l,e);case"MultiPolygon":return r<0&&(r=c.length+r),s<0&&(s=c[r].length+s),a<0&&(a=c[r][s].length-a),i.point(c[r][s][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,o=e.featureIndex||0,r=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),l=l||t.features[o].properties,n=t.features[o].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),i.lineString([c[a],c[a+1]],l,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a-1),i.lineString([c[s][a],c[s][a+1]],l,e);case"MultiLineString":return r<0&&(r=c.length+r),a<0&&(a=c[r].length+a-1),i.lineString([c[r][a],c[r][a+1]],l,e);case"MultiPolygon":return r<0&&(r=c.length+r),s<0&&(s=c[r].length+s),a<0&&(a=c[r][s].length-a-1),i.lineString([c[r][s][a],c[r][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var i=n;return l(t,(function(t,o,r){i=0===o&&0===r&&void 0===n?t:e(i,t,o,r)})),i},e.geomEach=a,e.geomReduce=function(t,e,n){var i=n;return a(t,(function(t,o,r,s,a){i=0===o&&void 0===n?t:e(i,t,o,r,s,a)})),i},e.lineEach=h,e.lineReduce=function(t,e,n){var i=n;return h(t,(function(t,o,r,s){i=0===o&&void 0===n?t:e(i,t,o,r,s)})),i},e.propEach=r,e.propReduce=function(t,e,n){var i=n;return r(t,(function(t,o){i=0===o&&void 0===n?t:e(i,t,o)})),i},e.segmentEach=c,e.segmentReduce=function(t,e,n){var i=n,o=!1;return c(t,(function(t,r,s,a,l){i=!1===o&&void 0===n?t:e(i,t,r,s,a,l),o=!0})),i}},5975:(t,e,n)=>{n(7107);var i=n(2492),o=n.n(i);const r=JSON.parse('{"tooltips":{"placeMarker":"Click to place marker","firstVertex":"Click to place first vertex","continueLine":"Click to continue drawing","finishLine":"Click any existing marker to finish","finishPoly":"Click first marker to finish","finishRect":"Click to finish","startCircle":"Click to place circle center","finishCircle":"Click to finish circle","placeCircleMarker":"Click to place circle marker","placeText":"Click to place text"},"actions":{"finish":"Finish","cancel":"Cancel","removeLastVertex":"Remove Last Vertex"},"buttonTitles":{"drawMarkerButton":"Draw Marker","drawPolyButton":"Draw Polygons","drawLineButton":"Draw Polyline","drawCircleButton":"Draw Circle","drawRectButton":"Draw Rectangle","editButton":"Edit Layers","dragButton":"Drag Layers","cutButton":"Cut Layers","deleteButton":"Remove Layers","drawCircleMarkerButton":"Draw Circle Marker","snappingButton":"Snap dragged marker to other layers and vertices","pinningButton":"Pin shared vertices together","rotateButton":"Rotate Layers","drawTextButton":"Draw Text","scaleButton":"Scale Layers","autoTracingButton":"Auto trace Line"},"measurements":{"totalLength":"Length","segmentLength":"Segment length","area":"Area","radius":"Radius","perimeter":"Perimeter","height":"Height","width":"Width","coordinates":"Position","coordinatesMarker":"Position Marker"}}'),s=JSON.parse('{"tooltips":{"placeMarker":"Platziere den Marker mit Klick","firstVertex":"Platziere den ersten Marker mit Klick","continueLine":"Klicke, um weiter zu zeichnen","finishLine":"Beende mit Klick auf existierenden Marker","finishPoly":"Beende mit Klick auf ersten Marker","finishRect":"Beende mit Klick","startCircle":"Platziere das Kreiszentrum mit Klick","finishCircle":"Beende den Kreis mit Klick","placeCircleMarker":"Platziere den Kreismarker mit Klick","placeText":"Platziere den Text mit Klick"},"actions":{"finish":"Beenden","cancel":"Abbrechen","removeLastVertex":"Letzten Vertex löschen"},"buttonTitles":{"drawMarkerButton":"Marker zeichnen","drawPolyButton":"Polygon zeichnen","drawLineButton":"Polyline zeichnen","drawCircleButton":"Kreis zeichnen","drawRectButton":"Rechteck zeichnen","editButton":"Layer editieren","dragButton":"Layer bewegen","cutButton":"Layer schneiden","deleteButton":"Layer löschen","drawCircleMarkerButton":"Kreismarker zeichnen","snappingButton":"Bewegter Layer an andere Layer oder Vertexe einhacken","pinningButton":"Vertexe an der gleichen Position verknüpfen","rotateButton":"Layer drehen","drawTextButton":"Text zeichnen","scaleButton":"Layer skalieren","autoTracingButton":"Linie automatisch nachzeichen"},"measurements":{"totalLength":"Länge","segmentLength":"Segment Länge","area":"Fläche","radius":"Radius","perimeter":"Umfang","height":"Höhe","width":"Breite","coordinates":"Position","coordinatesMarker":"Position Marker"}}'),a=JSON.parse('{"tooltips":{"placeMarker":"Clicca per posizionare un Marker","firstVertex":"Clicca per posizionare il primo vertice","continueLine":"Clicca per continuare a disegnare","finishLine":"Clicca qualsiasi marker esistente per terminare","finishPoly":"Clicca il primo marker per terminare","finishRect":"Clicca per terminare","startCircle":"Clicca per posizionare il punto centrale del cerchio","finishCircle":"Clicca per terminare il cerchio","placeCircleMarker":"Clicca per posizionare un Marker del cherchio"},"actions":{"finish":"Termina","cancel":"Annulla","removeLastVertex":"Rimuovi l\'ultimo vertice"},"buttonTitles":{"drawMarkerButton":"Disegna Marker","drawPolyButton":"Disegna Poligoni","drawLineButton":"Disegna Polilinea","drawCircleButton":"Disegna Cerchio","drawRectButton":"Disegna Rettangolo","editButton":"Modifica Livelli","dragButton":"Sposta Livelli","cutButton":"Ritaglia Livelli","deleteButton":"Elimina Livelli","drawCircleMarkerButton":"Disegna Marker del Cerchio","snappingButton":"Snap ha trascinato il pennarello su altri strati e vertici","pinningButton":"Pin condiviso vertici insieme"}}'),l=JSON.parse('{"tooltips":{"placeMarker":"Klik untuk menempatkan marker","firstVertex":"Klik untuk menempatkan vertex pertama","continueLine":"Klik untuk meneruskan digitasi","finishLine":"Klik pada sembarang marker yang ada untuk mengakhiri","finishPoly":"Klik marker pertama untuk mengakhiri","finishRect":"Klik untuk mengakhiri","startCircle":"Klik untuk menempatkan titik pusat lingkaran","finishCircle":"Klik untuk mengakhiri lingkaran","placeCircleMarker":"Klik untuk menempatkan penanda lingkarann"},"actions":{"finish":"Selesai","cancel":"Batal","removeLastVertex":"Hilangkan Vertex Terakhir"},"buttonTitles":{"drawMarkerButton":"Digitasi Marker","drawPolyButton":"Digitasi Polygon","drawLineButton":"Digitasi Polyline","drawCircleButton":"Digitasi Lingkaran","drawRectButton":"Digitasi Segi Empat","editButton":"Edit Layer","dragButton":"Geser Layer","cutButton":"Potong Layer","deleteButton":"Hilangkan Layer","drawCircleMarkerButton":"Digitasi Penanda Lingkaran","snappingButton":"Jepretkan penanda yang ditarik ke lapisan dan simpul lain","pinningButton":"Sematkan simpul bersama bersama"}}'),c=JSON.parse('{"tooltips":{"placeMarker":"Adaugă un punct","firstVertex":"Apasă aici pentru a adăuga primul Vertex","continueLine":"Apasă aici pentru a continua desenul","finishLine":"Apasă pe orice obiect pentru a finisa desenul","finishPoly":"Apasă pe primul obiect pentru a finisa","finishRect":"Apasă pentru a finisa","startCircle":"Apasă pentru a desena un cerc","finishCircle":"Apasă pentru a finisa un cerc","placeCircleMarker":"Adaugă un punct"},"actions":{"finish":"Termină","cancel":"Anulează","removeLastVertex":"Șterge ultimul Vertex"},"buttonTitles":{"drawMarkerButton":"Adaugă o bulină","drawPolyButton":"Desenează un poligon","drawLineButton":"Desenează o linie","drawCircleButton":"Desenează un cerc","drawRectButton":"Desenează un dreptunghi","editButton":"Editează straturile","dragButton":"Mută straturile","cutButton":"Taie straturile","deleteButton":"Șterge straturile","drawCircleMarkerButton":"Desenează marcatorul cercului","snappingButton":"Fixați marcatorul glisat pe alte straturi și vârfuri","pinningButton":"Fixați vârfurile partajate împreună"}}'),h=JSON.parse('{"tooltips":{"placeMarker":"Нажмите, чтобы нанести маркер","firstVertex":"Нажмите, чтобы нанести первый объект","continueLine":"Нажмите, чтобы продолжить рисование","finishLine":"Нажмите любой существующий маркер для завершения","finishPoly":"Выберите первую точку, чтобы закончить","finishRect":"Нажмите, чтобы закончить","startCircle":"Нажмите, чтобы добавить центр круга","finishCircle":"Нажмите, чтобы задать радиус","placeCircleMarker":"Нажмите, чтобы нанести круговой маркер"},"actions":{"finish":"Завершить","cancel":"Отменить","removeLastVertex":"Отменить последнее действие"},"buttonTitles":{"drawMarkerButton":"Добавить маркер","drawPolyButton":"Рисовать полигон","drawLineButton":"Рисовать кривую","drawCircleButton":"Рисовать круг","drawRectButton":"Рисовать прямоугольник","editButton":"Редактировать слой","dragButton":"Перенести слой","cutButton":"Вырезать слой","deleteButton":"Удалить слой","drawCircleMarkerButton":"Добавить круговой маркер","snappingButton":"Привязать перетаскиваемый маркер к другим слоям и вершинам","pinningButton":"Связать общие точки вместе"}}'),u=JSON.parse('{"tooltips":{"placeMarker":"Presiona para colocar un marcador","firstVertex":"Presiona para colocar el primer vértice","continueLine":"Presiona para continuar dibujando","finishLine":"Presiona cualquier marcador existente para finalizar","finishPoly":"Presiona el primer marcador para finalizar","finishRect":"Presiona para finalizar","startCircle":"Presiona para colocar el centro del círculo","finishCircle":"Presiona para finalizar el círculo","placeCircleMarker":"Presiona para colocar un marcador de círculo"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Eliminar último vértice"},"buttonTitles":{"drawMarkerButton":"Dibujar Marcador","drawPolyButton":"Dibujar Polígono","drawLineButton":"Dibujar Línea","drawCircleButton":"Dibujar Círculo","drawRectButton":"Dibujar Rectángulo","editButton":"Editar Capas","dragButton":"Arrastrar Capas","cutButton":"Cortar Capas","deleteButton":"Eliminar Capas","drawCircleMarkerButton":"Dibujar Marcador de Círculo","snappingButton":"El marcador de Snap arrastrado a otras capas y vértices","pinningButton":"Fijar juntos los vértices compartidos"}}'),d=JSON.parse('{"tooltips":{"placeMarker":"Klik om een marker te plaatsen","firstVertex":"Klik om het eerste punt te plaatsen","continueLine":"Klik om te blijven tekenen","finishLine":"Klik op een bestaand punt om te beëindigen","finishPoly":"Klik op het eerst punt om te beëindigen","finishRect":"Klik om te beëindigen","startCircle":"Klik om het middelpunt te plaatsen","finishCircle":"Klik om de cirkel te beëindigen","placeCircleMarker":"Klik om een marker te plaatsen"},"actions":{"finish":"Bewaar","cancel":"Annuleer","removeLastVertex":"Verwijder laatste punt"},"buttonTitles":{"drawMarkerButton":"Plaats Marker","drawPolyButton":"Teken een vlak","drawLineButton":"Teken een lijn","drawCircleButton":"Teken een cirkel","drawRectButton":"Teken een vierkant","editButton":"Bewerk","dragButton":"Verplaats","cutButton":"Knip","deleteButton":"Verwijder","drawCircleMarkerButton":"Plaats Marker","snappingButton":"Snap gesleepte marker naar andere lagen en hoekpunten","pinningButton":"Speld gedeelde hoekpunten samen"}}'),p=JSON.parse('{"tooltips":{"placeMarker":"Cliquez pour placer un marqueur","firstVertex":"Cliquez pour placer le premier sommet","continueLine":"Cliquez pour continuer à dessiner","finishLine":"Cliquez sur n\'importe quel marqueur pour terminer","finishPoly":"Cliquez sur le premier marqueur pour terminer","finishRect":"Cliquez pour terminer","startCircle":"Cliquez pour placer le centre du cercle","finishCircle":"Cliquez pour finir le cercle","placeCircleMarker":"Cliquez pour placer le marqueur circulaire"},"actions":{"finish":"Terminer","cancel":"Annuler","removeLastVertex":"Retirer le dernier sommet"},"buttonTitles":{"drawMarkerButton":"Placer des marqueurs","drawPolyButton":"Dessiner des polygones","drawLineButton":"Dessiner des polylignes","drawCircleButton":"Dessiner un cercle","drawRectButton":"Dessiner un rectangle","editButton":"Éditer des calques","dragButton":"Déplacer des calques","cutButton":"Couper des calques","deleteButton":"Supprimer des calques","drawCircleMarkerButton":"Dessiner un marqueur circulaire","snappingButton":"Glisser le marqueur vers d\'autres couches et sommets","pinningButton":"Épingler ensemble les sommets partagés","rotateButton":"Tourner des calques"}}'),_=JSON.parse('{"tooltips":{"placeMarker":"单击放置标记","firstVertex":"单击放置首个顶点","continueLine":"单击继续绘制","finishLine":"单击任何存在的标记以完成","finishPoly":"单击第一个标记以完成","finishRect":"单击完成","startCircle":"单击放置圆心","finishCircle":"单击完成圆形","placeCircleMarker":"点击放置圆形标记"},"actions":{"finish":"完成","cancel":"取消","removeLastVertex":"移除最后的顶点"},"buttonTitles":{"drawMarkerButton":"绘制标记","drawPolyButton":"绘制多边形","drawLineButton":"绘制线段","drawCircleButton":"绘制圆形","drawRectButton":"绘制长方形","editButton":"编辑图层","dragButton":"拖拽图层","cutButton":"剪切图层","deleteButton":"删除图层","drawCircleMarkerButton":"画圆圈标记","snappingButton":"将拖动的标记捕捉到其他图层和顶点","pinningButton":"将共享顶点固定在一起"}}'),f=JSON.parse('{"tooltips":{"placeMarker":"單擊放置標記","firstVertex":"單擊放置第一個頂點","continueLine":"單擊繼續繪製","finishLine":"單擊任何存在的標記以完成","finishPoly":"單擊第一個標記以完成","finishRect":"單擊完成","startCircle":"單擊放置圓心","finishCircle":"單擊完成圓形","placeCircleMarker":"點擊放置圓形標記"},"actions":{"finish":"完成","cancel":"取消","removeLastVertex":"移除最後一個頂點"},"buttonTitles":{"drawMarkerButton":"放置標記","drawPolyButton":"繪製多邊形","drawLineButton":"繪製線段","drawCircleButton":"繪製圓形","drawRectButton":"繪製方形","editButton":"編輯圖形","dragButton":"移動圖形","cutButton":"裁切圖形","deleteButton":"刪除圖形","drawCircleMarkerButton":"畫圓圈標記","snappingButton":"將拖動的標記對齊到其他圖層和頂點","pinningButton":"將共享頂點固定在一起"}}'),m={en:r,de:s,it:a,id:l,ro:c,ru:h,es:u,nl:d,fr:p,pt_br:JSON.parse('{"tooltips":{"placeMarker":"Clique para posicionar o marcador","firstVertex":"Clique para posicionar o primeiro vértice","continueLine":"Clique para continuar desenhando","finishLine":"Clique em qualquer marcador existente para finalizar","finishPoly":"Clique no primeiro ponto para fechar o polígono","finishRect":"Clique para finalizar","startCircle":"Clique para posicionar o centro do círculo","finishCircle":"Clique para fechar o círculo","placeCircleMarker":"Clique para posicionar o marcador circular"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover último vértice"},"buttonTitles":{"drawMarkerButton":"Desenhar um marcador","drawPolyButton":"Desenhar um polígono","drawLineButton":"Desenhar uma polilinha","drawCircleButton":"Desenhar um círculo","drawRectButton":"Desenhar um retângulo","editButton":"Editar camada(s)","dragButton":"Mover camada(s)","cutButton":"Recortar camada(s)","deleteButton":"Remover camada(s)","drawCircleMarkerButton":"Marcador de círculos de desenho","snappingButton":"Marcador arrastado para outras camadas e vértices","pinningButton":"Vértices compartilhados de pinos juntos"}}'),zh:_,zh_tw:f,pl:JSON.parse('{"tooltips":{"placeMarker":"Kliknij, aby ustawić znacznik","firstVertex":"Kliknij, aby ustawić pierwszy punkt","continueLine":"Kliknij, aby kontynuować rysowanie","finishLine":"Kliknij dowolny punkt, aby zakończyć","finishPoly":"Kliknij pierwszy punkt, aby zakończyć","finishRect":"Kliknij, aby zakończyć","startCircle":"Kliknij, aby ustawić środek koła","finishCircle":"Kliknij, aby zakończyć rysowanie koła","placeCircleMarker":"Kliknij, aby ustawić okrągły znacznik"},"actions":{"finish":"Zakończ","cancel":"Anuluj","removeLastVertex":"Usuń ostatni punkt"},"buttonTitles":{"drawMarkerButton":"Narysuj znacznik","drawPolyButton":"Narysuj wielokąt","drawLineButton":"Narysuj ścieżkę","drawCircleButton":"Narysuj koło","drawRectButton":"Narysuj prostokąt","editButton":"Edytuj","dragButton":"Przesuń","cutButton":"Wytnij","deleteButton":"Usuń","drawCircleMarkerButton":"Narysuj okrągły znacznik","snappingButton":"Snap przeciągnięty marker na inne warstwy i wierzchołki","pinningButton":"Sworzeń wspólne wierzchołki razem"}}'),sv:JSON.parse('{"tooltips":{"placeMarker":"Klicka för att placera markör","firstVertex":"Klicka för att placera första hörnet","continueLine":"Klicka för att fortsätta rita","finishLine":"Klicka på en existerande punkt för att slutföra","finishPoly":"Klicka på den första punkten för att slutföra","finishRect":"Klicka för att slutföra","startCircle":"Klicka för att placera cirkelns centrum","finishCircle":"Klicka för att slutföra cirkeln","placeCircleMarker":"Klicka för att placera cirkelmarkör"},"actions":{"finish":"Slutför","cancel":"Avbryt","removeLastVertex":"Ta bort sista hörnet"},"buttonTitles":{"drawMarkerButton":"Rita Markör","drawPolyButton":"Rita Polygoner","drawLineButton":"Rita Linje","drawCircleButton":"Rita Cirkel","drawRectButton":"Rita Rektangel","editButton":"Redigera Lager","dragButton":"Dra Lager","cutButton":"Klipp i Lager","deleteButton":"Ta bort Lager","drawCircleMarkerButton":"Rita Cirkelmarkör","snappingButton":"Snäpp dra markören till andra lager och hörn","pinningButton":"Fäst delade hörn tillsammans"}}'),el:JSON.parse('{"tooltips":{"placeMarker":"Κάντε κλικ για να τοποθετήσετε Δείκτη","firstVertex":"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο","continueLine":"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε","finishLine":"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί","finishPoly":"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε","finishRect":"Κάντε κλικ για να τελειώσετε","startCircle":"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου","finishCircle":"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο","placeCircleMarker":"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},"actions":{"finish":"Τέλος","cancel":"Ακύρωση","removeLastVertex":"Κατάργηση τελευταίου σημείου"},"buttonTitles":{"drawMarkerButton":"Σχεδίαση Δείκτη","drawPolyButton":"Σχεδίαση Πολυγώνου","drawLineButton":"Σχεδίαση Γραμμής","drawCircleButton":"Σχεδίαση Κύκλου","drawRectButton":"Σχεδίαση Ορθογωνίου","editButton":"Επεξεργασία Επιπέδων","dragButton":"Μεταφορά Επιπέδων","cutButton":"Αποκοπή Επιπέδων","deleteButton":"Κατάργηση Επιπέδων","drawCircleMarkerButton":"Σχεδίαση Κυκλικού Δείκτη","snappingButton":"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές","pinningButton":"Περικοπή κοινών κορυφών μαζί"}}'),hu:JSON.parse('{"tooltips":{"placeMarker":"Kattintson a jelölő elhelyezéséhez","firstVertex":"Kattintson az első pont elhelyezéséhez","continueLine":"Kattintson a következő pont elhelyezéséhez","finishLine":"A befejezéshez kattintson egy meglévő pontra","finishPoly":"A befejezéshez kattintson az első pontra","finishRect":"Kattintson a befejezéshez","startCircle":"Kattintson a kör középpontjának elhelyezéséhez","finishCircle":"Kattintson a kör befejezéséhez","placeCircleMarker":"Kattintson a körjelölő elhelyezéséhez"},"actions":{"finish":"Befejezés","cancel":"Mégse","removeLastVertex":"Utolsó pont eltávolítása"},"buttonTitles":{"drawMarkerButton":"Jelölő rajzolása","drawPolyButton":"Poligon rajzolása","drawLineButton":"Vonal rajzolása","drawCircleButton":"Kör rajzolása","drawRectButton":"Négyzet rajzolása","editButton":"Elemek szerkesztése","dragButton":"Elemek mozgatása","cutButton":"Elemek vágása","deleteButton":"Elemek törlése","drawCircleMarkerButton":"Kör jelölő rajzolása","snappingButton":"Kapcsolja a jelöltőt másik elemhez vagy ponthoz","pinningButton":"Közös pontok összekötése"}}'),da:JSON.parse('{"tooltips":{"placeMarker":"Tryk for at placere en markør","firstVertex":"Tryk for at placere det første punkt","continueLine":"Tryk for at fortsætte linjen","finishLine":"Tryk på et eksisterende punkt for at afslutte","finishPoly":"Tryk på det første punkt for at afslutte","finishRect":"Tryk for at afslutte","startCircle":"Tryk for at placere cirklens center","finishCircle":"Tryk for at afslutte cirklen","placeCircleMarker":"Tryk for at placere en cirkelmarkør"},"actions":{"finish":"Afslut","cancel":"Afbryd","removeLastVertex":"Fjern sidste punkt"},"buttonTitles":{"drawMarkerButton":"Placer markør","drawPolyButton":"Tegn polygon","drawLineButton":"Tegn linje","drawCircleButton":"Tegn cirkel","drawRectButton":"Tegn firkant","editButton":"Rediger","dragButton":"Træk","cutButton":"Klip","deleteButton":"Fjern","drawCircleMarkerButton":"Tegn cirkelmarkør","snappingButton":"Fastgør trukket markør til andre elementer","pinningButton":"Sammenlæg delte elementer"}}'),no:JSON.parse('{"tooltips":{"placeMarker":"Klikk for å plassere punkt","firstVertex":"Klikk for å plassere første punkt","continueLine":"Klikk for å tegne videre","finishLine":"Klikk på et eksisterende punkt for å fullføre","finishPoly":"Klikk første punkt for å fullføre","finishRect":"Klikk for å fullføre","startCircle":"Klikk for å sette sirkel midtpunkt","finishCircle":"Klikk for å fullføre sirkel","placeCircleMarker":"Klikk for å plassere sirkel"},"actions":{"finish":"Fullfør","cancel":"Kanseller","removeLastVertex":"Fjern forrige punkt"},"buttonTitles":{"drawMarkerButton":"Tegn Punkt","drawPolyButton":"Tegn Flate","drawLineButton":"Tegn Linje","drawCircleButton":"Tegn Sirkel","drawRectButton":"Tegn rektangel","editButton":"Rediger Objekter","dragButton":"Dra Objekter","cutButton":"Kutt Objekter","deleteButton":"Fjern Objekter","drawCircleMarkerButton":"Tegn sirkel-punkt","snappingButton":"Fest dratt punkt til andre objekter og punkt","pinningButton":"Pin delte punkt sammen"}}'),fa:JSON.parse('{"tooltips":{"placeMarker":"کلیک برای جانمایی نشان","firstVertex":"کلیک برای رسم اولین رأس","continueLine":"کلیک برای ادامه رسم","finishLine":"کلیک روی هر نشان موجود برای پایان","finishPoly":"کلیک روی اولین نشان برای پایان","finishRect":"کلیک برای پایان","startCircle":"کلیک برای رسم مرکز دایره","finishCircle":"کلیک برای پایان رسم دایره","placeCircleMarker":"کلیک برای رسم نشان دایره","placeText":"کلیک برای نوشتن متن"},"actions":{"finish":"پایان","cancel":"لفو","removeLastVertex":"حذف آخرین رأس"},"buttonTitles":{"drawMarkerButton":"درج نشان","drawPolyButton":"رسم چندضلعی","drawLineButton":"رسم خط","drawCircleButton":"رسم دایره","drawRectButton":"رسم چهارضلعی","editButton":"ویرایش لایه‌ها","dragButton":"جابجایی لایه‌ها","cutButton":"برش لایه‌ها","deleteButton":"حذف لایه‌ها","drawCircleMarkerButton":"رسم نشان دایره","snappingButton":"نشانگر را به لایه‌ها و رئوس دیگر بکشید","pinningButton":"رئوس مشترک را با هم پین کنید","rotateButton":"چرخش لایه","drawTextButton":"رسم متن"}}'),ua:JSON.parse('{"tooltips":{"placeMarker":"Натисніть, щоб нанести маркер","firstVertex":"Натисніть, щоб нанести першу вершину","continueLine":"Натисніть, щоб продовжити малювати","finishLine":"Натисніть будь-який існуючий маркер для завершення","finishPoly":"Виберіть перший маркер, щоб завершити","finishRect":"Натисніть, щоб завершити","startCircle":"Натисніть, щоб додати центр кола","finishCircle":"Натисніть, щоб завершити коло","placeCircleMarker":"Натисніть, щоб нанести круговий маркер"},"actions":{"finish":"Завершити","cancel":"Відмінити","removeLastVertex":"Видалити попередню вершину"},"buttonTitles":{"drawMarkerButton":"Малювати маркер","drawPolyButton":"Малювати полігон","drawLineButton":"Малювати криву","drawCircleButton":"Малювати коло","drawRectButton":"Малювати прямокутник","editButton":"Редагувати шари","dragButton":"Перенести шари","cutButton":"Вирізати шари","deleteButton":"Видалити шари","drawCircleMarkerButton":"Малювати круговий маркер","snappingButton":"Прив’язати перетягнутий маркер до інших шарів та вершин","pinningButton":"Зв\'язати спільні вершини разом"}}'),tr:JSON.parse('{"tooltips":{"placeMarker":"İşaretçi yerleştirmek için tıklayın","firstVertex":"İlk tepe noktasını yerleştirmek için tıklayın","continueLine":"Çizime devam etmek için tıklayın","finishLine":"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın","finishPoly":"Bitirmek için ilk işaretçiyi tıklayın","finishRect":"Bitirmek için tıklayın","startCircle":"Daire merkezine yerleştirmek için tıklayın","finishCircle":"Daireyi bitirmek için tıklayın","placeCircleMarker":"Daire işaretçisi yerleştirmek için tıklayın"},"actions":{"finish":"Bitir","cancel":"İptal","removeLastVertex":"Son köşeyi kaldır"},"buttonTitles":{"drawMarkerButton":"Çizim İşaretçisi","drawPolyButton":"Çokgenler çiz","drawLineButton":"Çoklu çizgi çiz","drawCircleButton":"Çember çiz","drawRectButton":"Dikdörtgen çiz","editButton":"Katmanları düzenle","dragButton":"Katmanları sürükle","cutButton":"Katmanları kes","deleteButton":"Katmanları kaldır","drawCircleMarkerButton":"Daire işaretçisi çiz","snappingButton":"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır","pinningButton":"Paylaşılan köşeleri birbirine sabitle"}}'),cz:JSON.parse('{"tooltips":{"placeMarker":"Kliknutím vytvoříte značku","firstVertex":"Kliknutím vytvoříte první objekt","continueLine":"Kliknutím pokračujte v kreslení","finishLine":"Kliknutí na libovolnou existující značku pro dokončení","finishPoly":"Vyberte první bod pro dokončení","finishRect":"Klikněte pro dokončení","startCircle":"Kliknutím přidejte střed kruhu","finishCircle":"Нажмите, чтобы задать радиус","placeCircleMarker":"Kliknutím nastavte poloměr"},"actions":{"finish":"Dokončit","cancel":"Zrušit","removeLastVertex":"Zrušit poslední akci"},"buttonTitles":{"drawMarkerButton":"Přidat značku","drawPolyButton":"Nakreslit polygon","drawLineButton":"Nakreslit křivku","drawCircleButton":"Nakreslit kruh","drawRectButton":"Nakreslit obdélník","editButton":"Upravit vrstvu","dragButton":"Přeneste vrstvu","cutButton":"Vyjmout vrstvu","deleteButton":"Smazat vrstvu","drawCircleMarkerButton":"Přidat kruhovou značku","snappingButton":"Navázat tažnou značku k dalším vrstvám a vrcholům","pinningButton":"Spojit společné body dohromady"}}'),ja:JSON.parse('{"tooltips":{"placeMarker":"クリックしてマーカーを配置","firstVertex":"クリックして最初の頂点を配置","continueLine":"クリックして描画を続ける","finishLine":"任意のマーカーをクリックして終了","finishPoly":"最初のマーカーをクリックして終了","finishRect":"クリックして終了","startCircle":"クリックして円の中心を配置","finishCircle":"クリックして円の描画を終了","placeCircleMarker":"クリックして円マーカーを配置","placeText":"クリックしてテキストを配置"},"actions":{"finish":"終了","cancel":"キャンセル","removeLastVertex":"最後の頂点を削除"},"buttonTitles":{"drawMarkerButton":"マーカーを描画","drawPolyButton":"ポリゴンを描画","drawLineButton":"折れ線を描画","drawCircleButton":"円を描画","drawRectButton":"矩形を描画","editButton":"レイヤーを編集","dragButton":"レイヤーをドラッグ","cutButton":"レイヤーを切り取り","deleteButton":"レイヤーを削除","drawCircleMarkerButton":"円マーカーを描画","snappingButton":"ドラッグしたマーカーを他のレイヤーや頂点にスナップする","pinningButton":"共有する頂点を同時に動かす","rotateButton":"レイヤーを回転","drawTextButton":"テキストを描画"}}'),fi:JSON.parse('{"tooltips":{"placeMarker":"Klikkaa asettaaksesi merkin","firstVertex":"Klikkaa asettaakseni ensimmäisen osuuden","continueLine":"Klikkaa jatkaaksesi piirtämistä","finishLine":"Klikkaa olemassa olevaa merkkiä lopettaaksesi","finishPoly":"Klikkaa ensimmäistä merkkiä lopettaaksesi","finishRect":"Klikkaa lopettaaksesi","startCircle":"Klikkaa asettaaksesi ympyrän keskipisteen","finishCircle":"Klikkaa lopettaaksesi ympyrän","placeCircleMarker":"Klikkaa asettaaksesi ympyrämerkin","placeText":"Klikkaa asettaaksesi tekstin"},"actions":{"finish":"Valmis","cancel":"Peruuta","removeLastVertex":"Poista viimeinen osuus"},"buttonTitles":{"drawMarkerButton":"Piirrä merkkejä","drawPolyButton":"Piirrä monikulmioita","drawLineButton":"Piirrä viivoja","drawCircleButton":"Piirrä ympyrä","drawRectButton":"Piirrä neliskulmioita","editButton":"Muokkaa","dragButton":"Siirrä","cutButton":"Leikkaa","deleteButton":"Poista","drawCircleMarkerButton":"Piirrä ympyrämerkki","snappingButton":"Kiinnitä siirrettävä merkki toisiin muotoihin","pinningButton":"Kiinnitä jaetut muodot yhteen","rotateButton":"Käännä","drawTextButton":"Piirrä tekstiä"}}'),ko:JSON.parse('{"tooltips":{"placeMarker":"마커 위치를 클릭하세요","firstVertex":"첫번째 꼭지점 위치을 클릭하세요","continueLine":"계속 그리려면 클릭하세요","finishLine":"끝내려면 기존 마커를 클릭하세요","finishPoly":"끝내려면 처음 마커를 클릭하세요","finishRect":"끝내려면 클릭하세요","startCircle":"원의 중심이 될 위치를 클릭하세요","finishCircle":"원을 끝내려면 클릭하세요","placeCircleMarker":"원 마커 위치를 클릭하세요","placeText":"텍스트 위치를 클릭하세요"},"actions":{"finish":"끝내기","cancel":"취소","removeLastVertex":"마지막 꼭지점 제거"},"buttonTitles":{"drawMarkerButton":"마커 그리기","drawPolyButton":"다각형 그리기","drawLineButton":"다각선 그리기","drawCircleButton":"원 그리기","drawRectButton":"직사각형 그리기","editButton":"레이어 편집하기","dragButton":"레이어 끌기","cutButton":"레이어 자르기","deleteButton":"레이어 제거하기","drawCircleMarkerButton":"원 마커 그리기","snappingButton":"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기","pinningButton":"공유 꼭지점을 함께 찍기","rotateButton":"레이어 회전하기","drawTextButton":"텍스트 그리기"}}')};function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const b={_globalEditModeEnabled:!1,enableGlobalEditMode:function(t){var e=v({},t);this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach((function(t){t.pm.enable(e)})),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayers={},this.map.on("layeradd",this._layerAdded,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode:function(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach((function(t){t.pm.disable()})),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled:function(){return this.globalEditModeEnabled()},globalEditModeEnabled:function(){return this._globalEditModeEnabled},toggleGlobalEditMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.globalOptions;this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)},handleLayerAdditionInGlobalEditMode:function(){var t=this._addedLayers;for(var e in this._addedLayers={},t){var n=t[e];this._isRelevantForEdit(n)&&this.globalEditModeEnabled()&&n.pm.enable(v({},this.globalOptions))}},_layerAdded:function(t){var e=t.layer;this._addedLayers[L.stamp(e)]=e},_isRelevantForEdit:function(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowEditing}},k={_globalDragModeEnabled:!1,enableGlobalDragMode:function(){var t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},t.forEach((function(t){t.pm.enableLayerDrag()})),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode:function(){var t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,t.forEach((function(t){t.pm.disableLayerDrag()})),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled:function(){return!!this._globalDragModeEnabled},toggleGlobalDragMode:function(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode:function(){var t=this._addedLayersDrag;for(var e in this._addedLayersDrag={},t){var n=t[e];this._isRelevantForDrag(n)&&this.globalDragModeEnabled()&&n.pm.enableLayerDrag()}},_layerAddedDrag:function(t){var e=t.layer;this._addedLayersDrag[L.stamp(e)]=e},_isRelevantForDrag:function(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.draggable}},w={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode:function(){var t=this;this._globalRemovalModeEnabled=!0,this.map.eachLayer((function(e){t._isRelevantForRemoval(e)&&(e.pm.disable(),e.on("click",t.removeLayer,t))})),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.reinitGlobalRemovalMode,100,this)),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode:function(){var t=this;this._globalRemovalModeEnabled=!1,this.map.eachLayer((function(e){e.off("click",t.removeLayer,t)})),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled:function(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled:function(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode:function(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},reinitGlobalRemovalMode:function(t){var e=t.layer;this._isRelevantForRemoval(e)&&this.globalRemovalModeEnabled()&&(this.disableGlobalRemovalMode(),this.enableGlobalRemovalMode())},removeLayer:function(t){var e=t.target;this._isRelevantForRemoval(e)&&!e.pm.dragging()&&(e.removeFrom(this.map.pm._getContainingLayer()),e.remove(),e instanceof L.LayerGroup?(this._fireRemoveLayerGroup(e),this._fireRemoveLayerGroup(this.map,e)):(e.pm._fireRemove(e),e.pm._fireRemove(this.map,e)))},_isRelevantForRemoval:function(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRemoval}},x={_globalRotateModeEnabled:!1,enableGlobalRotateMode:function(){var t=this;this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter((function(t){return t instanceof L.Polyline})).forEach((function(e){t._isRelevantForRotate(e)&&e.pm.enableRotate()})),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this._reinitGlobalRotateMode,100,this)),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode:function(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter((function(t){return t instanceof L.Polyline})).forEach((function(t){t.pm.disableRotate()})),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled:function(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode:function(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_reinitGlobalRotateMode:function(t){var e=t.layer;this._isRelevantForRotate(e)&&this.globalRotateModeEnabled()&&(this.disableGlobalRotateMode(),this.enableGlobalRotateMode())},_isRelevantForRotate:function(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRotation}};function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){C(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E={_fireDrawStart:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Draw",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},t,e)},_fireDrawEnd:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Draw",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:drawend",{shape:this._shape},t,e)},_fireCreate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Draw",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._map,"pm:create",{shape:this._shape,marker:t,layer:t},e,n)},_fireCenterPlaced:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Draw",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="Draw"===t?this._layer:void 0,i="Draw"!==t?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:n,layer:i,latlng:this._layer.getLatLng()},t,e)},_fireCut:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Draw",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(t,"pm:cut",{shape:this._shape,layer:e,originalLayer:n},i,o)},_fireEdit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._layer,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(t,"pm:edit",{layer:this._layer,shape:this.getShape()},e,n)},_fireEnable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDisable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},t,e)},_fireUpdate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},t,e)},_fireMarkerDragStart:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},n,i)},_fireMarkerDrag:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},n,i)},_fireMarkerDragEnd:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Edit",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e,intersectionReset:n},i,o)},_fireDragStart:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},t,e)},_fireDrag:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._layer,"pm:drag",M(M({},t),{},{shape:this.getShape()}),e,n)},_fireDragEnd:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragEnable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragDisable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},t,e)},_fireRemove:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:remove",{layer:e,shape:this.getShape()},n,i)},_fireVertexAdded:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Edit",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:t,indexPath:e,latlng:n,shape:this.getShape()},i,o)},_fireVertexRemoved:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:t,indexPath:e,shape:this.getShape()},n,i)},_fireVertexClick:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},n,i)},_fireIntersect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._layer,"pm:intersect",{layer:this._layer,intersection:t,shape:this.getShape()},e,n)},_fireLayerReset:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},n,i)},_fireChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:t,shape:this.getShape()},e,n)},_fireTextChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:t,shape:this.getShape()},e,n)},_fireTextFocus:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},t,e)},_fireTextBlur:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},t,e)},_fireSnapDrag:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Snapping",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:snapdrag",e,n,i)},_fireSnap:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Snapping",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:snap",e,n,i)},_fireUnsnap:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Snapping",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:unsnap",e,n,i)},_fireRotationEnable:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Rotation",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},n,i)},_fireRotationDisable:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Rotation",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(t,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},e,n)},_fireRotationStart:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Rotation",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:e},n,i)},_fireRotation:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._rotationLayer,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Rotation",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.__fire(t,"pm:rotate",{layer:i,helpLayer:this._layer,startAngle:this._startAngle,angle:i.pm.getAngle(),angleDiff:e,oldLatLngs:n,newLatLngs:i.getLatLngs()},o,r)},_fireRotationEnd:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Rotation",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(t,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:e,angle:this._rotationLayer.pm.getAngle(),originLatLngs:n,newLatLngs:this._rotationLayer.getLatLngs()},i,o)},_fireActionClick:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Toolbar",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this._map,"pm:actionclick",{text:t.text,action:t,btnName:e,button:n},i,o)},_fireButtonClick:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Toolbar",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._map,"pm:buttonclick",{btnName:t,button:e},n,i)},_fireLangChange:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Global",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.__fire(this.map,"pm:langchange",{oldLang:t,activeLang:e,fallback:n,translations:i},o,r)},_fireGlobalDragModeToggled:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:t,map:this.map},e,n)},_fireGlobalEditModeToggled:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:t,map:this.map},e,n)},_fireGlobalRemovalModeToggled:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:t,map:this.map},e,n)},_fireGlobalCutModeToggled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},t,e)},_fireGlobalDrawModeToggled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},t,e)},_fireGlobalRotateModeToggled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},t,e)},_fireRemoveLayerGroup:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:remove",{layer:e,shape:void 0},n,i)},_fireKeyeventEvent:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Global",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this.map,"pm:keyevent",{event:t,eventType:e,focusOn:n},i,o)},__fire:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};n=o()(n,r,{source:i}),L.PM.Utils._fireEvent(t,e,n)}};const P=E,T={_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener:function(t){this.map=t,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this)},_onKeyListener:function(t){var e="document";this.map.getContainer().contains(t.target)&&(e="map");var n={event:t,eventType:t.type,focusOn:e};this._lastEvents[t.type]=n,this._lastEvents.current=n,this.map.pm._fireKeyeventEvent(t,t.type,e)},_onBlur:function(t){t.altKey=!1;var e={event:t,eventType:t.type,focusOn:"document"};this._lastEvents[t.type]=e,this._lastEvents.current=e},getLastKeyEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"current";return this._lastEvents[t]},isShiftKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.shiftKey},isAltKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.altKey},isCtrlKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.ctrlKey},isMetaKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.metaKey},getPressedKey:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.key}};var S=n(7361),O=n.n(S),D=n(8721),I=n.n(D);function R(t){var e=L.PM.activeLang;return I()(m,e)||(e="en"),O()(m[e],t)}function A(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Array.isArray(n)){if(A(n))return!0}else if(null!=n&&""!==n)return!0}return!1}function B(t){return t.reduce((function(t,e){if(0!==e.length){var n=Array.isArray(e)?B(e):e;Array.isArray(n)?0!==n.length&&t.push(n):t.push(n)}return t}),[])}function z(t,e,n){for(var i,o,r,s=6378137,a=6356752.3142,l=1/298.257223563,c=t.lng,h=t.lat,u=n,d=Math.PI,p=e*d/180,_=Math.sin(p),f=Math.cos(p),m=(1-l)*Math.tan(h*d/180),g=1/Math.sqrt(1+m*m),v=m*g,y=Math.atan2(m,f),b=g*_,k=1-b*b,w=k*(s*s-a*a)/(a*a),x=1+w/16384*(4096+w*(w*(320-175*w)-768)),$=w/1024*(256+w*(w*(74-47*w)-128)),M=u/(a*x),C=2*Math.PI;Math.abs(M-C)>1e-12;)i=Math.cos(2*y+M),C=M,M=u/(a*x)+$*(o=Math.sin(M))*(i+$/4*((r=Math.cos(M))*(2*i*i-1)-$/6*i*(4*o*o-3)*(4*i*i-3)));var E=v*o-g*r*f,P=Math.atan2(v*r+g*o*f,(1-l)*Math.sqrt(b*b+E*E)),T=l/16*k*(4+l*(4-3*k)),S=c+180*(Math.atan2(o*_,g*r-v*o*f)-(1-T)*l*b*(M+T*o*(i+T*r*(2*i*i-1))))/d,O=180*P/d;return L.latLng(S,O)}function N(t,e,n,i){for(var o,r,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=[],l=0;l<n;l+=1){if(s)o=z(t,360*l/n+i,e),r=L.latLng(o.lng,o.lat);else{var c=t.lat+Math.cos(2*l*Math.PI/n)*e,h=t.lng+Math.sin(2*l*Math.PI/n)*e;r=L.latLng(c,h)}a.push(r)}return a}function j(t,e,n,i){var o=function(t,e,n){var i=t.latLngToContainerPoint(e),o=t.latLngToContainerPoint(n),r=180*Math.atan2(o.y-i.y,o.x-i.x)/Math.PI+90;return r+(r<0?360:0)}(t,e,n);return function(t,e,n){e=(e+360)%360;var i=Math.PI/180,o=180/Math.PI,r=6378137,s=t.lng*i,a=t.lat*i,l=e*i,c=Math.sin(a),h=Math.cos(a),u=Math.cos(n/r),d=Math.sin(n/r),p=Math.asin(c*u+h*d*Math.cos(l)),_=s+Math.atan2(Math.sin(l)*d*h,u-c*Math.sin(p));return _=(_*=o)>180?_-360:_<-180?_+360:_,L.latLng([p*o,_])}(e,o,i)}function F(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getLatLngs();return t instanceof L.Polygon?L.polygon(e).getLatLngs():L.polyline(e).getLatLngs()}function W(t,e){var n,i;if(null!==(n=e.options.crs)&&void 0!==n&&null!==(i=n.projection)&&void 0!==i&&i.MAX_LATITUDE){var o,r,s=null===(o=e.options.crs)||void 0===o||null===(r=o.projection)||void 0===r?void 0:r.MAX_LATITUDE;t.lat=Math.max(Math.min(s,t.lat),-s)}return t}function H(t){return t.options.renderer||t._map&&(t._map._getPaneRenderer(t.options.pane)||t._map.options.renderer||t._map._renderer)||t._renderer}const G=L.Class.extend({includes:[b,k,w,x,P],initialize:function(t){this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this.Keyboard=T,this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(t)},setLang:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",i=L.PM.activeLang;e&&(m[t]=o()(m[n],e)),L.PM.activeLang=t,this.map.pm.Toolbar.reinit(),this._fireLangChange(i,t,n,m[t])},addControls:function(t){this.Toolbar.addControls(t)},removeControls:function(){this.Toolbar.removeControls()},toggleControls:function(){this.Toolbar.toggleControls()},controlsVisible:function(){return this.Toolbar.isVisible},enableDraw:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Polygon",e=arguments.length>1?arguments[1]:void 0;"Poly"===t&&(t="Polygon"),this.Draw.enable(t,e)},disableDraw:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Polygon";"Poly"===t&&(t="Polygon"),this.Draw.disable(t)},setPathOptions:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.ignoreShapes||[],o=n.merge||!1;this.map.pm.Draw.shapes.forEach((function(n){-1===i.indexOf(n)&&e.map.pm.Draw[n].setPathOptions(t,o)}))},getGlobalOptions:function(){return this.globalOptions},setGlobalOptions:function(t){var e=this,n=o()(this.globalOptions,t),i=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.editable!=!!n.editable&&(this.map.pm.Draw.CircleMarker.disable(),i=!0),this.map.pm.Draw.shapes.forEach((function(t){e.map.pm.Draw[t].setOptions(n)})),i&&this.map.pm.Draw.CircleMarker.enable(),L.PM.Utils.findLayers(this.map).forEach((function(t){t.pm.setOptions(n)})),this.map.fire("pm:globaloptionschanged"),this.globalOptions=n,this.applyGlobalOptions()},applyGlobalOptions:function(){L.PM.Utils.findLayers(this.map).forEach((function(t){t.pm.enabled()&&t.pm.applyOptions()}))},globalDrawModeEnabled:function(){return!!this.Draw.getActiveShape()},globalCutModeEnabled:function(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode:function(t){return this.Draw.Cut.enable(t)},toggleGlobalCutMode:function(t){return this.Draw.Cut.toggle(t)},disableGlobalCutMode:function(){return this.Draw.Cut.disable()},getGeomanLayers:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=L.PM.Utils.findLayers(this.map);if(!t)return e;var n=L.featureGroup();return n._pmTempLayer=!0,e.forEach((function(t){n.addLayer(t)})),n},getGeomanDrawLayers:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=L.PM.Utils.findLayers(this.map).filter((function(t){return!0===t._drawnByGeoman}));if(!t)return e;var n=L.featureGroup();return n._pmTempLayer=!0,e.forEach((function(t){n.addLayer(t)})),n},_getContainingLayer:function(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple:function(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents:function(t){0===this._touchEventCounter&&(L.DomEvent.on(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents:function(t){1===this._touchEventCounter&&(L.DomEvent.off(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove:function(t){H(this.map)._onMouseMove(this._createMouseEvent("mousemove",t))},_canvasTouchClick:function(t){var e="";"touchstart"===t.type||"pointerdown"===t.type?e="mousedown":"touchend"===t.type||"pointerup"===t.type?e="mouseup":"touchcancel"!==t.type&&"pointercancel"!==t.type||(e="mouseup"),e&&H(this.map)._onClick(this._createMouseEvent(e,t))},_createMouseEvent:function(t,e){var n,i=e.touches[0]||e.changedTouches[0];try{n=new MouseEvent(t,{bubbles:e.bubbles,cancelable:e.cancelable,view:e.view,detail:i.detail,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:e.button,relatedTarget:e.relatedTarget})}catch(o){(n=document.createEvent("MouseEvents")).initMouseEvent(t,e.bubbles,e.cancelable,e.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}return n}}),Z=L.Control.extend({includes:[P],options:{position:"topleft",disableByOtherButtons:!0},initialize:function(t){this._button=L.Util.extend({},this.options,t)},onAdd:function(t){return this._map=t,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):"edit"===this._button.tool?this._container=this._map.pm.Toolbar.editContainer:"options"===this._button.tool?this._container=this._map.pm.Toolbar.optionsContainer:"custom"===this._button.tool?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove:function(){return this.buttonsDomNode.remove(),this._container},getText:function(){return this._button.text},getIconUrl:function(){return this._button.iconUrl},destroy:function(){this._button={},this._update()},toggle:function(t){return this._button.toggleStatus="boolean"==typeof t?t:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled:function(){return this._button.toggleStatus},onCreate:function(){this.toggle(!1)},disable:function(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable:function(){this._button.disabled=!1,this._updateDisabled()},_triggerClick:function(t){t&&t.preventDefault(),this._button.disabled||(this._button.onClick(t,{button:this,event:t}),this._clicked(t),this._button.afterClick(t,{button:this,event:t}))},_makeButton:function(t){var e=this,n=this.options.position.indexOf("right")>-1?"pos-right":"",i=L.DomUtil.create("div","button-container  ".concat(n),this._container);t.title&&i.setAttribute("title",t.title);var o=L.DomUtil.create("a","leaflet-buttons-control-button",i);o.setAttribute("role","button"),o.setAttribute("tabindex","0"),o.href="#";var r=L.DomUtil.create("div","leaflet-pm-actions-container ".concat(n),i),s=t.actions,a={cancel:{text:R("actions.cancel"),onClick:function(){this._triggerClick()}},finishMode:{text:R("actions.finish"),onClick:function(){this._triggerClick()}},removeLastVertex:{text:R("actions.removeLastVertex"),onClick:function(){this._map.pm.Draw[t.jsClass]._removeLastVertex()}},finish:{text:R("actions.finish"),onClick:function(e){this._map.pm.Draw[t.jsClass]._finishShape(e)}}};s.forEach((function(i){var o,s="string"==typeof i?i:i.name;if(a[s])o=a[s];else{if(!i.text)return;o=i}var l=L.DomUtil.create("a","leaflet-pm-action ".concat(n," action-").concat(s),r);l.setAttribute("role","button"),l.setAttribute("tabindex","0"),l.href="#",l.innerHTML=o.text,L.DomEvent.disableClickPropagation(l),L.DomEvent.on(l,"click",L.DomEvent.stop),!t.disabled&&o.onClick&&(L.DomEvent.addListener(l,"click",(function(n){n.preventDefault();var i="",r=e._map.pm.Toolbar.buttons;for(var s in r)if(r[s]._button===t){i=s;break}e._fireActionClick(o,i,t)}),e),L.DomEvent.addListener(l,"click",o.onClick,e))})),t.toggleStatus&&L.DomUtil.addClass(i,"active");var l=L.DomUtil.create("div","control-icon",o);return t.iconUrl&&l.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(l,t.className),L.DomEvent.disableClickPropagation(o),L.DomEvent.on(o,"click",L.DomEvent.stop),t.disabled||(L.DomEvent.addListener(o,"click",this._onBtnClick,this),L.DomEvent.addListener(o,"click",this._triggerClick,this)),t.disabled&&(L.DomUtil.addClass(o,"pm-disabled"),o.setAttribute("aria-disabled","true")),i},_applyStyleClasses:function(){this._container&&(this._button.toggleStatus&&!1!==this._button.cssToggle?(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")):(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")))},_onBtnClick:function(){this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);var t="",e=this._map.pm.Toolbar.buttons;for(var n in e)if(e[n]._button===this._button){t=n;break}this._fireButtonClick(t,this._button)},_clicked:function(){this._button.doToggle&&this.toggle()},_updateDisabled:function(){if(this._container){var t="pm-disabled",e=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(e,t),e.setAttribute("aria-disabled","true"),L.DomEvent.off(e,"click",this._triggerClick,this),L.DomEvent.off(e,"click",this._onBtnClick,this)):(L.DomUtil.removeClass(e,t),e.setAttribute("aria-disabled","false"),L.DomEvent.on(e,"click",this._triggerClick,this),L.DomEvent.on(e,"click",this._onBtnClick,this))}}});function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){V(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function V(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}L.Control.PMButton=Z;const K=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize:function(t){this.init(t)},reinit:function(){var t=this.isVisible;this.removeControls(),this._defineButtons(),t&&this.addControls()},init:function(t){this.map=t,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer:function(t){var e="".concat(t,"Container");return this[e]||(this[e]=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-".concat(t," leaflet-bar leaflet-control"))),this[e]},getButtons:function(){return this.buttons},addControls:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options;void 0!==t.editPolygon&&(t.editMode=t.editPolygon),void 0!==t.deleteLayer&&(t.removalMode=t.deleteLayer),L.Util.setOptions(this,t),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle:function(){var t=this.getButtons(),e={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(var n in t){var i=t[n];L.Util.setOptions(i,{className:e.geomanIcons[n]})}},removeControls:function(){var t=this.getButtons();for(var e in t)t[e].remove();this.isVisible=!1},toggleControls:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options;this.isVisible?this.removeControls():this.addControls(t)},_addButton:function(t,e){return this.buttons[t]=e,this.options[t]=this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons:function(t){for(var e in this.buttons){var n=this.buttons[e];n._button.disableByOtherButtons&&n!==t&&n.toggled()&&n._triggerClick()}},toggleButton:function(t,e){return"editPolygon"===t&&(t="editMode"),"deleteLayer"===t&&(t="removalMode"),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&this.triggerClickOnToggledButtons(this.buttons[t]),!!this.buttons[t]&&this.buttons[t].toggle(e)},_defineButtons:function(){var t=this,e={className:"control-icon leaflet-pm-icon-marker",title:R("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},n={title:R("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={className:"control-icon leaflet-pm-icon-polyline",title:R("buttonTitles.drawLineButton"),jsClass:"Line",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},o={title:R("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},r={title:R("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},s={title:R("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},a={title:R("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},l={title:R("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},c={title:R("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},h={title:R("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},u={title:R("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},d={className:"control-icon leaflet-pm-icon-text",title:R("buttonTitles.drawTextButton"),jsClass:"Text",onClick:function(){},afterClick:function(e,n){t.map.pm.Draw[n.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(e)),this._addButton("drawPolyline",new L.Control.PMButton(i)),this._addButton("drawRectangle",new L.Control.PMButton(s)),this._addButton("drawPolygon",new L.Control.PMButton(n)),this._addButton("drawCircle",new L.Control.PMButton(o)),this._addButton("drawCircleMarker",new L.Control.PMButton(r)),this._addButton("drawText",new L.Control.PMButton(d)),this._addButton("editMode",new L.Control.PMButton(a)),this._addButton("dragMode",new L.Control.PMButton(l)),this._addButton("cutPolygon",new L.Control.PMButton(c)),this._addButton("removalMode",new L.Control.PMButton(h)),this._addButton("rotateMode",new L.Control.PMButton(u))},_showHideButtons:function(){if(this.isVisible){this.removeControls(),this.isVisible=!0;var t=this.getButtons(),e=[];for(var n in!1===this.options.drawControls&&(e=e.concat(Object.keys(t).filter((function(e){return!t[e]._button.tool})))),!1===this.options.editControls&&(e=e.concat(Object.keys(t).filter((function(e){return"edit"===t[e]._button.tool})))),!1===this.options.optionsControls&&(e=e.concat(Object.keys(t).filter((function(e){return"options"===t[e]._button.tool})))),!1===this.options.customControls&&(e=e.concat(Object.keys(t).filter((function(e){return"custom"===t[e]._button.tool})))),t)if(this.options[n]&&-1===e.indexOf(n)){var i=t[n]._button.tool;i||(i="draw"),t[n].setPosition(this._getBtnPosition(i)),t[n].addTo(this.map)}}},_getBtnPosition:function(t){return this.options.positions&&this.options.positions[t]?this.options.positions[t]:this.options.position},setBlockPosition:function(t,e){this.options.positions[t]=e,this._showHideButtons(),this.changeControlOrder()},getBlockPositions:function(){return this.options.positions},copyDrawControl:function(t,e){if(!e)throw new TypeError("Button has no name");"object"!==Y(e)&&(e={name:e});var n=this._btnNameMapping(t);if(!e.name)throw new TypeError("Button has no name");if(this.buttons[e.name])throw new TypeError("Button with this name already exists");var i=this.map.pm.Draw.createNewDrawInstance(e.name,n);return e=q(q({},this.buttons[n]._button),e),{drawInstance:i,control:this.createCustomControl(e)}},createCustomControl:function(t){var e,n;if(!t.name)throw new TypeError("Button has no name");if(this.buttons[t.name])throw new TypeError("Button with this name already exists");t.onClick||(t.onClick=function(){}),t.afterClick||(t.afterClick=function(){}),!1!==t.toggle&&(t.toggle=!0),t.block&&(t.block=t.block.toLowerCase()),t.block&&"draw"!==t.block||(t.block=""),t.className?-1===t.className.indexOf("control-icon")&&(t.className="control-icon ".concat(t.className)):t.className="control-icon";var i={tool:t.block,className:t.className,title:t.title||"",jsClass:t.name,onClick:t.onClick,afterClick:t.afterClick,doToggle:t.toggle,toggleStatus:!1,disableOtherButtons:null===(e=t.disableOtherButtons)||void 0===e||e,disableByOtherButtons:null===(n=t.disableByOtherButtons)||void 0===n||n,cssToggle:t.toggle,position:this.options.position,actions:t.actions||[],disabled:!!t.disabled};!1!==this.options[t.name]&&(this.options[t.name]=!0);var o=this._addButton(t.name,new L.Control.PMButton(i));return this.changeControlOrder(),o},changeControlOrder:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this._shapeMapping(),n=[];t.forEach((function(t){e[t]?n.push(e[t]):n.push(t)}));var i=this.getButtons(),o={};n.forEach((function(t){i[t]&&(o[t]=i[t])}));var r=Object.keys(i).filter((function(t){return!i[t]._button.tool}));r.forEach((function(t){-1===n.indexOf(t)&&(o[t]=i[t])}));var s=Object.keys(i).filter((function(t){return"edit"===i[t]._button.tool}));s.forEach((function(t){-1===n.indexOf(t)&&(o[t]=i[t])}));var a=Object.keys(i).filter((function(t){return"options"===i[t]._button.tool}));a.forEach((function(t){-1===n.indexOf(t)&&(o[t]=i[t])}));var l=Object.keys(i).filter((function(t){return"custom"===i[t]._button.tool}));l.forEach((function(t){-1===n.indexOf(t)&&(o[t]=i[t])})),Object.keys(i).forEach((function(t){-1===n.indexOf(t)&&(o[t]=i[t])})),this.map.pm.Toolbar.buttons=o,this._showHideButtons()},getControlOrder:function(){var t=this.getButtons(),e=[];for(var n in t)e.push(n);return e},changeActionsOfControl:function(t,e){var n=this._btnNameMapping(t);if(!n)throw new TypeError("No name passed");if(!e)throw new TypeError("No actions passed");if(!this.buttons[n])throw new TypeError("Button with this name not exists");this.buttons[n]._button.actions=e,this.changeControlOrder()},setButtonDisabled:function(t,e){var n=this._btnNameMapping(t);e?this.buttons[n].disable():this.buttons[n].enable()},_shapeMapping:function(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping:function(t){var e=this._shapeMapping();return e[t]?e[t]:t}});function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){Q(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Q(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var tt={_initSnappableMarkers:function(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents:function(t){var e=this;t.forEach((function(t){Array.isArray(t)?e._assignEvents(t):(t.off("drag",e._handleSnapping,e),t.on("drag",e._handleSnapping,e),t.off("dragend",e._cleanupSnapping,e),t.on("dragend",e._cleanupSnapping,e))}))},_cleanupSnapping:function(t){t&&(t.target._snapped=!1),delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("pm:remove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach((function(t){t.remove()}))},_handleThrottleSnapping:function(){this.throttledList&&this._createSnapList()},_handleSnapping:function(t){var e=this,n=t.target;if(n._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),this._map.pm.Keyboard.isAltKeyPressed())return!1;if(void 0===this._snapList&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0)return!1;var i,o=this._calcClosestLayer(n.getLatLng(),this._snapList);if(0===Object.keys(o).length)return!1;i=o.layer instanceof L.Marker||o.layer instanceof L.CircleMarker||!this.options.snapSegment?o.latlng:this._checkPrioritiySnapping(o);var r=this.options.snapDistance,s={marker:n,shape:this._shape,snapLatLng:i,segment:o.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:o.layer,distance:o.distance};if(this._fireSnapDrag(s.marker,s),this._fireSnapDrag(this._layer,s),o.distance<r){n._orgLatLng=n.getLatLng(),n.setLatLng(i),n._snapped=!0,n._snapInfo=s;var a=this._snapLatLng||{},l=i||{};a.lat===l.lat&&a.lng===l.lng||(e._snapLatLng=i,e._fireSnap(n,s),e._fireSnap(e._layer,s))}else this._snapLatLng&&(this._unsnap(s),n._snapped=!1,n._snapInfo=void 0,this._fireUnsnap(s.marker,s),this._fireUnsnap(this._layer,s));return!0},_createSnapList:function(){var t=this,e=[],n=[],i=this._map;i.off("pm:remove",this._handleSnapLayerRemoval,this),i.on("pm:remove",this._handleSnapLayerRemoval,this),i.eachLayer((function(t){if((t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.CircleMarker||t instanceof L.ImageOverlay)&&!0!==t.options.snapIgnore){if(void 0===t.options.snapIgnore&&(!L.PM.optIn&&!0===t.options.pmIgnore||L.PM.optIn&&!1!==t.options.pmIgnore))return;(t instanceof L.Circle||t instanceof L.CircleMarker)&&t.pm&&t.pm._hiddenPolyCircle?e.push(t.pm._hiddenPolyCircle):t instanceof L.ImageOverlay&&(t=L.rectangle(t.getBounds())),e.push(t);var i=L.polyline([],{color:"red",pmIgnore:!0});i._pmTempLayer=!0,n.push(i),(t instanceof L.Circle||t instanceof L.CircleMarker)&&n.push(i)}})),e=(e=(e=e.filter((function(e){return t._layer!==e}))).filter((function(t){return t._latlng||t._latlngs&&A(t._latlngs)}))).filter((function(t){return!t._pmTempLayer})),this._otherSnapLayers?(this._otherSnapLayers.forEach((function(){var t=L.polyline([],{color:"red",pmIgnore:!0});t._pmTempLayer=!0,n.push(t)})),this._snapList=e.concat(this._otherSnapLayers)):this._snapList=e,this.debugIndicatorLines=n},_handleSnapLayerRemoval:function(t){var e=t.layer,n=this._snapList.findIndex((function(t){return t._leaflet_id===e._leaflet_id}));this._snapList.splice(n,1)},_calcClosestLayer:function(t,e){return this._calcClosestLayers(t,e,1)[0]},_calcClosestLayers:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=[],r={};e.forEach((function(e,s){if(!e._parentCopy||e._parentCopy!==n._layer){var a=n._calcLayerDistances(t,e);if(a.distance=Math.floor(a.distance),n.debugIndicatorLines){if(!n.debugIndicatorLines[s]){var l=L.polyline([],{color:"red",pmIgnore:!0});l._pmTempLayer=!0,n.debugIndicatorLines[s]=l}n.debugIndicatorLines[s].setLatLngs([t,a.latlng])}1===i&&(void 0===r.distance||a.distance<=r.distance)?(a.distance<r.distance&&(o=[]),(r=a).layer=e,o.push(r)):1!==i&&(r={},(r=a).layer=e,o.push(r))}})),1!==i&&(o=o.sort((function(t,e){return t.distance-e.distance}))),-1===i&&(i=o.length);var s=this._getClosestLayerByPriority(o,i);return L.Util.isArray(s)?s:[s]},_calcLayerDistances:function(t,e){var n=this._map,i=e instanceof L.Marker||e instanceof L.CircleMarker,o=e instanceof L.Polygon,r=t;if(i){var s=e.getLatLng();return{latlng:J({},s),distance:this._getDistance(n,s,r)}}return this._calcLatLngDistances(r,e.getLatLngs(),n,o)},_calcLatLngDistances:function(t,e,n){var i,o,r,s=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function e(l){l.forEach((function(c,h){if(Array.isArray(c))e(c);else if(s.options.snapSegment){var u,d=c;u=a?h+1===l.length?0:h+1:h+1===l.length?void 0:h+1;var p=l[u];if(p){var _=s._getDistanceToSegment(n,t,d,p);(void 0===o||_<o)&&(o=_,r=[d,p])}}else{var f=s._getDistance(n,t,c);(void 0===o||f<o)&&(o=f,i=c)}}))}(e),this.options.snapSegment?{latlng:J({},this._getClosestPointOnSegment(n,t,r[0],r[1])),segment:r,distance:o}:{latlng:i,distance:o}},_getClosestLayerByPriority:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t=t.sort((function(t,e){return t._leaflet_id-e._leaflet_id}));var n=this._map.pm.globalOptions.snappingOrder||[],i=0,o={};return n.concat(["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"]).forEach((function(t){o[t]||(i+=1,o[t]=i)})),t.sort(function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc";if(!e||0===Object.keys(e).length)return function(t,e){return t-e};for(var i,o=Object.keys(e),r=o.length-1,s={};r>=0;)i=o[r],s[i.toLowerCase()]=e[i],r-=1;function a(t){return t instanceof L.Marker?"Marker":t instanceof L.Circle?"Circle":t instanceof L.CircleMarker?"CircleMarker":t instanceof L.Rectangle?"Rectangle":t instanceof L.Polygon?"Polygon":t instanceof L.Polyline?"Line":void 0}return function(e,i){var o,r;if("instanceofShape"===t){if(o=a(e.layer).toLowerCase(),r=a(i.layer).toLowerCase(),!o||!r)return 0}else{if(!e.hasOwnProperty(t)||!i.hasOwnProperty(t))return 0;o=e[t].toLowerCase(),r=i[t].toLowerCase()}var l=o in s?s[o]:Number.MAX_SAFE_INTEGER,c=r in s?s[r]:Number.MAX_SAFE_INTEGER,h=0;return l<c?h=-1:l>c&&(h=1),"desc"===n?-1*h:h}}("instanceofShape",o)),1===e?t[0]||{}:t.slice(0,e)},_checkPrioritiySnapping:function(t){var e=this._map,n=t.segment[0],i=t.segment[1],o=t.latlng,r=this._getDistance(e,n,o),s=this._getDistance(e,i,o),a=r<s?n:i,l=r<s?r:s;if(this.options.snapMiddle){var c=L.PM.Utils.calcMiddleLatLng(e,n,i),h=this._getDistance(e,c,o);h<r&&h<s&&(a=c,l=h)}return J({},l<this.options.snapDistance?a:o)},_unsnap:function(){delete this._snapLatLng},_getClosestPointOnSegment:function(t,e,n,i){var o=t.getMaxZoom();o===1/0&&(o=t.getZoom());var r=t.project(e,o),s=t.project(n,o),a=t.project(i,o),l=L.LineUtil.closestPointOnSegment(r,s,a);return t.unproject(l,o)},_getDistanceToSegment:function(t,e,n,i){var o=t.latLngToLayerPoint(e),r=t.latLngToLayerPoint(n),s=t.latLngToLayerPoint(i);return L.LineUtil.pointToSegmentDistance(o,r,s)},_getDistance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))}};const et=tt,nt=L.Class.extend({includes:[et,P],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,editable:!1,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1},setOptions:function(t){L.Util.setOptions(this,t),this.setStyle(this.options)},setStyle:function(){},getOptions:function(){return this.options},initialize:function(t){var e=this,n=new L.Icon.Default;n.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=n,this._map=t,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach((function(t){e[t]=new L.PM.Draw[t](e._map)})),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.options.pathOptions=e?o()(this.options.pathOptions,t):t},getShapes:function(){return this.shapes},getShape:function(){return this._shape},enable:function(t,e){if(!t)throw new Error("Error: Please pass a shape as a parameter. Possible shapes are: ".concat(this.getShapes().join(",")));this.disable(),this[t].enable(e)},disable:function(){var t=this;this.shapes.forEach((function(e){t[e].disable()}))},addControls:function(){var t=this;this.shapes.forEach((function(e){t[e].addButton()}))},getActiveShape:function(){var t,e=this;return this.shapes.forEach((function(n){e[n]._enabled&&(t=n)})),t},_setGlobalDrawMode:function(){"Cut"===this._shape?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();var t=L.PM.Utils.findLayers(this._map);this._enabled?t.forEach((function(t){L.PM.Utils.disablePopup(t)})):t.forEach((function(t){L.PM.Utils.enablePopup(t)}))},createNewDrawInstance:function(t,e){var n=this._getShapeFromBtnName(e);if(this[t])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[n])throw new TypeError("There is no class L.PM.Draw.".concat(n));return this[t]=new L.PM.Draw[n](this._map),this[t].toolbarButtonName=t,this[t]._shape=t,this.shapes.push(t),this[e]&&this[t].setOptions(this[e].options),this[t].setOptions(this[t].options),this[t]},_getShapeFromBtnName:function(t){var e={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return e[t]?e[t]:this[t]?this[t]._shape:t},_finishLayer:function(t){t.pm&&(t.pm.setOptions(this.options),t.pm._shape=this._shape,t.pm._map=this._map),this._addDrawnLayerProp(t)},_addDrawnLayerProp:function(t){t._drawnByGeoman=!0},_setPane:function(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer:function(){return 0===(this._map||this._layer._map).pm.getGeomanLayers().length}});nt.Marker=nt.extend({initialize:function(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable:function(t){var e=this;L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(R("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer((function(t){e.isRelevantMarker(t)&&t.pm.enable()})),this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){var t=this;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer((function(e){t.isRelevantMarker(e)&&e.pm.disable()})),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},isRelevantMarker:function(t){return t instanceof L.Marker&&t.pm&&!t._pmTempLayer&&!t.pm._initTextMarker},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker:function(t){if(t.latlng&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=new L.Marker(e,this.options.markerStyle);this._setPane(n,"markerPane"),this._finishLayer(n),n.pm||(n.options.draggable=!1),n.addTo(this._map.pm._getContainingLayer()),n.pm&&this.options.markerEditable?n.pm.enable():n.dragging&&n.dragging.disable(),this._fireCreate(n),this._cleanupSnapping(),this.options.continueDrawing||this.disable()}},setStyle:function(){var t,e;null!==(t=this.options.markerStyle)&&void 0!==t&&t.icon&&(null===(e=this._hintMarker)||void 0===e||e.setIcon(this.options.markerStyle.icon))}});var it=6371008.8,ot={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*it,kilometers:6371.0088,kilometres:6371.0088,meters:it,metres:it,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:it/1852,radians:1,yards:6967335.223679999};function rt(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function st(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ut(t[0])||!ut(t[1]))throw new Error("coordinates must contain numbers");return rt({type:"Point",coordinates:t},e,n)}function at(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return rt({type:"LineString",coordinates:t},e,n)}function lt(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function ct(t){return t%(2*Math.PI)*180/Math.PI}function ht(t){return t%360*Math.PI/180}function ut(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function dt(t){var e,n,i={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var n=0;n<t.length-1;n++)for(var o=n;o<e.length-1;o++){if(t===e){if(1===Math.abs(n-o))continue;if(0===n&&o===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var r=pt(t[n][0],t[n][1],t[n+1][0],t[n+1][1],e[o][0],e[o][1],e[o+1][0],e[o+1][1]);r&&i.features.push(st([r[0],r[1]]))}}))})),i}function pt(t,e,n,i,o,r,s,a){var l,c,h,u,d={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(l=(a-r)*(n-t)-(s-o)*(i-e))?null!==d.x&&null!==d.y&&d:(u=(n-t)*(c=e-r)-(i-e)*(h=t-o),c=((s-o)*c-(a-r)*h)/l,h=u/l,d.x=t+c*(n-t),d.y=e+c*(i-e),c>=0&&c<=1&&(d.onLine1=!0),h>=0&&h<=1&&(d.onLine2=!0),!(!d.onLine1||!d.onLine2)&&[d.x,d.y])}function _t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(n),!0).forEach((function(e){mt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function mt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gt(Object(n),!0).forEach((function(e){yt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function yt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){wt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function wt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Lt(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function $t(t){return"Feature"===t.type?t.geometry:t}function Mt(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}function Ct(t,e,n){if(null!==t)for(var i,o,r,s,a,l,c,h,u=0,d=0,p=t.type,_="FeatureCollection"===p,f="Feature"===p,m=_?t.features.length:1,g=0;g<m;g++){a=(h=!!(c=_?t.features[g].geometry:f?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var v=0;v<a;v++){var y=0,b=0;if(null!==(s=h?c.geometries[v]:c)){l=s.coordinates;var k=s.type;switch(u=!n||"Polygon"!==k&&"MultiPolygon"!==k?0:1,k){case null:break;case"Point":if(!1===e(l,d,g,y,b))return!1;d++,y++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],d,g,y,b))return!1;d++,"MultiPoint"===k&&y++}"LineString"===k&&y++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(o=0;o<l[i].length-u;o++){if(!1===e(l[i][o],d,g,y,b))return!1;d++}"MultiLineString"===k&&y++,"Polygon"===k&&b++}"Polygon"===k&&y++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(b=0,o=0;o<l[i].length;o++){for(r=0;r<l[i][o].length-u;r++){if(!1===e(l[i][o][r],d,g,y,b))return!1;d++}b++}y++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===Ct(s.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Et(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function Pt(t,e){!function(t,e){var n,i,o,r,s,a,l,c,h,u,d=0,p="FeatureCollection"===t.type,_="Feature"===t.type,f=p?t.features.length:1;for(n=0;n<f;n++){for(a=p?t.features[n].geometry:_?t.geometry:t,c=p?t.features[n].properties:_?t.properties:{},h=p?t.features[n].bbox:_?t.bbox:void 0,u=p?t.features[n].id:_?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<s;o++)if(null!==(r=l?a.geometries[o]:a))switch(r.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(r,d,c,h,u))return!1;break;case"GeometryCollection":for(i=0;i<r.geometries.length;i++)if(!1===e(r.geometries[i],d,c,h,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,c,h,u))return!1;d++}}(t,(function(t,n,i,o,r){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(rt(t,i,{bbox:o,id:r}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var c=t.coordinates[l];if(!1===e(rt({type:s,coordinates:c},i),n,l))return!1}}))}nt.Line=nt.extend({initialize:function(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable:function(t){L.Util.setOptions(this,t),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],ft(ft({},this.options.templineStyle),{},{pmIgnore:!1})),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(R("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map._container.style.cursor="crosshair",this._map.on("click",this._createVertex,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._layer.getLatLngs();if(t.length>0){var e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());var n=this._layer._defaultShape().slice();n.push(this._hintMarker.getLatLng()),this._change(n)},hasSelfIntersection:function(){return dt(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection:function(t,e){var n=L.polyline(this._layer.getLatLngs());t&&(e||(e=this._hintMarker.getLatLng()),n.addLatLng(e));var i=dt(n.toGeoJSON(15));this._doesSelfIntersect=i.features.length>0,this._doesSelfIntersect?this._hintline.setStyle({color:"#f00000ff"}):this._hintline.isEmpty()||this._hintline.setStyle(this.options.hintlineStyle)},_createVertex:function(t){if(this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,t.latlng),!this._doesSelfIntersect)){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=this._layer.getLatLngs(),i=n[n.length-1];if(e.equals(n[0])||n.length>0&&e.equals(i))this._finishShape();else{this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:e,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(e);var o=this._createMarker(e);this._setTooltipText(),this._setHintLineAfterNewVertex(e),this._fireVertexAdded(o,void 0,e,"Draw"),this._change(this._layer.getLatLngs()),"snap"===this.options.finishOn&&this._hintMarker._snapped&&this._finishShape(t)}}},_setHintLineAfterNewVertex:function(t){this._hintline.setLatLngs([t,t])},_removeLastVertex:function(){var t=this._markers;if(t.length<=1)this.disable();else{var e=this._layer.getLatLngs(),n=t[t.length-1],i=L.PM.Utils.findDeepMarkerIndex(t,n).indexPath;t.pop(),this._layerGroup.removeLayer(n);var o=t[t.length-1],r=e.indexOf(o.getLatLng());e=e.slice(0,r+1),this._layer.setLatLngs(e),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(n,i,"Draw"),this._change(this._layer.getLatLngs())}},_finishShape:function(){if((this.options.allowSelfIntersection||(this._handleSelfIntersection(!1),!this._doesSelfIntersect))&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){var t=this._layer.getLatLngs();if(!(t.length<=1)){var e=L.polyline(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this.options.snappable&&this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()}}},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),e.on("click",this._finishShape,this),e},_setTooltipText:function(){var t;t=R(this._layer.getLatLngs().flat().length<=1?"tooltips.continueLine":"tooltips.finishLine"),this._hintMarker.setTooltipContent(t)},_change:function(t){this._fireChange(t,"Draw")},setStyle:function(){var t,e;null===(t=this._layer)||void 0===t||t.setStyle(this.options.templineStyle),null===(e=this._hintline)||void 0===e||e.setStyle(this.options.hintlineStyle)}}),nt.Polygon=nt.Line.extend({initialize:function(t){this._map=t,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable:function(t){L.PM.Draw.Line.prototype.enable.call(this,t),this._layer.pm._shape="Polygon"},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),1===this._layer.getLatLngs().flat().length?(e.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(e)-1,this.options.snappable&&this._cleanupSnapping()):e.on("click",(function(){return 1})),e},_setTooltipText:function(){var t;t=R(this._layer.getLatLngs().flat().length<=2?"tooltips.continueLine":"tooltips.finishPoly"),this._hintMarker.setTooltipContent(t)},_finishShape:function(){if((this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),!this._doesSelfIntersect))&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){var t=this._layer.getLatLngs();if(!(t.length<=2)){var e=L.polygon(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this.disable(),this.options.continueDrawing&&this.enable()}}}}),nt.Rectangle=nt.extend({initialize:function(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable:function(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(R("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(var e=0;e<2;e+=1){var n=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(n,"vertexPane"),n._pmTempLayer=!0,this._layerGroup.addLayer(n),this._styleMarkers.push(n)}}this._map._container.style.cursor="crosshair",this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach((function(t){L.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)})),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(R("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin:function(){var t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}var n=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(n,"Draw")},_syncRectangleSize:function(){var t=this,e=W(this._startMarker.getLatLng(),this._map),n=W(this._hintMarker.getLatLng(),this._map),i=L.PM.Utils._getRotatedRectangle(e,n,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(i),this.options.cursorMarker&&this._styleMarkers){var o=[];i.forEach((function(t){t.equals(e,1e-8)||t.equals(n,1e-8)||o.push(t)})),o.forEach((function(e,n){try{t._styleMarkers[n].setLatLng(e)}catch(t){}}))}},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_finishShape:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=this._startMarker.getLatLng();if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){var i=L.rectangle([n,e],this.options.pathOptions);if(this.options.rectangleAngle){var o=L.PM.Utils._getRotatedRectangle(n,e,this.options.rectangleAngle||0,this._map);i.setLatLngs(o),i.pm&&i.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(i,"layerPane"),this._finishLayer(i),i.addTo(this._map.pm._getContainingLayer()),this._fireCreate(i),this.disable(),this.options.continueDrawing&&this.enable()}},setStyle:function(){var t;null===(t=this._layer)||void 0===t||t.setStyle(this.options.pathOptions)}}),nt.Circle=nt.extend({initialize:function(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle"},enable:function(t){L.Util.setOptions(this,t),this.options.radius=0,this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circle(this._map.getCenter(),vt(vt({},this.options.templineStyle),{},{radius:0})),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(R("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map._container.style.cursor="crosshair",this._map.on("click",this._placeCenterMarker,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius:function(){var t,e=this._centerMarker.getLatLng(),n=this._hintMarker.getLatLng();t=this._map.options.crs===L.CRS.Simple?this._map.distance(e,n):e.distanceTo(n),this.options.minRadiusCircle&&t<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&t>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(t)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._handleHintMarkerSnapping();var n=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(n,"Draw")},_placeCenterMarker:function(t){this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker),this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();this._layerGroup.addLayer(this._layer),this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(R("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_finishShape:function(t){if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e,n=this._centerMarker.getLatLng(),i=this._hintMarker.getLatLng();e=this._map.options.crs===L.CRS.Simple?this._map.distance(n,i):n.distanceTo(i),this.options.minRadiusCircle&&e<this.options.minRadiusCircle?e=this.options.minRadiusCircle:this.options.maxRadiusCircle&&e>this.options.maxRadiusCircle&&(e=this.options.maxRadiusCircle);var o=vt(vt({},this.options.pathOptions),{},{radius:e}),r=L.circle(n,o);this._setPane(r,"layerPane"),this._finishLayer(r),r.addTo(this._map.pm._getContainingLayer()),r.pm&&r.pm._updateHiddenPolyCircle(),this._fireCreate(r),this.disable(),this.options.continueDrawing&&this.enable()}},_getNewDestinationOfHintMarker:function(){var t=this._hintMarker.getLatLng();if(!this._layerGroup.hasLayer(this._centerMarker))return t;var e=this._centerMarker.getLatLng(),n=e.distanceTo(t);return this.options.minRadiusCircle&&n<this.options.minRadiusCircle?t=j(this._map,e,t,this.options.minRadiusCircle):this.options.maxRadiusCircle&&n>this.options.maxRadiusCircle&&(t=j(this._map,e,t,this.options.maxRadiusCircle)),t},_handleHintMarkerSnapping:function(){if(this._hintMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=t.distanceTo(e);this._layerGroup.hasLayer(this._centerMarker)&&(this.options.minRadiusCircle&&n<this.options.minRadiusCircle||this.options.maxRadiusCircle&&n>this.options.maxRadiusCircle)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())},setStyle:function(){var t,e;null===(t=this._layer)||void 0===t||t.setStyle(this.options.templineStyle),null===(e=this._hintline)||void 0===e||e.setStyle(this.options.hintlineStyle)}}),nt.CircleMarker=nt.Marker.extend({initialize:function(t){this._map=t,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1},enable:function(t){var e=this;if(L.Util.setOptions(this,t),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this.options.editable){var n={};L.extend(n,this.options.templineStyle),n.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circleMarker(this._map.getCenter(),n),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(R("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this),this._map._container.style.cursor="crosshair"}else this._map.on("click",this._createMarker,this),this._hintMarker=L.circleMarker(this._map.getCenter(),this.options.templineStyle),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(R("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),!this.options.editable&&this.options.markerEditable&&this._map.eachLayer((function(t){e.isRelevantMarker(t)&&t.pm.enable()})),this._layer.bringToBack(),this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){var t=this;this._enabled&&(this._enabled=!1,this.options.editable?(this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._map.eachLayer((function(e){t.isRelevantMarker(e)&&e.pm.disable()})),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_placeCenterMarker:function(t){this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker),this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();this._layerGroup.addLayer(this._layer),this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(R("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=this._map.project(t).distanceTo(this._map.project(e));this.options.minRadiusCircleMarker&&n<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&n>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(n)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._handleHintMarkerSnapping();var n=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(n,"Draw")},isRelevantMarker:function(t){return t instanceof L.CircleMarker&&!(t instanceof L.Circle)&&t.pm&&!t._pmTempLayer},_createMarker:function(t){if((!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())&&t.latlng&&!this._layerIsDragging){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=L.circleMarker(e,this.options.pathOptions);this._setPane(n,"layerPane"),this._finishLayer(n),n.addTo(this._map.pm._getContainingLayer()),n.pm&&this.options.markerEditable&&n.pm.enable(),this._fireCreate(n),this._cleanupSnapping(),this.options.continueDrawing||this.disable()}},_finishShape:function(t){if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._centerMarker.getLatLng(),n=this._hintMarker.getLatLng(),i=this._map.project(e).distanceTo(this._map.project(n));this.options.editable&&(this.options.minRadiusCircleMarker&&i<this.options.minRadiusCircleMarker?i=this.options.minRadiusCircleMarker:this.options.maxRadiusCircleMarker&&i>this.options.maxRadiusCircleMarker&&(i=this.options.maxRadiusCircleMarker));var o=kt(kt({},this.options.pathOptions),{},{radius:i}),r=L.circleMarker(e,o);this._setPane(r,"layerPane"),this._finishLayer(r),r.addTo(this._map.pm._getContainingLayer()),r.pm&&r.pm._updateHiddenPolyCircle(),this._fireCreate(r),this.disable(),this.options.continueDrawing&&this.enable()}},_getNewDestinationOfHintMarker:function(){var t=this._hintMarker.getLatLng();if(this.options.editable){if(!this._layerGroup.hasLayer(this._centerMarker))return t;var e=this._centerMarker.getLatLng(),n=this._map.project(e).distanceTo(this._map.project(t));this.options.minRadiusCircleMarker&&n<this.options.minRadiusCircleMarker?t=j(this._map,e,t,this._pxRadiusToMeter(this.options.minRadiusCircleMarker)):this.options.maxRadiusCircleMarker&&n>this.options.maxRadiusCircleMarker&&(t=j(this._map,e,t,this._pxRadiusToMeter(this.options.maxRadiusCircleMarker)))}return t},_handleHintMarkerSnapping:function(){if(this.options.editable){if(this._hintMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=this._map.project(t).distanceTo(this._map.project(e));this._layerGroup.hasLayer(this._centerMarker)&&(this.options.minRadiusCircleMarker&&n<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&n>this.options.maxRadiusCircleMarker)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},_pxRadiusToMeter:function(t){var e=this._centerMarker.getLatLng(),n=this._map.project(e),i=L.point(n.x+t,n.y);return this._map.unproject(i).distanceTo(e)},setStyle:function(){var t,e,n={};L.extend(n,this.options.templineStyle),this.options.editable&&(n.radius=0),null===(t=this._layer)||void 0===t||t.setStyle(n),null===(e=this._hintline)||void 0===e||e.setStyle(this.options.hintlineStyle)}});const Tt=function(t){if(!t)throw new Error("geojson is required");var e=[];return Pt(t,(function(t){!function(t,e){var n=[],i=t.geometry;if(null!==i){switch(i.type){case"Polygon":n=Lt(i);break;case"LineString":n=[Lt(i)]}n.forEach((function(n){var i=function(t,e){var n=[];return t.reduce((function(t,i){var o,r,s,a,l,c,h=at([t,i],e);return h.bbox=(r=i,s=(o=t)[0],a=o[1],[s<(l=r[0])?s:l,a<(c=r[1])?a:c,s>l?s:l,a>c?a:c]),n.push(h),i})),n}(n,t.properties);i.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),lt(e)};var St=n(1787);function Ot(t,e){var n=Lt(t),i=Lt(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],r=n[0][1],s=n[1][0],a=n[1][1],l=i[0][0],c=i[0][1],h=i[1][0],u=i[1][1],d=(u-c)*(s-o)-(h-l)*(a-r);if(0===d)return null;var p=((h-l)*(r-c)-(u-c)*(o-l))/d,_=((s-o)*(r-c)-(a-r)*(o-l))/d;return p>=0&&p<=1&&_>=0&&_<=1?st([o+p*(s-o),r+p*(a-r)]):null}const Dt=function(t,e){var n={},i=[];if("LineString"===t.type&&(t=rt(t)),"LineString"===e.type&&(e=rt(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var o=Ot(t,e);return o&&i.push(o),lt(i)}var r=St();return r.load(Tt(e)),Et(Tt(t),(function(t){Et(r.search(t),(function(e){var o=Ot(t,e);if(o){var r=Lt(o).join(",");n[r]||(n[r]=!0,i.push(o))}}))})),lt(i)},It=function(t,e,n){void 0===n&&(n={});var i=xt(t),o=xt(e),r=ht(o[1]-i[1]),s=ht(o[0]-i[0]),a=ht(i[1]),l=ht(o[1]),c=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return function(t,e){void 0===e&&(e="kilometers");var n=ot[e];if(!n)throw new Error(e+" units is invalid");return t*n}(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n.units)};function Rt(t){var e=[1/0,1/0,-1/0,-1/0];return Ct(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}Rt.default=Rt;const At=Rt;function Bt(t,e,n){if(void 0===n&&(n={}),!0===n.final)return function(t,e){var n=Bt(e,t);return(n+180)%360}(t,e);var i=xt(t),o=xt(e),r=ht(i[0]),s=ht(o[0]),a=ht(i[1]),l=ht(o[1]),c=Math.sin(s-r)*Math.cos(l),h=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-r);return ct(Math.atan2(c,h))}function zt(t,e,n,i){void 0===i&&(i={});var o=xt(t),r=ht(o[0]),s=ht(o[1]),a=ht(n),l=function(t,e){void 0===e&&(e="kilometers");var n=ot[e];if(!n)throw new Error(e+" units is invalid");return t/n}(e,i.units),c=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(a));return st([ct(r+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(c))),ct(c)],i.properties)}const Nt=function(t,e,n){void 0===n&&(n={});var i=st([1/0,1/0],{dist:1/0}),o=0;return Pt(t,(function(t){for(var r=Lt(t),s=0;s<r.length-1;s++){var a=st(r[s]);a.properties.dist=It(e,a,n);var l=st(r[s+1]);l.properties.dist=It(e,l,n);var c=It(a,l,n),h=Math.max(a.properties.dist,l.properties.dist),u=Bt(a,l),d=zt(e,h,u+90,n),p=zt(e,h,u-90,n),_=Dt(at([d.geometry.coordinates,p.geometry.coordinates]),at([a.geometry.coordinates,l.geometry.coordinates])),f=null;_.features.length>0&&((f=_.features[0]).properties.dist=It(e,f,n),f.properties.location=o+It(a,f,n)),a.properties.dist<i.properties.dist&&((i=a).properties.index=s,i.properties.location=o),l.properties.dist<i.properties.dist&&((i=l).properties.index=s+1,i.properties.location=o+c),f&&f.properties.dist<i.properties.dist&&((i=f).properties.index=s),o+=c}})),i};function jt(t,e){var n=[],i=St();return Pt(e,(function(e){if(n.forEach((function(t,e){t.id=e})),n.length){var o=i.search(e);if(o.features.length){var r=Wt(e,o);n=n.filter((function(t){return t.id!==r.id})),i.remove(r),Et(Ft(r,e),(function(t){n.push(t),i.insert(t)}))}}else(n=Ft(t,e).features).forEach((function(t){t.bbox||(t.bbox=function(t){var e=t[0],n=t[1],i=t[2],o=t[3];if(It(t.slice(0,2),[i,n])>=It(t.slice(0,2),[e,o])){var r=(n+o)/2;return[e,r-(i-e)/2,i,r+(i-e)/2]}var s=(e+i)/2;return[s-(o-n)/2,n,s+(o-n)/2,o]}(At(t)))})),i.load(lt(n))})),lt(n)}function Ft(t,e){var n=[],i=Lt(t)[0],o=Lt(t)[t.geometry.coordinates.length-1];if(Ht(i,xt(e))||Ht(o,xt(e)))return lt([t]);var r=St(),s=Tt(t);r.load(s);var a=r.search(e);if(!a.features.length)return lt([t]);var l=Wt(e,a),c=function(t,e,n){var i=n;return Et(t,(function(t,o){i=0===o&&void 0===n?t:e(i,t,o)})),i}(s,(function(t,i,o){var r=Lt(i)[1],s=xt(e);return o===l.id?(t.push(s),n.push(at(t)),Ht(s,r)?[s]:[s,r]):(t.push(r),t)}),[i]);return c.length>1&&n.push(at(c)),lt(n)}function Wt(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var n,i=1/0;return Et(e,(function(e){var o=Nt(e,t).properties.dist;o<i&&(n=e,i=o)})),n}function Ht(t,e){return t[0]===e[0]&&t[1]===e[1]}const Gt=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=Mt(t),i=Mt(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===i)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===i)throw new Error("splitter cannot be a GeometryCollection");var o=function(t,e){void 0===e&&(e={});var n=e.precision,i=e.coordinates,o=e.mutate;if(n=null==n||isNaN(n)?6:n,i=null==i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==o&&void 0!==o||(t=JSON.parse(JSON.stringify(t)));var r=Math.pow(10,n);return Ct(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,r,i)})),t}(e,{precision:7});switch(i){case"Point":return Ft(t,o);case"MultiPoint":return jt(t,o);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return jt(t,Dt(t,o))}};function Zt(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=xt(t),o=$t(e),r=o.type,s=e.bbox,a=o.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,s))return!1;"Polygon"===r&&(a=[a]);for(var l=!1,c=0;c<a.length&&!l;c++)if(Ut(i,a[c][0],n.ignoreBoundary)){for(var h=!1,u=1;u<a[c].length&&!h;)Ut(i,a[c][u],!n.ignoreBoundary)&&(h=!0),u++;h||(l=!0)}return l}function Ut(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,r=e.length-1;o<e.length;r=o++){var s=e[o][0],a=e[o][1],l=e[r][0],c=e[r][1];if(t[1]*(s-l)+a*(l-t[0])+c*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(c-t[1])<=0)return!n;a>t[1]!=c>t[1]&&t[0]<(l-s)*(t[1]-a)/(c-a)+s&&(i=!i)}return i}function qt(t,e,n,i,o){var r=n[0],s=n[1],a=t[0],l=t[1],c=e[0],h=e[1],u=c-a,d=h-l,p=(n[0]-a)*d-(n[1]-l)*u;if(null!==o){if(Math.abs(p)>o)return!1}else if(0!==p)return!1;return i?"start"===i?Math.abs(u)>=Math.abs(d)?u>0?a<r&&r<=c:c<=r&&r<a:d>0?l<s&&s<=h:h<=s&&s<l:"end"===i?Math.abs(u)>=Math.abs(d)?u>0?a<=r&&r<c:c<r&&r<=a:d>0?l<=s&&s<h:h<s&&s<=l:"both"===i&&(Math.abs(u)>=Math.abs(d)?u>0?a<r&&r<c:c<r&&r<a:d>0?l<s&&s<h:h<s&&s<l):Math.abs(u)>=Math.abs(d)?u>0?a<=r&&r<=c:c<=r&&r<=a:d>0?l<=s&&s<=h:h<=s&&s<=l}const Vt=function(t,e,n){void 0===n&&(n={});for(var i=xt(t),o=Lt(e),r=0;r<o.length-1;r++){var s=!1;if(n.ignoreEndVertices&&(0===r&&(s="start"),r===o.length-2&&(s="end"),0===r&&r+1===o.length-1&&(s="both")),qt(o[r],o[r+1],i,s,void 0===n.epsilon?null:n.epsilon))return!0}return!1};function Yt(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Kt(t,e){return t[0]===e[0]&&t[1]===e[1]}function Xt(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}var Jt=n(2676),Qt=n.n(Jt);function te(t){var e={type:"Feature"};return e.geometry=t,e}function ee(t){return"Feature"===t.type?t.geometry:t}function ne(t){return t&&t.geometry&&t.geometry.coordinates?t.geometry.coordinates:t}function ie(t){return te({type:"Polygon",coordinates:t})}function oe(t){return te({type:"MultiPolygon",coordinates:t})}function re(t){return Array.isArray(t)?1+re(t[0]):-1}function se(t){t instanceof L.Polyline&&(t=t.toGeoJSON(15));var e=ne(t),n=re(e),i=[];return n>1?e.forEach((function(t){i.push(function(t){return te({type:"LineString",coordinates:t})}(t))})):i.push(t),i}function ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}nt.Cut=nt.Polygon.extend({initialize:function(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape:function(){var t=this;if(this._editedLayers=[],(this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),!this._doesSelfIntersect))&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){var e=this._layer.getLatLngs();if(!(e.length<=2)){var n=L.polygon(e,this.options.pathOptions);n._latlngInfos=this._layer._latlngInfo,this.cut(n),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach((function(e){var n=e.layer,i=e.originalLayer;t._fireCut(i,n,i),t._fireCut(t._map,n,i),i.pm._fireEdit()})),this._editedLayers=[],this.disable(),this.options.continueDrawing&&this.enable()}}},cut:function(t){var e=this,n=this._map._layers,i=t._latlngInfos||[];Object.keys(n).map((function(t){return n[t]})).filter((function(t){return t.pm})).filter((function(t){return!t._pmTempLayer})).filter((function(t){return!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore})).filter((function(t){return t instanceof L.Polyline})).filter((function(e){return e!==t})).filter((function(t){return t.pm.options.allowCutting})).filter((function(t){return!(e.options.layersToCut&&L.Util.isArray(e.options.layersToCut)&&e.options.layersToCut.length>0)||e.options.layersToCut.indexOf(t)>-1})).filter((function(t){return!e._layerGroup.hasLayer(t)})).filter((function(e){try{var n=!!Dt(t.toGeoJSON(15),e.toGeoJSON(15)).features.length>0;return n||e instanceof L.Polyline&&!(e instanceof L.Polygon)?n:(i=t.toGeoJSON(15),o=e.toGeoJSON(15),r=ee(i),s=ee(o),!(0===(a=Qt().intersection(r.coordinates,s.coordinates)).length||!(1===a.length?ie(a[0]):oe(a))))}catch(t){return e instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}var i,o,r,s,a})).forEach((function(n){var o;if(n instanceof L.Polygon){var r=(o=L.polygon(n.getLatLngs())).getLatLngs();i.forEach((function(t){if(t&&t.snapInfo){var n=t.latlng,i=e._calcClosestLayer(n,[o]);if(i&&i.segment&&i.distance<e.options.snapDistance){var s=i.segment;if(s&&2===s.length){var a=L.PM.Utils._getIndexFromSegment(r,s),l=a.indexPath,c=a.parentPath,h=a.newIndex;(l.length>1?O()(r,c):r).splice(h,0,n)}}}}))}else o=n;var s=e._cutLayer(t,o),a=L.geoJSON(s,n.options);if(1===a.getLayers().length){var l=a.getLayers();a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ae(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(l,1)[0]}e._setPane(a,"layerPane");var c=a.addTo(e._map.pm._getContainingLayer());if(c.pm.enable(n.pm.options),c.pm.disable(),n._pmTempLayer=!0,t._pmTempLayer=!0,n.remove(),n.removeFrom(e._map.pm._getContainingLayer()),t.remove(),t.removeFrom(e._map.pm._getContainingLayer()),c.getLayers&&0===c.getLayers().length&&e._map.pm.removeLayer({target:c}),c instanceof L.LayerGroup?(c.eachLayer((function(t){e._addDrawnLayerProp(t)})),e._addDrawnLayerProp(c)):e._addDrawnLayerProp(c),e.options.layersToCut&&L.Util.isArray(e.options.layersToCut)&&e.options.layersToCut.length>0){var h=e.options.layersToCut.indexOf(n);h>-1&&e.options.layersToCut.splice(h,1)}e._editedLayers.push({layer:c,originalLayer:n})}))},_cutLayer:function(t,e){var n,i,o,r,s,a,l=L.geoJSON();if(e instanceof L.Polygon)i=e.toGeoJSON(15),o=t.toGeoJSON(15),r=ee(i),s=ee(o),n=0===(a=Qt().difference(r.coordinates,s.coordinates)).length?null:1===a.length?ie(a[0]):oe(a);else{var c=se(e);c.forEach((function(e){var n=Gt(e,t.toGeoJSON(15));(n&&n.features.length>0?L.geoJSON(n):L.geoJSON(e)).getLayers().forEach((function(e){(function(t,e){var n=$t(t),i=$t(e),o=n.type,r=i.type,s=n.coordinates,a=i.coordinates;switch(o){case"Point":if("Point"===r)return Kt(s,a);throw new Error("feature2 "+r+" geometry not supported");case"MultiPoint":switch(r){case"Point":return function(t,e){var n,i=!1;for(n=0;n<t.coordinates.length;n++)if(Kt(t.coordinates[n],e.coordinates)){i=!0;break}return i}(n,i);case"MultiPoint":return function(t,e){for(var n=0,i=e.coordinates;n<i.length;n++){for(var o=i[n],r=!1,s=0,a=t.coordinates;s<a.length;s++)if(Kt(o,a[s])){r=!0;break}if(!r)return!1}return!0}(n,i);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"Point":return Vt(i,n,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,i=0,o=e.coordinates;i<o.length;i++){var r=o[i];if(Vt({type:"Point",coordinates:r},t,{ignoreEndVertices:!0})&&(n=!0),!Vt({type:"Point",coordinates:r},t,{ignoreEndVertices:!1}))return!1}return n}(n,i);case"MultiPoint":return function(t,e){for(var n=!1,i=0,o=e.coordinates;i<o.length;i++){var r=o[i];if(Vt(r,t,{ignoreEndVertices:!0})&&(n=!0),!Vt(r,t))return!1}return!!n}(n,i);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Point":return Zt(i,n,{ignoreBoundary:!0});case"LineString":return function(t,e){var n=!1,i=0;if(!Yt(At(t),At(e)))return!1;for(;i<e.coordinates.length-1;i++)if(Zt({type:"Point",coordinates:Xt(e.coordinates[i],e.coordinates[i+1])},t,{ignoreBoundary:!0})){n=!0;break}return n}(n,i);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!Yt(At(t),At(e)))return!1;for(var n=0,i=$t(e).coordinates;n<i.length;n++)for(var o=0,r=i[n];o<r.length;o++)if(!Zt(r[o],t))return!1;return!0}(n,i);case"MultiPoint":return function(t,e){for(var n=0,i=e.coordinates;n<i.length;n++)if(!Zt(i[n],t,{ignoreBoundary:!0}))return!1;return!0}(n,i);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+o+" geometry not supported")}})(t.toGeoJSON(15),e.toGeoJSON(15))||e.addTo(l)}))})),n=c.length>1?function(t){var e=[];return t.eachLayer((function(t){e.push(ne(t.toGeoJSON(15)))})),function(t){return te({type:"MultiLineString",coordinates:t})}(e)}(l):l.toGeoJSON(15)}return n},_change:L.Util.falseFn}),nt.Text=nt.extend({initialize:function(t){this._map=t,this._shape="Text",this.toolbarButtonName="drawText"},enable:function(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(R("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_createMarker:function(t){var e;if(t.latlng&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var n=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),null!==(e=this.options.textOptions)&&void 0!==e&&e.className){var i,o=this.options.textOptions.className.split(" ");(i=this.textArea.classList).add.apply(i,function(t){return function(t){if(Array.isArray(t))return le(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return le(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o))}var r=this._createTextIcon(this.textArea),s=new L.Marker(n,{textMarker:!0,_textMarkerOverPM:!0,icon:r});if(this._setPane(s,"markerPane"),this._finishLayer(s),s.pm||(s.options.draggable=!1),s.addTo(this._map.pm._getContainingLayer()),s.pm){var a,l,c,h,u;s.pm.textArea=this.textArea,L.setOptions(s.pm,{removeIfEmpty:null===(a=null===(l=this.options.textOptions)||void 0===l?void 0:l.removeIfEmpty)||void 0===a||a});var d=null===(c=null===(h=this.options.textOptions)||void 0===h?void 0:h.focusAfterDraw)||void 0===c||c;s.pm._createTextMarker(d),null!==(u=this.options.textOptions)&&void 0!==u&&u.text&&s.pm.setText(this.options.textOptions.text)}this._fireCreate(s),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()}},_createTextArea:function(){var t=document.createElement("textarea");return t.autofocus=!0,t.readOnly=!0,t.classList.add("pm-textarea","pm-disabled"),t},_createTextIcon:function(t){return L.divIcon({className:"pm-text-marker",html:t})}});const ce={enableLayerDrag:function(){if(this.options.draggable&&this._layer._map){this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,H(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;var t=this._getDOMElem();t&&(H(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(t)):L.DomEvent.on(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()}},disableLayerDrag:function(){this._layerDragEnabled=!1,H(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();var t=this._getDOMElem();t&&(H(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(t)):L.DomEvent.off(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging:function(){return this._dragging},layerDragEnabled:function(){return!!this._layerDragEnabled},_simulateMouseDownEvent:function(t){var e=t.touches?t.touches[0]:t,n={originalEvent:e,target:this._layer};return n.containerPoint=this._map.mouseEventToContainerPoint(e),n.latlng=this._map.containerPointToLatLng(n.containerPoint),this._dragMixinOnMouseDown(n),!1},_simulateMouseMoveEvent:function(t){var e=t.touches?t.touches[0]:t,n={originalEvent:e,target:this._layer};return n.containerPoint=this._map.mouseEventToContainerPoint(e),n.latlng=this._map.containerPointToLatLng(n.containerPoint),this._dragMixinOnMouseMove(n),!1},_simulateMouseUpEvent:function(t){var e={originalEvent:t.touches?t.touches[0]:t,target:this._layer};return-1===t.type.indexOf("touch")&&(e.containerPoint=this._map.mouseEventToContainerPoint(t),e.latlng=this._map.containerPointToLatLng(e.containerPoint)),this._dragMixinOnMouseUp(e),!1},_dragMixinOnMouseDown:function(t){if(!(t.originalEvent.button>0)){this._overwriteEventIfItComesFromMarker(t);var e=t._fromLayerSync,n=this._syncLayers("_dragMixinOnMouseDown",t);this._layer instanceof L.Marker&&(!this.options.snappable||e||n?this._disableSnapping():this._initSnappableMarkers()),this._layer instanceof L.CircleMarker&&!(this._layer instanceof L.Circle)&&(!this.options.snappable||e||n?this._layer.pm.options.editable?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag():this._layer.pm.options.editable||this._initSnappableMarkersDrag()),this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)}},_dragMixinOnMouseMove:function(t){this._overwriteEventIfItComesFromMarker(t);var e=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",t),this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=t.latlng),this._onLayerDrag(t),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp:function(t){var e=this,n=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",t),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),!!this._dragging&&(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout((function(){e._dragging=!1,n&&L.DomUtil.removeClass(n,"leaflet-pm-dragging"),e._fireDragEnd(),e._fireEdit(),e._layerEdited=!0}),10),!0)},_onLayerDrag:function(t){var e=t.latlng,n=e.lat-this._tempDragCoord.lat,i=e.lng-this._tempDragCoord.lng,o=function t(e){return e.map((function(e){if(Array.isArray(e))return t(e);var o={lat:e.lat+n,lng:e.lng+i};return(e.alt||0===e.alt)&&(o.alt=e.alt),o}))};if(this._layer instanceof L.Circle||this._layer instanceof L.CircleMarker&&this._layer.options.editable){var r=o([this._layer.getLatLng()]);this._layer.setLatLng(r[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){var s=this._layer.getLatLng();this._layer._snapped&&(s=this._layer._orgLatLng);var a=o([s]);this._layer.setLatLng(a[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){var l=o([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(l),this._fireChange(this._layer.getBounds(),"Edit")}else{var c=o(this._layer.getLatLngs());this._layer.setLatLngs(c),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=e,t.layer=this._layer,this._fireDrag(t)},addDraggingClass:function(){var t=this._getDOMElem();t&&L.DomUtil.addClass(t,"leaflet-pm-draggable")},removeDraggingClass:function(){var t=this._getDOMElem();t&&L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_getDOMElem:function(){var t=null;return this._layer._path?t=this._layer._path:this._layer._renderer&&this._layer._renderer._container?t=this._layer._renderer._container:this._layer._image?t=this._layer._image:this._layer._icon&&(t=this._layer._icon),t},_overwriteEventIfItComesFromMarker:function(t){t.target.getLatLng&&(!t.target._radius||t.target._radius<=10)&&(t.containerPoint=this._map.mouseEventToContainerPoint(t.originalEvent),t.latlng=this._map.containerPointToLatLng(t.containerPoint))},_syncLayers:function(t,e){var n=this;if(this.enabled())return!1;if(!e._fromLayerSync&&this._layer===e.target&&this.options.syncLayersOnDrag){e._fromLayerSync=!0;var i=[];if(L.Util.isArray(this.options.syncLayersOnDrag))i=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach((function(t){t instanceof L.LayerGroup&&(i=i.concat(t.pm.getLayers(!0)))}));else if(!0===this.options.syncLayersOnDrag&&this._parentLayerGroup)for(var o in this._parentLayerGroup){var r=this._parentLayerGroup[o];r.pm&&(i=r.pm.getLayers(!0))}return L.Util.isArray(i)&&i.length>0&&(i=i.filter((function(t){return!!t.pm})).filter((function(t){return!!t.pm.options.draggable}))).forEach((function(i){i!==n._layer&&i.pm[t]&&(i._snapped=!1,i.pm[t](e))})),i.length>0}return!1},_stopDOMImageDrag:function(t){return t.preventDefault(),!1}};function he(t,e,n){var i=n.getMaxZoom();if(i===1/0&&(i=n.getZoom()),L.Util.isArray(t)){var o=[];return t.forEach((function(t){o.push(he(t,e,n))})),o}return t instanceof L.LatLng?function(t,e,n,i){return n.unproject(e.transform(n.project(t,i)),i)}(t,e,n,i):null}function ue(t,e){e instanceof L.Layer&&(e=e.getLatLng());var n=t.getMaxZoom();return n===1/0&&(n=t.getZoom()),t.project(e,n)}function de(t,e){var n=t.getMaxZoom();return n===1/0&&(n=t.getZoom()),t.unproject(e,n)}var pe={_onRotateStart:function(t){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=ue(this._map,this._rotationOriginLatLng),this._rotationStartPoint=ue(this._map,t.target.getLatLng()),this._initialRotateLatLng=F(this._layer),this._startAngle=this.getAngle();var e=F(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,e),this._fireRotationStart(this._map,e)},_onRotate:function(t){var e=ue(this._map,t.target.getLatLng()),n=this._rotationStartPoint,i=this._rotationOriginPoint,o=Math.atan2(e.y-i.y,e.x-i.x)-Math.atan2(n.y-i.y,n.x-i.x);this._layer.setLatLngs(this._rotateLayer(o,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));var r=this;!function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(i>-1&&n.push(i),L.Util.isArray(e[0]))e.forEach((function(e,i){return t(e,n.slice(),i)}));else{var o=O()(r._markers,n);e.forEach((function(t,e){o[e].setLatLng(t)}))}}(this._layer.getLatLngs());var s=F(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(o,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));var a=180*o/Math.PI,l=(a=a<0?a+360:a)+this._startAngle;this._setAngle(l),this._rotationLayer.pm._setAngle(l),this._fireRotation(this._rotationLayer,a,s),this._fireRotation(this._map,a,s),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd:function(){var t=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;var e=F(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=F(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,t,e),this._fireRotationEnd(this._map,t,e),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer:function(t,e,n,i,o){var r=ue(o,n);return this._matrix=i.clone().rotate(t,r).flip(),he(e,this._matrix,o)},_setAngle:function(t){t=t<0?t+360:t,this._angle=t%360},_getRotationCenter:function(){var t=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),e=t.getCenter();return t.removeFrom(this._layer._map),e},enableRotate:function(){this.options.allowRotation?(this.rotateEnabled()&&this.disableRotate(),this._rotatePoly=L.polygon(this._layer.getLatLngs(),{fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0}),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=F(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)):this.disableRotate()},disableRotate:function(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled:function(){return this._rotateEnabled},rotateLayer:function(t){var e=this.getAngle(),n=this._layer.getLatLngs(),i=t*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(i,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+t),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(i,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());var o=this.getAngle()-e;o=o<0?o+360:o,this._startAngle=e,this._fireRotation(this._layer,o,n,this._layer),this._fireRotation(this._map||this._layer._map,o,n,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle:function(t){var e=t-this.getAngle();this.rotateLayer(e)},getAngle:function(){return this._angle||0},setInitAngle:function(t){this._setAngle(t)}};const _e=pe,fe=L.Class.extend({includes:[ce,et,_e,P],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0},setOptions:function(t){L.Util.setOptions(this,t)},getOptions:function(){return this.options},applyOptions:function(){},isPolygon:function(){return this._layer instanceof L.Polygon},getShape:function(){return this._shape},_setPane:function(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove:function(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation:function(t,e){var n=e.target,i={layer:this._layer,marker:n,event:e},o="";return"move"===t?o="moveVertexValidation":"add"===t?o="addVertexValidation":"remove"===t&&(o="removeVertexValidation"),this.options[o]&&"function"==typeof this.options[o]&&!this.options[o](i)?("move"===t&&(n._cancelDragEventChain=n.getLatLng()),!1):(n._cancelDragEventChain=null,!0)},_vertexValidationDrag:function(t){return!t._cancelDragEventChain||(t._latlng=t._cancelDragEventChain,t.update(),!1)},_vertexValidationDragEnd:function(t){return!t._cancelDragEventChain||(t._cancelDragEventChain=null,!1)}});function me(t){return function(t){if(Array.isArray(t))return ge(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ge(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}fe.LayerGroup=L.Class.extend({initialize:function(t){var e=this;this._layerGroup=t,this._layers=this.getLayers(),this._getMap(),this._layers.forEach((function(t){return e._initLayer(t)})),this._layerGroup.on("layeradd",L.Util.throttle((function(t){if(!t.layer._pmTempLayer){e._layers=e.getLayers();var n=e._layers.filter((function(t){return!t.pm._parentLayerGroup||!(e._layerGroup._leaflet_id in t.pm._parentLayerGroup)}));n.forEach((function(t){e._initLayer(t)})),n.length>0&&e._getMap()&&e._getMap().pm.globalEditModeEnabled()&&e.enabled()&&e.enable(e.getOptions())}}),100,this),this),this._layerGroup.on("layerremove",(function(t){e._removeLayerFromGroup(t.target)}),this),this._layerGroup.on("layerremove",L.Util.throttle((function(t){t.target._pmTempLayer||(e._layers=e.getLayers())}),100,this),this)},enable:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach((function(n){n instanceof L.LayerGroup?-1===e.indexOf(n._leaflet_id)&&(e.push(n._leaflet_id),n.pm.enable(t,e)):n.pm.enable(t)}))},disable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(this._layers=this.getLayers()),this._layers.forEach((function(e){e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.disable(t)):e.pm.disable()}))},enabled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 0===t.length&&(this._layers=this.getLayers()),!!this._layers.find((function(e){return e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.enabled(t)):e.pm.enabled()}))},toggleEdit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach((function(n){n instanceof L.LayerGroup?-1===e.indexOf(n._leaflet_id)&&(e.push(n._leaflet_id),n.pm.toggleEdit(t,e)):n.pm.toggleEdit(t)}))},_initLayer:function(t){var e=L.Util.stamp(this._layerGroup);t.pm._parentLayerGroup||(t.pm._parentLayerGroup={}),t.pm._parentLayerGroup[e]=this._layerGroup},_removeLayerFromGroup:function(t){if(t.pm&&t.pm._layerGroup){var e=L.Util.stamp(this._layerGroup);delete t.pm._layerGroup[e]}},dragging:function(){return this._layers=this.getLayers(),!!this._layers&&!!this._layers.find((function(t){return t.pm.dragging()}))},getOptions:function(){return this.options},_getMap:function(){var t;return this._map||(null===(t=this._layers.find((function(t){return!!t._map})))||void 0===t?void 0:t._map)||null},getLayers:function(){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=[];return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this._layerGroup.getLayers().forEach((function(t){i.push(t),t instanceof L.LayerGroup&&-1===n.indexOf(t._leaflet_id)&&(n.push(t._leaflet_id),i=i.concat(t.pm.getLayers(!0,!0,!0,n)))})):i=this._layerGroup.getLayers(),e&&(i=i.filter((function(t){return!(t instanceof L.LayerGroup)}))),t&&(i=(i=(i=i.filter((function(t){return!!t.pm}))).filter((function(t){return!t._pmTempLayer}))).filter((function(t){return!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore}))),i},setOptions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===e.length&&(this._layers=this.getLayers()),this.options=t,this._layers.forEach((function(n){n.pm&&(n instanceof L.LayerGroup?-1===e.indexOf(n._leaflet_id)&&(e.push(n._leaflet_id),n.pm.setOptions(t,e)):n.pm.setOptions(t))}))}}),fe.Marker=fe.extend({_shape:"Marker",initialize:function(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{draggable:!0};L.Util.setOptions(this,t),this.options.allowEditing&&this._layer._map?(this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()):this.disable()},disable:function(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker:function(t){var e=t.target;e.remove(),this._fireRemove(e),this._fireRemove(this._map,e)},_onDragEnd:function(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){var t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}});const ve={filterMarkerGroup:function(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents:function(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache:function(){var t=[].concat(me(this._markerGroup.getLayers()),me(this.markerCache));this.markerCache=t.filter((function(t,e,n){return n.indexOf(t)===e}))},renderLimits:function(t){var e=this;this.markerCache.forEach((function(n){t.includes(n)?e._markerGroup.addLayer(n):e._markerGroup.removeLayer(n)}))},applyLimitFilters:function(t){var e=t.latlng,n=void 0===e?{lat:0,lng:0}:e;if(!this._preventRenderMarkers){var i=me(this._filterClosestMarkers(n));this.renderLimits(i)}},_filterClosestMarkers:function(t){var e=me(this.markerCache),n=this.options.limitMarkersToCount;return-1===n?e:(e.sort((function(e,n){return e._latlng.distanceTo(t)-n._latlng.distanceTo(t)})),e.filter((function(t,e){return!(n>-1)||e<n})))},_preventRenderMarkers:!1,_preventRenderingMarkers:function(t){this._preventRenderMarkers=!!t}};function ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function be(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}fe.Line=fe.extend({includes:[ve],_shape:"Line",initialize:function(t){this._layer=t,this._enabled=!1},enable:function(t){L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:("#f00000ff"!==this._layer.options.color?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()):this.disable())},disable:function(){if(this.enabled()&&!this._dragging){this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);var t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable"),this._map.hasLayer(this._layer)&&!this.hasSelfIntersection()||L.DomUtil.removeClass(t,"leaflet-pm-invalid"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()}},enabled:function(){return this._enabled},toggleEdit:function(t){return this.enabled()?this.disable():this.enable(t),this.enabled()},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers:function(){var t=this,e=this._map,n=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,this._markers=function e(n){if(Array.isArray(n[0]))return n.map(e,t);var i=n.map(t._createMarker,t);return!0!==t.options.hideMiddleMarkers&&n.map((function(e,o){var r=t.isPolygon()?(o+1)%n.length:o+1;return t._createMiddleMarker(i[o],i[r])})),i}(n),this.filterMarkerGroup(),e.addLayer(this._markerGroup)},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this.options.rotate?(e.on("dragstart",this._onRotateStart,this),e.on("drag",this._onRotate,this),e.on("dragend",this._onRotateEnd,this)):(e.on("click",this._onVertexClick,this),e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(e),e},_createMiddleMarker:function(t,e){if(!t||!e)return!1;var n=L.PM.Utils.calcMiddleLatLng(this._map,t.getLatLng(),e.getLatLng()),i=this._createMarker(n),o=L.divIcon({className:"marker-icon marker-icon-middle"});return i.setIcon(o),i.leftM=t,i.rightM=e,t._middleMarkerNext=i,e._middleMarkerPrev=i,i.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),i.on("movestart",this._onMiddleMarkerMoveStart,this),i},_onMiddleMarkerClick:function(t){var e=t.target;if(this._vertexValidation("add",t)){var n=L.divIcon({className:"marker-icon"});e.setIcon(n),this._addMarker(e,e.leftM,e.rightM)}},_onMiddleMarkerMoveStart:function(t){var e=t.target;e.on("moveend",this._onMiddleMarkerMoveEnd,this),this._vertexValidation("add",t)?(e._dragging=!0,this._addMarker(e,e.leftM,e.rightM)):e.on("move",this._onMiddleMarkerMovePrevent,this)},_onMiddleMarkerMovePrevent:function(t){var e=t.target;this._vertexValidationDrag(e)},_onMiddleMarkerMoveEnd:function(t){var e=t.target;if(e.off("move",this._onMiddleMarkerMovePrevent,this),e.off("moveend",this._onMiddleMarkerMoveEnd,this),this._vertexValidationDragEnd(e)){var n=L.divIcon({className:"marker-icon"});e.setIcon(n),setTimeout((function(){delete e._dragging}),100)}},_addMarker:function(t,e,n){t.off("movestart",this._onMiddleMarkerMoveStart,this),t.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);var i=t.getLatLng(),o=this._layer._latlngs;delete t.leftM,delete t.rightM;var r=L.PM.Utils.findDeepMarkerIndex(this._markers,e),s=r.indexPath,a=r.index,l=r.parentPath,c=s.length>1?O()(o,l):o,h=s.length>1?O()(this._markers,l):this._markers;c.splice(a+1,0,i),h.splice(a+1,0,t),this._layer.setLatLngs(o),!0!==this.options.hideMiddleMarkers&&(this._createMiddleMarker(e,t),this._createMiddleMarker(t,n)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(t,L.PM.Utils.findDeepMarkerIndex(this._markers,t).indexPath,i),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection:function(){return dt(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval:function(){this._handleLayerStyle(!0),this.hasSelfIntersection()&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle:function(t){var e=this._layer;if(this.hasSelfIntersection()){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return;t?this._flashLayer():(e.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(dt(this._layer.toGeoJSON(15)))}else e.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1)},_flashLayer:function(){var t=this;this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout((function(){t._layer.setStyle({color:t.cachedColor}),t.isRed=!1}),200)},_updateDisabledMarkerStyle:function(t,e){var n=this;t.forEach((function(t){Array.isArray(t)?n._updateDisabledMarkerStyle(t,e):t._icon&&(e&&!n._checkMarkerAllowedToDrag(t)?L.DomUtil.addClass(t._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(t._icon,"vertexmarker-disabled"))}))},_removeMarker:function(t){var e=t.target;if(this._vertexValidation("remove",t)){this.options.allowSelfIntersection||(this._coordsBeforeEdit=F(this._layer,this._layer.getLatLngs()));var n=this._layer.getLatLngs(),i=L.PM.Utils.findDeepMarkerIndex(this._markers,e),o=i.indexPath,r=i.index,s=i.parentPath;if(o){var a=o.length>1?O()(n,s):n,l=o.length>1?O()(this._markers,s):this._markers;if(this.options.removeLayerBelowMinVertexCount||!(a.length<=2||this.isPolygon()&&a.length<=3)){a.splice(r,1),this._layer.setLatLngs(n),this.isPolygon()&&a.length<=2&&a.splice(0,a.length);var c=!1;if(a.length<=1&&(a.splice(0,a.length),s.length>1&&o.length>1&&(n=B(n)),this._layer.setLatLngs(n),this._initMarkers(),c=!0),A(n)||this._layer.remove(),n=B(n),this._layer.setLatLngs(n),this._markers=B(this._markers),!c&&(l=o.length>1?O()(this._markers,s):this._markers,e._middleMarkerPrev&&this._markerGroup.removeLayer(e._middleMarkerPrev),e._middleMarkerNext&&this._markerGroup.removeLayer(e._middleMarkerNext),this._markerGroup.removeLayer(e),l)){var h,u;if(this.isPolygon()?(h=(r+1)%l.length,u=(r+(l.length-1))%l.length):(u=r-1<0?void 0:r-1,h=r+1>=l.length?void 0:r+1),h!==u){var d=l[u],p=l[h];!0!==this.options.hideMiddleMarkers&&this._createMiddleMarker(d,p)}l.splice(r,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(e,o),this._fireChange(this._layer.getLatLngs(),"Edit")}else this._flashLayer()}}},updatePolygonCoordsFromMarkerDrag:function(t){var e=this._layer.getLatLngs(),n=t.getLatLng(),i=L.PM.Utils.findDeepMarkerIndex(this._markers,t),o=i.indexPath,r=i.index,s=i.parentPath;(o.length>1?O()(e,s):e).splice(r,1,n),this._layer.setLatLngs(e)},_getNeighborMarkers:function(t){var e=L.PM.Utils.findDeepMarkerIndex(this._markers,t),n=e.indexPath,i=e.index,o=e.parentPath,r=n.length>1?O()(this._markers,o):this._markers,s=(i+1)%r.length;return{prevMarker:r[(i+(r.length-1))%r.length],nextMarker:r[s]}},_checkMarkerAllowedToDrag:function(t){var e=this._getNeighborMarkers(t),n=e.prevMarker,i=e.nextMarker,o=L.polyline([n.getLatLng(),t.getLatLng()]),r=L.polyline([t.getLatLng(),i.getLatLng()]),s=Dt(this._layer.toGeoJSON(15),o.toGeoJSON(15)).features.length,a=Dt(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length;return t.getLatLng()===this._markers[0][0].getLatLng()?a+=1:t.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(s+=1),!(s<=2&&a<=2)},_onMarkerDragStart:function(t){var e=t.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),this._vertexValidation("move",t)){var n=L.PM.Utils.findDeepMarkerIndex(this._markers,e).indexPath;this._fireMarkerDragStart(t,n),this.options.allowSelfIntersection||(this._coordsBeforeEdit=F(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(e):this._markerAllowedToDrag=null}},_onMarkerDrag:function(t){var e=t.target;if(this._vertexValidationDrag(e)){var n=L.PM.Utils.findDeepMarkerIndex(this._markers,e),i=n.indexPath,o=n.index,r=n.parentPath;if(i){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&!1===this._markerAllowedToDrag)return this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),void this._handleLayerStyle();this.updatePolygonCoordsFromMarkerDrag(e);var s=i.length>1?O()(this._markers,r):this._markers,a=(o+1)%s.length,l=(o+(s.length-1))%s.length,c=e.getLatLng(),h=s[l].getLatLng(),u=s[a].getLatLng();if(e._middleMarkerNext){var d=L.PM.Utils.calcMiddleLatLng(this._map,c,u);e._middleMarkerNext.setLatLng(d)}if(e._middleMarkerPrev){var p=L.PM.Utils.calcMiddleLatLng(this._map,c,h);e._middleMarkerPrev.setLatLng(p)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(t,i),this._fireChange(this._layer.getLatLngs(),"Edit")}}},_onMarkerDragEnd:function(t){var e=t.target;if(this._vertexValidationDragEnd(e)){var n=L.PM.Utils.findDeepMarkerIndex(this._markers,e).indexPath,i=this.hasSelfIntersection();i&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(i=!1);var o=!this.options.allowSelfIntersection&&i;if(this._fireMarkerDragEnd(t,n,o),o)return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),void this._fireLayerReset(t,n);!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")}},_onVertexClick:function(t){var e=t.target;if(!e._dragging){var n=L.PM.Utils.findDeepMarkerIndex(this._markers,e).indexPath;this._fireVertexClick(t,n)}}}),fe.Polygon=fe.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag:function(t){var e=this._getNeighborMarkers(t),n=e.prevMarker,i=e.nextMarker,o=L.polyline([n.getLatLng(),t.getLatLng()]),r=L.polyline([t.getLatLng(),i.getLatLng()]),s=Dt(this._layer.toGeoJSON(15),o.toGeoJSON(15)).features.length,a=Dt(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length;return!(s<=2&&a<=2)}}),fe.Rectangle=fe.Polygon.extend({_shape:"Rectangle",_initMarkers:function(){var t=this,e=this._map,n=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,e.addLayer(this._markerGroup),this._markers=[],this._markers[0]=n.map(this._createMarker,this);var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ye(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ye(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this._markers,1);this._cornerMarkers=i[0],this._layer.getLatLngs()[0].forEach((function(e,n){var i=t._cornerMarkers.find((function(t){return t._index===n}));i&&i.setLatLng(e)}))},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(n,"vertexPane"),n._origLatLng=t,n._index=e,n._pmTempLayer=!0,this._markerGroup.addLayer(n),n},_addMarkerEvents:function(){var t=this;this._markers[0].forEach((function(e){e.on("dragstart",t._onMarkerDragStart,t),e.on("drag",t._onMarkerDrag,t),e.on("dragend",t._onMarkerDragEnd,t),t.options.preventMarkerRemoval||e.on("contextmenu",t._removeMarker,t)}))},_removeMarker:function(){return null},_onMarkerDragStart:function(t){if(this._vertexValidation("move",t)){var e=t.target,n=this._cornerMarkers;e._oppositeCornerLatLng=n.find((function(t){return t._index===(e._index+2)%4})).getLatLng(),e._snapped=!1,this._fireMarkerDragStart(t)}},_onMarkerDrag:function(t){var e=t.target;this._vertexValidationDrag(e)&&void 0!==e._index&&(this._adjustRectangleForMarkerMove(e),this._fireMarkerDrag(t),this._fireChange(this._layer.getLatLngs(),"Edit"))},_onMarkerDragEnd:function(t){var e=t.target;this._vertexValidationDragEnd(e)&&(this._cornerMarkers.forEach((function(t){delete t._oppositeCornerLatLng})),this._fireMarkerDragEnd(t),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"))},_adjustRectangleForMarkerMove:function(t){L.extend(t._origLatLng,t._latlng);var e=L.PM.Utils._getRotatedRectangle(t.getLatLng(),t._oppositeCornerLatLng,this._angle||0,this._map);this._layer.setLatLngs(e),this._adjustAllMarkers(),this._layer.redraw()},_adjustAllMarkers:function(){var t=this,e=this._layer.getLatLngs()[0];e&&4!==e.length&&e.length>0?(e.forEach((function(e,n){t._cornerMarkers[n].setLatLng(e)})),this._cornerMarkers.slice(e.length).forEach((function(t){t.setLatLng(e[0])}))):e&&e.length?this._cornerMarkers.forEach((function(t){t.setLatLng(e[t._index])})):console.error("The layer has no LatLngs")},_findCorners:function(){var t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this._angle||0,this._map)}}),fe.Circle=fe.extend({_shape:"Circle",initialize:function(t){this._layer=t,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(t){L.Util.setOptions(this,t),this._map=this._layer._map,this.options.allowEditing?(this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._updateHiddenPolyCircle(),this._fireEnable()):this.disable()},disable:function(){if(this.enabled()&&!this._dragging){this._centerMarker.off("dragstart",this._onCircleDragStart,this),this._centerMarker.off("drag",this._onCircleDrag,this),this._centerMarker.off("dragend",this._onCircleDragEnd,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this),this._layer.off("remove",this.disable,this),this._enabled=!1,this._helperLayers.clearLayers();var t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()}},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},_initMarkers:function(){var t=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);var e=this._layer.getLatLng(),n=this._layer._radius,i=this._getLatLngOnCircle(e,n);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(i),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},applyOptions:function(){this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this),this._centerMarker.on("move",this._moveCircle,this)):this._disableSnapping()},_createHintLine:function(t,e){var n=t.getLatLng(),i=e.getLatLng();this._hintline=L.polyline([n,i],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(t){var e=this._createMarker(t);return L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"),e.on("drag",this._moveCircle,this),e.on("dragstart",this._onCircleDragStart,this),e.on("drag",this._onCircleDrag,this),e.on("dragend",this._onCircleDragEnd,this),e},_createOuterMarker:function(t){var e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(e),e},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_moveCircle:function(t){if(!t.target._cancelDragEventChain){var e=t.latlng;this._layer.setLatLng(e);var n=this._layer._radius,i=this._getLatLngOnCircle(e,n);this._outerMarker._latlng=i,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")}},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=this._map.distance(t,e);this.options.minRadiusCircle&&n<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&n>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(n),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_disableSnapping:function(){var t=this;this._markers.forEach((function(e){e.off("move",t._syncHintLine,t),e.off("move",t._syncCircleRadius,t),e.off("drag",t._handleSnapping,t),e.off("dragend",t._cleanupSnapping,t)})),this._layer.off("pm:dragstart",this._unsnap,this)},_onMarkerDragStart:function(t){this._vertexValidation("move",t)&&this._fireMarkerDragStart(t)},_onMarkerDrag:function(t){var e=t.target;this._vertexValidationDrag(e)&&this._fireMarkerDrag(t)},_onMarkerDragEnd:function(t){var e=t.target;this._vertexValidationDragEnd(e)&&(this._fireEdit(),this._layerEdited=!0,this._fireMarkerDragEnd(t))},_onCircleDragStart:function(t){this._vertexValidationDrag(t.target)?(delete this._vertexValidationReset,this._fireDragStart()):this._vertexValidationReset=!0},_onCircleDrag:function(t){this._vertexValidationReset||this._fireDrag(t)},_onCircleDragEnd:function(){this._vertexValidationReset?delete this._vertexValidationReset:this._fireDragEnd()},_updateHiddenPolyCircle:function(){var t=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!t).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!t),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_getLatLngOnCircle:function(t,e){var n=this._map.project(t),i=L.point(n.x+e,n.y);return this._map.unproject(i)},_getNewDestinationOfOuterMarker:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=this._map.distance(t,e);return this.options.minRadiusCircle&&n<this.options.minRadiusCircle?e=j(this._map,t,e,this.options.minRadiusCircle):this.options.maxRadiusCircle&&n>this.options.maxRadiusCircle&&(e=j(this._map,t,e,this.options.maxRadiusCircle)),e},_handleOuterMarkerSnapping:function(){if(this._outerMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=this._map.distance(t,e);(this.options.minRadiusCircle&&n<this.options.minRadiusCircle||this.options.maxRadiusCircle&&n>this.options.maxRadiusCircle)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())}}),fe.CircleMarker=fe.extend({_shape:"CircleMarker",initialize:function(t){this._layer=t,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0};L.Util.setOptions(this,t),this.options.allowEditing&&this._layer._map?(this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this),this._updateHiddenPolyCircle(),this._fireEnable()):this.disable()},disable:function(){this._dragging||(this._helperLayers&&this._helperLayers.clearLayers(),this._map||(this._map=this._layer._map),this._map||(this.options.editable?(this._map.off("move",this._syncMarkers,this),this._outerMarker&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this)),this.disableLayerDrag(),this._layer.off("contextmenu",this._removeMarker,this),this._layer.off("remove",this.disable,this),this.enabled()&&(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},applyOptions:function(){!this.options.editable&&this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.editable?(this._initMarkers(),this._map.on("move",this._syncMarkers,this)):this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this.options.editable?(this._initSnappableMarkers(),this._centerMarker.on("drag",this._moveCircle,this),this.options.editable&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._initSnappableMarkersDrag():this.options.editable?this._disableSnapping():this._disableSnappingDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers:function(){var t=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);var e=this._layer.getLatLng(),n=this._layer._radius,i=this._getLatLngOnCircle(e,n);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(i),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle:function(t,e){var n=this._map.project(t),i=L.point(n.x+e,n.y);return this._map.unproject(i)},_createHintLine:function(t,e){var n=t.getLatLng(),i=e.getLatLng();this._hintline=L.polyline([n,i],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(t){var e=this._createMarker(t);return this.options.draggable?L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"):e.dragging.disable(),e},_createOuterMarker:function(t){var e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(e),e},_moveCircle:function(){var t=this._centerMarker.getLatLng();this._layer.setLatLng(t);var e=this._layer._radius,n=this._getLatLngOnCircle(t,e);this._outerMarker._latlng=n,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers:function(){var t=this._layer.getLatLng(),e=this._layer._radius,n=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(n),this._centerMarker.setLatLng(t),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=this._map.project(t).distanceTo(this._map.project(e));this.options.minRadiusCircleMarker&&n<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&n>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(n),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_removeMarker:function(){this.options.editable&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart:function(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart:function(t){this._vertexValidation("move",t)&&this._fireMarkerDragStart(t)},_onMarkerDrag:function(t){var e=t.target;e instanceof L.Marker&&!this._vertexValidationDrag(e)||this._fireMarkerDrag(t)},_onMarkerDragEnd:function(t){this._map.pm.Draw.CircleMarker._layerIsDragging=!1;var e=t.target;this._vertexValidationDragEnd(e)&&(this.options.editable&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(t))},_initSnappableMarkersDrag:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag:function(){var t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle:function(){var t=this._layer._map||this._map;if(t){var e=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),t,this._layer.getLatLng()),n=L.circle(this._layer.getLatLng(),this._layer.options);n.setRadius(e);var i=t&&t.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(n,200,!i).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(n,200,!i),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=this._map.project(t).distanceTo(this._map.project(e));return this.options.minRadiusCircleMarker&&n<this.options.minRadiusCircleMarker?e=j(this._map,t,e,L.PM.Utils.pxRadiusToMeterRadius(this.options.minRadiusCircleMarker,this._map,t)):this.options.maxRadiusCircleMarker&&n>this.options.maxRadiusCircleMarker&&(e=j(this._map,t,e,L.PM.Utils.pxRadiusToMeterRadius(this.options.maxRadiusCircleMarker,this._map,t))),e},_handleOuterMarkerSnapping:function(){if(this._outerMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=this._map.project(t).distanceTo(this._map.project(e));(this.options.minRadiusCircleMarker&&n<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&n>this.options.maxRadiusCircleMarker)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())}}),fe.ImageOverlay=fe.extend({_shape:"ImageOverlay",initialize:function(t){this._layer=t,this._enabled=!1},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enabled:function(){return this._enabled},enable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0};L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()):this.disable())},disable:function(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),fe.Text=fe.extend({_shape:"Text",initialize:function(t){this._layer=t,this._enabled=!1},enable:function(t){L.Util.setOptions(this,t),this.textArea&&(this.options.allowEditing&&this._layer._map?(this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()):this.disable())},disable:function(){if(this.enabled()){this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");var t=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),t.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1}},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){var t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_autoResize:function(){this.textArea.style.height="1px",this.textArea.style.width="1px";var t=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,e=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height="".concat(t,"px"),this.textArea.style.width="".concat(e,"px"),this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur:function(){var t=this;this._disableOnBlurActive=!0,setTimeout((function(){t.enabled()&&L.DomEvent.on(document,"click",t._documentClick,t)}),100)},_documentClick:function(t){t.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._hasFocus;this._hasFocus="focus"===t.type,!e!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus:function(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus:function(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus:function(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur:function(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus:function(){return this._hasFocus},getElement:function(){return this.textArea},setText:function(t){this.textArea.value=t,this._autoResize()},getText:function(){return this.textArea.value},_initTextMarker:function(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){var t,e=this.options.className.split(" ");(t=this.textArea.classList).add.apply(t,function(t){return function(t){if(Array.isArray(t))return be(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return be(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e))}var n=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(n),this._layer.once("add",this._createTextMarker,this)},_createTextMarker:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),!0===t&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection:function(t){t.preventDefault()}});var ke=function(t,e,n,i,o,r){this._matrix=[t,e,n,i,o,r]};ke.init=function(){return new L.PM.Matrix(1,0,0,1,0,0)},ke.prototype={transform:function(t){return this._transform(t.clone())},_transform:function(t){var e=this._matrix,n=t.x,i=t.y;return t.x=e[0]*n+e[1]*i+e[4],t.y=e[2]*n+e[3]*i+e[5],t},untransform:function(t){var e=this._matrix;return new L.Point((t.x/e[0]-e[4])/e[0],(t.y/e[2]-e[5])/e[2])},clone:function(){var t=this._matrix;return new L.PM.Matrix(t[0],t[1],t[2],t[3],t[4],t[5])},translate:function(t){return void 0===t?new L.Point(this._matrix[4],this._matrix[5]):("number"==typeof t?(e=t,n=t):(e=t.x,n=t.y),this._add(1,0,0,1,e,n));var e,n},scale:function(t,e){return void 0===t?new L.Point(this._matrix[0],this._matrix[3]):(e=e||L.point(0,0),"number"==typeof t?(n=t,i=t):(n=t.x,i=t.y),this._add(n,0,0,i,e.x,e.y)._add(1,0,0,1,-e.x,-e.y));var n,i},rotate:function(t,e){var n=Math.cos(t),i=Math.sin(t);return e=e||new L.Point(0,0),this._add(n,i,-i,n,e.x,e.y)._add(1,0,0,1,-e.x,-e.y)},flip:function(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add:function(t,e,n,i,o,r){var s,a=[[],[],[]],l=this._matrix,c=[[l[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]],h=[[t,n,o],[e,i,r],[0,0,1]];t&&t instanceof L.PM.Matrix&&(h=[[(l=t._matrix)[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]]);for(var u=0;u<3;u+=1)for(var d=0;d<3;d+=1){s=0;for(var p=0;p<3;p+=1)s+=c[u][p]*h[p][d];a[u][d]=s}return this._matrix=[a[0][0],a[1][0],a[0][1],a[1][1],a[0][2],a[1][2]],this}};const we=ke;var xe={calcMiddleLatLng:function(t,e,n){var i=t.project(e),o=t.project(n);return t.unproject(i._add(o)._divideBy(2))},findLayers:function(t){var e=[];return t.eachLayer((function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle||t instanceof L.CircleMarker||t instanceof L.ImageOverlay)&&e.push(t)})),e=(e=(e=e.filter((function(t){return!!t.pm}))).filter((function(t){return!t._pmTempLayer}))).filter((function(t){return!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore}))},circleToPolygon:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=N(t.getLatLng(),t.getRadius(),e,0,n),o=[],r=0;r<i.length;r+=1){var s=[i[r].lat,i[r].lng];o.push(s)}return L.polygon(o,t.options)},disablePopup:function(t){t.getPopup()&&(t._tempPopupCopy=t.getPopup(),t.unbindPopup())},enablePopup:function(t){t._tempPopupCopy&&(t.bindPopup(t._tempPopupCopy),delete t._tempPopupCopy)},_fireEvent:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.fire(e,n,i),this.getAllParentGroups(t).groups.forEach((function(t){t.fire(e,n,i)}))},getAllParentGroups:function(t){var e=[],n=[];return!t._pmLastGroupFetch||!t._pmLastGroupFetch.time||(new Date).getTime()-t._pmLastGroupFetch.time>1e3?(function t(i){for(var o in i._eventParents)if(-1===e.indexOf(o)){e.push(o);var r=i._eventParents[o];n.push(r),t(r)}}(t),t._pmLastGroupFetch={time:(new Date).getTime(),groups:n,groupIds:e},{groupIds:e,groups:n}):{groups:t._pmLastGroupFetch.groups,groupIds:t._pmLastGroupFetch.groupIds}},createGeodesicPolygon:N,getTranslation:R,findDeepCoordIndex:function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.some(function t(o){return function(r,s){var a=o.concat(s);if(i){if(r.lat&&r.lat===e.lat&&r.lng===e.lng)return n=a,!0}else if(r.lat&&L.latLng(r).equals(e))return n=a,!0;return Array.isArray(r)&&r.some(t(a))}}([]));var o={};return n&&(o={indexPath:n,index:n[n.length-1],parentPath:n.slice(0,n.length-1)}),o},findDeepMarkerIndex:function(t,e){var n;t.some(function t(i){return function(o,r){var s=i.concat(r);return o._leaflet_id===e._leaflet_id?(n=s,!0):Array.isArray(o)&&o.some(t(s))}}([]));var i={};return n&&(i={indexPath:n,index:n[n.length-1],parentPath:n.slice(0,n.length-1)}),i},_getIndexFromSegment:function(t,e){if(e&&2===e.length){var n=this.findDeepCoordIndex(t,e[0]),i=this.findDeepCoordIndex(t,e[1]),o=Math.max(n.index,i.index);return 0!==n.index&&0!==i.index||1===o||(o+=1),{indexA:n,indexB:i,newIndex:o,indexPath:n.indexPath,parentPath:n.parentPath}}return null},_getRotatedRectangle:function(t,e,n,i){var o=ue(i,t),r=ue(i,e),s=n*Math.PI/180,a=Math.cos(s),l=Math.sin(s),c=(r.x-o.x)*a+(r.y-o.y)*l,h=(r.y-o.y)*a-(r.x-o.x)*l,u=c*a+o.x,d=c*l+o.y,p=-h*l+o.x,_=h*a+o.y;return[de(i,o),de(i,{x:u,y:d}),de(i,r),de(i,{x:p,y:_})]},pxRadiusToMeterRadius:function(t,e,n){var i=e.project(n),o=L.point(i.x+t,i.y);return e.distance(e.unproject(o),n)}};const Le=xe;L.PM=L.PM||{version:"2.14.2",Map:G,Toolbar:K,Draw:nt,Edit:fe,Utils:Le,Matrix:we,activeLang:"en",optIn:!1,initialize:function(t){this.addInitHooks(t)},setOptIn:function(t){this.optIn=!!t},addInitHooks:function(){L.Map.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})})),L.LayerGroup.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))})),L.Marker.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))})),L.CircleMarker.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))})),L.Polyline.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))})),L.Polygon.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))})),L.Rectangle.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))})),L.Circle.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))})),L.ImageOverlay.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}))},reInitLayer:function(t){var e=this;t instanceof L.LayerGroup&&t.eachLayer((function(t){e.reInitLayer(t)})),t.pm||L.PM.optIn&&!1!==t.options.pmIgnore||t.options.pmIgnore||(t instanceof L.Map?t.pm=new L.PM.Map(t):t instanceof L.Marker?t.options.textMarker?(t.pm=new L.PM.Edit.Text(t),t.pm._initTextMarker(),t.pm._createTextMarker(!1)):t.pm=new L.PM.Edit.Marker(t):t instanceof L.Circle?t.pm=new L.PM.Edit.Circle(t):t instanceof L.CircleMarker?t.pm=new L.PM.Edit.CircleMarker(t):t instanceof L.Rectangle?t.pm=new L.PM.Edit.Rectangle(t):t instanceof L.Polygon?t.pm=new L.PM.Edit.Polygon(t):t instanceof L.Polyline?t.pm=new L.PM.Edit.Line(t):t instanceof L.LayerGroup?t.pm=new L.PM.Edit.LayerGroup(t):t instanceof L.ImageOverlay&&(t.pm=new L.PM.Edit.ImageOverlay(t)))}},"1.7.1"===L.version&&L.Canvas.include({_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(i)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(n=e);n&&(L.DomEvent.fakeStop(t),this._fireEvent([n],t))}}),L.PM.initialize()},7107:()=>{Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,i=arguments[1],o=0;o<n;o++)if(t.call(i,e[o],o,e))return o;return-1},Array.prototype.find=Array.prototype.find||function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,i=arguments[1],o=0;o<n;o++){var r=e[o];if(t.call(i,r,o,e))return r}},"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var n=arguments[e];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;for(var o,r,s=0|e,a=Math.max(s>=0?s:i-Math.abs(s),0);a<i;){if((o=n[a])===(r=t)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return!0;a++}return!1}})},1787:(t,e,n)=>{var i=n(2582),o=n(4102),r=n(1540),s=n(9705).Z,a=r.featureEach,l=(r.coordEach,o.polygon,o.featureCollection);function c(t){var e=new i(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),i.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.remove.call(this,t,e)},e.clear=function(){return i.prototype.clear.call(this)},e.search=function(t){var e=i.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return i.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=i.prototype.all.call(this);return l(t)},e.toJSON=function(){return i.prototype.toJSON.call(this)},e.fromJSON=function(t){return i.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=c,t.exports.default=c},1989:(t,e,n)=>{var i=n(1789),o=n(401),r=n(7667),s=n(1327),a=n(1866);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=s,l.prototype.set=a,t.exports=l},8407:(t,e,n)=>{var i=n(7040),o=n(4125),r=n(2117),s=n(7518),a=n(4705);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=s,l.prototype.set=a,t.exports=l},7071:(t,e,n)=>{var i=n(852)(n(5639),"Map");t.exports=i},3369:(t,e,n)=>{var i=n(4785),o=n(1285),r=n(6e3),s=n(9916),a=n(5265);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=s,l.prototype.set=a,t.exports=l},6384:(t,e,n)=>{var i=n(8407),o=n(7465),r=n(3779),s=n(7599),a=n(4758),l=n(4309);function c(t){var e=this.__data__=new i(t);this.size=e.size}c.prototype.clear=o,c.prototype.delete=r,c.prototype.get=s,c.prototype.has=a,c.prototype.set=l,t.exports=c},2705:(t,e,n)=>{var i=n(5639).Symbol;t.exports=i},1149:(t,e,n)=>{var i=n(5639).Uint8Array;t.exports=i},6874:t=>{t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},4636:(t,e,n)=>{var i=n(2545),o=n(5694),r=n(1469),s=n(4144),a=n(5776),l=n(6719),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=r(t),h=!n&&o(t),u=!n&&!h&&s(t),d=!n&&!h&&!u&&l(t),p=n||h||u||d,_=p?i(t.length,String):[],f=_.length;for(var m in t)!e&&!c.call(t,m)||p&&("length"==m||u&&("offset"==m||"parent"==m)||d&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,f))||_.push(m);return _}},9932:t=>{t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,o=Array(i);++n<i;)o[n]=e(t[n],n,t);return o}},6556:(t,e,n)=>{var i=n(9465),o=n(7813);t.exports=function(t,e,n){(void 0!==n&&!o(t[e],n)||void 0===n&&!(e in t))&&i(t,e,n)}},4865:(t,e,n)=>{var i=n(9465),o=n(7813),r=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var s=t[e];r.call(t,e)&&o(s,n)&&(void 0!==n||e in t)||i(t,e,n)}},8470:(t,e,n)=>{var i=n(7813);t.exports=function(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}},9465:(t,e,n)=>{var i=n(8777);t.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},3118:(t,e,n)=>{var i=n(3218),o=Object.create,r=function(){function t(){}return function(e){if(!i(e))return{};if(o)return o(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=r},8483:(t,e,n)=>{var i=n(5063)();t.exports=i},7786:(t,e,n)=>{var i=n(1811),o=n(327);t.exports=function(t,e){for(var n=0,r=(e=i(e,t)).length;null!=t&&n<r;)t=t[o(e[n++])];return n&&n==r?t:void 0}},4239:(t,e,n)=>{var i=n(2705),o=n(9607),r=n(2333),s=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?o(t):r(t)}},8565:t=>{var e=Object.prototype.hasOwnProperty;t.exports=function(t,n){return null!=t&&e.call(t,n)}},9454:(t,e,n)=>{var i=n(4239),o=n(7005);t.exports=function(t){return o(t)&&"[object Arguments]"==i(t)}},8458:(t,e,n)=>{var i=n(3560),o=n(5346),r=n(3218),s=n(346),a=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,h=l.toString,u=c.hasOwnProperty,d=RegExp("^"+h.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!r(t)||o(t))&&(i(t)?d:a).test(s(t))}},8749:(t,e,n)=>{var i=n(4239),o=n(1780),r=n(7005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return r(t)&&o(t.length)&&!!s[i(t)]}},313:(t,e,n)=>{var i=n(3218),o=n(5726),r=n(3498),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return r(t);var e=o(t),n=[];for(var a in t)("constructor"!=a||!e&&s.call(t,a))&&n.push(a);return n}},2980:(t,e,n)=>{var i=n(6384),o=n(6556),r=n(8483),s=n(9783),a=n(3218),l=n(1704),c=n(6390);t.exports=function t(e,n,h,u,d){e!==n&&r(n,(function(r,l){if(d||(d=new i),a(r))s(e,n,l,h,t,u,d);else{var p=u?u(c(e,l),r,l+"",e,n,d):void 0;void 0===p&&(p=r),o(e,l,p)}}),l)}},9783:(t,e,n)=>{var i=n(6556),o=n(4626),r=n(7133),s=n(278),a=n(8517),l=n(5694),c=n(1469),h=n(9246),u=n(4144),d=n(3560),p=n(3218),_=n(8630),f=n(6719),m=n(6390),g=n(9881);t.exports=function(t,e,n,v,y,b,k){var w=m(t,n),x=m(e,n),L=k.get(x);if(L)i(t,n,L);else{var $=b?b(w,x,n+"",t,e,k):void 0,M=void 0===$;if(M){var C=c(x),E=!C&&u(x),P=!C&&!E&&f(x);$=x,C||E||P?c(w)?$=w:h(w)?$=s(w):E?(M=!1,$=o(x,!0)):P?(M=!1,$=r(x,!0)):$=[]:_(x)||l(x)?($=w,l(w)?$=g(w):p(w)&&!d(w)||($=a(x))):M=!1}M&&(k.set(x,$),y($,x,v,b,k),k.delete(x)),i(t,n,$)}}},5976:(t,e,n)=>{var i=n(6557),o=n(5357),r=n(61);t.exports=function(t,e){return r(o(t,e,i),t+"")}},6560:(t,e,n)=>{var i=n(5703),o=n(8777),r=n(6557),s=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:r;t.exports=s},2545:t=>{t.exports=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}},531:(t,e,n)=>{var i=n(2705),o=n(9932),r=n(1469),s=n(3448),a=i?i.prototype:void 0,l=a?a.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(r(e))return o(e,t)+"";if(s(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},1717:t=>{t.exports=function(t){return function(e){return t(e)}}},1811:(t,e,n)=>{var i=n(1469),o=n(5403),r=n(5514),s=n(9833);t.exports=function(t,e){return i(t)?t:o(t,e)?[t]:r(s(t))}},4318:(t,e,n)=>{var i=n(1149);t.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}},4626:(t,e,n)=>{t=n.nmd(t);var i=n(5639),o=e&&!e.nodeType&&e,r=o&&t&&!t.nodeType&&t,s=r&&r.exports===o?i.Buffer:void 0,a=s?s.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,i=a?a(n):new t.constructor(n);return t.copy(i),i}},7133:(t,e,n)=>{var i=n(4318);t.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},278:t=>{t.exports=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}},8363:(t,e,n)=>{var i=n(4865),o=n(9465);t.exports=function(t,e,n,r){var s=!n;n||(n={});for(var a=-1,l=e.length;++a<l;){var c=e[a],h=r?r(n[c],t[c],c,n,t):void 0;void 0===h&&(h=t[c]),s?o(n,c,h):i(n,c,h)}return n}},4429:(t,e,n)=>{var i=n(5639)["__core-js_shared__"];t.exports=i},1463:(t,e,n)=>{var i=n(5976),o=n(6612);t.exports=function(t){return i((function(e,n){var i=-1,r=n.length,s=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(s=t.length>3&&"function"==typeof s?(r--,s):void 0,a&&o(n[0],n[1],a)&&(s=r<3?void 0:s,r=1),e=Object(e);++i<r;){var l=n[i];l&&t(e,l,i,s)}return e}))}},5063:t=>{t.exports=function(t){return function(e,n,i){for(var o=-1,r=Object(e),s=i(e),a=s.length;a--;){var l=s[t?a:++o];if(!1===n(r[l],l,r))break}return e}}},8777:(t,e,n)=>{var i=n(852),o=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},1957:(t,e,n)=>{var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=i},5050:(t,e,n)=>{var i=n(7019);t.exports=function(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}},852:(t,e,n)=>{var i=n(8458),o=n(7801);t.exports=function(t,e){var n=o(t,e);return i(n)?n:void 0}},5924:(t,e,n)=>{var i=n(5569)(Object.getPrototypeOf,Object);t.exports=i},9607:(t,e,n)=>{var i=n(2705),o=Object.prototype,r=o.hasOwnProperty,s=o.toString,a=i?i.toStringTag:void 0;t.exports=function(t){var e=r.call(t,a),n=t[a];try{t[a]=void 0;var i=!0}catch(t){}var o=s.call(t);return i&&(e?t[a]=n:delete t[a]),o}},7801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},222:(t,e,n)=>{var i=n(1811),o=n(5694),r=n(1469),s=n(5776),a=n(1780),l=n(327);t.exports=function(t,e,n){for(var c=-1,h=(e=i(e,t)).length,u=!1;++c<h;){var d=l(e[c]);if(!(u=null!=t&&n(t,d)))break;t=t[d]}return u||++c!=h?u:!!(h=null==t?0:t.length)&&a(h)&&s(d,h)&&(r(t)||o(t))}},1789:(t,e,n)=>{var i=n(4536);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},401:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},7667:(t,e,n)=>{var i=n(4536),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(e,t)?e[t]:void 0}},1327:(t,e,n)=>{var i=n(4536),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:o.call(e,t)}},1866:(t,e,n)=>{var i=n(4536);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},8517:(t,e,n)=>{var i=n(3118),o=n(5924),r=n(5726);t.exports=function(t){return"function"!=typeof t.constructor||r(t)?{}:i(o(t))}},5776:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,n){var i=typeof t;return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&e.test(t))&&t>-1&&t%1==0&&t<n}},6612:(t,e,n)=>{var i=n(7813),o=n(8612),r=n(5776),s=n(3218);t.exports=function(t,e,n){if(!s(n))return!1;var a=typeof e;return!!("number"==a?o(n)&&r(e,n.length):"string"==a&&e in n)&&i(n[e],t)}},5403:(t,e,n)=>{var i=n(1469),o=n(3448),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||s.test(t)||!r.test(t)||null!=e&&t in Object(e)}},7019:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},5346:(t,e,n)=>{var i,o=n(4429),r=(i=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!r&&r in t}},5726:t=>{var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},7040:t=>{t.exports=function(){this.__data__=[],this.size=0}},4125:(t,e,n)=>{var i=n(8470),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=i(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),--this.size,0))}},2117:(t,e,n)=>{var i=n(8470);t.exports=function(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}},7518:(t,e,n)=>{var i=n(8470);t.exports=function(t){return i(this.__data__,t)>-1}},4705:(t,e,n)=>{var i=n(8470);t.exports=function(t,e){var n=this.__data__,o=i(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}},4785:(t,e,n)=>{var i=n(1989),o=n(8407),r=n(7071);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(r||o),string:new i}}},1285:(t,e,n)=>{var i=n(5050);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},6e3:(t,e,n)=>{var i=n(5050);t.exports=function(t){return i(this,t).get(t)}},9916:(t,e,n)=>{var i=n(5050);t.exports=function(t){return i(this,t).has(t)}},5265:(t,e,n)=>{var i=n(5050);t.exports=function(t,e){var n=i(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}},4523:(t,e,n)=>{var i=n(8306);t.exports=function(t){var e=i(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},4536:(t,e,n)=>{var i=n(852)(Object,"create");t.exports=i},3498:t=>{t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},1167:(t,e,n)=>{t=n.nmd(t);var i=n(1957),o=e&&!e.nodeType&&e,r=o&&t&&!t.nodeType&&t,s=r&&r.exports===o&&i.process,a=function(){try{return r&&r.require&&r.require("util").types||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=a},2333:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},5569:t=>{t.exports=function(t,e){return function(n){return t(e(n))}}},5357:(t,e,n)=>{var i=n(6874),o=Math.max;t.exports=function(t,e,n){return e=o(void 0===e?t.length-1:e,0),function(){for(var r=arguments,s=-1,a=o(r.length-e,0),l=Array(a);++s<a;)l[s]=r[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=r[s];return c[e]=n(l),i(t,this,c)}}},5639:(t,e,n)=>{var i=n(1957),o="object"==typeof self&&self&&self.Object===Object&&self,r=i||o||Function("return this")();t.exports=r},6390:t=>{t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},61:(t,e,n)=>{var i=n(6560),o=n(1275)(i);t.exports=o},1275:t=>{var e=Date.now;t.exports=function(t){var n=0,i=0;return function(){var o=e(),r=16-(o-i);if(i=o,r>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}},7465:(t,e,n)=>{var i=n(8407);t.exports=function(){this.__data__=new i,this.size=0}},3779:t=>{t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},7599:t=>{t.exports=function(t){return this.__data__.get(t)}},4758:t=>{t.exports=function(t){return this.__data__.has(t)}},4309:(t,e,n)=>{var i=n(8407),o=n(7071),r=n(3369);t.exports=function(t,e){var n=this.__data__;if(n instanceof i){var s=n.__data__;if(!o||s.length<199)return s.push([t,e]),this.size=++n.size,this;n=this.__data__=new r(s)}return n.set(t,e),this.size=n.size,this}},5514:(t,e,n)=>{var i=n(4523),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,s=i((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(o,(function(t,n,i,o){e.push(i?o.replace(r,"$1"):n||t)})),e}));t.exports=s},327:(t,e,n)=>{var i=n(3448);t.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},346:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},5703:t=>{t.exports=function(t){return function(){return t}}},7813:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},7361:(t,e,n)=>{var i=n(7786);t.exports=function(t,e,n){var o=null==t?void 0:i(t,e);return void 0===o?n:o}},8721:(t,e,n)=>{var i=n(8565),o=n(222);t.exports=function(t,e){return null!=t&&o(t,e,i)}},6557:t=>{t.exports=function(t){return t}},5694:(t,e,n)=>{var i=n(9454),o=n(7005),r=Object.prototype,s=r.hasOwnProperty,a=r.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(t){return o(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=l},1469:t=>{var e=Array.isArray;t.exports=e},8612:(t,e,n)=>{var i=n(3560),o=n(1780);t.exports=function(t){return null!=t&&o(t.length)&&!i(t)}},9246:(t,e,n)=>{var i=n(8612),o=n(7005);t.exports=function(t){return o(t)&&i(t)}},4144:(t,e,n)=>{t=n.nmd(t);var i=n(5639),o=n(5062),r=e&&!e.nodeType&&e,s=r&&t&&!t.nodeType&&t,a=s&&s.exports===r?i.Buffer:void 0,l=(a?a.isBuffer:void 0)||o;t.exports=l},3560:(t,e,n)=>{var i=n(4239),o=n(3218);t.exports=function(t){if(!o(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},1780:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},3218:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},8630:(t,e,n)=>{var i=n(4239),o=n(5924),r=n(7005),s=Function.prototype,a=Object.prototype,l=s.toString,c=a.hasOwnProperty,h=l.call(Object);t.exports=function(t){if(!r(t)||"[object Object]"!=i(t))return!1;var e=o(t);if(null===e)return!0;var n=c.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==h}},3448:(t,e,n)=>{var i=n(4239),o=n(7005);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==i(t)}},6719:(t,e,n)=>{var i=n(8749),o=n(1717),r=n(1167),s=r&&r.isTypedArray,a=s?o(s):i;t.exports=a},1704:(t,e,n)=>{var i=n(4636),o=n(313),r=n(8612);t.exports=function(t){return r(t)?i(t,!0):o(t)}},8306:(t,e,n)=>{var i=n(3369);function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,o=e?e.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var s=t.apply(this,i);return n.cache=r.set(o,s)||r,s};return n.cache=new(o.Cache||i),n}o.Cache=i,t.exports=o},2492:(t,e,n)=>{var i=n(2980),o=n(1463)((function(t,e,n){i(t,e,n)}));t.exports=o},5062:t=>{t.exports=function(){return!1}},9881:(t,e,n)=>{var i=n(8363),o=n(1704);t.exports=function(t){return i(t,o(t))}},9833:(t,e,n)=>{var i=n(531);t.exports=function(t){return null==t?"":i(t)}},2676:function(t){t.exports=function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}var i=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function o(t,e){return t>e?1:t<e?-1:0}function r(t,e,n){for(var o=new i(null,null),r=o,s=o;;){var a=n(t,e.key);if(a<0){if(null===e.left)break;if(n(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(l=e.right,e.right=l.left,l.left=e,null===(e=l).right))break;r.right=e,r=e,e=e.right}}return r.right=e.left,s.left=e.right,e.left=o.right,e.right=o.left,e}function s(t,e,n,o){var s=new i(t,e);if(null===n)return s.left=s.right=null,s;var a=o(t,(n=r(t,n,o)).key);return a<0?(s.left=n.left,s.right=n,n.left=null):a>=0&&(s.right=n.right,s.left=n,n.right=null),s}function a(t,e,n){var i=null,o=null;if(e){var s=n((e=r(t,e,n)).key,t);0===s?(i=e.left,o=e.right):s<0?(o=e.right,e.right=null,i=e):(i=e.left,e.left=null,o=e)}return{left:i,right:o}}function l(t,e,n){return null===e?t:(null===t||((e=r(t.key,e,n)).left=t),e)}function c(t,e,n,i,o){if(t){i(e+(n?"└── ":"├── ")+o(t)+"\n");var r=e+(n?"    ":"│   ");t.left&&c(t.left,r,!1,i,o),t.right&&c(t.right,r,!0,i,o)}}var h=function(){function t(t){void 0===t&&(t=o),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=s(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new i(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var o=this._comparator,s=r(t,this._root,o),a=o(t,s.key);return 0===a?this._root=s:(a<0?(n.left=s.left,n.right=s,s.left=null):a>0&&(n.right=s.right,n.left=s,s.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var i;return null===e?null:0===n(t,(e=r(t,e,n)).key)?(null===e.left?i=e.right:(i=r(t,e.left,n)).right=e.right,this._size--,i):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=r(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=r(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,i=[],o=!1;!o;)null!==n?(i.push(n),n=n.left):0!==i.length?(n=i.pop(),t.call(e,n),n=n.right):o=!0;return this},t.prototype.range=function(t,e,n,i){for(var o=[],r=this._comparator,s=this._root;0!==o.length||s;)if(s)o.push(s),s=s.left;else{if(r((s=o.pop()).key,e)>0)break;if(r(s.key,t)>=0&&n.call(i,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,i=0,o=[];!n;)if(e)o.push(e),e=e.left;else if(o.length>0){if(e=o.pop(),i===t)return e;i++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;e;){var o=i(t.key,e.key);if(0===o)break;o<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;e;){var o=i(t.key,e.key);if(0===o)break;o<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var e=t,n=[],o=!1,r=new i(null,null),s=r;!o;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:o=!0;return s.next=null,r.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var i=t.length,o=this._comparator;if(n&&f(t,e,0,i-1,o),null===this._root)this._root=u(t,e,0,i),this._size=i;else{var r=_(this.toList(),d(t,e),o);i=this._size+i,this._root=p({head:r},0,i)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return c(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var i=this._comparator,o=a(t,this._root,i),r=o.left,c=o.right;i(t,e)<0?c=s(e,n,c,i):r=s(e,n,r,i),this._root=l(r,c,i)},t.prototype.split=function(t){return a(t,this._root,this._comparator)},t}();function u(t,e,n,o){var r=o-n;if(r>0){var s=n+Math.floor(r/2),a=t[s],l=e[s],c=new i(a,l);return c.left=u(t,e,n,s),c.right=u(t,e,s+1,o),c}return null}function d(t,e){for(var n=new i(null,null),o=n,r=0;r<t.length;r++)o=o.next=new i(t[r],e[r]);return o.next=null,n.next}function p(t,e,n){var i=n-e;if(i>0){var o=e+Math.floor(i/2),r=p(t,e,o),s=t.head;return s.left=r,t.head=t.head.next,s.right=p(t,o+1,n),s}return null}function _(t,e,n){for(var o=new i(null,null),r=o,s=t,a=e;null!==s&&null!==a;)n(s.key,a.key)<0?(r.next=s,s=s.next):(r.next=a,a=a.next),r=r.next;return null!==s?r.next=s:null!==a&&(r.next=a),o.next}function f(t,e,n,i,o){if(!(n>=i)){for(var r=t[n+i>>1],s=n-1,a=i+1;;){do{s++}while(o(t[s],r)<0);do{a--}while(o(t[a],r)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}f(t,e,n,a,o),f(t,e,a+1,i,o)}}var m=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},g=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},v=Number.EPSILON;void 0===v&&(v=Math.pow(2,-52));var y=v*v,b=function(t,e){if(-v<t&&t<v&&-v<e&&e<v)return 0;var n=t-e;return n*n<y*t*e?0:t<e?-1:1},k=function(){function e(){t(this,e),this.reset()}return n(e,[{key:"reset",value:function(){this.xRounder=new w,this.yRounder=new w}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),w=function(){function e(){t(this,e),this.tree=new h,this.round(0)}return n(e,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===b(e.key,n.key))return this.tree.remove(t),n.key;var i=this.tree.next(e);return null!==i&&0===b(e.key,i.key)?(this.tree.remove(t),i.key):t}}]),e}(),x=new k,L=function(t,e){return t.x*e.y-t.y*e.x},$=function(t,e){return t.x*e.x+t.y*e.y},M=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y},r=L(i,o);return b(r,0)},C=function(t){return Math.sqrt($(t,t))},E=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y};return L(o,i)/C(o)/C(i)},P=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y};return $(o,i)/C(o)/C(i)},T=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},S=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},O=function(){function e(n,i){t(this,e),void 0===n.events?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=i}return n(e,null,[{key:"compare",value:function(t,n){var i=e.comparePoints(t.point,n.point);return 0!==i?i:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:I.compare(t.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),n(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,i=e.length;n<i;n++){var o=e[n];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var i=e+1;i<t;i++){var o=this.point.events[i];void 0===o.consumedBy&&n.otherSE.point.events===o.otherSE.point.events&&n.segment.consume(o.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,i=function(i){var o=i.otherSE;n.set(i,{sine:E(e.point,t.point,o.point),cosine:P(e.point,t.point,o.point)})};return function(t,e){n.has(t)||i(t),n.has(e)||i(e);var o=n.get(t),r=o.sine,s=o.cosine,a=n.get(e),l=a.sine,c=a.cosine;return r>=0&&l>=0?s<c?1:s>c?-1:0:r<0&&l<0?s<c?-1:s>c?1:0:l<r?-1:l>r?1:0}}}]),e}(),D=0,I=function(){function e(n,i,o,r){t(this,e),this.id=++D,this.leftSE=n,n.segment=this,n.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=n,this.rings=o,this.windings=r}return n(e,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,i=e.leftSE.point.x,o=t.rightSE.point.x,r=e.rightSE.point.x;if(r<n)return 1;if(o<i)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,c=e.rightSE.point.y;if(n<i){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var h=t.comparePoint(e.leftSE.point);if(h<0)return 1;if(h>0)return-1;var u=e.comparePoint(t.rightSE.point);return 0!==u?u:-1}if(n>i){if(s<a&&s<c)return-1;if(s>a&&s>c)return 1;var d=e.comparePoint(t.leftSE.point);if(0!==d)return d;var p=t.comparePoint(e.rightSE.point);return p<0?1:p>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(o<r){var _=e.comparePoint(t.rightSE.point);if(0!==_)return _}if(o>r){var f=t.comparePoint(e.rightSE.point);if(f<0)return 1;if(f>0)return-1}if(o!==r){var m=l-s,g=o-n,v=c-a,y=r-i;if(m>g&&v<y)return 1;if(m<g&&v>y)return-1}return o>r?1:o<r||l<c?-1:l>c?1:t.id<e.id?-1:t.id>e.id?1:0}}]),n(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var o=(t.y-e.y)/i.y,r=e.x+o*i.x;if(t.x===r)return 0;var s=(t.x-e.x)/i.x,a=e.y+s*i.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),i=g(e,n);if(null===i)return null;var o=this.leftSE.point,r=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=m(e,s)&&0===this.comparePoint(s),c=m(n,o)&&0===t.comparePoint(o),h=m(e,a)&&0===this.comparePoint(a),u=m(n,r)&&0===t.comparePoint(r);if(c&&l)return u&&!h?r:!u&&h?a:null;if(c)return h&&o.x===a.x&&o.y===a.y?null:o;if(l)return u&&r.x===s.x&&r.y===s.y?null:s;if(u&&h)return null;if(u)return r;if(h)return a;var d=function(t,e,n,i){if(0===e.x)return S(n,i,t.x);if(0===i.x)return S(t,e,n.x);if(0===e.y)return T(n,i,t.y);if(0===i.y)return T(t,e,n.y);var o=L(e,i);if(0==o)return null;var r={x:n.x-t.x,y:n.y-t.y},s=L(r,e)/o,a=L(r,i)/o;return{x:(t.x+a*e.x+(n.x+s*i.x))/2,y:(t.y+a*e.y+(n.y+s*i.y))/2}}(o,this.vector(),s,t.vector());return null===d?null:m(i,d)?x.round(d.x,d.y):null}},{key:"split",value:function(t){var n=[],i=void 0!==t.events,o=new O(t,!0),r=new O(t,!1),s=this.rightSE;this.replaceRightSE(r),n.push(r),n.push(o);var a=new e(o,s,this.rings.slice(),this.windings.slice());return O.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),O.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(o.checkForConsuming(),r.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var n=this,i=t;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var o=e.compare(n,i);if(0!==o){if(o>0){var r=n;n=i,i=r}if(n.prev===i){var s=n;n=i,i=s}for(var a=0,l=i.rings.length;a<l;a++){var c=i.rings[a],h=i.windings[a],u=n.rings.indexOf(c);-1===u?(n.rings.push(c),n.windings.push(h)):n.windings[u]+=h}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys,o=0,r=this.rings.length;o<r;o++){var s=this.rings[o],a=this.windings[o],l=e.indexOf(s);-1===l?(e.push(s),n.push(a)):n[l]+=a}for(var c=[],h=[],u=0,d=e.length;u<d;u++)if(0!==n[u]){var p=e[u],_=p.poly;if(-1===h.indexOf(_))if(p.isExterior)c.push(_);else{-1===h.indexOf(_)&&h.push(_);var f=c.indexOf(p.poly);-1!==f&&c.splice(f,1)}}for(var m=0,g=c.length;m<g;m++){var v=c[m].multiPoly;-1===i.indexOf(v)&&i.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(G.type){case"union":var n=0===t.length,i=0===e.length;this._isInResult=n!==i;break;case"intersection":var o,r;t.length<e.length?(o=t.length,r=e.length):(o=e.length,r=t.length),this._isInResult=r===G.numMultiPolys&&o<r;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(G.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,n,i){var o,r,s,a=O.comparePoints(t,n);if(a<0)o=t,r=n,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));o=n,r=t,s=-1}return new e(new O(o,!0),new O(r,!1),[i],[s])}}]),e}(),R=function(){function e(n,i,o){if(t(this,e),!Array.isArray(n)||0===n.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=o,this.segments=[],"number"!=typeof n[0][0]||"number"!=typeof n[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=x.round(n[0][0],n[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var s=r,a=1,l=n.length;a<l;a++){if("number"!=typeof n[a][0]||"number"!=typeof n[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var c=x.round(n[a][0],n[a][1]);c.x===s.x&&c.y===s.y||(this.segments.push(I.fromRing(s,c,this)),c.x<this.bbox.ll.x&&(this.bbox.ll.x=c.x),c.y<this.bbox.ll.y&&(this.bbox.ll.y=c.y),c.x>this.bbox.ur.x&&(this.bbox.ur.x=c.x),c.y>this.bbox.ur.y&&(this.bbox.ur.y=c.y),s=c)}r.x===s.x&&r.y===s.y||this.segments.push(I.fromRing(s,r,this))}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}}]),e}(),A=function(){function e(n,i){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new R(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var o=1,r=n.length;o<r;o++){var s=new R(n[o],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=i}return n(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var i=this.interiorRings[e].getSweepEvents(),o=0,r=i.length;o<r;o++)t.push(i[o]);return t}}]),e}(),B=function(){function e(n,i){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof n[0][0][0]&&(n=[n])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var o=0,r=n.length;o<r;o++){var s=new A(n[o],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=i}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var i=this.polys[e].getSweepEvents(),o=0,r=i.length;o<r;o++)t.push(i[o]);return t}}]),e}(),z=function(){function e(n){t(this,e),this.events=n;for(var i=0,o=n.length;i<o;i++)n[i].segment.ringOut=this;this.poly=null}return n(e,null,[{key:"factory",value:function(t){for(var n=[],i=0,o=t.length;i<o;i++){var r=t[i];if(r.isInResult()&&!r.ringOut){for(var s=null,a=r.leftSE,l=r.rightSE,c=[a],h=a.point,u=[];s=a,a=l,c.push(a),a.point!==h;)for(;;){var d=a.getAvailableLinkedEvents();if(0===d.length){var p=c[0].point,_=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(_.x,", ").concat(_.y,"]."))}if(1===d.length){l=d[0].otherSE;break}for(var f=null,m=0,g=u.length;m<g;m++)if(u[m].point===a.point){f=m;break}if(null===f){u.push({index:c.length,point:a.point});var v=a.getLeftmostComparator(s);l=d.sort(v)[0].otherSE;break}var y=u.splice(f)[0],b=c.splice(y.index);b.unshift(b[0].otherSE),n.push(new e(b.reverse()))}n.push(new e(c))}}return n}}]),n(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,i=this.events.length-1;n<i;n++){var o=this.events[n].point,r=this.events[n+1].point;0!==M(o,t,r)&&(e.push(o),t=o)}if(1===e.length)return null;var s=e[0],a=e[1];0===M(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,c=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,u=[],d=c;d!=h;d+=l)u.push([e[d].x,e[d].y]);return u}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var i=this.events[e];O.compare(t,i)>0&&(t=i)}for(var o=t.segment.prevInResult(),r=o?o.prevInResult():null;;){if(!o)return null;if(!r)return o.ringOut;if(r.ringOut!==o.ringOut)return r.ringOut.enclosingRing()!==o.ringOut?o.ringOut:o.ringOut.enclosingRing();o=r.prevInResult(),r=o?o.prevInResult():null}}}]),e}(),N=function(){function e(n){t(this,e),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}return n(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var i=this.interiorRings[e].getGeom();null!==i&&t.push(i)}return t}}]),e}(),j=function(){function e(n){t(this,e),this.rings=n,this.polys=this._composePolys(n)}return n(e,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n];if(!o.poly)if(o.isExteriorRing())e.push(new N(o));else{var r=o.enclosingRing();r.poly||e.push(new N(r)),r.poly.addInterior(o)}}return e}}]),e}(),F=function(){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.compare;t(this,e),this.queue=n,this.tree=new h(i),this.segments=[]}return n(e,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var i=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!i)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var o=i,r=i,s=void 0,a=void 0;void 0===s;)null===(o=this.tree.prev(o))?s=null:void 0===o.key.consumedBy&&(s=o.key);for(;void 0===a;)null===(r=this.tree.next(r))?a=null:void 0===r.key.consumedBy&&(a=r.key);if(t.isLeft){var l=null;if(s){var c=s.getIntersection(e);if(null!==c&&(e.isAnEndpoint(c)||(l=c),!s.isAnEndpoint(c)))for(var h=this._splitSafely(s,c),u=0,d=h.length;u<d;u++)n.push(h[u])}var p=null;if(a){var _=a.getIntersection(e);if(null!==_&&(e.isAnEndpoint(_)||(p=_),!a.isAnEndpoint(_)))for(var f=this._splitSafely(a,_),m=0,g=f.length;m<g;m++)n.push(f[m])}if(null!==l||null!==p){var v;v=null===l?p:null===p||O.comparePoints(l,p)<=0?l:p,this.queue.remove(e.rightSE),n.push(e.rightSE);for(var y=e.split(v),b=0,k=y.length;b<k;b++)n.push(y[b])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var w=s.getIntersection(a);if(null!==w){if(!s.isAnEndpoint(w))for(var x=this._splitSafely(s,w),L=0,$=x.length;L<$;L++)n.push(x[L]);if(!a.isAnEndpoint(w))for(var M=this._splitSafely(a,w),C=0,E=M.length;C<E;C++)n.push(M[C])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.insert(t),i}}]),e}(),W="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,H="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,G=new(function(){function e(){t(this,e)}return n(e,[{key:"run",value:function(t,e,n){G.type=t,x.reset();for(var i=[new B(e,!0)],o=0,r=n.length;o<r;o++)i.push(new B(n[o],!1));if(G.numMultiPolys=i.length,"difference"===G.type)for(var s=i[0],a=1;a<i.length;)null!==g(i[a].bbox,s.bbox)?a++:i.splice(a,1);if("intersection"===G.type)for(var l=0,c=i.length;l<c;l++)for(var u=i[l],d=l+1,p=i.length;d<p;d++)if(null===g(u.bbox,i[d].bbox))return[];for(var _=new h(O.compare),f=0,m=i.length;f<m;f++)for(var v=i[f].getSweepEvents(),y=0,b=v.length;y<b;y++)if(_.insert(v[y]),_.size>W)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var k=new F(_),w=_.size,L=_.pop();L;){var $=L.key;if(_.size===w){var M=$.segment;throw new Error("Unable to pop() ".concat($.isLeft?"left":"right"," SweepEvent ")+"[".concat($.point.x,", ").concat($.point.y,"] from segment #").concat(M.id," ")+"[".concat(M.leftSE.point.x,", ").concat(M.leftSE.point.y,"] -> ")+"[".concat(M.rightSE.point.x,", ").concat(M.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(_.size>W)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(k.segments.length>H)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var C=k.process($),E=0,P=C.length;E<P;E++){var T=C[E];void 0===T.consumedBy&&_.insert(T)}w=_.size,L=_.pop()}x.reset();var S=z.factory(k.segments);return new j(S).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return G.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return G.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return G.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return G.run("difference",t,n)}}}()},2582:function(t){t.exports=function(){function t(t,i,o,r,s){!function t(n,i,o,r,s){for(;r>o;){if(r-o>600){var a=r-o+1,l=i-o+1,c=Math.log(a),h=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*h*(a-h)/a)*(l-a/2<0?-1:1);t(n,i,Math.max(o,Math.floor(i-l*h/a+u)),Math.min(r,Math.floor(i+(a-l)*h/a+u)),s)}var d=n[i],p=o,_=r;for(e(n,o,i),s(n[r],d)>0&&e(n,o,r);p<_;){for(e(n,p,_),p++,_--;s(n[p],d)<0;)p++;for(;s(n[_],d)>0;)_--}0===s(n[o],d)?e(n,o,_):e(n,++_,r),_<=i&&(o=_+1),i<=_&&(r=_-1)}}(t,i,o||0,r||t.length-1,s||n)}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function r(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,o){o||(o=_(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var r=e;r<n;r++){var s=t.children[r];a(o,t.leaf?i(s):s)}return o}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function _(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(e,n,i,o,r){for(var s=[n,i];s.length;)if(!((i=s.pop())-(n=s.pop())<=o)){var a=n+Math.ceil((i-n)/o/2)*o;t(e,a,n,i,r),s.push(n,a,a,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var i=this.toBBox,o=[];e;){for(var r=0;r<e.children.length;r++){var s=e.children[r],a=e.leaf?i(s):s;p(t,a)&&(e.leaf?n.push(s):d(t,a)?this._all(s,n):o.push(s))}e=o.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var o=e.children[i],r=e.leaf?this.toBBox(o):o;if(p(t,r)){if(e.leaf||d(t,r))return!0;n.push(o)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=_([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,i,r,s=this.data,a=this.toBBox(t),l=[],c=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=c.pop(),r=!0),s.leaf){var h=o(t,s.children,e);if(-1!==h)return s.children.splice(h,1),l.push(s),this._condense(l),this}r||s.leaf||!d(s,a)?i?(n++,s=i.children[n],r=!1):s=null:(l.push(s),c.push(n),n=0,i=s,s=s.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,i){var o,s=n-e+1,a=this._maxEntries;if(s<=a)return r(o=_(t.slice(e,n+1)),this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(o=_([])).leaf=!1,o.height=i;var l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));f(t,e,n,c,this.compareMinX);for(var h=e;h<=n;h+=c){var u=Math.min(h+c-1,n);f(t,h,u,l,this.compareMinY);for(var d=h;d<=u;d+=l){var p=Math.min(d+l-1,u);o.children.push(this._build(t,d,p,i-1))}}return r(o,this.toBBox),o},i.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var o=1/0,r=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],c=h(l),u=(d=t,p=l,(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-c);u<r?(r=u,o=c<o?c:o,s=l):u===r&&c<o&&(o=c,s=l)}e=s||e.children[0]}var d,p;return e},i.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),o=[],r=this._chooseSubtree(i,this.data,e,o);for(r.children.push(t),a(r,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},i.prototype._split=function(t,e){var n=t[e],i=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,i);var s=this._chooseSplitIndex(n,o,i),a=_(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,r(n,this.toBBox),r(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},i.prototype._splitRoot=function(t,e){this.data=_([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var i,o,r,a,l,c,u,d=1/0,p=1/0,_=e;_<=n-e;_++){var f=s(t,0,_,this.toBBox),m=s(t,_,n,this.toBBox),g=(o=f,r=m,void 0,void 0,void 0,void 0,a=Math.max(o.minX,r.minX),l=Math.max(o.minY,r.minY),c=Math.min(o.maxX,r.maxX),u=Math.min(o.maxY,r.maxY),Math.max(0,c-a)*Math.max(0,u-l)),v=h(f)+h(m);g<d?(d=g,i=_,p=v<p?v:p):g===d&&v<p&&(p=v,i=_)}return i||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:l,o=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,o)&&t.children.sort(i)},i.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var o=this.toBBox,r=s(t,0,e,o),l=s(t,n-e,n,o),c=u(r)+u(l),h=e;h<n-e;h++){var d=t.children[h];a(r,t.leaf?o(d):d),c+=u(r)}for(var p=n-e-1;p>=e;p--){var _=t.children[p];a(l,t.leaf?o(_):_),c+=u(l)}return c},i.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)a(e[i],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():r(t[e],this.toBBox)},i}()}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n(5975)})(),L.Map.mergeOptions({smoothWheelZoom:!0,smoothSensitivity:1}),L.Map.SmoothWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"wheel",this._onWheelScroll,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){this._isWheeling||this._onWheelStart(t),this._onWheeling(t)},_onWheelStart:function(t){var e=this._map;this._isWheeling=!0,this._wheelMousePosition=e.mouseEventToContainerPoint(t),this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),this._wheelStartLatLng=e.containerPointToLatLng(this._wheelMousePosition),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),e._panAnim&&e._panAnim.stop(),this._goalZoom=e.getZoom(),this._prevCenter=e.getCenter(),this._prevZoom=e.getZoom(),this._zoomAnimationId=requestAnimationFrame(this._updateWheelZoom.bind(this))},_onWheeling:function(t){var e=this._map;this._goalZoom=this._goalZoom+.003*L.DomEvent.getWheelDelta(t)*e.options.smoothSensitivity,(this._goalZoom<e.getMinZoom()||this._goalZoom>e.getMaxZoom())&&(this._goalZoom=e._limitZoom(this._goalZoom)),this._wheelMousePosition=this._map.mouseEventToContainerPoint(t),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(this._onWheelEnd.bind(this),200),L.DomEvent.preventDefault(t),L.DomEvent.stopPropagation(t)},_onWheelEnd:function(t){this._isWheeling=!1,cancelAnimationFrame(this._zoomAnimationId),this._map._moveEnd(!0)},_updateWheelZoom:function(){var t=this._map;if(t.getCenter().equals(this._prevCenter)&&t.getZoom()==this._prevZoom){this._zoom=t.getZoom()+.3*(this._goalZoom-t.getZoom());var e=this._wheelMousePosition.subtract(this._centerPoint);0===e.x&&0===e.y||("center"===t.options.smoothWheelZoom?this._center=this._startLatLng:this._center=t.unproject(t.project(this._wheelStartLatLng,this._zoom).subtract(e),this._zoom),this._moved||(t._moveStart(!0,!1),this._moved=!0),t._move(this._center,this._zoom),this._prevCenter=t.getCenter(),this._prevZoom=t.getZoom(),this._zoomAnimationId=requestAnimationFrame(this._updateWheelZoom.bind(this)))}}}),L.Map.addInitHook("addHandler","smoothWheelZoom",L.Map.SmoothWheelZoom),L.TileLayer.Canvas=L.TileLayer.extend({_delays:{},_delaysForZoom:null,createCanvas:function(t,e,n){let i;const o=t.getContext("2d"),{doubleSize:r}=this.options,{x:s,y:a}=this.getTileSize();t.width=r?2*s:s,t.height=r?2*a:a;const l=new Image;l.onload=()=>{try{o.drawImage(l,0,0),t.complete=!0}catch(t){i=t}finally{n(i,t)}};const c=this._getZoomForUrl();l.src=isNaN(c)?"":this.getTileUrl(e),l.crossOrigin=null},createTile:function(t,e){const{timeout:n}=this.options,{z:i}=t,o=document.createElement("canvas");return n?(i!==this._delaysForZoom&&(this._clearDelaysForZoom(),this._delaysForZoom=i),this._delays[i]||(this._delays[i]=[]),this._delays[i].push(setTimeout((()=>{this.createCanvas(o,t,e)}),n))):this.createCanvas(o,t,e),o},_clearDelaysForZoom:function(){const t=this._delaysForZoom,e=this._delays[t];e&&(e.forEach(((t,n)=>{clearTimeout(t),delete e[n]})),delete this._delays[t])}}),L.tileLayer.canvas=function(t,e){return new L.TileLayer.Canvas(t,e)},L.CanvasOverlay=L.Layer.extend({initialize:function(t,e){this._userDrawFunc=t,L.setOptions(this,e)},params:function(t){return L.setOptions(this,t),this},drawing:function(t){return this._userDrawFunc=t,this},canvas:function(){return this._canvas},redraw:function(){return this._frame||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this._canvas=L.DomUtil.create("canvas","leaflet-canvas-layer cellGrid");var e=this._map.getSize();this._canvas.width=e.x,this._canvas.height=e.y;var n=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(n?"animated":"hide")),t._panes.overlayPane.appendChild(this._canvas),t.on("move",this._reset,this),t.on("resize",this._resize,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._canvas),t.off("move",this._reset,this),t.off("resize",this._resize,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this),this._canvas=null},addTo:function(t){return t.addLayer(this),this},_resize:function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t),this._redraw()},_redraw:function(){var t=this._map.getSize(),e=this.options.bounds||this._map.getBounds(),n=180*t.x/(20037508.34*(e.getEast()-e.getWest())),i=this._map.getZoom();this._userDrawFunc&&this._userDrawFunc(this,{canvas:this._canvas,bounds:e,size:t,zoomScale:n,zoom:i,options:this.options}),this._frame=null},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil?.getTranslateString(n)+" scale("+e+")"}}),L.canvasOverlay=function(t,e){return new L.CanvasOverlay(t,e)},createCommonjsModule((function(t,e){!function(e,n){t.exports=e(leafletSrc),void 0!==n&&n.L&&!n.L.EdgeBuffer&&e(n.L)}((function(t){t.EdgeBuffer={previousMethods:{getTiledPixelBounds:t.GridLayer.prototype._getTiledPixelBounds}},t.GridLayer.include({_getTiledPixelBounds:function(e,n,i){var o=t.EdgeBuffer.previousMethods.getTiledPixelBounds.call(this,e,n,i),r=1;if(void 0!==this.options.edgeBufferTiles&&null!==this.options.edgeBufferTiles&&(r=this.options.edgeBufferTiles),r>0){var s=t.GridLayer.prototype.getTileSize.call(this).multiplyBy(r);o=new t.Bounds(o.min.subtract(s),o.max.add(s))}return o}})}),window)}));class MapState{constructor(t){this.pendingJump=t?.pendingJump??null,this.coords=t?.coords??this.pendingJump instanceof Location?this.pendingJump?.getCentre():null,this.world=(()=>{if(t?.world)return t.world;if(null==this.pendingJump)return gamemap.getWorldByID(MAPCONFIG.defaultWorldID||0);{let t=this.pendingJump;if(t instanceof Location)return gamemap.getWorldByID(t.worldID);if(t instanceof World)return t}})(),this.zoom=t?.zoom??(this.pendingJump instanceof Location?gamemap.getWorldByID(this.pendingJump?.worldID).maxZoomLevel:null),this.gridData=t?.gridData??null,this.layerIndex=t?.layerIndex??0,this.pendingSearch=null}getZoom(){return this.zoom}isGridEnabled(){return null!=this.gridData&&this.world.hasGrid()}isGridShown(){return null!=this.gridData?.gridShown}}let self$1,map,tileLayer,RC,gridLayer;class Gamemap{constructor(t,e,n){if(null==t){let e=document.createElement("div");e.id="gamemap",(null!=document.body.children[0]?document.body.children[0]:document.body).prepend(e),t=e}if(!e||!n)throw new Error("The gamemap was provided invalid/missing params.");if(this.mapConfig=e,this.mapCallbacks=n,this.mapRoot=t,self$1=this,this.mapConfig.hasCustomFavIcon&&changeFavIcon(e.iconPath+"favicon.png"),this.mapConfig.bgColor&&(t.style.backgroundColor=e.bgColor),this.mapConfig.hasCustomCSS){let t=e.assetsPath+"css/"+e.database+"-styles.css";print("Loading custom map css: "+t),injectCSS(t)}this.mapWorlds=new Map,this.gridEnabled=!1,this.mapLock=null,this.checkEditingPermissions(),this.getWorlds(e)}initialise(){var t={crs:leafletSrc.CRS.Simple,zoomSnap:!1,zoomDelta:.5,zoomControl:!1,boxZoom:!1,doubleClickZoom:!1,scrollWheelZoom:!1,smoothWheelZoom:!0,smoothSensitivity:.9,attributionControl:!1,renderer:leafletSrc.svg({padding:2})};map=leafletSrc.map(this.mapRoot.id,t),self$1.mapRoot.style.transition="background-color ease 100ms";let e=new MapState;this.hasURLParams()&&(e=this.getMapStateFromURL()),this.setMapState(e),this.bindMapEvents()}getMapState(){return this.mapState}async setMapState(t,e){if(print("Setting map state!"),print(t),e=e??!1,null!=tileLayer&&(tileLayer.remove(),e||this.clearLocations()),getURLParams().has("centeron")){print("pending centeron");try{let e=await this.getLocation(getURLParams().get("centeron"),getURLParams().has("world")?this.getWorld(getURLParams().get("world")):null);t.world=this.getWorldFromID(e.worldID),t.zoom=t.world.maxZoomLevel,t.pendingJump=e,t.coords=e.getCentre()}catch(e){t.pendingJump=null,print(e)}t.legacy=null}if(t.world=t.world?t.world:this.getWorldByID(MAPCONFIG.defaultWorldID),this.currentWorldID=t.world.id,RC=new RasterCoords(map,t.world.getWorldDimensions()),map.setMaxBounds(null),t.legacy){if(t.zoom=t.zoom&&t.zoom>t.world.maxZoomLevel?t.zoom-t.world.zoomOffset:t.zoom,MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED&&t.coords){let e=(t.coords.x-t.world.minX)/t.world.maxRangeX,n=Math.abs((t.coords.y-t.world.maxY)/t.world.maxRangeY);e=(e*nextPowerOfTwo(t.world.dbNumTilesX)/t.world.dbNumTilesX).toFixed(3),n=(n*nextPowerOfTwo(t.world.dbNumTilesY)/t.world.dbNumTilesY).toFixed(3),t.coords=new Point(e,n,MAPCONFIG.coordType)}t.legacy=!1}t.zoom=t.zoom?t.zoom:t.coords&&!t.zoom?t.world.maxZoomLevel:map.getBoundsZoom(RC.getMaxBounds()),t.coords=t.coords?t.coords:this.toCoords(RC.getMaxBounds().getCenter()),t.coords||t.zoom?map.setView(this.toLatLngs(t.coords),t.zoom,{animate:!1}):map.fitBounds(RC.getMaxBounds(),{animate:!1}),map.setMaxBounds(RC.getMaxBounds(130)),t.pendingJump instanceof World&&t.pendingJump.editing&&(this.edit(t.pendingJump),t.pendingJump=null),this.updateMapState(t);let n={noWrap:!0,bounds:RC.getMaxBounds(),errorTileUrl:IMAGES_DIR+"outofrange.png",minZoom:t.world.minZoomLevel,maxZoom:t.world.maxZoomLevel,edgeBufferTiles:2};tileLayer=isFirefox()?leafletSrc.tileLayer(this.getMapTileImageURL(t.world,t.layerIndex),n):tileLayer=leafletSrc.tileLayer.canvas(this.getMapTileImageURL(t.world,t.layerIndex),n),tileLayer.addTo(map),t.world.layers[t.layerIndex].bg_color&&(this.mapRoot.style.backgroundColor=t.world.layers[t.layerIndex].bg_color),e||(null==t.world.locations?this.getLocations(t.world.id):this.drawLocations(t.world.locations)),this.toggleGrid(t?.gridData)}getMapStateFromURL(){let t=new MapState;if(t.legacy=getURLParams().has("legacy"),getURLParams().has("world")&&(print(getURLParams().get("world")),t.world=this.getWorld(getURLParams().get("world"))),getURLParams().has("zoom")&&(t.zoom=Number(getURLParams().get("zoom"))),getURLParams().has("x")&&getURLParams().has("y")||getURLParams().has("locx")&&getURLParams().has("locy")){let e=Number(getURLParams().get("x")??getURLParams().get("locx")),n=Number(getURLParams().get("y")??getURLParams().get("locy"));t.coords=new Point(e,n,MAPCONFIG.coordType)}if(getURLParams().has("grid")&&(t.gridData=JSON.parse(decodeURIComponent(getURLParams().get("grid")))),getURLParams().has("cellresource")&&(t.cellResource=getURLParams().get("cellresource")),getURLParams().has("layer")){let e=getURLParams().get("layer");t.layerIndex=isNaN(parseInt(e))?this.getLayerIndexFromName(e,t.world.layers):parseInt(e)}return getURLParams().has("search")&&(t.pendingSearch=getURLParams().get("search")),t}updateMapState(t){t=t??this.getMapState();let e,n=Number(this.toCoords(map.getCenter()).x,MAPCONFIG.coordType).toFixed(3),i=Number(this.toCoords(map.getCenter()).y,MAPCONFIG.coordType).toFixed(3);t.coords=MAPCONFIG.coordType==COORD_TYPES.NORMALISED||MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?[n,i]:[Math.floor(n),Math.floor(i)],t.zoom=parseFloat(map.getZoom().toFixed(3)),t.world=this.getWorldFromID(this.currentWorldID),this.mapState=t,e=location.href.includes("localhost")||window.location.href.includes("/"+MAPCONFIG.database+"/")?"?":MAPCONFIG.database+"/?",this.hasMultipleWorlds()&&(e+=`world=${t.world.name}&`),t.world.hasMultipleLayers()&&(e+=`layer=${t.world.layers[t.layerIndex]?.name}&`),e+=`x=${t.coords[0]}`,e+=`&y=${t.coords[1]}`,e+=`&zoom=${t.zoom}`,t?.gridData&&(e+=`&grid=${encodeURIComponent(JSON.stringify(t.gridData))}`),t?.pendingSearch&&(e+=`&search=${t.pendingSearch}`),self$1.mapCallbacks?.onMapStateChanged(t),window.history.replaceState(t,document.title,e),window.dispatchEvent(new PopStateEvent("popstate"))}setMapLock(t){t&&t==MAPLOCK.FULL?(map.dragging.disable(),map.smoothWheelZoom.disable(),map.keyboard.disable(),this.mapRoot.classList.add("locked")):(map.dragging.enable(),map.smoothWheelZoom.enable(),map.keyboard.enable(),this.mapRoot.classList.remove("locked")),this.mapLock=t,this.mapCallbacks?.onMapLockChanged(this.mapLock)}getMapLock(){return this.mapLock}async edit(t){isNaN(t)||(t=t>0?this.getWorldByID(t):await this.getLocation(t));let e=t instanceof Location;t instanceof World&&t.id!=this.getCurrentWorldID()||e&&t.worldID!=this.getCurrentWorldID()?(t.editing=!0,self$1.mapState.pendingJump=t,self$1.setMapState(new MapState({pendingJump:t}))):(this.mapCallbacks?.edit(t),map.closePopup())}reset(t,e){!this.hasMultipleWorlds()||t?e?map.fitBounds(RC.getMaxBounds(e),{animate:!0}):map.fitBounds(RC.getMaxBounds(),{animate:!0}):this.goto(this.mapConfig.defaultWorldID)}setZoomTo(t){map.setZoom(t,{animate:!0})}hasURLParams(){return Array.from(getURLParams().values()).length>=1}isEmbedded(){return window.self!==window.top}getWorlds(t){if(!t)return this.mapWorlds;{let e={action:"get_worlds"};e.db=t.database,self$1.mapCallbacks?.setLoading("Loading worlds"),0==this.mapWorlds.size&&getJSON(GAME_DATA_SCRIPT+queryify(e)).then((e=>{let n=e.worlds;n.forEach((e=>{e.id>=t.minWorldID&&e.id<=t.maxWorldID&&e.name&&self$1.mapWorlds.set(e.id,new World(e))})),print(`Loaded ${n.length} worlds!`),print(n),self$1.initialise()})).catch((t=>{throw new Error(`Could not retrieve world data: ${t}`)}))}}isWorldValid(t){return t&&t>=0&&this.mapWorlds.has(t)}getCurrentWorld(){return this.getWorldFromID(this.currentWorldID)??this.getMapState()?.world??getWorldFromID(this.mapConfig.defaultWorldID)}getCurrentWorldID(){return this.currentWorldID??getCurrentWorld()?.id}getWorldByID(t){return this.getWorldFromID(t)}getWorldFromID(t){return this.mapWorlds.get(Number(t))}getWorldNameByID(t){return this.getWorldFromID(t)}getWorldNameFromID(t){return this.getWorldFromID(t)?.name}getWorldDisplayNameByID(t){return this.getWorldDisplayNameFromID(t)}getWorldDisplayNameFromID(t){return this.getWorldFromID(t)?.displayName}getWorldByName(t){return this.getWorldFromName(t)}getWorldFromName(t){return[...this.mapWorlds.values()].find((e=>e.name.toLowerCase()==t.toLowerCase()))}getWorldByDisplayName(t){return this.getWorldFromDisplayName(t)}getWorldFromDisplayName(t){return[...this.mapWorlds.values()].find((e=>e.displayName==t))}getWorld(t){if(t&&"undefined"!=t){let e=isNaN(parseInt(t))?this.getWorldFromName(t)??this.getWorldFromDisplayName(t):this.isWorldValid(t)?this.getWorldFromID(t):null;return e||(M.toast({html:"That world doesn't exist!"}),this.getWorldFromID(MAPCONFIG.defaultWorldID))}return this.getCurrentWorld()}hasMultipleWorlds(){return this.mapWorlds.size>1}updateWorld(t){this.getWorlds().set(t?.id,t),this.setMapState(this.getMapState(),!0)}deleteWorld(t){this.getWorlds()?.delete(t.id),this.goto(t.parentID??MAPCONFIG.defaultWorldID),getWorldLists()}getZoom(){return this.getCurrentZoom()}getCurrentZoom(){return map?map.getZoom():0}getMaxZoom(){return this.getCurrentWorld()?this.getCurrentWorld().maxZoomLevel:MAPCONFIG.maxZoomLevel}getMinZoom(){return this.getCurrentWorld()?this.getCurrentWorld().minZoomLevel:MAPCONFIG.minZoomLevel}async getLocation(t,e){if(null==t)return Promise.reject("Location identifier was null");this.mapCallbacks?.setLoading(!0);let n,i=!isNaN(t)||t instanceof Location,o=t instanceof String||"string"==typeof t,r=Math.abs(t?.id??t),s=o?t?.toLowerCase():null;if(print(`Getting info for location: ${t}`),e?n=e.getLocation(t):this.mapWorlds?.forEach((e=>{n=e.hasLocation(t)?e.getLocation(t):n})),n)return print("found cached location"),this.mapCallbacks?.setLoading(!1),Promise.resolve(n);if(!n){let n={action:"get_centeron",db:MAPCONFIG.database,centeron:i?r:s,world:e?.id??null},o=await getJSON(GAME_DATA_SCRIPT+queryify(n));if(o&&o.locations.length>0){print("Got location info!");let t=self$1.getWorldFromID(o?.locations[0]?.worldId),e=new Location(o.locations[0],t);return this.mapCallbacks?.setLoading(!1),Promise.resolve(e)}return M.toast({html:"That location doesn't exist!"}),this.mapCallbacks?.setLoading(!1),Promise.reject(`Location ${t} was invalid.`)}}addLocation(t){print("adding location..");let e=t==LOCTYPES.MARKER,n=e;this.setMapLock(e?MAPLOCK.PARTIAL_NEW_MARKER:t==LOCTYPES.AREA?MAPLOCK.PARTIAL_NEW_POLYGON:MAPLOCK.PARTIAL_NEW_LINE);let i=e?"Marker":t==LOCTYPES.AREA?"Polygon":"Line",o=e?"new_marker":"";if(map.pm.enableDraw(i,{markerStyle:{icon:this.getIcon(Math.min(...Array.from(MAPCONFIG.icons.keys()))),alt:o},continueDrawing:!1,tooltips:n}),e){let t=document.querySelectorAll(`[alt="${o}"]`)[0];if(t){t.removeAttribute("alt"),t.classList.add("editing"),print(t);let e=document.getElementById(t.getAttribute("aria-describedby"));e.classList.add("location-label","new-marker-label","editing"),e.innerText="New Marker"}}map.on("pm:create",(({shape:t,layer:e})=>{print(t),print(e);let n="Marker"==t;e.remove(),print(n);let i=new Location({locType:n?LOCTYPES.MARKER:"Polygon"==t?LOCTYPES.AREA:LOCTYPES.PATH,coords:self$1.toCoords(e.getCoordinates())},this.getCurrentWorld());this.getCurrentWorld()?.locations?.set(i.id,i),this.edit(i)}))}getLocations(t){if(self$1.clearLocations(),print("Getting locations..."),null==t||isNaN(t)||this.isWorldValid(t)&&(t=this.getWorldFromID(t)),!(null==t||null==t.id||t.id<0)){var e={action:"get_locs"};e.world=t.id,e.db=MAPCONFIG.database,getJSON(GAME_DATA_SCRIPT+queryify(e)).then((e=>{let n=e.locations,i=new Map;print(`Got ${e.locationCount} locations!`),print(n),n.forEach((e=>{e.id&&1==e.visible&&!e.description.includes("teleport dest")&&i.set(e.id,new Location(e,t))})),self$1.mapWorlds.get(t.id).locations=i,self$1.getCurrentWorldID()==t.id&&self$1.drawLocations(i)})).catch((t=>{throw new Error(`There was an error getting locations: ${t}`)}))}}deleteLocation(t){this.findMarkers(t).forEach((function(t){t.remove()}));let e=this.getCurrentWorld().locations;e?.delete(t.id)}updateLocation(t){let e=this.findMarkers(t);e.forEach((function(t){t.remove()})),map.closePopup(),this.getCurrentWorld().locations?.set(t?.id,t),e=this.getMarkers(t),e.forEach((function(t){t.addTo(map)})),t?.editing&&(t.revertID||(t.locType==LOCTYPES.MARKER?setTimeout((()=>{e[0].edit()}),0):e[0].edit()),e.forEach((function(t){t.setEditingEffect(!0)})))}clearLocations(){map.eachLayer((t=>{t._tiles||"cellGrid"==t.options.className||(t.off("resize move zoom"),t.remove())}))}drawLocations(t){this.clearLocations(),print("Loading initial locations..."),t.size>0&&(print("Adding location markers to map..."),t.forEach((t=>{if(t?.isVisible()){this.getMarkers(t).forEach((t=>{t.addTo(map)})),t.setWasVisible(!0);let e=this.mapState?.pendingJump;e instanceof Location&&e.id==t.id&&(this.mapState.pendingJump=null,this.gotoLocation(e))}}))),this.mapCallbacks?.onMapLoaded(!0),this.mapRoot.style.animation="none"}getMarkers(t){if(null==t||null==t.coords)return[];let e=null,n=t.coords,i=new leafletSrc.marker(this.toLatLngs(n[0]),{riseOnHover:!0});if(leafletSrc.Marker.prototype.options.icon=leafletSrc.icon({iconUrl:IMAGES_DIR+"transparent.png"}),t.isPolygon()){n=[];for(let e=0;e<t.coords.length;e++)n.push(this.toLatLngs(t.coords[e]));let o={noClip:!0,smoothFactor:2,fillColor:t.fillColour,color:t.strokeColour,fillOpacity:null,weight:t.strokeWidth};t.locType==LOCTYPES.AREA&&(i=new leafletSrc.polygon(n,o),t.hasIcon()&&(i.setIsIconPolygon(!0),e=t.getMarker())),t.locType==LOCTYPES.PATH&&(i=new leafletSrc.polyline(n,o))}else t.hasIcon()&&(i=t.getMarker());let o=[i,e].filter((t=>null!==t));return o.forEach((e=>{e.setLocation(t),t.hasLabel()&&!e.isIconPolygon()&&e.bindTooltip(t.name,t.getLabel()),e.once("add",(function(){e.on("mouseout",(function(){self$1.clearTooltips(),e.location.isPolygon()&&e._path&&this.setStyle({fillColor:t.fillColour,color:t.strokeColour,weight:t.strokeWidth})})),e.on("mouseover",(function(){let n=t.isPolygon()&&e._path;leafletSrc.tooltip(self$1.toLatLngs(t.getCentre()),{content:t.getTooltipContent(),sticky:!0,className:"location-tooltip"}).addTo(map),n&&this.setStyle({fillColor:t.fillColourHover,color:t.strokeColourHover,weight:t.strokeWidthHover})})),e.on("click",(t=>{let e=t.originalEvent.shiftKey,n=t.originalEvent.ctrlKey;self$1.mapLock&&!MAPLOCK.isPartialNoNew(self$1.mapLock)||self$1.onMarkerClicked(this,e,n)})),e.on("dblclick",(()=>{self$1.mapLock&&!MAPLOCK.isPartialNoNew(self$1.mapLock)||this.getLocation().isClickable()||self$1.onMarkerClicked(this,!0,!1)}))}))})),o}findMarkers(t){let e=[];return map.eachLayer((n=>{n?.location&&n.location?.id==t?.id&&e.push(n)})),e}goto(t){if(null==t)return;this.mapCallbacks?.setLoading(!0);let e=(t=t?isString(t)?parseInt(t):t:this.getCurrentWorldID())instanceof World||t.numTilesX||t>0,n=t instanceof Location||t.coords||t<0;e?this.gotoWorld(this.getWorld(t)):n&&this.gotoLocation(t)}gotoWorld(t,e){if(t=t instanceof World?t.id:t,print(t),self$1.isWorldValid(t))if(t==self$1.getCurrentWorldID())e?map.setView(self$1.toLatLngs(e),self$1.getCurrentWorld().maxZoomLevel):self$1.reset(!0),self$1.mapCallbacks?.setLoading(!1);else{self$1.clearLocations();let n=self$1.getWorldFromID(t);print(`Going to world... ${n.displayName} (${n.id});`),self$1.setMapState(new MapState({coords:e,world:n,pendingJump:n?.editing?n:null,layerIndex:0}))}else this.mapCallbacks?.setLoading(!1),print("Gamemap attempted to navigate to invalid world ID: "+t)}gotoLocation(t){print(`going to location: ${t}`),this.mapCallbacks?.setLoading(!0),this.mapState.pendingJump=null,this.getLocation(t).then((e=>{e.worldID==self$1.getCurrentWorldID()?(setTimeout((()=>{map.setZoom(self$1.getCurrentZoom()-1e-4,{animate:!1}),map.setView(self$1.toLatLngs(e.getCentre()),self$1.getCurrentWorld().maxZoomLevel,{animate:!0}),t?.editing?this.edit(e):e.openPopup()}),1),this.mapCallbacks?.setLoading(!1)):(self$1.mapState.pendingJump=e,self$1.setMapState(new MapState({pendingJump:e})))})).catch((t=>{print(t),self$1.mapCallbacks?.setLoading(!1)}))}getMapTileImageURL(t,e,n){isNaN(e)&&(e=this.getLayerIndexFromName(e));let i=n?"/zoom0/":"/zoom{z}/",o=n?"-0-0.jpg":"-{x}-{y}.jpg";return`${this.mapConfig.tileURL+t.name}/leaflet/${t.layers[e].name+i+t.name+o}`}setTileLayerTo(t){if(null!=t){let e;if(e=isNaN(t)?this.getLayerIndexFromName(t):t,e>-1&&e<this.getCurrentWorld().layers.length){let t=this.getMapState();print(t),t.layerIndex!=e&&(t.layerIndex=e,this.setMapState(t,!0))}else print.warn("TileLayer index was out of bounds.")}else print.error("Provided TileLayer was invalid.")}getCurrentTileLayerIndex(){return parseInt(this.getMapState().layerIndex)}getNextTileLayerIndex(){return this.getCurrentTileLayerIndex()+1==this.getMapState().world?.layers?.length?0:this.getCurrentTileLayerIndex()+1}getNextTileLayerName(){return this.getMapState().world?.layers[this.getNextTileLayerIndex()]?.name}getCurrentTileLayerName(){return this.getMapState().world?.layers[this.getCurrentTileLayerIndex()]?.name}getLayerIndexFromName(t,e){let n=null!=e?e:this.getCurrentWorld().layers;for(let[e]of Object.entries(n))if(n[e].name==t)return parseInt(e);return 0}toggleGrid(t){let e=t?.cellResourceData??this.getMapState()?.cellResourceData;t=null==t||0===Object.keys(t).length?null:{gridShown:t.gridShown??t.gridshown,cellResource:t.cellResource??t.cellresource,cellResourceData:t.cellResourceData};let n=t?.cellResource&&"none"!=t?.cellResource?t.cellResource:null,i=t?.gridShown,o=this.getMapState();if(t){let{cellResourceData:e,...n}=t;o.gridData=n}else o.gridData=null;o.cellResourceData=t?e:null,this.updateMapState(o),!n||e&&n==e?.resource||(this.mapCallbacks?.setLoading(!0),this.getCellResourceData(n).then((e=>{this.mapCallbacks?.setLoading(!1),o.isGridEnabled()&&(t.cellResourceData={resource:n,data:e},self$1.toggleGrid(t))})).catch((()=>this.mapCallbacks?.setLoading(!1)))),t?(gridLayer?.remove(),gridLayer=leafletSrc.canvasOverlay().params({bounds:RC.getMaxBounds(),className:"cellGrid",zoomAnimation:!0}).drawing((function(t,n){let o=n.canvas.getContext("2d");o.clearRect(0,0,n.size.x,n.size.y);let r=RC.getMaxBounds(),[s,a,l,c]=[map.layerPointToContainerPoint(map.latLngToLayerPoint(r.getNorthWest())).x,map.layerPointToContainerPoint(map.latLngToLayerPoint(r.getNorthEast())).x,map.layerPointToContainerPoint(map.latLngToLayerPoint(r.getNorthEast())).y,map.layerPointToContainerPoint(map.latLngToLayerPoint(r.getSouthEast())).y],[h,u]=[a-s,c-l],d=self$1.getCurrentWorld(),p=self$1.getCurrentZoom(),_=null!=self$1.mapConfig.cellSize?self$1.mapConfig.cellSize:Math.round(self$1.mapConfig.tileSize*Math.pow(2,Math.round(d.maxZoomLevel))/((d.maxX-d.minX)/d.cellSize)),f=_/Math.pow(2,Math.round(d.maxZoomLevel)-p)/u,m=d.getWorldDimensions().width/_,g=d.getWorldDimensions().height/_;for(let y=0;y<=m;y++)for(let b=0;b<=g;b++){let k=y*f,w=b*f,x=(v(k).x>=0||v(k).x<0&&v(k+f).x>=0)&&(v(w).y>=0||v(w).y<0&&v(w+f).y>=0)&&v(k).x<=window.innerWidth&&v(w).y<=window.innerHeight;if(i&&y==b&&(o.beginPath(),o.moveTo(v(0).x,v(w).y),o.lineTo(v(1).x,v(w).y),o.moveTo(v(k).x,v(0).y),o.lineTo(v(k).x,v(1).y),o.strokeStyle=o.strokeStyle=self$1.mapConfig.gridLineColour,o.lineWidth=self$1.mapConfig.gridLineWidth,o.stroke()),x){let $=e?.data;if($){let M=b<(y<$.length?$[y]:[]).length?$[y][b]:0;0!=M&&(M>0&&M<=2?L(self$1.mapConfig.cellResourceColours[0]):M>2&&M<=5?L(self$1.mapConfig.cellResourceColours[1]):M>5&&M<=10?L(self$1.mapConfig.cellResourceColours[2]):M>10&&M<=20?L(self$1.mapConfig.cellResourceColours[3]):M>20&&M<=50?L(self$1.mapConfig.cellResourceColours[4]):M>50&&L(self$1.mapConfig.cellResourceColours[5]))}if(i&&p>self$1.mapConfig.gridShowLabelZoom){let C=y+d.gridStart[0],E=-b+d.gridStart[1];E%5!=0&&C%5!=0||y==m||b==g||(L(self$1.mapConfig.gridLabelCellBgColour),E%5==0&&C%5==0&&(o.fillStyle=self$1.mapConfig.gridLabelColour,o.font="bold 13px Arial",o.fillText([C,E].join(", "),v(k).x,v(w+f).y)))}}function L(t){o.fillStyle=t,o.beginPath(),o.moveTo(v(k).x,v(w).y),o.lineTo(v(k+f).x,v(w).y),o.lineTo(v(k+f).x,v(w+f).y),o.lineTo(v(k).x,v(w+f).y),o.closePath(),o.fill()}}function v(t,e){return((e=null!=e?e:t)>4||e<-4)&&(e/=u),(t>4||t<-4)&&(t/=h),new Point(s+t*h,l+e*u)}})),gridLayer.addTo(map)):!t&&gridLayer&&(gridLayer.remove(),gridLayer=null)}async getCellResourceData(t){if(null!=t||""!=t){var e={action:"get_cellresource"};e.db=MAPCONFIG.database,e.worldid=this.getCurrentWorldID(),e.editorid=t;let n=(await getJSON(GAME_DATA_SCRIPT+queryify(e))).resources[0].data;for(let t in n)n[t]=n[t].reverse();return n}}getCoords(...t){return this.toCoords(...t)}toCoords(t,e){if(t=structuredClone(t),e=null!=e?e:t instanceof Point?t.coordType:this.mapConfig.coordType,null!=t.lat){let n=RC.project(t);if(e==COORD_TYPES.XY)return n;{let t=this.getCurrentWorld().getWorldDimensions();if(e==COORD_TYPES.NORMALISED||e==COORD_TYPES.PSEUDO_NORMALISED){let e=(n.x/t.width).toFixed(3),i=(n.y/t.height).toFixed(3);return new Point(e,i,COORD_TYPES.NORMALISED)}if(e==COORD_TYPES.WORLDSPACE){let e=n.x/t.width,i=1-n.y/t.height,o=Math.trunc(t.minX+(t.maxX-t.minX)*e),r=Math.trunc(t.minY+(t.maxY-t.minY)*i);return new Point(o,r,COORD_TYPES.WORLDSPACE)}}}else if(Array.isArray(t)){let e=[];return t.forEach((t=>{e.push(this.toCoords(t,this.mapConfig.coordType))})),e}}getLatLngs(...t){return this.toLatLngs(...t)}toLatLngs(t){if(((t=structuredClone(t))instanceof Point||t?.x)&&!Array.isArray(t))switch(t.coordType){default:case COORD_TYPES.XY:return RC.unproject([t.x,t.y]);case COORD_TYPES.NORMALISED:let e=Number(t.x)*this.getCurrentWorld().width,n=Number(t.y)*this.getCurrentWorld().height;return RC.unproject([e,n]);case COORD_TYPES.PSEUDO_NORMALISED:return t.coordType=COORD_TYPES.NORMALISED,this.toLatLngs(t);case COORD_TYPES.WORLDSPACE:let i=t.x,o=t.y;return i=(i-this.getCurrentWorld().minX)/this.getCurrentWorld().maxRangeX,o=Math.abs((o-this.getCurrentWorld().maxY)/this.getCurrentWorld().maxRangeY),this.toLatLngs(new Point(i,o,COORD_TYPES.NORMALISED))}else if(Array.isArray(t))if(t[0]?.x){if(1==t.length)return this.toLatLngs(t[0])}else if(t.length>1)return this.toLatLngs(new Point(0==t[0]?.001:t[0],0==t[1]?.001:t[1],this.mapConfig.coordType))}getMapObject(){return map}getMap(){return map}getMapConfig(){return this.mapConfig}getElement(){return this.mapRoot}canEdit(){return MAPCONFIG.editingEnabled}checkEditingPermissions(){let t={},e=this;t.action="get_perm",t.db=MAPCONFIG.database,this.mapCallbacks?.setLoading("Getting permissions"),getJSON(GAME_DATA_SCRIPT+queryify(t)).then((t=>{let n=t?.canEdit;MAPCONFIG.editingEnabled=!!n&&(!e.isEmbedded()&&!isMobile()),MAPCONFIG.isAdmin=t.isAdmin,e.mapCallbacks?.onPermissionsLoaded(MAPCONFIG.editingEnabled)}))}clearTooltips(){map.eachLayer((t=>{"location-tooltip"==t.options.className&&t.remove()}))}getIconByName(t){if(t=t?.trim()?.toLowerCase(),!MAPCONFIG.icons||""==t)return null;print(t);for(const[e,n]of MAPCONFIG.icons)if(print(e,n),t==n?.toLowerCase())return print("found it"),e}getIcon(t){let e=[MAPCONFIG.iconSize/2,MAPCONFIG.iconSize/2],n=MAPCONFIG.iconPath+t+".png";return leafletSrc.icon({iconUrl:n,iconAnchor:e,iconSize:[MAPCONFIG.iconSize,MAPCONFIG.iconSize]})}getZoomFromBounds(t){return map.getBoundsZoom(t,!1)}getMaxBoundsZoom(){return map.getBoundsZoom(this.getMaxMapBounds())}getMaxMapBounds(){return RC.getMaxBounds()}getViewBounds(){let t=this.toCoords(map.getBounds().getNorthWest()),e=this.toCoords(map.getBounds().getSouthEast()),n={};return n.minX=t.x,n.maxX=e.x,n.minY=this.mapConfig.coordType==COORD_TYPES.WORLDSPACE?e.y:t.y,n.maxY=this.mapConfig.coordType==COORD_TYPES.WORLDSPACE?t.y:e.y,n}bindMapEvents(){map.on("resize moveend zoomend",(function(){self$1.getCurrentWorld()?.locations?.forEach((t=>{let e=t?.isVisible()??!1;if(e!=(t?.getWasVisible()??!1)){if(e){self$1.getMarkers(t).forEach((function(t){t.addTo(map),!t.location.hasLabel()||t.location.hasIcon()&&t._path||t.bindTooltip(t.location.name,t.location.getLabel())}))}else self$1.findMarkers(t).forEach((t=>t.remove()));t.setWasVisible(e)}})),self$1.clearTooltips(),self$1.getMapState()&&(self$1.getMapState().isGridEnabled()&&self$1.toggleGrid(self$1.getMapState()?.gridData),self$1.updateMapState())})),map.on("contextmenu",(function(){null!=self$1.getMapState().world.parentID&&-1!=self$1.getMapState().world.parentID&&!self$1.mapLock&&self$1.hasMultipleWorlds()&&self$1.goto(self$1.getMapState().world.parentID)})),map.on("zoom",(function(){self$1.mapLock||"full"==self$1.mapLock||map.dragging.enable()})),map.on("mousemove mousedown",(function(t){let e=t.originalEvent?.target??t?.originalEvent?.explicitOriginalTarget??t?.sourceTarget?._container;self$1.mapLock==MAPLOCK.FULL||e!=self$1.mapRoot&&!e?.classList?.contains("leaflet-interactive")?(t?.originalEvent?.preventDefault(),map.dragging.disable()):map.dragging.enable()})),map.on("dblclick",(function(t){let e=t.originalEvent?.target??t?.originalEvent?.explicitOriginalTarget;e?.className?.includes&&e?.className?.includes("leaflet")&&!self$1.mapLock&&map.panTo(t.latlng,{animate:!0})}))}onMarkerClicked(t,e,n){print(t.location);let i=t.getLocation()?.isClickable()&&!this.mapLock;if(!i||e||n)e&&this.canEdit()?this.edit(t.location):e&&!n&&i||t.getLocation()?.editing||t.openPopup();else{let e=t.getLocation();null!=e&&(this.mapCallbacks?.setLoading(!0),e.destinationID>0?this.goto(e.destinationID):this.getLocation(e.destinationID).then((t=>self$1.goto(t))))}}}leafletSrc.Layer.include({location:null,element:null,editing:!1,isIconPoly:null,getLocation:function(){return this.location},getCentre:function(){return gamemap.toLatLngs(this.getLocation().getCentre())},getElement(){return this.element=this?._icon??this?._path},getTooltip(){return document.getElementById(this.getElement()?.getAttribute("aria-describedby"))},isIconPolygon(){return this.isIconPoly},isEditing(){return this.getElement()?.classList?.contains("editing")||this.editing},setLocation(t){this.location=t},setIsIconPolygon(t){this.isIconPoly=t},getCoordinates(){if(this.getLatLng)return[structuredClone(this.getLatLng())];if(this.getLatLngs){let t=structuredClone(this.getLatLngs());return t.length>1?t:t[0]}},setEditingEffect(t){t&&(this.getElement()?.classList?.add("editing"),setTimeout((()=>{this.getTooltip()?.classList?.add("editing")}),15),this.editing=t)},edit(){this.editing=!0,this.pm.enable({allowEditing:!0,snapDistance:self$1.mapConfig.markerSnapDistance,draggable:!0,preventMarkerRemoval:1==this.getCoordinates().length}),this.on("pm:drag",(()=>gamemap.clearTooltips())),this.on("pm:markerdragend pm:vertexremoved pm:edit",(t=>{"Marker"!=t.shape&&("Polygon"!=t.shape&&"Line"!=t.shape||"pm:markerdragend"!=t.type&&"pm:vertexremoved"!=t.type)||updateMarkerCoords(self$1.toCoords(t.layer.getCoordinates()))}))},openPopup(){print("making popup"),print(this),leafletSrc.popup(this.getCentre(),{content:this.getLocation().getPopupContent()}).openOn(map)}});const{window:window_1}=globals;function get_each_context(t,e,n){const i=t.slice();return i[39]=e[n][0],i[40]=e[n][1],i}function create_if_block_15(t){let e,n;return e=new MapChooser({}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_5(t){let e,n,i=t[14]&&create_if_block_6(t);return{c(){i&&i.c(),e=empty()},m(t,o){i&&i.m(t,o),insert(t,e,o),n=!0},p(t,n){t[14]?i?(i.p(t,n),16384&n[0]&&transition_in(i,1)):(i=create_if_block_6(t),i.c(),transition_in(i,1),i.m(e.parentNode,e)):i&&(group_outros(),transition_out(i,1,1,(()=>{i=null})),check_outros())},i(t){n||(transition_in(i),n=!0)},o(t){transition_out(i),n=!1},d(t){i&&i.d(t),t&&detach(e)}}}function create_if_block_6(t){let e,n,i,o,r=!t[13]?.isGridEnabled(),s=t[0]&&create_if_block_14(),a=t[2]&&create_if_block_8(t),l=r&&create_if_block_7(t);return{c(){s&&s.c(),e=space(),a&&a.c(),n=space(),l&&l.c(),i=empty()},m(t,r){s&&s.m(t,r),insert(t,e,r),a&&a.m(t,r),insert(t,n,r),l&&l.m(t,r),insert(t,i,r),o=!0},p(t,o){t[0]?s?1&o[0]&&transition_in(s,1):(s=create_if_block_14(),s.c(),transition_in(s,1),s.m(e.parentNode,e)):s&&(group_outros(),transition_out(s,1,1,(()=>{s=null})),check_outros()),t[2]?a?(a.p(t,o),4&o[0]&&transition_in(a,1)):(a=create_if_block_8(t),a.c(),transition_in(a,1),a.m(n.parentNode,n)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros()),8192&o[0]&&(r=!t[13]?.isGridEnabled()),r?l?(l.p(t,o),8192&o[0]&&transition_in(l,1)):(l=create_if_block_7(t),l.c(),transition_in(l,1),l.m(i.parentNode,i)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){o||(transition_in(s),transition_in(a),transition_in(l),o=!0)},o(t){transition_out(s),transition_out(a),transition_out(l),o=!1},d(t){s&&s.d(t),t&&detach(e),a&&a.d(t),t&&detach(n),l&&l.d(t),t&&detach(i)}}}function create_if_block_14(t){let e,n;return e=new ProgressBar({}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_8(t){let e,n,i=!t[7].isEmbedded(),o=i&&create_if_block_9(t);return{c(){o&&o.c(),e=empty()},m(t,i){o&&o.m(t,i),insert(t,e,i),n=!0},p(t,n){128&n[0]&&(i=!t[7].isEmbedded()),i?o?(o.p(t,n),128&n[0]&&transition_in(o,1)):(o=create_if_block_9(t),o.c(),transition_in(o,1),o.m(e.parentNode,e)):o&&(group_outros(),transition_out(o,1,1,(()=>{o=null})),check_outros())},i(t){n||(transition_in(o),n=!0)},o(t){transition_out(o),n=!1},d(t){o&&o.d(t),t&&detach(e)}}}function create_if_block_9(t){let e,n,i,o,r,s,a,l,c,h=t[13].world.hasLayerMenu();e=new ZoomWidget({props:{currentZoom:t[13]?.getZoom(),lock:t[12]}});let u={lock:t[12]};i=new SearchPane({props:u}),t[22](i);let d=h&&create_if_block_13(t);s=new IconBar({props:{$$slots:{secondary:[create_secondary_slot],primary:[create_primary_slot]},$$scope:{ctx:t}}});return l=new LocationList({props:{}}),t[28](l),l.$on("toggled",t[29]),{c(){create_component(e.$$.fragment),n=space(),create_component(i.$$.fragment),o=space(),d&&d.c(),r=space(),create_component(s.$$.fragment),a=space(),create_component(l.$$.fragment)},m(t,h){mount_component(e,t,h),insert(t,n,h),mount_component(i,t,h),insert(t,o,h),d&&d.m(t,h),insert(t,r,h),mount_component(s,t,h),insert(t,a,h),mount_component(l,t,h),c=!0},p(t,n){const o={};8192&n[0]&&(o.currentZoom=t[13]?.getZoom()),4096&n[0]&&(o.lock=t[12]),e.$set(o);const a={};4096&n[0]&&(a.lock=t[12]),i.$set(a),8192&n[0]&&(h=t[13].world.hasLayerMenu()),h?d?(d.p(t,n),8192&n[0]&&transition_in(d,1)):(d=create_if_block_13(t),d.c(),transition_in(d,1),d.m(r.parentNode,r)):d&&(group_outros(),transition_out(d,1,1,(()=>{d=null})),check_outros());const c={};376464&n[0]|4096&n[1]&&(c.$$scope={dirty:n,ctx:t}),s.$set(c);l.$set({})},i(t){c||(transition_in(e.$$.fragment,t),transition_in(i.$$.fragment,t),transition_in(d),transition_in(s.$$.fragment,t),transition_in(l.$$.fragment,t),c=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(i.$$.fragment,t),transition_out(d),transition_out(s.$$.fragment,t),transition_out(l.$$.fragment,t),c=!1},d(c){destroy_component(e,c),c&&detach(n),t[22](null),destroy_component(i,c),c&&detach(o),d&&d.d(c),c&&detach(r),destroy_component(s,c),c&&detach(a),t[28](null),destroy_component(l,c)}}}function create_if_block_13(t){let e,n;return e=new LayerSwitcher({props:{mapState:t[13],lock:t[12]}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.mapState=t[13]),4096&n[0]&&(i.lock=t[12]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_12(t){let e,n;return e=new IconButton({props:{icon:"edit",tooltip:"Toggle map editor",noMobile:"true",checked:t[11],lock:t[12]}}),e.$on("checked",t[26]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};2048&n[0]&&(i.checked=t[11]),4096&n[0]&&(i.lock=t[12]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_default_slot_2(t){let e,n,i,o,r,s,a,l,c,h,u,d,p,_,f,m,g,v,y,b,k,w,x,L=t[4]?"Exit":"Fullscreen";return o=new Icon({props:{name:"help_outline"}}),c=new Icon({props:{name:"list"}}),_=new Icon({props:{name:"messenger_outline"}}),y=new Icon({props:{name:t[4]?"fullscreen_exit":"fullscreen"}}),{c(){e=element("ul"),n=element("li"),i=element("a"),create_component(o.$$.fragment),r=text("Help"),s=space(),a=element("li"),l=element("a"),create_component(c.$$.fragment),h=text("Map Key"),u=space(),d=element("li"),p=element("a"),create_component(_.$$.fragment),f=text("Feedback"),m=space(),g=element("li"),v=element("a"),create_component(y.$$.fragment),b=text(L),attr(i,"title","See help info"),attr(i,"href","https://en.uesp.net/wiki/UESPWiki:Map_Help"),attr(i,"target","_blank"),attr(i,"rel","noopener noreferrer"),attr(n,"class","waves-effect"),attr(l,"title","Show map key"),attr(a,"class","waves-effect"),attr(p,"href","https://en.uesp.net/wiki/UESPWiki_talk:Maps"),attr(p,"target","_blank"),attr(p,"rel","noopener noreferrer"),attr(p,"title","Tell us your thoughts"),attr(d,"class","waves-effect"),attr(v,"id","fullscreen-toggle"),attr(v,"title","Toggle fullscreen mode"),attr(g,"class","waves-effect"),attr(e,"id","overflow-menu"),attr(e,"class","dropdown-content")},m(L,$){insert(L,e,$),append(e,n),append(n,i),mount_component(o,i,null),append(i,r),append(e,s),append(e,a),append(a,l),mount_component(c,l,null),append(l,h),append(e,u),append(e,d),append(d,p),mount_component(_,p,null),append(p,f),append(e,m),append(e,g),append(g,v),mount_component(y,v,null),append(v,b),k=!0,w||(x=[listen(l,"click",t[27]),listen(v,"click",t[21])],w=!0)},p(t,e){const n={};16&e[0]&&(n.name=t[4]?"fullscreen_exit":"fullscreen"),y.$set(n),(!k||16&e[0])&&L!==(L=t[4]?"Exit":"Fullscreen")&&set_data(b,L)},i(t){k||(transition_in(o.$$.fragment,t),transition_in(c.$$.fragment,t),transition_in(_.$$.fragment,t),transition_in(y.$$.fragment,t),k=!0)},o(t){transition_out(o.$$.fragment,t),transition_out(c.$$.fragment,t),transition_out(_.$$.fragment,t),transition_out(y.$$.fragment,t),k=!1},d(t){t&&detach(e),destroy_component(o),destroy_component(c),destroy_component(_),destroy_component(y),w=!1,run_all(x)}}}function create_primary_slot(t){let e,n,i,o,r=t[9]&&create_if_block_12(t);return i=new IconButton({props:{icon:"more_vert",tooltip:"More actions",menu:"overflow-menu",lock:t[12],$$slots:{default:[create_default_slot_2]},$$scope:{ctx:t}}}),{c(){e=element("slot:template"),r&&r.c(),n=space(),create_component(i.$$.fragment),attr(e,"slot","primary")},m(t,s){insert(t,e,s),r&&r.m(e,null),append(e,n),mount_component(i,e,null),o=!0},p(t,o){t[9]?r?(r.p(t,o),512&o[0]&&transition_in(r,1)):(r=create_if_block_12(t),r.c(),transition_in(r,1),r.m(e,n)):r&&(group_outros(),transition_out(r,1,1,(()=>{r=null})),check_outros());const s={};4096&o[0]&&(s.lock=t[12]),262160&o[0]|4096&o[1]&&(s.$$scope={dirty:o,ctx:t}),i.$set(s)},i(t){o||(transition_in(r),transition_in(i.$$.fragment,t),o=!0)},o(t){transition_out(r),transition_out(i.$$.fragment,t),o=!1},d(t){t&&detach(e),r&&r.d(),destroy_component(i)}}}function create_if_block_11(t){let e,n;return e=new IconButton({props:{icon:"explore",label:t[13].world.displayName,tooltip:"Show location list",dropdown:"true",lock:t[12],checked:t[16]}}),e.$on("checked",t[23]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};8192&n[0]&&(i.label=t[13].world.displayName),4096&n[0]&&(i.lock=t[12]),65536&n[0]&&(i.checked=t[16]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_10(t){let e,n;return e=new IconButton({props:{icon:"article",label:"Goto Article",tooltip:"Goto this map's article",lock:t[12]}}),e.$on("click",t[24]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};4096&n[0]&&(i.lock=t[12]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_secondary_slot(t){let e,n,i,o,r,s=t[7].hasMultipleWorlds(),a=s&&create_if_block_11(t),l=t[13].world.wikiPage&&create_if_block_10(t);return o=new IconButton({props:{icon:"link",label:"Copy Link",lock:t[12],tooltip:"Copy link to current map view"}}),o.$on("click",t[25]),{c(){e=element("slot:template"),a&&a.c(),n=space(),l&&l.c(),i=space(),create_component(o.$$.fragment),attr(e,"slot","secondary")},m(t,s){insert(t,e,s),a&&a.m(e,null),append(e,n),l&&l.m(e,null),append(e,i),mount_component(o,e,null),r=!0},p(t,r){128&r[0]&&(s=t[7].hasMultipleWorlds()),s?a?(a.p(t,r),128&r[0]&&transition_in(a,1)):(a=create_if_block_11(t),a.c(),transition_in(a,1),a.m(e,n)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros()),t[13].world.wikiPage?l?(l.p(t,r),8192&r[0]&&transition_in(l,1)):(l=create_if_block_10(t),l.c(),transition_in(l,1),l.m(e,i)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros());const c={};4096&r[0]&&(c.lock=t[12]),o.$set(c)},i(t){r||(transition_in(a),transition_in(l),transition_in(o.$$.fragment,t),r=!0)},o(t){transition_out(a),transition_out(l),transition_out(o.$$.fragment,t),r=!1},d(t){t&&detach(e),a&&a.d(),l&&l.d(),destroy_component(o)}}}function create_if_block_7(t){let e,n;return e=new LayerOptionsContainer({props:{$$slots:{default:[create_default_slot_1]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};4288&n[0]|4096&n[1]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_default_slot_1(t){let e,n;return e=new Infobar({props:{mapName:t[6].mapTitle,embedded:t[7].isEmbedded(),lock:t[12]}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};64&n[0]&&(i.mapName=t[6].mapTitle),128&n[0]&&(i.embedded=t[7].isEmbedded()),4096&n[0]&&(i.lock=t[12]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_4(t){let e,n;return e=new ErrorBox({props:{reason:t[5]}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};32&n[0]&&(i.reason=t[5]),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_3(t){let e,n;return e=new LoadingBox({props:{reason:t[1]+"..."}}),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};2&n[0]&&(i.reason=t[1]+"..."),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_if_block_2(t){let e,n,i;function o(e){t[32](e)}let r={};return void 0!==t[11]&&(r.shown=t[11]),e=new Editor({props:r}),t[31](e),binding_callbacks.push((()=>bind(e,"shown",o))),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const o={};!n&&2048&i[0]&&(n=!0,o.shown=t[11],add_flush_callback((()=>n=!1))),e.$set(o)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(n){t[31](null),destroy_component(e,n)}}}function create_if_block_1(t){let e,n;return e=new Dialog({props:{title:"Map Key",fixedFooter:!0,cancel:"close",$$slots:{default:[create_default_slot]},$$scope:{ctx:t}}}),t[33](e),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const i={};64&n[0]|4096&n[1]&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(n){t[33](null),destroy_component(e,n)}}}function create_each_block(t){let e,n,i,o,r,s,a,l,c,h=t[40]+"";return{c(){e=element("div"),n=element("img"),s=space(),a=element("b"),l=text(h),c=space(),attr(n,"title",i=t[40]),attr(n,"alt",o=t[40]),src_url_equal(n.src,r=t[6].iconPath+t[39]+".png")||attr(n,"src",r),attr(a,"class","left-align"),attr(e,"class","map_key_item left-align")},m(t,i){insert(t,e,i),append(e,n),append(e,s),append(e,a),append(a,l),append(e,c)},p(t,e){64&e[0]&&i!==(i=t[40])&&attr(n,"title",i),64&e[0]&&o!==(o=t[40])&&attr(n,"alt",o),64&e[0]&&!src_url_equal(n.src,r=t[6].iconPath+t[39]+".png")&&attr(n,"src",r),64&e[0]&&h!==(h=t[40]+"")&&set_data(l,h)},d(t){t&&detach(e)}}}function create_default_slot(t){let e,n=[...t[6].icons],i=[];for(let e=0;e<n.length;e+=1)i[e]=create_each_block(get_each_context(t,n,e));return{c(){e=element("div");for(let t=0;t<i.length;t+=1)i[t].c();attr(e,"id","map_key_container")},m(t,n){insert(t,e,n);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,null)},p(t,o){if(64&o[0]){let r;for(n=[...t[6].icons],r=0;r<n.length;r+=1){const s=get_each_context(t,n,r);i[r]?i[r].p(s,o):(i[r]=create_each_block(s),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){t&&detach(e),destroy_each(i,t)}}}function create_fragment(t){let e,n,i,o,r,s,a,l,c,h,u,d,p=t[17]&&create_if_block_15(),_=t[7]&&create_if_block_5(t);const f=[create_if_block_3,create_if_block_4],m=[];function g(t,e){return t[2]||""==t[1]?t[3]?1:-1:0}~(o=g(t))&&(r=m[o]=f[o](t));let v=t[9]&&create_if_block_2(t),y=t[6]&&create_if_block_1(t);return{c(){p&&p.c(),e=space(),n=element("div"),_&&_.c(),i=space(),r&&r.c(),s=space(),v&&v.c(),a=space(),y&&y.c(),l=space(),c=empty(),attr(n,"id","gamemap")},m(r,f){p&&p.m(r,f),insert(r,e,f),insert(r,n,f),_&&_.m(n,null),t[30](n),insert(r,i,f),~o&&m[o].m(r,f),insert(r,s,f),v&&v.m(r,f),insert(r,a,f),y&&y.m(r,f),insert(r,l,f),insert(r,c,f),h=!0,u||(d=[listen(window_1,"keydown",t[20]),listen(window_1,"fullscreenchange",t[21])],u=!0)},p(t,i){t[17]?p?131072&i[0]&&transition_in(p,1):(p=create_if_block_15(),p.c(),transition_in(p,1),p.m(e.parentNode,e)):p&&(group_outros(),transition_out(p,1,1,(()=>{p=null})),check_outros()),t[7]?_?(_.p(t,i),128&i[0]&&transition_in(_,1)):(_=create_if_block_5(t),_.c(),transition_in(_,1),_.m(n,null)):_&&(group_outros(),transition_out(_,1,1,(()=>{_=null})),check_outros());let c=o;o=g(t),o===c?~o&&m[o].p(t,i):(r&&(group_outros(),transition_out(m[c],1,1,(()=>{m[c]=null})),check_outros()),~o?(r=m[o],r?r.p(t,i):(r=m[o]=f[o](t),r.c()),transition_in(r,1),r.m(s.parentNode,s)):r=null),t[9]?v?(v.p(t,i),512&i[0]&&transition_in(v,1)):(v=create_if_block_2(t),v.c(),transition_in(v,1),v.m(a.parentNode,a)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros()),t[6]?y?(y.p(t,i),64&i[0]&&transition_in(y,1)):(y=create_if_block_1(t),y.c(),transition_in(y,1),y.m(l.parentNode,l)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros())},i(t){h||(transition_in(p),transition_in(_),transition_in(r),transition_in(v),transition_in(y),transition_in(false),h=!0)},o(t){transition_out(p),transition_out(_),transition_out(r),transition_out(v),transition_out(y),transition_out(false),h=!1},d(r){p&&p.d(r),r&&detach(e),r&&detach(n),_&&_.d(),t[30](null),r&&detach(i),~o&&m[o].d(r),r&&detach(s),v&&v.d(r),r&&detach(a),y&&y.d(r),r&&detach(l),r&&detach(c),u=!1,run_all(d)}}}function instance(t,e,n){print("Initialising app..."),document.getElementById("app").addEventListener("DOMSubtreeModified",(function(){let t=document.querySelectorAll("[class*='svelte']");for(let e=0;e<t.length;e++){let n=t[e];L.DomEvent.disableScrollPropagation(n)}}),!1);let i,o,r,s,a,l,c=!0,h="",u=!1,d=!1,p=!1,_="",f=null,m=null,g=null,v=!1,y=null,b=!0,k=!1,w=!1;function x(t){n(13,r=t),function(t){document.title=f.mapTitle,m.hasMultipleWorlds()&&(document.title=t+" | "+document.title);document.title=document.title+" (UESP)"}(r.world.displayName),s?.dismiss(),n(2,u=!0),setTimeout((()=>{r.pendingSearch&&(l.updateSearch(r.pendingSearch),n(13,r.pendingSearch=null,r),m.updateMapState(r))}))}function $(t){"boolean"==typeof t?(n(0,c=t),n(1,h="")):(n(0,c=!0),n(1,h=t),print(h+"..."))}function C(t){0==t?n(3,d=t):($(!1),n(3,d=!0),n(5,_=t),print.error(t))}onMount((async()=>{var t=document.getElementsByTagName("noscript");for(let e=t.length-1;e>=0;e--)t[e].parentNode.removeChild(t[e]);setTimeout((function(){document.firstElementChild.style.zoom="reset",document.querySelector('meta[name="viewport"]').content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"}),location.toString().includes("dev")?1e4:0);let e=""!=location.pathname.replace(/\\|\//g,"")?location.pathname.replace(/\\|\//g,""):null!=location.search?getURLParams().get("game"):null;$("Loading map"),null!=e&&e.toLowerCase().match(/^([a-z]+)/)?(print("Game parameter was: "+e),getJSON(DEFAULT_MAP_CONFIG_DIR).then((t=>{window.DEFAULT_MAP_CONFIG=t;let o=MAP_ASSETS_DIR+e.toLowerCase()+"/config/"+e+"-"+MAP_CONFIG_FILENAME;$("Loading config"),print("Getting map config at "+o+"..."),getJSON(o).then((t=>{print("Imported map config successfully."),n(6,f=t),print("Merging with default map config...");let e=mergeObjects(DEFAULT_MAP_CONFIG,f);n(6,f=e),n(6,f.assetsPath=f.assetsPath+f.database+"/",f),n(6,f.iconPath=f.assetsPath+"icons/",f),n(6,f.db=f.database,f),n(6,f.tileURL=f.tileURLName?f.baseTileURL+f.tileURLName+"/":f.baseTileURL+f.database+"map/",f);let o=Object.entries(f.icons).map((([t,e])=>({[t]:e})));o.sort(((t,e)=>Object.values(t)[0].localeCompare(Object.values(e)[0],"en",{sensitivity:"base"}))),n(6,f.icons=new Map(o.map((t=>[Number(Object.keys(t)[0]),Object.values(t)[0]]))),f),print("Completed merged map config:"),print(f),window.MAPCONFIG=f,function(t){let e={onPermissionsLoaded:t=>{print("Editing permissions: "+t),n(9,v=t)},onMapLoaded:()=>$(!1),onMapLockChanged:t=>{n(12,y=t)},edit:t=>{i.edit(t)},onMapStateChanged:x,setLoading:$};window.gamemap=new Gamemap(g,t,e),n(7,m=window.gamemap)}(f)})).catch((t=>t.toString().includes("JSON.parse")?C("Provided game doesn't exist. Please check the URL."):C(`Could not load map: ${t}`)))})).catch((t=>C(`There was an error getting the default map config: ${t}`)))):($(!1),n(17,w=!0))})),window.onunhandledrejection=t=>{C(t.reason)};return[c,h,u,d,p,_,f,m,g,v,i,o,y,r,b,s,k,w,a,l,function(t){45==t.keyCode&&(n(14,b=!b),print("UI "+(b?"shown.":"hidden.")))},function(t){n(4,p=null!=document.fullscreenElement),"fullscreenchange"!=t.type?(p?document.exitFullscreen():document.documentElement.requestFullscreen(),n(4,p=null!=document.fullscreenElement)):"fullscreenchange"==t.type&&n(4,p=null!=document.fullscreenElement)},function(t){binding_callbacks[t?"unshift":"push"]((()=>{l=t,n(19,l)}))},()=>s.toggle(),()=>{print("Getting article link..."),window.open(r.world.getWikiLink())},()=>{print("Copying link to clipboard..."),M.toast({html:"Map link copied to clipboard!"}),navigator?.clipboard?.writeText(window.location)},t=>{t.detail.checked&&t.detail.shift?i.edit(m.getCurrentWorld()):i.show(t.detail.checked)},()=>a.show(),function(t){binding_callbacks[t?"unshift":"push"]((()=>{s=t,n(15,s)}))},t=>n(16,k=t.detail),function(t){binding_callbacks[t?"unshift":"push"]((()=>{g=t,n(8,g)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{i=t,n(10,i)}))},function(t){o=t,n(11,o)},function(t){binding_callbacks[t?"unshift":"push"]((()=>{a=t,n(18,a)}))}]}class App extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{},null,[-1,-1])}}var mount=new App({target:document.querySelector("#app")});return mount}();
//# sourceMappingURL=bundle.js.map
