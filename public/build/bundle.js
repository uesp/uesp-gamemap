var app=function(){"use strict";function noop(){}const identity=t=>t;function assign(t,e){for(const i in e)t[i]=e[i];return t}function run(t){return t()}function blank_object(){return Object.create(null)}function run_all(t){t.forEach(run)}function is_function(t){return"function"==typeof t}function safe_not_equal(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let src_url_equal_anchor;function src_url_equal(t,e){return src_url_equal_anchor||(src_url_equal_anchor=document.createElement("a")),src_url_equal_anchor.href=e,t===src_url_equal_anchor.href}function is_empty(t){return 0===Object.keys(t).length}function create_slot(t,e,i,n){if(t){const o=get_slot_context(t,e,i,n);return t[0](o)}}function get_slot_context(t,e,i,n){return t[1]&&n?assign(i.ctx.slice(),t[1](n(e))):i.ctx}function get_slot_changes(t,e,i,n){if(t[2]&&n){const o=t[2](n(i));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],i=Math.max(e.dirty.length,o.length);for(let n=0;n<i;n+=1)t[n]=e.dirty[n]|o[n];return t}return e.dirty|o}return e.dirty}function update_slot_base(t,e,i,n,o,s){if(o){const r=get_slot_context(e,i,n,s);t.p(r,o)}}function get_all_dirty_from_scope(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let t=0;t<i;t++)e[t]=-1;return e}return-1}function action_destroyer(t){return t&&is_function(t.destroy)?t.destroy:noop}function split_css_unit(t){const e="string"==typeof t&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const is_client="undefined"!=typeof window;let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?t=>requestAnimationFrame(t):noop;const tasks=new Set;function run_tasks(t){tasks.forEach((e=>{e.c(t)||(tasks.delete(e),e.f())})),0!==tasks.size&&raf(run_tasks)}function loop(t){let e;return 0===tasks.size&&raf(run_tasks),{promise:new Promise((i=>{tasks.add(e={c:t,f:i})})),abort(){tasks.delete(e)}}}const globals="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function append(t,e){t.appendChild(e)}function get_root_for_style(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function append_empty_stylesheet(t){const e=element("style");return append_stylesheet(get_root_for_style(t),e),e.sheet}function append_stylesheet(t,e){return append(t.head||t,e),e.sheet}function insert(t,e,i){t.insertBefore(e,i||null)}function detach(t){t.parentNode&&t.parentNode.removeChild(t)}function destroy_each(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}function element(t){return document.createElement(t)}function svg_element(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function text(t){return document.createTextNode(t)}function space(){return text(" ")}function empty(){return text("")}function listen(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function stop_propagation(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function attr(t,e,i){null==i?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function children(t){return Array.from(t.childNodes)}function set_data(t,e){e=""+e,t.data!==e&&(t.data=e)}function set_input_value(t,e){t.value=null==e?"":e}function set_style(t,e,i,n){null==i?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}let crossorigin;function is_crossorigin(){if(void 0===crossorigin){crossorigin=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){crossorigin=!0}}return crossorigin}function add_iframe_resize_listener(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const i=element("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const n=is_crossorigin();let o;return n?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=listen(window,"message",(t=>{t.source===i.contentWindow&&e()}))):(i.src="about:blank",i.onload=()=>{o=listen(i.contentWindow,"resize",e),e()}),append(t,i),()=>{(n||o&&i.contentWindow)&&o(),detach(i)}}function toggle_class(t,e,i){t.classList[i?"add":"remove"](e)}function custom_event(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,i,n,e),o}const managed_styles=new Map;let active=0,current_component;function hash(t){let e=5381,i=t.length;for(;i--;)e=(e<<5)-e^t.charCodeAt(i);return e>>>0}function create_style_information(t,e){const i={stylesheet:append_empty_stylesheet(e),rules:{}};return managed_styles.set(t,i),i}function create_rule(t,e,i,n,o,s,r,a=0){const l=16.666/n;let c="{\n";for(let t=0;t<=1;t+=l){const n=e+(i-e)*s(t);c+=100*t+`%{${r(n,1-n)}}\n`}const h=c+`100% {${r(i,1-i)}}\n}`,u=`__svelte_${hash(h)}_${a}`,d=get_root_for_style(t),{stylesheet:p,rules:_}=managed_styles.get(d)||create_style_information(d,t);_[u]||(_[u]=!0,p.insertRule(`@keyframes ${u} ${h}`,p.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${u} ${n}ms linear ${o}ms 1 both`,active+=1,u}function delete_rule(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),o=i.length-n.length;o&&(t.style.animation=n.join(", "),active-=o,active||clear_rules())}function clear_rules(){raf((()=>{active||(managed_styles.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&detach(e)})),managed_styles.clear())}))}function set_current_component(t){current_component=t}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(t){get_current_component().$$.on_mount.push(t)}function onDestroy(t){get_current_component().$$.on_destroy.push(t)}function createEventDispatcher(){const t=get_current_component();return(e,i,{cancelable:n=!1}={})=>{const o=t.$$.callbacks[e];if(o){const s=custom_event(e,i,{cancelable:n});return o.slice().forEach((e=>{e.call(t,s)})),!s.defaultPrevented}return!0}}function bubble(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach((t=>t.call(this,e)))}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(t){render_callbacks.push(t)}function add_flush_callback(t){flush_callbacks.push(t)}const seen_callbacks=new Set;let flushidx=0,promise;function flush(){if(0!==flushidx)return;const t=current_component;do{try{for(;flushidx<dirty_components.length;){const t=dirty_components[flushidx];flushidx++,set_current_component(t),update(t.$$)}}catch(t){throw dirty_components.length=0,flushidx=0,t}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let t=0;t<render_callbacks.length;t+=1){const e=render_callbacks[t];seen_callbacks.has(e)||(seen_callbacks.add(e),e())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(t)}function update(t){if(null!==t.fragment){t.update(),run_all(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(add_render_callback)}}function flush_render_callbacks(t){const e=[],i=[];render_callbacks.forEach((n=>-1===t.indexOf(n)?e.push(n):i.push(n))),i.forEach((t=>t())),render_callbacks=e}function wait(){return promise||(promise=Promise.resolve(),promise.then((()=>{promise=null}))),promise}function dispatch(t,e,i){t.dispatchEvent(custom_event(`${e?"intro":"outro"}${i}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(t,e){t&&t.i&&(outroing.delete(t),t.i(e))}function transition_out(t,e,i,n){if(t&&t.o){if(outroing.has(t))return;outroing.add(t),outros.c.push((()=>{outroing.delete(t),n&&(i&&t.d(1),n())})),t.o(e)}else n&&n()}const null_transition={duration:0};function create_in_transition(t,e,i){const n={direction:"in"};let o,s,r=e(t,i,n),a=!1,l=0;function c(){o&&delete_rule(t,o)}function h(){const{delay:e=0,duration:i=300,easing:n=identity,tick:h=noop,css:u}=r||null_transition;u&&(o=create_rule(t,0,1,i,e,n,u,l++)),h(0,1);const d=now()+e,p=d+i;s&&s.abort(),a=!0,add_render_callback((()=>dispatch(t,!0,"start"))),s=loop((e=>{if(a){if(e>=p)return h(1,0),dispatch(t,!0,"end"),c(),a=!1;if(e>=d){const t=n((e-d)/i);h(t,1-t)}}return a}))}let u=!1;return{start(){u||(u=!0,delete_rule(t),is_function(r)?(r=r(n),wait().then(h)):h())},invalidate(){u=!1},end(){a&&(c(),a=!1)}}}function create_out_transition(t,e,i){const n={direction:"out"};let o,s=e(t,i,n),r=!0;const a=outros;function l(){const{delay:e=0,duration:i=300,easing:n=identity,tick:l=noop,css:c}=s||null_transition;c&&(o=create_rule(t,1,0,i,e,n,c));const h=now()+e,u=h+i;add_render_callback((()=>dispatch(t,!1,"start"))),loop((e=>{if(r){if(e>=u)return l(0,1),dispatch(t,!1,"end"),--a.r||run_all(a.c),!1;if(e>=h){const t=n((e-h)/i);l(1-t,t)}}return r}))}return a.r+=1,is_function(s)?wait().then((()=>{s=s(n),l()})):l(),{end(e){e&&s.tick&&s.tick(1,0),r&&(o&&delete_rule(t,o),r=!1)}}}function outro_and_destroy_block(t,e){transition_out(t,1,1,(()=>{e.delete(t.key)}))}function update_keyed_each(t,e,i,n,o,s,r,a,l,c,h,u){let d=t.length,p=s.length,_=d;const m={};for(;_--;)m[t[_].key]=_;const f=[],g=new Map,y=new Map,v=[];for(_=p;_--;){const t=u(o,s,_),a=i(t);let l=r.get(a);l?n&&v.push((()=>l.p(t,e))):(l=c(a,t),l.c()),g.set(a,f[_]=l),a in m&&y.set(a,Math.abs(_-m[a]))}const b=new Set,k=new Set;function w(t){transition_in(t,1),t.m(a,h),r.set(t.key,t),h=t.first,p--}for(;d&&p;){const e=f[p-1],i=t[d-1],n=e.key,o=i.key;e===i?(h=e.first,d--,p--):g.has(o)?!r.has(n)||b.has(n)?w(e):k.has(o)?d--:y.get(n)>y.get(o)?(k.add(n),w(e)):(b.add(o),d--):(l(i,r),d--)}for(;d--;){const e=t[d];g.has(e.key)||l(e,r)}for(;p;)w(f[p-1]);return run_all(v),f}function get_spread_update(t,e){const i={},n={},o={$$scope:1};let s=t.length;for(;s--;){const r=t[s],a=e[s];if(a){for(const t in r)t in a||(n[t]=1);for(const t in a)o[t]||(i[t]=a[t],o[t]=1);t[s]=a}else for(const t in r)o[t]=1}for(const t in n)t in i||(i[t]=void 0);return i}function get_spread_object(t){return"object"==typeof t&&null!==t?t:{}}function bind(t,e,i){const n=t.$$.props[e];void 0!==n&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function create_component(t){t&&t.c()}function mount_component(t,e,i,n){const{fragment:o,after_update:s}=t.$$;o&&o.m(e,i),n||add_render_callback((()=>{const e=t.$$.on_mount.map(run).filter(is_function);t.$$.on_destroy?t.$$.on_destroy.push(...e):run_all(e),t.$$.on_mount=[]})),s.forEach(add_render_callback)}function destroy_component(t,e){const i=t.$$;null!==i.fragment&&(flush_render_callbacks(i.after_update),run_all(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function make_dirty(t,e){-1===t.$$.dirty[0]&&(dirty_components.push(t),schedule_update(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function init(t,e,i,n,o,s,r,a=[-1]){const l=current_component;set_current_component(t);const c=t.$$={fragment:null,ctx:[],props:s,update:noop,not_equal:o,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:blank_object(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};r&&r(c.root);let h=!1;if(c.ctx=i?i(t,e.props||{},((e,i,...n)=>{const s=n.length?n[0]:i;return c.ctx&&o(c.ctx[e],c.ctx[e]=s)&&(!c.skip_bound&&c.bound[e]&&c.bound[e](s),h&&make_dirty(t,e)),i})):[],c.update(),h=!0,run_all(c.before_update),c.fragment=!!n&&n(c.ctx),e.target){if(e.hydrate){const t=children(e.target);c.fragment&&c.fragment.l(t),t.forEach(detach)}else c.fragment&&c.fragment.c();e.intro&&transition_in(t.$$.fragment),mount_component(t,e.target,e.anchor,e.customElement),flush()}set_current_component(l)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(t,e){if(!is_function(e))return noop;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}$set(t){this.$$set&&!is_empty(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ZERO=1e-4;class Point{constructor(t,e,i){this.x=t?isNaN(t)?ZERO:0!=t?Number(t):ZERO:ZERO,this.y=e?isNaN(e)?ZERO:0!=e?Number(e):ZERO:ZERO,this.coordType=i}toArray(){return[this.x,this.y]}}if(window.isFirefox=function(){return-1!==navigator.userAgent.indexOf("Firefox")},window.isChrome=function(){return null!=window.chrome},!navigator.userAgent.match(/Mobi/)||location.toString().includes("localhost")||location.toString().includes("devgame")){window.addEventListener("beforeprint",(function(t){t.preventDefault()}));let t={};t=function(){},window.print=t,t=window.console.log=window.console.log.bind(window.console.log,"%c[Debug]%o","color: black; font-weight: bold; padding: 2px; background: aqua;"),t.warn=window.console.warn=window.console.warn.bind(window.console.warn,"%c[Warn]%o","color: black; font-weight: bold; padding: 2px; background: yellow;"),t.error=window.console.error=window.console.error.bind(window.console.error,"%c[Error]%o","color: black; font-weight: bold; padding: 2px; background: palevioletred ;"),window.print=t,window.print.warn=t.warn,window.print.error=t.error}else{let t={log:function(){}};window.console=t;let e=function(){};window.print=e,e=t.log.bind(t),window.print=function(){},window.print.warn=function(){},window.print.error=function(){},window.console.warn=function(){},t.warn=function(){}}function setCookie(t,e,i){null==i&&(i=999999);const n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3);let o="expires="+n.toUTCString();document.cookie=t+"="+e+";"+o+";path=/;SameSite=Lax"}function getCookie(t){var e=" "+document.cookie,i=e.indexOf(" "+t+"=");if(-1==i)e=null;else{i=e.indexOf("=",i)+1;var n=e.indexOf(";",i);-1==n&&(n=e.length),e=unescape(e.substring(i,n))}return e}window.getJSON=function(t,e){return new Promise(((e,i)=>{try{fetch(t).then((t=>t.text())).then((t=>{try{e(JSON.parse(t.replace(/\\"|"(?:\\"|[^"])*"|(\/\/.*|\/\*[\s\S]*?\*\/)/g,((t,e)=>e?"":t))))}catch(t){console.error(t),i(t)}}))}catch(t){i(t)}}))},window.getURLParams=function(t){let e;return e=null==t||t==PARAM_TYPE_QUERY?location.search.replace("#?",""):location.hash.replace("#?",""),new URLSearchParams(e)},window.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},window.beginsWith=function(t,e){return t.substring(0,e.length)===e},window.mergeObjects=function(t,e){return{...t,...e}},window.square=function(t){return t*t},window.getUniqueListFrom=function(t,e){return[...new Map(t.map((t=>[t[e],t]))).values()]},window.RGBAtoHex=function(t){if(/^rgb/.test(t)){const e=t.replace(/^rgba?\(|\s+|\)$/g,"").split(",");let i=`#${((1<<24)+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1)}`;if(e[4]){i+=(Math.round(255)+65536).toString(16).substr(-2).toUpperCase()}return i}return t},window.nextPowerOfTwo=function(t){for(t-=1;t&t-1;)t&=t-1;return t<<1},window.isNull=function(t){return null==t},window.changeFavIcon=function(t){let e=document.querySelector("link[rel*='icon']")||document.createElement("link");e.type="image/png",e.rel="icon",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)},window.injectCSS=function(t){t=t+"?"+Math.random().toString(36).substr(2,10),document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="'+t+'" />')},window.queryify=function(t){let e="?",i=Object.entries(t);return i.forEach((function(t){e+=t[0]+"="+t[1],i.indexOf(t)+1<i.length&&(e+="&")})),e},window.objectify=function(t){const e=new URLSearchParams(t),i={};for(const t of e.keys())e.getAll(t).length>1?i[t]=e.getAll(t):i[t]=e.get(t);return i},window.setPrefs=function(t,e){setCookie(t,e)},window.getPrefs=function(t,e){if(e=null!=e&&e,getURLParams().has(t))return getURLParams().get(t);{let i=null!=getCookie(t)&&""!=getCookie(t)?getCookie(t):e;return setPrefs(t,i),!("string"==typeof i||i instanceof String)||"true"!=i.toLowerCase()&&"false"!=i.toLowerCase()?i:JSON.parse(i)}},window.isString=function(t){return"string"==typeof t||t instanceof String},window.getTimeAgo=function(t){const e=Math.round((Date.now()-Number(t))/1e3);if(e<MINUTE)return"Just now";let i,n="";[i,n]=e<HOUR?[MINUTE,"minute"]:e<DAY?[HOUR,"hour"]:e<WEEK?[DAY,"day"]:e<MONTH?[WEEK,"week"]:e<YEAR?[MONTH,"month"]:[YEAR,"year"];const o=Math.floor(e/i);return`${o} ${n}${o>1?"s":""} ago`},window.getClientLocale=function(){if("undefined"!=typeof Intl)try{return Intl.NumberFormat().resolvedOptions().locale}catch(t){console.error("Cannot get locale from Intl")}},window.UTCtoLocalDate=function(t){return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()))},Object.assign(String.prototype,{toSentenceCase(){return this.toLowerCase().replace(/\.\s*([a-z])|^[a-z]/gm,(t=>t.toUpperCase()))}}),String.prototype.toTitleCase=function(){return this.replace(/(^\w{1})|(\s+\w{1})/g,(t=>t.toUpperCase()))},window.encodeURI=function(t){return t?encodeURIComponent(t):""},window.polygonCenter=function(t){var e,i,n,o,s,r,a,l,c=t.length;for(r=a=l=0,e=0,i=c-1;e<c;i=e++)n=t[e],o=t[i],s=Number(n.y)*Number(o.x)-Number(o.y)*Number(n.x),a+=(Number(n.x)+Number(o.x))*s,l+=(Number(n.y)+Number(o.y))*s,r+=3*s;return 0===r?new Point(Number(t[0].x).toFixed(3),Number(t[0].y).toFixed(3),t[0].coordType):new Point(Number(a/r).toFixed(3),Number(l/r).toFixed(3),MAPCONFIG.coordType)},window.structuredClone=function(t){return JSON.parse(JSON.stringify(t))},window.deepClone=function(t){return Object.assign(Object.create(Object.getPrototypeOf(t)),t)},NodeList.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator],HTMLCollection.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator],window.isLocalHost=location.hostname.includes("localhost"),window.HOST=isLocalHost?"https://gamemap.uesp.net":location.origin,window.GAME=""!=location.pathname.replace(/\\|\//g,"")?location.pathname.replace(/\\|\//g,""):null!=location.search?getURLParams().get("game"):null,window.ASSETS_DIR=isLocalHost?`${HOST}/assets/`:"/assets/",window.MAPS_DIR=`${ASSETS_DIR}maps/`,window.MAP_ASSETS_DIR=`${ASSETS_DIR}maps/${GAME}/`,window.ICONS_DIR=MAP_ASSETS_DIR+"icons/",window.IMAGES_DIR=ASSETS_DIR+"images/",window.CONFIG_DIR="config/",window.PARAM_TYPE_QUERY=0,window.PARAM_TYPE_HASH=1,window.CSS_OVERRIDE_FILENAME="override.css",window.MAP_CONFIG_FILENAME="config.json",window.DEFAULT_MAP_CONFIG_DIR=`${MAPS_DIR}default-${MAP_CONFIG_FILENAME}`,window.MAP_CONFIG_DIR=`${MAP_ASSETS_DIR}${CONFIG_DIR}${GAME}-${MAP_CONFIG_FILENAME}`,window.GAME_DATA_SCRIPT="db/gamemap.php",window.LOCTYPES={MARKER:1,PATH:2,AREA:3},window.COORD_TYPES={XY:0,NORMALISED:1,PSEUDO_NORMALISED:1.5,WORLDSPACE:2},window.EDIT_TYPES={0:"adding",1:"editing",2:"reverting",3:"deleting",ADD:0,EDIT:1,REVERT:2,DELETE:3},window.MAPLOCK={NONE:!1,FULL:1,PARTIAL:2,PARTIAL_MARKER:3,PARTIAL_NEW_MARKER:3.5,PARTIAL_POLYGON:4,PARTIAL_NEW_POLYGON:4.5,PARTIAL_NEW_LINE:5,isPartial:t=>t>=MAPLOCK.PARTIAL,isPartialNoNew:t=>MAPLOCK.isPartial(t)&&!Object.keys(MAPLOCK).find((e=>MAPLOCK[e]===t)).toLowerCase().includes("new")},window.LABEL_POSITIONS={0:"none",4:"left",5:"center",6:"right",2:"top",8:"bottom",10:"auto"};const MINUTE=60,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY,MONTH=30*DAY,YEAR=365*DAY;var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t){var e={exports:{}};return t(e,e.exports),e.exports
/*!
     * Materialize v1.0.0 (http://materializecss.com)
     * Copyright 2014-2017 Materialize
     * MIT License (https://raw.githubusercontent.com/Dogfalo/materialize/master/LICENSE)
     */}function create_fragment$z(t){let e,i;const n=t[1].default,o=create_slot(n,t,t[0],null);return{c(){e=element("div"),o&&o.c(),attr(e,"class","preload_box svelte-6l4gii")},m(t,n){insert(t,e,n),o&&o.m(e,null),i=!0},p(t,[e]){o&&o.p&&(!i||1&e)&&update_slot_base(o,n,t,t[0],i?get_slot_changes(n,t[0],e,null):get_all_dirty_from_scope(t[0]),null)},i(t){i||(transition_in(o,t),i=!0)},o(t){transition_out(o,t),i=!1},d(t){t&&detach(e),o&&o.d(t)}}}function instance$x(t,e,i){let{$$slots:n={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&i(0,o=t.$$scope)},[o,n]}createCommonjsModule((function(t,e){var i=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(n):void 0},n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}
/*! cash-dom 1.3.5, https://github.com/kenwheeler/cash @license MIT */window.cash=function(){var t,e=document,i=window,n=Array.prototype,o=n.slice,s=n.filter,r=n.push,a=function(){},l=function(t){return typeof t==typeof a&&t.call},c=function(t){return"string"==typeof t},h=/^#[\w-]*$/,u=/^\.[\w-]*$/,d=/<.+>/,p=/^\w+$/;function _(t,i){return i=i||e,u.test(t)?i.getElementsByClassName(t.slice(1)):p.test(t)?i.getElementsByTagName(t):i.querySelectorAll(t)}function m(i){if(!t){var n=(t=e.implementation.createHTMLDocument(null)).createElement("base");n.href=e.location.href,t.head.appendChild(n)}return t.body.innerHTML=i,t.body.childNodes}function f(t){"loading"!==e.readyState?t():e.addEventListener("DOMContentLoaded",t)}function g(t,n){if(!t)return this;if(t.cash&&t!==i)return t;var o,s=t,r=0;if(c(t))s=h.test(t)?e.getElementById(t.slice(1)):d.test(t)?m(t):_(t,n);else if(l(t))return f(t),this;if(!s)return this;if(s.nodeType||s===i)this[0]=s,this.length=1;else for(o=this.length=s.length;r<o;r++)this[r]=s[r];return this}function y(t,e){return new g(t,e)}var v=y.fn=y.prototype=g.prototype={cash:!0,length:0,push:r,splice:n.splice,map:n.map,init:g};function b(t,e){for(var i=t.length,n=0;n<i&&!1!==e.call(t[n],t[n],n,t);n++);}function k(t,e){var i=t&&(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector);return!!i&&i.call(t,e)}function w(t){return c(t)?k:t.cash?function(e){return t.is(e)}:function(t,e){return t===e}}function L(t){return y(o.call(t).filter((function(t,e,i){return i.indexOf(t)===e})))}Object.defineProperty(v,"constructor",{value:y}),y.parseHTML=m,y.noop=a,y.isFunction=l,y.isString=c,y.extend=v.extend=function(t){t=t||{};var e=o.call(arguments),i=e.length,n=1;for(1===e.length&&(t=this,n=0);n<i;n++)if(e[n])for(var s in e[n])e[n].hasOwnProperty(s)&&(t[s]=e[n][s]);return t},y.extend({merge:function(t,e){for(var i=+e.length,n=t.length,o=0;o<i;n++,o++)t[n]=e[o];return t.length=n,t},each:b,matches:k,unique:L,isArray:Array.isArray,isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}});var x=y.uid="_cash"+Date.now();function $(t){return t[x]=t[x]||{}}function C(t,e,i){return $(t)[e]=i}function M(t,e){var i=$(t);return void 0===i[e]&&(i[e]=t.dataset?t.dataset[e]:y(t).attr("data-"+e)),i[e]}function E(t,e){var i=$(t);i?delete i[e]:t.dataset?delete t.dataset[e]:y(t).removeAttr("data-"+name)}v.extend({data:function(t,e){if(c(t))return void 0===e?M(this[0],t):this.each((function(i){return C(i,t,e)}));for(var i in t)this.data(i,t[i]);return this},removeData:function(t){return this.each((function(e){return E(e,t)}))}});var T=/\S+/g;function P(t){return c(t)&&t.match(T)}function S(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}function O(t,e,i){t.classList?t.classList.add(e):i.indexOf(" "+e+" ")&&(t.className+=" "+e)}function D(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(e,"")}v.extend({addClass:function(t){var e=P(t);return e?this.each((function(t){var i=" "+t.className+" ";b(e,(function(e){O(t,e,i)}))})):this},attr:function(t,e){if(t){if(c(t))return void 0===e?this[0]?this[0].getAttribute?this[0].getAttribute(t):this[0][t]:void 0:this.each((function(i){i.setAttribute?i.setAttribute(t,e):i[t]=e}));for(var i in t)this.attr(i,t[i]);return this}},hasClass:function(t){var e=!1,i=P(t);return i&&i.length&&this.each((function(t){return!(e=S(t,i[0]))})),e},prop:function(t,e){if(c(t))return void 0===e?this[0][t]:this.each((function(i){i[t]=e}));for(var i in t)this.prop(i,t[i]);return this},removeAttr:function(t){return this.each((function(e){e.removeAttribute?e.removeAttribute(t):delete e[t]}))},removeClass:function(t){if(!arguments.length)return this.attr("class","");var e=P(t);return e?this.each((function(t){b(e,(function(e){D(t,e)}))})):this},removeProp:function(t){return this.each((function(e){delete e[t]}))},toggleClass:function(t,e){if(void 0!==e)return this[e?"addClass":"removeClass"](t);var i=P(t);return i?this.each((function(t){var e=" "+t.className+" ";b(i,(function(i){S(t,i)?D(t,i):O(t,i,e)}))})):this}}),v.extend({add:function(t,e){return L(y.merge(this,y(t,e)))},each:function(t){return b(this,t),this},eq:function(t){return y(this.get(t))},filter:function(t){if(!t)return this;var e=l(t)?t:w(t);return y(s.call(this,(function(i){return e(i,t)})))},first:function(){return this.eq(0)},get:function(t){return void 0===t?o.call(this):t<0?this[t+this.length]:this[t]},index:function(t){var e=t?y(t)[0]:this[0],i=t?this:y(e).parent().children();return o.call(i).indexOf(e)},last:function(){return this.eq(-1)}});var I,B,R=(I=/(?:^\w|[A-Z]|\b\w)/g,B=/[\s-_]+/g,function(t){return t.replace(I,(function(t,e){return t[0===e?"toLowerCase":"toUpperCase"]()})).replace(B,"")}),A=function(){var t={},e=document.createElement("div").style;return function(i){if(i=R(i),t[i])return t[i];var n=i.charAt(0).toUpperCase()+i.slice(1);return b((i+" "+["webkit","moz","ms","o"].join(n+" ")+n).split(" "),(function(n){if(n in e)return t[n]=i=t[i]=n,!1})),t[i]}}();function N(t,e){return parseInt(i.getComputedStyle(t[0],null)[e],10)||0}function z(t,e,i){var n=M(t,"_cashEvents")||C(t,"_cashEvents",{});n[e]=n[e]||[],n[e].push(i),t.addEventListener(e,i)}function j(t,e,i){var n,o=M(t,"_cashEvents"),s=o&&o[e];s&&(i?(t.removeEventListener(e,i),(n=s.indexOf(i))>=0&&s.splice(n,1)):(b(s,(function(i){t.removeEventListener(e,i)})),s=[]))}function F(t,e){return"&"+encodeURIComponent(t)+"="+encodeURIComponent(e).replace(/%20/g,"+")}function W(t){var e=[];return b(t.options,(function(t){t.selected&&e.push(t.value)})),e.length?e:null}function G(t){var e=t.selectedIndex;return e>=0?t.options[e].value:null}function H(t){var e=t.type;if(!e)return null;switch(e.toLowerCase()){case"select-one":return G(t);case"select-multiple":return W(t);case"radio":case"checkbox":return t.checked?t.value:null;default:return t.value?t.value:null}}function Z(t,e,i){if(i){var n=t.childNodes[0];t.insertBefore(e,n)}else t.appendChild(e)}function U(t,e,i){var n=c(e);n||!e.length?b(t,n?function(t){return t.insertAdjacentHTML(i?"afterbegin":"beforeend",e)}:function(t,n){return Z(t,0===n?e:e.cloneNode(!0),i)}):b(e,(function(e){return U(t,e,i)}))}y.prefixedProp=A,y.camelCase=R,v.extend({css:function(t,e){if(c(t))return t=A(t),arguments.length>1?this.each((function(i){return i.style[t]=e})):i.getComputedStyle(this[0])[t];for(var n in t)this.css(n,t[n]);return this}}),b(["Width","Height"],(function(t){var e=t.toLowerCase();v[e]=function(){return this[0].getBoundingClientRect()[e]},v["inner"+t]=function(){return this[0]["client"+t]},v["outer"+t]=function(e){return this[0]["offset"+t]+(e?N(this,"margin"+("Width"===t?"Left":"Top"))+N(this,"margin"+("Width"===t?"Right":"Bottom")):0)}})),v.extend({off:function(t,e){return this.each((function(i){return j(i,t,e)}))},on:function(t,e,i,n){var o;if(!c(t)){for(var s in t)this.on(s,e,t[s]);return this}return l(e)&&(i=e,e=null),"ready"===t?(f(i),this):(e&&(o=i,i=function(t){for(var i=t.target;!k(i,e);){if(i===this||null===i)return!1;i=i.parentNode}i&&o.call(i,t)}),this.each((function(e){var o=i;n&&(o=function(){i.apply(this,arguments),j(e,t,o)}),z(e,t,o)})))},one:function(t,e,i){return this.on(t,e,i,!0)},ready:f,trigger:function(t,e){if(document.createEvent){var i=document.createEvent("HTMLEvents");return i.initEvent(t,!0,!1),i=this.extend(i,e),this.each((function(t){return t.dispatchEvent(i)}))}}}),v.extend({serialize:function(){var t="";return b(this[0].elements||this,(function(e){if(!e.disabled&&"FIELDSET"!==e.tagName){var i=e.name;switch(e.type.toLowerCase()){case"file":case"reset":case"submit":case"button":break;case"select-multiple":var n=H(e);null!==n&&b(n,(function(e){t+=F(i,e)}));break;default:var o=H(e);null!==o&&(t+=F(i,o))}}})),t.substr(1)},val:function(t){return void 0===t?H(this[0]):this.each((function(e){return e.value=t}))}}),v.extend({after:function(t){return y(t).insertAfter(this),this},append:function(t){return U(this,t),this},appendTo:function(t){return U(y(t),this),this},before:function(t){return y(t).insertBefore(this),this},clone:function(){return y(this.map((function(t){return t.cloneNode(!0)})))},empty:function(){return this.html(""),this},html:function(t){if(void 0===t)return this[0].innerHTML;var e=t.nodeType?t[0].outerHTML:t;return this.each((function(t){return t.innerHTML=e}))},insertAfter:function(t){var e=this;return y(t).each((function(t,i){var n=t.parentNode,o=t.nextSibling;e.each((function(t){n.insertBefore(0===i?t:t.cloneNode(!0),o)}))})),this},insertBefore:function(t){var e=this;return y(t).each((function(t,i){var n=t.parentNode;e.each((function(e){n.insertBefore(0===i?e:e.cloneNode(!0),t)}))})),this},prepend:function(t){return U(this,t,!0),this},prependTo:function(t){return U(y(t),this,!0),this},remove:function(){return this.each((function(t){if(t.parentNode)return t.parentNode.removeChild(t)}))},text:function(t){return void 0===t?this[0].textContent:this.each((function(e){return e.textContent=t}))}});var q=e.documentElement;return v.extend({position:function(){var t=this[0];return{left:t.offsetLeft,top:t.offsetTop}},offset:function(){var t=this[0].getBoundingClientRect();return{top:t.top+i.pageYOffset-q.clientTop,left:t.left+i.pageXOffset-q.clientLeft}},offsetParent:function(){return y(this[0].offsetParent)}}),v.extend({children:function(t){var e=[];return this.each((function(t){r.apply(e,t.children)})),e=L(e),t?e.filter((function(e){return k(e,t)})):e},closest:function(t){return!t||this.length<1?y():this.is(t)?this.filter(t):this.parent().closest(t)},is:function(t){if(!t)return!1;var e=!1,i=w(t);return this.each((function(n){return!(e=i(n,t))})),e},find:function(t){if(!t||t.nodeType)return y(t&&this.has(t).length?t:null);var e=[];return this.each((function(i){r.apply(e,_(t,i))})),L(e)},has:function(t){var e=c(t)?function(e){return 0!==_(t,e).length}:function(e){return e.contains(t)};return this.filter(e)},next:function(){return y(this[0].nextElementSibling)},not:function(t){if(!t)return this;var e=w(t);return this.filter((function(i){return!e(i,t)}))},parent:function(){var t=[];return this.each((function(e){e&&e.parentNode&&t.push(e.parentNode)})),L(t)},parents:function(t){var i,n=[];return this.each((function(o){for(i=o;i&&i.parentNode&&i!==e.body.parentNode;)i=i.parentNode,(!t||t&&k(i,t))&&n.push(i)})),L(n)},prev:function(){return y(this[0].previousElementSibling)},siblings:function(t){var e=this.parent().children(t),i=this[0];return e.filter((function(t){return t!==i}))}}),y}();var a=function(){function t(e,i,n){r(this,t),i instanceof Element||console.error(Error(i+" is not an HTML Element"));var o=e.getInstance(i);o&&o.destroy(),this.el=i,this.$el=cash(i)}return n(t,null,[{key:"init",value:function(t,e,i){var n=null;if(e instanceof Element)n=new t(e,i);else if(e&&(e.jquery||e.cash||e instanceof NodeList)){for(var o=[],s=0;s<e.length;s++)o.push(new t(e[s],i));n=o}return n}}]),t}();!function(t){t.Package?M={}:t.M={},M.jQueryLoaded=!!t.jQuery}(window),e.nodeType||(!t.nodeType&&t.exports&&(e=t.exports=M),e.default=M),M.version="1.0.0",M.keys={TAB:9,ENTER:13,ESC:27,ARROW_UP:38,ARROW_DOWN:40},M.tabPressed=!1,M.keyDown=!1;document.addEventListener("keydown",(function(t){M.keyDown=!0,t.which!==M.keys.TAB&&t.which!==M.keys.ARROW_DOWN&&t.which!==M.keys.ARROW_UP||(M.tabPressed=!0)}),!0),document.addEventListener("keyup",(function(t){M.keyDown=!1,t.which!==M.keys.TAB&&t.which!==M.keys.ARROW_DOWN&&t.which!==M.keys.ARROW_UP||(M.tabPressed=!1)}),!0),document.addEventListener("focus",(function(t){M.keyDown&&document.body.classList.add("keyboard-focused")}),!0),document.addEventListener("blur",(function(t){document.body.classList.remove("keyboard-focused")}),!0),M.initializeJqueryWrapper=function(t,e,i){jQuery.fn[e]=function(n){if(t.prototype[n]){var o=Array.prototype.slice.call(arguments,1);if("get"===n.slice(0,3)){var s=this.first()[0][i];return s[n].apply(s,o)}return this.each((function(){var t=this[i];t[n].apply(t,o)}))}if("object"==typeof n||!n)return t.init(this,arguments[0]),this;jQuery.error("Method "+n+" does not exist on jQuery."+e)}},M.AutoInit=function(t){var e=t||document.body,i={Autocomplete:e.querySelectorAll(".autocomplete:not(.no-autoinit)"),Carousel:e.querySelectorAll(".carousel:not(.no-autoinit)"),Chips:e.querySelectorAll(".chips:not(.no-autoinit)"),Collapsible:e.querySelectorAll(".collapsible:not(.no-autoinit)"),Datepicker:e.querySelectorAll(".datepicker:not(.no-autoinit)"),Dropdown:e.querySelectorAll(".dropdown-trigger:not(.no-autoinit)"),Materialbox:e.querySelectorAll(".materialboxed:not(.no-autoinit)"),Modal:e.querySelectorAll(".modal:not(.no-autoinit)"),Parallax:e.querySelectorAll(".parallax:not(.no-autoinit)"),Pushpin:e.querySelectorAll(".pushpin:not(.no-autoinit)"),ScrollSpy:e.querySelectorAll(".scrollspy:not(.no-autoinit)"),FormSelect:e.querySelectorAll("select:not(.no-autoinit)"),Sidenav:e.querySelectorAll(".sidenav:not(.no-autoinit)"),Tabs:e.querySelectorAll(".tabs:not(.no-autoinit)"),TapTarget:e.querySelectorAll(".tap-target:not(.no-autoinit)"),Timepicker:e.querySelectorAll(".timepicker:not(.no-autoinit)"),Tooltip:e.querySelectorAll(".tooltipped:not(.no-autoinit)"),FloatingActionButton:e.querySelectorAll(".fixed-action-btn:not(.no-autoinit)")};for(var n in i){M[n].init(i[n])}},M.objectSelectorString=function(t){return((t.prop("tagName")||"")+(t.attr("id")||"")+(t.attr("class")||"")).replace(/\s/g,"")},M.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(),M.escapeHash=function(t){return t.replace(/(:|\.|\[|\]|,|=|\/)/g,"\\$1")},M.elementOrParentIsFixed=function(t){var e=$(t),i=e.add(e.parents()),n=!1;return i.each((function(){if("fixed"===$(this).css("position"))return n=!0,!1})),n},M.checkWithinContainer=function(t,e,i){var n={top:!1,right:!1,bottom:!1,left:!1},o=t.getBoundingClientRect(),s=t===document.body?Math.max(o.bottom,window.innerHeight):o.bottom,r=t.scrollLeft,a=t.scrollTop,l=e.left-r,c=e.top-a;return(l<o.left+i||l<i)&&(n.left=!0),(l+e.width>o.right-i||l+e.width>window.innerWidth-i)&&(n.right=!0),(c<o.top+i||c<i)&&(n.top=!0),(c+e.height>s-i||c+e.height>window.innerHeight-i)&&(n.bottom=!0),n},M.checkPossibleAlignments=function(t,e,i,n){var o={top:!0,right:!0,bottom:!0,left:!0,spaceOnTop:null,spaceOnRight:null,spaceOnBottom:null,spaceOnLeft:null},s="visible"===getComputedStyle(e).overflow,r=e.getBoundingClientRect(),a=Math.min(r.height,window.innerHeight),l=Math.min(r.width,window.innerWidth),c=t.getBoundingClientRect(),h=e.scrollLeft,u=e.scrollTop,d=i.left-h,p=i.top-u,_=i.top+c.height-u;return o.spaceOnRight=s?window.innerWidth-(c.left+i.width):l-(d+i.width),o.spaceOnRight<0&&(o.left=!1),o.spaceOnLeft=s?c.right-i.width:d-i.width+c.width,o.spaceOnLeft<0&&(o.right=!1),o.spaceOnBottom=s?window.innerHeight-(c.top+i.height+n):a-(p+i.height+n),o.spaceOnBottom<0&&(o.top=!1),o.spaceOnTop=s?c.bottom-(i.height+n):_-(i.height-n),o.spaceOnTop<0&&(o.bottom=!1),o},M.getOverflowParent=function(t){return null==t?null:t===document.body||"visible"!==getComputedStyle(t).overflow?t:M.getOverflowParent(t.parentElement)},M.getIdFromTrigger=function(t){var e=t.getAttribute("data-target");return e||(e=(e=t.getAttribute("href"))?e.slice(1):""),e},M.getDocumentScrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},M.getDocumentScrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0};
/**
     * Get time in ms
     * @license https://raw.github.com/jashkenas/underscore/master/LICENSE
     * @type {function}
     * @return {number}
     */
var l=Date.now||function(){return(new Date).getTime()};
/**
     * Returns a function, that, when invoked, will only be triggered at most once
     * during a given window of time. Normally, the throttled function will run
     * as much as it can, without ever going more than once per `wait` duration;
     * but if you'd like to disable the execution on the leading edge, pass
     * `{leading: false}`. To disable execution on the trailing edge, ditto.
     * @license https://raw.github.com/jashkenas/underscore/master/LICENSE
     * @param {function} func
     * @param {number} wait
     * @param {Object=} options
     * @returns {Function}
     */M.throttle=function(t,e,i){var n=void 0,o=void 0,s=void 0,r=null,a=0;i||(i={});var c=function(){a=!1===i.leading?0:l(),r=null,s=t.apply(n,o),n=o=null};return function(){var h=l();a||!1!==i.leading||(a=h);var u=e-(h-a);return n=this,o=arguments,u<=0?(clearTimeout(r),r=null,a=h,s=t.apply(n,o),n=o=null):r||!1===i.trailing||(r=setTimeout(c,u)),s}};var c={scope:{}};c.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){if(i.get||i.set)throw new TypeError("ES3 does not support getters and setters.");t!=Array.prototype&&t!=Object.prototype&&(t[e]=i.value)},c.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:void 0!==commonjsGlobal&&null!=commonjsGlobal?commonjsGlobal:t},c.global=c.getGlobal(commonjsGlobal),c.SYMBOL_PREFIX="jscomp_symbol_",c.initSymbol=function(){c.initSymbol=function(){},c.global.Symbol||(c.global.Symbol=c.Symbol)},c.symbolCounter_=0,c.Symbol=function(t){return c.SYMBOL_PREFIX+(t||"")+c.symbolCounter_++},c.initSymbolIterator=function(){c.initSymbol();var t=c.global.Symbol.iterator;t||(t=c.global.Symbol.iterator=c.global.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&c.defineProperty(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return c.arrayIterator(this)}}),c.initSymbolIterator=function(){}},c.arrayIterator=function(t){var e=0;return c.iteratorPrototype((function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}))},c.iteratorPrototype=function(t){return c.initSymbolIterator(),(t={next:t})[c.global.Symbol.iterator]=function(){return this},t},c.array=c.array||{},c.iteratorFromArray=function(t,e){c.initSymbolIterator(),t instanceof String&&(t+="");var i=0,n={next:function(){if(i<t.length){var o=i++;return{value:e(o,t[o]),done:!1}}return n.next=function(){return{done:!0,value:void 0}},n.next()}};return n[Symbol.iterator]=function(){return n},n},c.polyfill=function(t,e,i,n){if(e){for(i=c.global,t=t.split("."),n=0;n<t.length-1;n++){var o=t[n];o in i||(i[o]={}),i=i[o]}(e=e(n=i[t=t[t.length-1]]))!=n&&null!=e&&c.defineProperty(i,t,{configurable:!0,writable:!0,value:e})}},c.polyfill("Array.prototype.keys",(function(t){return t||function(){return c.iteratorFromArray(this,(function(t){return t}))}}),"es6-impl","es3");var h=commonjsGlobal;M.anime=function(){function t(t){if(!N.col(t))try{return document.querySelectorAll(t)}catch(t){}}function e(t,e){for(var i=t.length,n=2<=arguments.length?arguments[1]:void 0,o=[],s=0;s<i;s++)if(s in t){var r=t[s];e.call(n,r,s,t)&&o.push(r)}return o}function i(t){return t.reduce((function(t,e){return t.concat(N.arr(e)?i(e):e)}),[])}function n(e){return N.arr(e)?e:(N.str(e)&&(e=t(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function o(t,e){return t.some((function(t){return t===e}))}function s(t){var e,i={};for(e in t)i[e]=t[e];return i}function r(t,e){var i,n=s(t);for(i in t)n[i]=e.hasOwnProperty(i)?e[i]:t[i];return n}function a(t,e){var i,n=s(t);for(i in e)n[i]=N.und(t[i])?e[i]:t[i];return n}function l(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,i,n){return e+e+i+i+n+n}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+(t=parseInt(e[1],16))+","+parseInt(e[2],16)+","+(e=parseInt(e[3],16))+",1)"}function c(t){function e(t,e,i){return 0>i&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:.5>i?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var i=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t);t=parseInt(i[1])/360;var n=parseInt(i[2])/100,o=parseInt(i[3])/100;if(i=i[4]||1,0==n)o=n=t=o;else{var s=.5>o?o*(1+n):o+n-o*n,r=2*o-s;o=e(r,s,t+1/3),n=e(r,s,t),t=e(r,s,t-1/3)}return"rgba("+255*o+","+255*n+","+255*t+","+i+")"}function u(t){if(t=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t))return t[2]}function d(t){return-1<t.indexOf("translate")||"perspective"===t?"px":-1<t.indexOf("rotate")||-1<t.indexOf("skew")?"deg":void 0}function p(t,e){return N.fnc(t)?t(e.target,e.id,e.total):t}function _(t,e){if(e in t.style)return getComputedStyle(t).getPropertyValue(e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())||"0"}function m(t,e){return N.dom(t)&&o(A,e)?"transform":N.dom(t)&&(t.getAttribute(e)||N.svg(t)&&t[e])?"attribute":N.dom(t)&&"transform"!==e&&_(t,e)?"css":null!=t[e]?"object":void 0}function f(t,i){var n=d(i);if(n=-1<i.indexOf("scale")?1:0+n,!(t=t.style.transform))return n;for(var o=[],s=[],r=[],a=/(\w+)\((.+?)\)/g;o=a.exec(t);)s.push(o[1]),r.push(o[2]);return t=e(r,(function(t,e){return s[e]===i})),t.length?t[0]:n}function g(t,e){switch(m(t,e)){case"transform":return f(t,e);case"css":return _(t,e);case"attribute":return t.getAttribute(e)}return t[e]||0}function y(t,e){var i=/^(\*=|\+=|-=)/.exec(t);if(!i)return t;var n=u(t)||0;switch(e=parseFloat(e),t=parseFloat(t.replace(i[0],"")),i[0][0]){case"+":return e+t+n;case"-":return e-t+n;case"*":return e*t+n}}function v(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function b(t){t=t.points;for(var e,i=0,n=0;n<t.numberOfItems;n++){var o=t.getItem(n);0<n&&(i+=v(e,o)),e=o}return i}function k(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return 2*Math.PI*t.getAttribute("r");case"rect":return 2*t.getAttribute("width")+2*t.getAttribute("height");case"line":return v({x:t.getAttribute("x1"),y:t.getAttribute("y1")},{x:t.getAttribute("x2"),y:t.getAttribute("y2")});case"polyline":return b(t);case"polygon":var e=t.points;return b(t)+v(e.getItem(e.numberOfItems-1),e.getItem(0))}}function w(t,e){function i(i){return i=void 0===i?0:i,t.el.getPointAtLength(1<=e+i?e+i:0)}var n=i(),o=i(-1),s=i(1);switch(t.property){case"x":return n.x;case"y":return n.y;case"angle":return 180*Math.atan2(s.y-o.y,s.x-o.x)/Math.PI}}function L(t,e){var i,n=/-?\d*\.?\d+/g;if(i=N.pth(t)?t.totalLength:t,N.col(i))if(N.rgb(i)){var o=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(i);i=o?"rgba("+o[1]+",1)":i}else i=N.hex(i)?l(i):N.hsl(i)?c(i):void 0;else o=(o=u(i))?i.substr(0,i.length-o.length):i,i=e&&!/\s/g.test(i)?o+e:o;return{original:i+="",numbers:i.match(n)?i.match(n).map(Number):[0],strings:N.str(t)||e?i.split(n):[]}}function x(t){return e(t=t?i(N.arr(t)?t.map(n):n(t)):[],(function(t,e,i){return i.indexOf(t)===e}))}function $(t){var e=x(t);return e.map((function(t,i){return{target:t,id:i,total:e.length}}))}function C(t,e){var i=s(e);if(N.arr(t)){var o=t.length;2!==o||N.obj(t[0])?N.fnc(e.duration)||(i.duration=e.duration/o):t={value:t}}return n(t).map((function(t,i){return i=i?0:e.delay,t=N.obj(t)&&!N.pth(t)?t:{value:t},N.und(t.delay)&&(t.delay=i),t})).map((function(t){return a(t,i)}))}function M(t,e){var i,n={};for(i in t){var o=p(t[i],e);N.arr(o)&&(o=o.map((function(t){return p(t,e)})),1===o.length&&(o=o[0])),n[i]=o}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}function E(t){return N.arr(t)?z.apply(this,t):j[t]}function T(t,e){var i;return t.tweens.map((function(n){var o=(n=M(n,e)).value,s=g(e.target,t.name),r=i?i.to.original:s,a=(r=N.arr(o)?o[0]:r,y(N.arr(o)?o[1]:o,r));return s=u(a)||u(r)||u(s),n.from=L(r,s),n.to=L(a,s),n.start=i?i.end:t.offset,n.end=n.start+n.delay+n.duration,n.easing=E(n.easing),n.elasticity=(1e3-Math.min(Math.max(n.elasticity,1),999))/1e3,n.isPath=N.pth(o),n.isColor=N.col(n.from.original),n.isColor&&(n.round=1),i=n}))}function P(t,n){return e(i(t.map((function(t){return n.map((function(e){var i=m(t.target,e.name);if(i){var n=T(e,t);e={type:i,property:e.name,animatable:t,tweens:n,duration:n[n.length-1].end,delay:n[0].delay}}else e=void 0;return e}))}))),(function(t){return!N.und(t)}))}function S(t,e,i,n){var o="delay"===t;return e.length?(o?Math.min:Math.max).apply(Math,e.map((function(e){return e[t]}))):o?n.delay:i.offset+n.delay+n.duration}function O(t){var e,i=r(B,t),n=r(R,t),o=$(t.targets),s=[],l=a(i,n);for(e in t)l.hasOwnProperty(e)||"targets"===e||s.push({name:e,offset:l.offset,tweens:C(t[e],n)});return a(i,{children:[],animatables:o,animations:t=P(o,s),duration:S("duration",t,i,n),delay:S("delay",t,i,n)})}function D(t){function i(){return window.Promise&&new Promise((function(t){return u=t}))}function n(t){return p.reversed?p.duration-t:t}function o(t){for(var i=0,n={},o=p.animations,s=o.length;i<s;){var r=o[i],a=r.animatable,l=(c=r.tweens)[d=c.length-1];d&&(l=e(c,(function(e){return t<e.end}))[0]||l);for(var c=Math.min(Math.max(t-l.start-l.delay,0),l.duration)/l.duration,h=isNaN(c)?1:l.easing(c,l.elasticity),u=(c=l.to.strings,l.round),d=[],m=void 0,f=(m=l.to.numbers.length,0);f<m;f++){var g=void 0,y=(g=l.to.numbers[f],l.from.numbers[f]);g=l.isPath?w(l.value,h*g):y+h*(g-y),u&&(l.isColor&&2<f||(g=Math.round(g*u)/u)),d.push(g)}if(l=c.length)for(m=c[0],h=0;h<l;h++)u=c[h+1],f=d[h],isNaN(f)||(m=u?m+(f+u):m+(f+" "));else m=d[0];F[r.type](a.target,r.property,m,n,a.id),r.currentValue=m,i++}if(i=Object.keys(n).length)for(o=0;o<i;o++)I||(I=_(document.body,"transform")?"transform":"-webkit-transform"),p.animatables[o].target.style[I]=n[o].join(" ");p.currentTime=t,p.progress=t/p.duration*100}function s(t){p[t]&&p[t](p)}function r(){p.remaining&&!0!==p.remaining&&p.remaining--}function a(t){var e=p.duration,a=p.offset,_=a+p.delay,m=p.currentTime,f=p.reversed,g=n(t);if(p.children.length){var y=p.children,v=y.length;if(g>=p.currentTime)for(var b=0;b<v;b++)y[b].seek(g);else for(;v--;)y[v].seek(g)}(g>=_||!e)&&(p.began||(p.began=!0,s("begin")),s("run")),g>a&&g<e?o(g):(g<=a&&0!==m&&(o(0),f&&r()),(g>=e&&m!==e||!e)&&(o(e),f||r())),s("update"),t>=e&&(p.remaining?(c=l,"alternate"===p.direction&&(p.reversed=!p.reversed)):(p.pause(),p.completed||(p.completed=!0,s("complete"),"Promise"in window&&(u(),d=i()))),h=0)}t=void 0===t?{}:t;var l,c,h=0,u=null,d=i(),p=O(t);return p.reset=function(){var t=p.direction,e=p.loop;for(p.currentTime=0,p.progress=0,p.paused=!0,p.began=!1,p.completed=!1,p.reversed="reverse"===t,p.remaining="alternate"===t&&1===e?2:e,o(0),t=p.children.length;t--;)p.children[t].reset()},p.tick=function(t){l=t,c||(c=l),a((h+l-c)*D.speed)},p.seek=function(t){a(n(t))},p.pause=function(){var t=W.indexOf(p);-1<t&&W.splice(t,1),p.paused=!0},p.play=function(){p.paused&&(p.paused=!1,c=0,h=n(p.currentTime),W.push(p),G||H())},p.reverse=function(){p.reversed=!p.reversed,c=0,h=n(p.currentTime)},p.restart=function(){p.pause(),p.reset(),p.play()},p.finished=d,p.reset(),p.autoplay&&p.play(),p}var I,B={update:void 0,begin:void 0,run:void 0,complete:void 0,loop:1,direction:"normal",autoplay:!0,offset:0},R={duration:1e3,delay:0,easing:"easeOutElastic",elasticity:500,round:0},A="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY perspective".split(" "),N={arr:function(t){return Array.isArray(t)},obj:function(t){return-1<Object.prototype.toString.call(t).indexOf("Object")},pth:function(t){return N.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},dom:function(t){return t.nodeType||N.svg(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return N.hex(t)||N.rgb(t)||N.hsl(t)}},z=function(){function t(t,e,i){return(((1-3*i+3*e)*t+(3*i-6*e))*t+3*e)*t}return function(e,i,n,o){if(0<=e&&1>=e&&0<=n&&1>=n){var s=new Float32Array(11);if(e!==i||n!==o)for(var r=0;11>r;++r)s[r]=t(.1*r,e,n);return function(r){if(e===i&&n===o)return r;if(0===r)return 0;if(1===r)return 1;for(var a=0,l=1;10!==l&&s[l]<=r;++l)a+=.1;--l,l=a+(r-s[l])/(s[l+1]-s[l])*.1;var c=3*(1-3*n+3*e)*l*l+2*(3*n-6*e)*l+3*e;if(.001<=c){for(a=0;4>a&&0!=(c=3*(1-3*n+3*e)*l*l+2*(3*n-6*e)*l+3*e);++a){var h=t(l,e,n)-r;l-=h/c}r=l}else if(0===c)r=l;else{l=a,a+=.1;var u=0;do{0<(c=t(h=l+(a-l)/2,e,n)-r)?a=h:l=h}while(1e-7<Math.abs(c)&&10>++u);r=h}return t(r,i,o)}}}}(),j=function(){function t(t,e){return 0===t||1===t?t:-Math.pow(2,10*(t-1))*Math.sin(2*(t-1-e/(2*Math.PI)*Math.asin(1))*Math.PI/e)}var e,i="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),n={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],t],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(e,i){return 1-t(1-e,i)}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(e,i){return.5>e?t(2*e,i)/2:1-t(-2*e+2,i)/2}]},o={linear:z(.25,.25,.75,.75)},s={};for(e in n)s.type=e,n[s.type].forEach(function(t){return function(e,n){o["ease"+t.type+i[n]]=N.fnc(e)?e:z.apply(h,e)}}(s)),s={type:s.type};return o}(),F={css:function(t,e,i){return t.style[e]=i},attribute:function(t,e,i){return t.setAttribute(e,i)},object:function(t,e,i){return t[e]=i},transform:function(t,e,i,n,o){n[o]||(n[o]=[]),n[o].push(e+"("+i+")")}},W=[],G=0,H=function(){function t(){G=requestAnimationFrame(e)}function e(e){var i=W.length;if(i){for(var n=0;n<i;)W[n]&&W[n].tick(e),n++;t()}else cancelAnimationFrame(G),G=0}return t}();return D.version="2.2.0",D.speed=1,D.running=W,D.remove=function(t){t=x(t);for(var e=W.length;e--;)for(var i=W[e],n=i.animations,s=n.length;s--;)o(t,n[s].animatable.target)&&(n.splice(s,1),n.length||i.pause())},D.getValue=g,D.path=function(e,i){var n=N.str(e)?t(e)[0]:e,o=i||100;return function(t){return{el:n,property:t,totalLength:k(n)*(o/100)}}},D.setDashoffset=function(t){var e=k(t);return t.setAttribute("stroke-dasharray",e),e},D.bezier=z,D.easings=j,D.timeline=function(t){var e=D(t);return e.pause(),e.duration=0,e.add=function(i){return e.children.forEach((function(t){t.began=!0,t.completed=!0})),n(i).forEach((function(i){var n=a(i,r(R,t||{}));n.targets=n.targets||t.targets,i=e.duration;var o=n.offset;n.autoplay=!1,n.direction=e.direction,n.offset=N.und(o)?i:y(o,i),e.began=!0,e.completed=!0,e.seek(n.offset),(n=D(n)).began=!0,n.completed=!0,n.duration>i&&(e.duration=n.duration),e.children.push(n)})),e.seek(0),e.reset(),e.autoplay&&e.restart(),e},e},D.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},D}(),function(t,e){var l={accordion:!0,onOpenStart:void 0,onOpenEnd:void 0,onCloseStart:void 0,onCloseEnd:void 0,inDuration:300,outDuration:300},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));n.el.M_Collapsible=n,n.options=t.extend({},c.defaults,i),n.$headers=n.$el.children("li").children(".collapsible-header"),n.$headers.attr("tabindex",0),n._setupEventHandlers();var s=n.$el.children("li.active").children(".collapsible-body");return n.options.accordion?s.first().css("display","block"):s.css("display","block"),n}return s(c,a),n(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_Collapsible=void 0}},{key:"_setupEventHandlers",value:function(){var t=this;this._handleCollapsibleClickBound=this._handleCollapsibleClick.bind(this),this._handleCollapsibleKeydownBound=this._handleCollapsibleKeydown.bind(this),this.el.addEventListener("click",this._handleCollapsibleClickBound),this.$headers.each((function(e){e.addEventListener("keydown",t._handleCollapsibleKeydownBound)}))}},{key:"_removeEventHandlers",value:function(){var t=this;this.el.removeEventListener("click",this._handleCollapsibleClickBound),this.$headers.each((function(e){e.removeEventListener("keydown",t._handleCollapsibleKeydownBound)}))}},{key:"_handleCollapsibleClick",value:function(e){var i=t(e.target).closest(".collapsible-header");if(e.target&&i.length){var n=i.closest(".collapsible");if(n[0]===this.el){var o=i.closest("li"),s=n.children("li"),r=o[0].classList.contains("active"),a=s.index(o);r?this.close(a):this.open(a)}}}},{key:"_handleCollapsibleKeydown",value:function(t){13===t.keyCode&&this._handleCollapsibleClickBound(t)}},{key:"_animateIn",value:function(t){var i=this,n=this.$el.children("li").eq(t);if(n.length){var o=n.children(".collapsible-body");e.remove(o[0]),o.css({display:"block",overflow:"hidden",height:0,paddingTop:"",paddingBottom:""});var s=o.css("padding-top"),r=o.css("padding-bottom"),a=o[0].scrollHeight;o.css({paddingTop:0,paddingBottom:0}),e({targets:o[0],height:a,paddingTop:s,paddingBottom:r,duration:this.options.inDuration,easing:"easeInOutCubic",complete:function(t){o.css({overflow:"",paddingTop:"",paddingBottom:"",height:""}),"function"==typeof i.options.onOpenEnd&&i.options.onOpenEnd.call(i,n[0])}})}}},{key:"_animateOut",value:function(t){var i=this,n=this.$el.children("li").eq(t);if(n.length){var o=n.children(".collapsible-body");e.remove(o[0]),o.css("overflow","hidden"),e({targets:o[0],height:0,paddingTop:0,paddingBottom:0,duration:this.options.outDuration,easing:"easeInOutCubic",complete:function(){o.css({height:"",overflow:"",padding:"",display:""}),"function"==typeof i.options.onCloseEnd&&i.options.onCloseEnd.call(i,n[0])}})}}},{key:"open",value:function(e){var i=this,n=this.$el.children("li").eq(e);if(n.length&&!n[0].classList.contains("active")){if("function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,n[0]),this.options.accordion){var o=this.$el.children("li");this.$el.children("li.active").each((function(e){var n=o.index(t(e));i.close(n)}))}n[0].classList.add("active"),this._animateIn(e)}}},{key:"close",value:function(t){var e=this.$el.children("li").eq(t);e.length&&e[0].classList.contains("active")&&("function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,e[0]),e[0].classList.remove("active"),this._animateOut(t))}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Collapsible}},{key:"defaults",get:function(){return l}}]),c}(a);M.Collapsible=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"collapsible","M_Collapsible")}(cash,M.anime),function(t,e){var l={alignment:"left",autoFocus:!0,constrainWidth:!0,container:null,coverTrigger:!0,closeOnClick:!0,hover:!1,inDuration:150,outDuration:250,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,onItemClick:null},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_Dropdown=n,c._dropdowns.push(n),n.id=M.getIdFromTrigger(e),n.dropdownEl=document.getElementById(n.id),n.$dropdownEl=t(n.dropdownEl),n.options=t.extend({},c.defaults,i),n.isOpen=!1,n.isScrollable=!1,n.isTouchMoving=!1,n.focusedIndex=-1,n.filterQuery=[],n.options.container?t(n.options.container).append(n.dropdownEl):n.$el.after(n.dropdownEl),n._makeDropdownFocusable(),n._resetFilterQueryBound=n._resetFilterQuery.bind(n),n._handleDocumentClickBound=n._handleDocumentClick.bind(n),n._handleDocumentTouchmoveBound=n._handleDocumentTouchmove.bind(n),n._handleDropdownClickBound=n._handleDropdownClick.bind(n),n._handleDropdownKeydownBound=n._handleDropdownKeydown.bind(n),n._handleTriggerKeydownBound=n._handleTriggerKeydown.bind(n),n._setupEventHandlers(),n}return s(c,a),n(c,[{key:"destroy",value:function(){this._resetDropdownStyles(),this._removeEventHandlers(),c._dropdowns.splice(c._dropdowns.indexOf(this),1),this.el.M_Dropdown=void 0}},{key:"_setupEventHandlers",value:function(){this.el.addEventListener("keydown",this._handleTriggerKeydownBound),this.dropdownEl.addEventListener("click",this._handleDropdownClickBound),this.options.hover?(this._handleMouseEnterBound=this._handleMouseEnter.bind(this),this.el.addEventListener("mouseenter",this._handleMouseEnterBound),this._handleMouseLeaveBound=this._handleMouseLeave.bind(this),this.el.addEventListener("mouseleave",this._handleMouseLeaveBound),this.dropdownEl.addEventListener("mouseleave",this._handleMouseLeaveBound)):(this._handleClickBound=this._handleClick.bind(this),this.el.addEventListener("click",this._handleClickBound))}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("keydown",this._handleTriggerKeydownBound),this.dropdownEl.removeEventListener("click",this._handleDropdownClickBound),this.options.hover?(this.el.removeEventListener("mouseenter",this._handleMouseEnterBound),this.el.removeEventListener("mouseleave",this._handleMouseLeaveBound),this.dropdownEl.removeEventListener("mouseleave",this._handleMouseLeaveBound)):this.el.removeEventListener("click",this._handleClickBound)}},{key:"_setupTemporaryEventHandlers",value:function(){document.body.addEventListener("click",this._handleDocumentClickBound,!0),document.body.addEventListener("touchend",this._handleDocumentClickBound),document.body.addEventListener("touchmove",this._handleDocumentTouchmoveBound),this.dropdownEl.addEventListener("keydown",this._handleDropdownKeydownBound)}},{key:"_removeTemporaryEventHandlers",value:function(){document.body.removeEventListener("click",this._handleDocumentClickBound,!0),document.body.removeEventListener("touchend",this._handleDocumentClickBound),document.body.removeEventListener("touchmove",this._handleDocumentTouchmoveBound),this.dropdownEl.removeEventListener("keydown",this._handleDropdownKeydownBound)}},{key:"_handleClick",value:function(t){t.preventDefault(),this.open()}},{key:"_handleMouseEnter",value:function(){this.open()}},{key:"_handleMouseLeave",value:function(e){var i=e.toElement||e.relatedTarget,n=!!t(i).closest(".dropdown-content").length,o=!1,s=t(i).closest(".dropdown-trigger");s.length&&s[0].M_Dropdown&&s[0].M_Dropdown.isOpen&&(o=!0),o||n||this.close()}},{key:"_handleDocumentClick",value:function(e){var i=this,n=t(e.target);this.options.closeOnClick&&n.closest(".dropdown-content").length&&!this.isTouchMoving?setTimeout((function(){i.close()}),0):!n.closest(".dropdown-trigger").length&&n.closest(".dropdown-content").length||setTimeout((function(){i.close()}),0),this.isTouchMoving=!1}},{key:"_handleTriggerKeydown",value:function(t){t.which!==M.keys.ARROW_DOWN&&t.which!==M.keys.ENTER||this.isOpen||(t.preventDefault(),this.open())}},{key:"_handleDocumentTouchmove",value:function(e){t(e.target).closest(".dropdown-content").length&&(this.isTouchMoving=!0)}},{key:"_handleDropdownClick",value:function(e){if("function"==typeof this.options.onItemClick){var i=t(e.target).closest("li")[0];this.options.onItemClick.call(this,i)}}},{key:"_handleDropdownKeydown",value:function(e){if(e.which===M.keys.TAB)e.preventDefault(),this.close();else if(e.which!==M.keys.ARROW_DOWN&&e.which!==M.keys.ARROW_UP||!this.isOpen)if(e.which===M.keys.ENTER&&this.isOpen){var i=this.dropdownEl.children[this.focusedIndex],n=t(i).find("a, button").first();n.length?n[0].click():i&&i.click()}else e.which===M.keys.ESC&&this.isOpen&&(e.preventDefault(),this.close());else{e.preventDefault();var o=e.which===M.keys.ARROW_DOWN?1:-1,s=this.focusedIndex,r=!1;do{if(s+=o,this.dropdownEl.children[s]&&-1!==this.dropdownEl.children[s].tabIndex){r=!0;break}}while(s<this.dropdownEl.children.length&&s>=0);r&&(this.focusedIndex=s,this._focusFocusedItem())}var a=String.fromCharCode(e.which).toLowerCase();if(a&&-1===[9,13,27,38,40].indexOf(e.which)){this.filterQuery.push(a);var l=this.filterQuery.join(""),c=t(this.dropdownEl).find("li").filter((function(e){return 0===t(e).text().toLowerCase().indexOf(l)}))[0];c&&(this.focusedIndex=t(c).index(),this._focusFocusedItem())}this.filterTimeout=setTimeout(this._resetFilterQueryBound,1e3)}},{key:"_resetFilterQuery",value:function(){this.filterQuery=[]}},{key:"_resetDropdownStyles",value:function(){this.$dropdownEl.css({display:"",width:"",height:"",left:"",top:"","transform-origin":"",transform:"",opacity:""})}},{key:"_makeDropdownFocusable",value:function(){this.dropdownEl.tabIndex=0,t(this.dropdownEl).children().each((function(t){t.getAttribute("tabindex")||t.setAttribute("tabindex",0)}))}},{key:"_focusFocusedItem",value:function(){this.focusedIndex>=0&&this.focusedIndex<this.dropdownEl.children.length&&this.options.autoFocus&&this.dropdownEl.children[this.focusedIndex].focus()}},{key:"_getDropdownPosition",value:function(){this.el.offsetParent.getBoundingClientRect();var t=this.el.getBoundingClientRect(),e=this.dropdownEl.getBoundingClientRect(),i=e.height,n=e.width,o=t.left-e.left,s=t.top-e.top,r={left:o,top:s,height:i,width:n},a=this.dropdownEl.offsetParent?this.dropdownEl.offsetParent:this.dropdownEl.parentNode,l=M.checkPossibleAlignments(this.el,a,r,this.options.coverTrigger?0:t.height),c="top",h=this.options.alignment;if(s+=this.options.coverTrigger?0:t.height,this.isScrollable=!1,l.top||(l.bottom?c="bottom":(this.isScrollable=!0,l.spaceOnTop>l.spaceOnBottom?(c="bottom",i+=l.spaceOnTop,s-=l.spaceOnTop):i+=l.spaceOnBottom)),!l[h]){var u="left"===h?"right":"left";l[u]?h=u:l.spaceOnLeft>l.spaceOnRight?(h="right",n+=l.spaceOnLeft,o-=l.spaceOnLeft):(h="left",n+=l.spaceOnRight)}return"bottom"===c&&(s=s-e.height+(this.options.coverTrigger?t.height:0)),"right"===h&&(o=o-e.width+t.width),{x:o,y:s,verticalAlignment:c,horizontalAlignment:h,height:i,width:n}}},{key:"_animateIn",value:function(){var t=this;e.remove(this.dropdownEl),e({targets:this.dropdownEl,opacity:{value:[0,1],easing:"easeOutQuad"},scaleX:[.3,1],scaleY:[.3,1],duration:this.options.inDuration,easing:"easeOutQuint",complete:function(e){t.options.autoFocus&&t.dropdownEl.focus(),"function"==typeof t.options.onOpenEnd&&t.options.onOpenEnd.call(t,t.el)}})}},{key:"_animateOut",value:function(){var t=this;e.remove(this.dropdownEl),e({targets:this.dropdownEl,opacity:{value:0,easing:"easeOutQuint"},scaleX:.3,scaleY:.3,duration:this.options.outDuration,easing:"easeOutQuint",complete:function(e){t._resetDropdownStyles(),"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t,t.el)}})}},{key:"_placeDropdown",value:function(){var t=this.options.constrainWidth?this.el.getBoundingClientRect().width:this.dropdownEl.getBoundingClientRect().width;this.dropdownEl.style.width=t+"px";var e=this._getDropdownPosition();this.dropdownEl.style.left=e.x+"px",this.dropdownEl.style.top=e.y+"px",this.dropdownEl.style.height=e.height+"px",this.dropdownEl.style.width=e.width+"px",this.dropdownEl.style.transformOrigin=("left"===e.horizontalAlignment?"0":"100%")+" "+("top"===e.verticalAlignment?"0":"100%")}},{key:"open",value:function(){this.isOpen||(this.isOpen=!0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el),this._resetDropdownStyles(),this.dropdownEl.style.display="block",this._placeDropdown(),this._animateIn(),this._setupTemporaryEventHandlers())}},{key:"close",value:function(){this.isOpen&&(this.isOpen=!1,this.focusedIndex=-1,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),this._animateOut(),this._removeTemporaryEventHandlers(),this.options.autoFocus&&this.el.focus())}},{key:"recalculateDimensions",value:function(){this.isOpen&&(this.$dropdownEl.css({width:"",height:"",left:"",top:"","transform-origin":""}),this._placeDropdown())}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Dropdown}},{key:"defaults",get:function(){return l}}]),c}(a);c._dropdowns=[],M.Dropdown=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"dropdown","M_Dropdown")}(cash,M.anime),function(t,e){var l={opacity:.5,inDuration:250,outDuration:250,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,preventScrolling:!0,dismissible:!0,startingTop:"4%",endingTop:"10%"},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_Modal=n,n.options=t.extend({},c.defaults,i),n.isOpen=!1,n.id=n.$el.attr("id"),n._openingTrigger=void 0,n.$overlay=t('<div class="modal-overlay"></div>'),n.el.tabIndex=0,n._nthModalOpened=0,c._count++,n._setupEventHandlers(),n}return s(c,a),n(c,[{key:"destroy",value:function(){c._count--,this._removeEventHandlers(),this.el.removeAttribute("style"),this.$overlay.remove(),this.el.M_Modal=void 0}},{key:"_setupEventHandlers",value:function(){this._handleOverlayClickBound=this._handleOverlayClick.bind(this),this._handleModalCloseClickBound=this._handleModalCloseClick.bind(this),1===c._count&&document.body.addEventListener("click",this._handleTriggerClick),this.$overlay[0].addEventListener("click",this._handleOverlayClickBound),this.el.addEventListener("click",this._handleModalCloseClickBound)}},{key:"_removeEventHandlers",value:function(){0===c._count&&document.body.removeEventListener("click",this._handleTriggerClick),this.$overlay[0].removeEventListener("click",this._handleOverlayClickBound),this.el.removeEventListener("click",this._handleModalCloseClickBound)}},{key:"_handleTriggerClick",value:function(e){var i=t(e.target).closest(".modal-trigger");if(i.length){var n=M.getIdFromTrigger(i[0]),o=document.getElementById(n).M_Modal;o&&o.open(i),e.preventDefault()}}},{key:"_handleOverlayClick",value:function(){this.options.dismissible&&this.close()}},{key:"_handleModalCloseClick",value:function(e){t(e.target).closest(".modal-close").length&&this.close()}},{key:"_handleKeydown",value:function(t){27===t.keyCode&&this.options.dismissible&&this.close()}},{key:"_handleFocus",value:function(t){this.el.contains(t.target)||this._nthModalOpened!==c._modalsOpen||this.el.focus()}},{key:"_animateIn",value:function(){var i=this;t.extend(this.el.style,{display:"block",opacity:0}),t.extend(this.$overlay[0].style,{display:"block",opacity:0}),e({targets:this.$overlay[0],opacity:this.options.opacity,duration:this.options.inDuration,easing:"easeOutQuad"});var n={targets:this.el,duration:this.options.inDuration,easing:"easeOutCubic",complete:function(){"function"==typeof i.options.onOpenEnd&&i.options.onOpenEnd.call(i,i.el,i._openingTrigger)}};this.el.classList.contains("bottom-sheet")?(t.extend(n,{bottom:0,opacity:1}),e(n)):(t.extend(n,{top:[this.options.startingTop,this.options.endingTop],opacity:1,scaleX:[.8,1],scaleY:[.8,1]}),e(n))}},{key:"_animateOut",value:function(){var i=this;e({targets:this.$overlay[0],opacity:0,duration:this.options.outDuration,easing:"easeOutQuart"});var n={targets:this.el,duration:this.options.outDuration,easing:"easeOutCubic",complete:function(){i.el.style.display="none",i.$overlay.remove(),"function"==typeof i.options.onCloseEnd&&i.options.onCloseEnd.call(i,i.el)}};this.el.classList.contains("bottom-sheet")?(t.extend(n,{bottom:"-100%",opacity:0}),e(n)):(t.extend(n,{top:[this.options.endingTop,this.options.startingTop],opacity:0,scaleX:.8,scaleY:.8}),e(n))}},{key:"open",value:function(t){if(!this.isOpen)return this.isOpen=!0,c._modalsOpen++,this._nthModalOpened=c._modalsOpen,this.$overlay[0].style.zIndex=1e3+2*c._modalsOpen,this.el.style.zIndex=1e3+2*c._modalsOpen+1,this._openingTrigger=t?t[0]:void 0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el,this._openingTrigger),this.options.preventScrolling&&(document.body.style.overflow="hidden"),this.el.classList.add("open"),this.el.insertAdjacentElement("afterend",this.$overlay[0]),this.options.dismissible&&(this._handleKeydownBound=this._handleKeydown.bind(this),this._handleFocusBound=this._handleFocus.bind(this),document.addEventListener("keydown",this._handleKeydownBound),document.addEventListener("focus",this._handleFocusBound,!0)),e.remove(this.el),e.remove(this.$overlay[0]),this._animateIn(),this.el.focus(),this}},{key:"close",value:function(){if(this.isOpen)return this.isOpen=!1,c._modalsOpen--,this._nthModalOpened=0,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),this.el.classList.remove("open"),0===c._modalsOpen&&(document.body.style.overflow=""),this.options.dismissible&&(document.removeEventListener("keydown",this._handleKeydownBound),document.removeEventListener("focus",this._handleFocusBound,!0)),e.remove(this.el),e.remove(this.$overlay[0]),this._animateOut(),this}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Modal}},{key:"defaults",get:function(){return l}}]),c}(a);c._modalsOpen=0,c._count=0,M.Modal=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"modal","M_Modal")}(cash,M.anime),function(t,e){var l={inDuration:275,outDuration:200,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_Materialbox=n,n.options=t.extend({},c.defaults,i),n.overlayActive=!1,n.doneAnimating=!0,n.placeholder=t("<div></div>").addClass("material-placeholder"),n.originalWidth=0,n.originalHeight=0,n.originInlineStyles=n.$el.attr("style"),n.caption=n.el.getAttribute("data-caption")||"",n.$el.before(n.placeholder),n.placeholder.append(n.$el),n._setupEventHandlers(),n}return s(c,a),n(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_Materialbox=void 0,t(this.placeholder).after(this.el).remove(),this.$el.removeAttr("style")}},{key:"_setupEventHandlers",value:function(){this._handleMaterialboxClickBound=this._handleMaterialboxClick.bind(this),this.el.addEventListener("click",this._handleMaterialboxClickBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleMaterialboxClickBound)}},{key:"_handleMaterialboxClick",value:function(t){!1===this.doneAnimating||this.overlayActive&&this.doneAnimating?this.close():this.open()}},{key:"_handleWindowScroll",value:function(){this.overlayActive&&this.close()}},{key:"_handleWindowResize",value:function(){this.overlayActive&&this.close()}},{key:"_handleWindowEscape",value:function(t){27===t.keyCode&&this.doneAnimating&&this.overlayActive&&this.close()}},{key:"_makeAncestorsOverflowVisible",value:function(){this.ancestorsChanged=t();for(var e=this.placeholder[0].parentNode;null!==e&&!t(e).is(document);){var i=t(e);"visible"!==i.css("overflow")&&(i.css("overflow","visible"),void 0===this.ancestorsChanged?this.ancestorsChanged=i:this.ancestorsChanged=this.ancestorsChanged.add(i)),e=e.parentNode}}},{key:"_animateImageIn",value:function(){var t=this,i={targets:this.el,height:[this.originalHeight,this.newHeight],width:[this.originalWidth,this.newWidth],left:M.getDocumentScrollLeft()+this.windowWidth/2-this.placeholder.offset().left-this.newWidth/2,top:M.getDocumentScrollTop()+this.windowHeight/2-this.placeholder.offset().top-this.newHeight/2,duration:this.options.inDuration,easing:"easeOutQuad",complete:function(){t.doneAnimating=!0,"function"==typeof t.options.onOpenEnd&&t.options.onOpenEnd.call(t,t.el)}};this.maxWidth=this.$el.css("max-width"),this.maxHeight=this.$el.css("max-height"),"none"!==this.maxWidth&&(i.maxWidth=this.newWidth),"none"!==this.maxHeight&&(i.maxHeight=this.newHeight),e(i)}},{key:"_animateImageOut",value:function(){var t=this,i={targets:this.el,width:this.originalWidth,height:this.originalHeight,left:0,top:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t.placeholder.css({height:"",width:"",position:"",top:"",left:""}),t.attrWidth&&t.$el.attr("width",t.attrWidth),t.attrHeight&&t.$el.attr("height",t.attrHeight),t.$el.removeAttr("style"),t.originInlineStyles&&t.$el.attr("style",t.originInlineStyles),t.$el.removeClass("active"),t.doneAnimating=!0,t.ancestorsChanged.length&&t.ancestorsChanged.css("overflow",""),"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t,t.el)}};e(i)}},{key:"_updateVars",value:function(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.caption=this.el.getAttribute("data-caption")||""}},{key:"open",value:function(){var i=this;this._updateVars(),this.originalWidth=this.el.getBoundingClientRect().width,this.originalHeight=this.el.getBoundingClientRect().height,this.doneAnimating=!1,this.$el.addClass("active"),this.overlayActive=!0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el),this.placeholder.css({width:this.placeholder[0].getBoundingClientRect().width+"px",height:this.placeholder[0].getBoundingClientRect().height+"px",position:"relative",top:0,left:0}),this._makeAncestorsOverflowVisible(),this.$el.css({position:"absolute","z-index":1e3,"will-change":"left, top, width, height"}),this.attrWidth=this.$el.attr("width"),this.attrHeight=this.$el.attr("height"),this.attrWidth&&(this.$el.css("width",this.attrWidth+"px"),this.$el.removeAttr("width")),this.attrHeight&&(this.$el.css("width",this.attrHeight+"px"),this.$el.removeAttr("height")),this.$overlay=t('<div id="materialbox-overlay"></div>').css({opacity:0}).one("click",(function(){i.doneAnimating&&i.close()})),this.$el.before(this.$overlay);var n=this.$overlay[0].getBoundingClientRect();this.$overlay.css({width:this.windowWidth+"px",height:this.windowHeight+"px",left:-1*n.left+"px",top:-1*n.top+"px"}),e.remove(this.el),e.remove(this.$overlay[0]),e({targets:this.$overlay[0],opacity:1,duration:this.options.inDuration,easing:"easeOutQuad"}),""!==this.caption&&(this.$photocaption&&e.remove(this.$photoCaption[0]),this.$photoCaption=t('<div class="materialbox-caption"></div>'),this.$photoCaption.text(this.caption),t("body").append(this.$photoCaption),this.$photoCaption.css({display:"inline"}),e({targets:this.$photoCaption[0],opacity:1,duration:this.options.inDuration,easing:"easeOutQuad"}));var o=0,s=this.originalWidth/this.windowWidth,r=this.originalHeight/this.windowHeight;this.newWidth=0,this.newHeight=0,s>r?(o=this.originalHeight/this.originalWidth,this.newWidth=.9*this.windowWidth,this.newHeight=.9*this.windowWidth*o):(o=this.originalWidth/this.originalHeight,this.newWidth=.9*this.windowHeight*o,this.newHeight=.9*this.windowHeight),this._animateImageIn(),this._handleWindowScrollBound=this._handleWindowScroll.bind(this),this._handleWindowResizeBound=this._handleWindowResize.bind(this),this._handleWindowEscapeBound=this._handleWindowEscape.bind(this),window.addEventListener("scroll",this._handleWindowScrollBound),window.addEventListener("resize",this._handleWindowResizeBound),window.addEventListener("keyup",this._handleWindowEscapeBound)}},{key:"close",value:function(){var t=this;this._updateVars(),this.doneAnimating=!1,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),e.remove(this.el),e.remove(this.$overlay[0]),""!==this.caption&&e.remove(this.$photoCaption[0]),window.removeEventListener("scroll",this._handleWindowScrollBound),window.removeEventListener("resize",this._handleWindowResizeBound),window.removeEventListener("keyup",this._handleWindowEscapeBound),e({targets:this.$overlay[0],opacity:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t.overlayActive=!1,t.$overlay.remove()}}),this._animateImageOut(),""!==this.caption&&e({targets:this.$photoCaption[0],opacity:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t.$photoCaption.remove()}})}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Materialbox}},{key:"defaults",get:function(){return l}}]),c}(a);M.Materialbox=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"materialbox","M_Materialbox")}(cash,M.anime),function(t){var e={responsiveThreshold:0},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_Parallax=n,n.options=t.extend({},l.defaults,i),n._enabled=window.innerWidth>n.options.responsiveThreshold,n.$img=n.$el.find("img").first(),n.$img.each((function(){this.complete&&t(this).trigger("load")})),n._updateParallax(),n._setupEventHandlers(),n._setupStyles(),l._parallaxes.push(n),n}return s(l,a),n(l,[{key:"destroy",value:function(){l._parallaxes.splice(l._parallaxes.indexOf(this),1),this.$img[0].style.transform="",this._removeEventHandlers(),this.$el[0].M_Parallax=void 0}},{key:"_setupEventHandlers",value:function(){this._handleImageLoadBound=this._handleImageLoad.bind(this),this.$img[0].addEventListener("load",this._handleImageLoadBound),0===l._parallaxes.length&&(l._handleScrollThrottled=M.throttle(l._handleScroll,5),window.addEventListener("scroll",l._handleScrollThrottled),l._handleWindowResizeThrottled=M.throttle(l._handleWindowResize,5),window.addEventListener("resize",l._handleWindowResizeThrottled))}},{key:"_removeEventHandlers",value:function(){this.$img[0].removeEventListener("load",this._handleImageLoadBound),0===l._parallaxes.length&&(window.removeEventListener("scroll",l._handleScrollThrottled),window.removeEventListener("resize",l._handleWindowResizeThrottled))}},{key:"_setupStyles",value:function(){this.$img[0].style.opacity=1}},{key:"_handleImageLoad",value:function(){this._updateParallax()}},{key:"_updateParallax",value:function(){var t=this.$el.height()>0?this.el.parentNode.offsetHeight:500,e=this.$img[0].offsetHeight-t,i=this.$el.offset().top+t,n=this.$el.offset().top,o=M.getDocumentScrollTop(),s=window.innerHeight,r=e*((o+s-n)/(t+s));this._enabled?i>o&&n<o+s&&(this.$img[0].style.transform="translate3D(-50%, "+r+"px, 0)"):this.$img[0].style.transform=""}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Parallax}},{key:"_handleScroll",value:function(){for(var t=0;t<l._parallaxes.length;t++){var e=l._parallaxes[t];e._updateParallax.call(e)}}},{key:"_handleWindowResize",value:function(){for(var t=0;t<l._parallaxes.length;t++){var e=l._parallaxes[t];e._enabled=window.innerWidth>e.options.responsiveThreshold}}},{key:"defaults",get:function(){return e}}]),l}(a);l._parallaxes=[],M.Parallax=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"parallax","M_Parallax")}(cash),function(t,e){var l={duration:300,onShow:null,swipeable:!1,responsiveThreshold:1/0},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_Tabs=n,n.options=t.extend({},c.defaults,i),n.$tabLinks=n.$el.children("li.tab").children("a"),n.index=0,n._setupActiveTabLink(),n.options.swipeable?n._setupSwipeableTabs():n._setupNormalTabs(),n._setTabsAndTabWidth(),n._createIndicator(),n._setupEventHandlers(),n}return s(c,a),n(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this._indicator.parentNode.removeChild(this._indicator),this.options.swipeable?this._teardownSwipeableTabs():this._teardownNormalTabs(),this.$el[0].M_Tabs=void 0}},{key:"_setupEventHandlers",value:function(){this._handleWindowResizeBound=this._handleWindowResize.bind(this),window.addEventListener("resize",this._handleWindowResizeBound),this._handleTabClickBound=this._handleTabClick.bind(this),this.el.addEventListener("click",this._handleTabClickBound)}},{key:"_removeEventHandlers",value:function(){window.removeEventListener("resize",this._handleWindowResizeBound),this.el.removeEventListener("click",this._handleTabClickBound)}},{key:"_handleWindowResize",value:function(){this._setTabsAndTabWidth(),0!==this.tabWidth&&0!==this.tabsWidth&&(this._indicator.style.left=this._calcLeftPos(this.$activeTabLink)+"px",this._indicator.style.right=this._calcRightPos(this.$activeTabLink)+"px")}},{key:"_handleTabClick",value:function(e){var i=this,n=t(e.target).closest("li.tab"),o=t(e.target).closest("a");if(o.length&&o.parent().hasClass("tab"))if(n.hasClass("disabled"))e.preventDefault();else if(!o.attr("target")){this.$activeTabLink.removeClass("active");var s=this.$content;this.$activeTabLink=o,this.$content=t(M.escapeHash(o[0].hash)),this.$tabLinks=this.$el.children("li.tab").children("a"),this.$activeTabLink.addClass("active");var r=this.index;this.index=Math.max(this.$tabLinks.index(o),0),this.options.swipeable?this._tabsCarousel&&this._tabsCarousel.set(this.index,(function(){"function"==typeof i.options.onShow&&i.options.onShow.call(i,i.$content[0])})):this.$content.length&&(this.$content[0].style.display="block",this.$content.addClass("active"),"function"==typeof this.options.onShow&&this.options.onShow.call(this,this.$content[0]),s.length&&!s.is(this.$content)&&(s[0].style.display="none",s.removeClass("active"))),this._setTabsAndTabWidth(),this._animateIndicator(r),e.preventDefault()}}},{key:"_createIndicator",value:function(){var t=this,e=document.createElement("li");e.classList.add("indicator"),this.el.appendChild(e),this._indicator=e,setTimeout((function(){t._indicator.style.left=t._calcLeftPos(t.$activeTabLink)+"px",t._indicator.style.right=t._calcRightPos(t.$activeTabLink)+"px"}),0)}},{key:"_setupActiveTabLink",value:function(){this.$activeTabLink=t(this.$tabLinks.filter('[href="'+location.hash+'"]')),0===this.$activeTabLink.length&&(this.$activeTabLink=this.$el.children("li.tab").children("a.active").first()),0===this.$activeTabLink.length&&(this.$activeTabLink=this.$el.children("li.tab").children("a").first()),this.$tabLinks.removeClass("active"),this.$activeTabLink[0].classList.add("active"),this.index=Math.max(this.$tabLinks.index(this.$activeTabLink),0),this.$activeTabLink.length&&(this.$content=t(M.escapeHash(this.$activeTabLink[0].hash)),this.$content.addClass("active"))}},{key:"_setupSwipeableTabs",value:function(){var e=this;window.innerWidth>this.options.responsiveThreshold&&(this.options.swipeable=!1);var i=t();this.$tabLinks.each((function(e){var n=t(M.escapeHash(e.hash));n.addClass("carousel-item"),i=i.add(n)}));var n=t('<div class="tabs-content carousel carousel-slider"></div>');i.first().before(n),n.append(i),i[0].style.display="";var o=this.$activeTabLink.closest(".tab").index();this._tabsCarousel=M.Carousel.init(n[0],{fullWidth:!0,noWrap:!0,onCycleTo:function(i){var n=e.index;e.index=t(i).index(),e.$activeTabLink.removeClass("active"),e.$activeTabLink=e.$tabLinks.eq(e.index),e.$activeTabLink.addClass("active"),e._animateIndicator(n),"function"==typeof e.options.onShow&&e.options.onShow.call(e,e.$content[0])}}),this._tabsCarousel.set(o)}},{key:"_teardownSwipeableTabs",value:function(){var t=this._tabsCarousel.$el;this._tabsCarousel.destroy(),t.after(t.children()),t.remove()}},{key:"_setupNormalTabs",value:function(){this.$tabLinks.not(this.$activeTabLink).each((function(e){if(e.hash){var i=t(M.escapeHash(e.hash));i.length&&(i[0].style.display="none")}}))}},{key:"_teardownNormalTabs",value:function(){this.$tabLinks.each((function(e){if(e.hash){var i=t(M.escapeHash(e.hash));i.length&&(i[0].style.display="")}}))}},{key:"_setTabsAndTabWidth",value:function(){this.tabsWidth=this.$el.width(),this.tabWidth=Math.max(this.tabsWidth,this.el.scrollWidth)/this.$tabLinks.length}},{key:"_calcRightPos",value:function(t){return Math.ceil(this.tabsWidth-t.position().left-t[0].getBoundingClientRect().width)}},{key:"_calcLeftPos",value:function(t){return Math.floor(t.position().left)}},{key:"updateTabIndicator",value:function(){this._setTabsAndTabWidth(),this._animateIndicator(this.index)}},{key:"_animateIndicator",value:function(t){var i=0,n=0;this.index-t>=0?i=90:n=90;var o={targets:this._indicator,left:{value:this._calcLeftPos(this.$activeTabLink),delay:i},right:{value:this._calcRightPos(this.$activeTabLink),delay:n},duration:this.options.duration,easing:"easeOutQuad"};e.remove(this._indicator),e(o)}},{key:"select",value:function(t){var e=this.$tabLinks.filter('[href="#'+t+'"]');e.length&&e.trigger("click")}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Tabs}},{key:"defaults",get:function(){return l}}]),c}(a);M.Tabs=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"tabs","M_Tabs")}(cash,M.anime),function(t,e){var l={exitDelay:200,enterDelay:0,html:null,margin:5,inDuration:250,outDuration:200,position:"bottom",transitionMovement:10},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_Tooltip=n,n.options=t.extend({},c.defaults,i),n.isOpen=!1,n.isHovered=!1,n.isFocused=!1,n._appendTooltipEl(),n._setupEventHandlers(),n}return s(c,a),n(c,[{key:"destroy",value:function(){t(this.tooltipEl).remove(),this._removeEventHandlers(),this.el.M_Tooltip=void 0}},{key:"_appendTooltipEl",value:function(){var t=document.createElement("div");t.classList.add("material-tooltip"),this.tooltipEl=t;var e=document.createElement("div");e.classList.add("tooltip-content"),e.innerHTML=this.options.html,t.appendChild(e),document.body.appendChild(t)}},{key:"_updateTooltipContent",value:function(){this.tooltipEl.querySelector(".tooltip-content").innerHTML=this.options.html}},{key:"_setupEventHandlers",value:function(){this._handleMouseEnterBound=this._handleMouseEnter.bind(this),this._handleMouseLeaveBound=this._handleMouseLeave.bind(this),this._handleFocusBound=this._handleFocus.bind(this),this._handleBlurBound=this._handleBlur.bind(this),this.el.addEventListener("mouseenter",this._handleMouseEnterBound),this.el.addEventListener("mouseleave",this._handleMouseLeaveBound),this.el.addEventListener("focus",this._handleFocusBound,!0),this.el.addEventListener("blur",this._handleBlurBound,!0)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("mouseenter",this._handleMouseEnterBound),this.el.removeEventListener("mouseleave",this._handleMouseLeaveBound),this.el.removeEventListener("focus",this._handleFocusBound,!0),this.el.removeEventListener("blur",this._handleBlurBound,!0)}},{key:"open",value:function(e){this.isOpen||(e=void 0===e||void 0,this.isOpen=!0,this.options=t.extend({},this.options,this._getAttributeOptions()),this._updateTooltipContent(),this._setEnterDelayTimeout(e))}},{key:"close",value:function(){this.isOpen&&(this.isHovered=!1,this.isFocused=!1,this.isOpen=!1,this._setExitDelayTimeout())}},{key:"_setExitDelayTimeout",value:function(){var t=this;clearTimeout(this._exitDelayTimeout),this._exitDelayTimeout=setTimeout((function(){t.isHovered||t.isFocused||t._animateOut()}),this.options.exitDelay)}},{key:"_setEnterDelayTimeout",value:function(t){var e=this;clearTimeout(this._enterDelayTimeout),this._enterDelayTimeout=setTimeout((function(){(e.isHovered||e.isFocused||t)&&e._animateIn()}),this.options.enterDelay)}},{key:"_positionTooltip",value:function(){var e,i=this.el,n=this.tooltipEl,o=i.offsetHeight,s=i.offsetWidth,r=n.offsetHeight,a=n.offsetWidth,l=this.options.margin,c=void 0,h=void 0;this.xMovement=0,this.yMovement=0,c=i.getBoundingClientRect().top+M.getDocumentScrollTop(),h=i.getBoundingClientRect().left+M.getDocumentScrollLeft(),"top"===this.options.position?(c+=-r-l,h+=s/2-a/2,this.yMovement=-this.options.transitionMovement):"right"===this.options.position?(c+=o/2-r/2,h+=s+l,this.xMovement=this.options.transitionMovement):"left"===this.options.position?(c+=o/2-r/2,h+=-a-l,this.xMovement=-this.options.transitionMovement):(c+=o+l,h+=s/2-a/2,this.yMovement=this.options.transitionMovement),e=this._repositionWithinScreen(h,c,a,r),t(n).css({top:e.y+"px",left:e.x+"px"})}},{key:"_repositionWithinScreen",value:function(t,e,i,n){var o=M.getDocumentScrollLeft(),s=M.getDocumentScrollTop(),r=t-o,a=e-s,l={left:r,top:a,width:i,height:n},c=this.options.margin+this.options.transitionMovement,h=M.checkWithinContainer(document.body,l,c);return h.left?r=c:h.right&&(r-=r+i-window.innerWidth),h.top?a=c:h.bottom&&(a-=a+n-window.innerHeight),{x:r+o,y:a+s}}},{key:"_animateIn",value:function(){this._positionTooltip(),this.tooltipEl.style.visibility="visible",e.remove(this.tooltipEl),e({targets:this.tooltipEl,opacity:1,translateX:this.xMovement,translateY:this.yMovement,duration:this.options.inDuration,easing:"easeOutCubic"})}},{key:"_animateOut",value:function(){e.remove(this.tooltipEl),e({targets:this.tooltipEl,opacity:0,translateX:0,translateY:0,duration:this.options.outDuration,easing:"easeOutCubic"})}},{key:"_handleMouseEnter",value:function(){this.isHovered=!0,this.isFocused=!1,this.open(!1)}},{key:"_handleMouseLeave",value:function(){this.isHovered=!1,this.isFocused=!1,this.close()}},{key:"_handleFocus",value:function(){M.tabPressed&&(this.isFocused=!0,this.open(!1))}},{key:"_handleBlur",value:function(){this.isFocused=!1,this.close()}},{key:"_getAttributeOptions",value:function(){var t={},e=this.el.getAttribute("data-tooltip"),i=this.el.getAttribute("data-position");return e&&(t.html=e),i&&(t.position=i),t}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Tooltip}},{key:"defaults",get:function(){return l}}]),c}(a);M.Tooltip=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"tooltip","M_Tooltip")}(cash,M.anime),function(t){var e=e||{},i=document.querySelectorAll.bind(document);function n(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e+=i+":"+t[i]+";");return e}var o={duration:750,show:function(t,e){if(2===t.button)return!1;var i=e||this,s=document.createElement("div");s.className="waves-ripple",i.appendChild(s);var r,a,l,c,h,u=(c={top:0,left:0},h=(r=i)&&r.ownerDocument,a=h.documentElement,void 0!==r.getBoundingClientRect&&(c=r.getBoundingClientRect()),l=function(t){return null!==(e=t)&&e===e.window?t:9===t.nodeType&&t.defaultView;var e}(h),{top:c.top+l.pageYOffset-a.clientTop,left:c.left+l.pageXOffset-a.clientLeft}),d=t.pageY-u.top,p=t.pageX-u.left,_="scale("+i.clientWidth/100*10+")";"touches"in t&&(d=t.touches[0].pageY-u.top,p=t.touches[0].pageX-u.left),s.setAttribute("data-hold",Date.now()),s.setAttribute("data-scale",_),s.setAttribute("data-x",p),s.setAttribute("data-y",d);var m={top:d+"px",left:p+"px"};s.className=s.className+" waves-notransition",s.setAttribute("style",n(m)),s.className=s.className.replace("waves-notransition",""),m["-webkit-transform"]=_,m["-moz-transform"]=_,m["-ms-transform"]=_,m["-o-transform"]=_,m.transform=_,m.opacity="1",m["-webkit-transition-duration"]=o.duration+"ms",m["-moz-transition-duration"]=o.duration+"ms",m["-o-transition-duration"]=o.duration+"ms",m["transition-duration"]=o.duration+"ms",m["-webkit-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",m["-moz-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",m["-o-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",m["transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",s.setAttribute("style",n(m))},hide:function(t){s.touchup(t);var e=this;e.clientWidth;var i=null,r=e.getElementsByClassName("waves-ripple");if(!(r.length>0))return!1;var a=(i=r[r.length-1]).getAttribute("data-x"),l=i.getAttribute("data-y"),c=i.getAttribute("data-scale"),h=350-(Date.now()-Number(i.getAttribute("data-hold")));h<0&&(h=0),setTimeout((function(){var t={top:l+"px",left:a+"px",opacity:"0","-webkit-transition-duration":o.duration+"ms","-moz-transition-duration":o.duration+"ms","-o-transition-duration":o.duration+"ms","transition-duration":o.duration+"ms","-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,"-o-transform":c,transform:c};i.setAttribute("style",n(t)),setTimeout((function(){try{e.removeChild(i)}catch(t){return!1}}),o.duration)}),h)},wrapInput:function(t){for(var e=0;e<t.length;e++){var i=t[e];if("input"===i.tagName.toLowerCase()){var n=i.parentNode;if("i"===n.tagName.toLowerCase()&&-1!==n.className.indexOf("waves-effect"))continue;var o=document.createElement("i");o.className=i.className+" waves-input-wrapper";var s=i.getAttribute("style");s||(s=""),o.setAttribute("style",s),i.className="waves-button-input",i.removeAttribute("style"),n.replaceChild(o,i),o.appendChild(i)}}}},s={touches:0,allowEvent:function(t){var e=!0;return"touchstart"===t.type?s.touches+=1:"touchend"===t.type||"touchcancel"===t.type?setTimeout((function(){s.touches>0&&(s.touches-=1)}),500):"mousedown"===t.type&&s.touches>0&&(e=!1),e},touchup:function(t){s.allowEvent(t)}};function r(e){var i=function(t){if(!1===s.allowEvent(t))return null;for(var e=null,i=t.target||t.srcElement;null!==i.parentNode;){if(!(i instanceof SVGElement)&&-1!==i.className.indexOf("waves-effect")){e=i;break}i=i.parentNode}return e}(e);null!==i&&(o.show(e,i),"ontouchstart"in t&&(i.addEventListener("touchend",o.hide,!1),i.addEventListener("touchcancel",o.hide,!1)),i.addEventListener("mouseup",o.hide,!1),i.addEventListener("mouseleave",o.hide,!1),i.addEventListener("dragend",o.hide,!1))}e.displayEffect=function(e){"duration"in(e=e||{})&&(o.duration=e.duration),o.wrapInput(i(".waves-effect")),"ontouchstart"in t&&document.body.addEventListener("touchstart",r,!1),document.body.addEventListener("mousedown",r,!1)},e.attach=function(e){"input"===e.tagName.toLowerCase()&&(o.wrapInput([e]),e=e.parentNode),"ontouchstart"in t&&e.addEventListener("touchstart",r,!1),e.addEventListener("mousedown",r,!1)},t.Waves=e,document.addEventListener("DOMContentLoaded",(function(){e.displayEffect()}),!1)}(window),function(t,e){var i={html:"",displayLength:4e3,inDuration:300,outDuration:375,classes:"",completeCallback:null,activationPercent:.8},o=function(){function o(e){r(this,o),this.options=t.extend({},o.defaults,e),this.message=this.options.html,this.panning=!1,this.timeRemaining=this.options.displayLength,0===o._toasts.length&&o._createContainer(),o._toasts.push(this);var i=this._createToast();i.M_Toast=this,this.el=i,this.$el=t(i),this._animateIn(),this._setTimer()}return n(o,[{key:"_createToast",value:function(){var e=document.createElement("div");return e.classList.add("toast"),this.options.classes.length&&t(e).addClass(this.options.classes),("object"==typeof HTMLElement?this.message instanceof HTMLElement:this.message&&"object"==typeof this.message&&null!==this.message&&1===this.message.nodeType&&"string"==typeof this.message.nodeName)?e.appendChild(this.message):this.message.jquery?t(e).append(this.message[0]):e.innerHTML=this.message,o._container.appendChild(e),e}},{key:"_animateIn",value:function(){e({targets:this.el,top:0,opacity:1,duration:this.options.inDuration,easing:"easeOutCubic"})}},{key:"_setTimer",value:function(){var t=this;this.timeRemaining!==1/0&&(this.counterInterval=setInterval((function(){t.panning||(t.timeRemaining-=20),t.timeRemaining<=0&&t.dismiss()}),20))}},{key:"dismiss",value:function(){var t=this;window.clearInterval(this.counterInterval);var i=this.el.offsetWidth*this.options.activationPercent;this.wasSwiped&&(this.el.style.transition="transform .05s, opacity .05s",this.el.style.transform="translateX("+i+"px)",this.el.style.opacity=0),e({targets:this.el,opacity:0,marginTop:-40,duration:this.options.outDuration,easing:"easeOutExpo",complete:function(){"function"==typeof t.options.completeCallback&&t.options.completeCallback(),t.$el.remove(),o._toasts.splice(o._toasts.indexOf(t),1),0===o._toasts.length&&o._removeContainer()}})}}],[{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Toast}},{key:"_createContainer",value:function(){var t=document.createElement("div");t.setAttribute("id","toast-container"),t.addEventListener("touchstart",o._onDragStart),t.addEventListener("touchmove",o._onDragMove),t.addEventListener("touchend",o._onDragEnd),t.addEventListener("mousedown",o._onDragStart),document.addEventListener("mousemove",o._onDragMove),document.addEventListener("mouseup",o._onDragEnd),document.body.appendChild(t),o._container=t}},{key:"_removeContainer",value:function(){document.removeEventListener("mousemove",o._onDragMove),document.removeEventListener("mouseup",o._onDragEnd),t(o._container).remove(),o._container=null}},{key:"_onDragStart",value:function(e){if(e.target&&t(e.target).closest(".toast").length){var i=t(e.target).closest(".toast")[0].M_Toast;i.panning=!0,o._draggedToast=i,i.el.classList.add("panning"),i.el.style.transition="",i.startingXPos=o._xPos(e),i.time=Date.now(),i.xPos=o._xPos(e)}}},{key:"_onDragMove",value:function(t){if(o._draggedToast){t.preventDefault();var e=o._draggedToast;e.deltaX=Math.abs(e.xPos-o._xPos(t)),e.xPos=o._xPos(t),e.velocityX=e.deltaX/(Date.now()-e.time),e.time=Date.now();var i=e.xPos-e.startingXPos,n=e.el.offsetWidth*e.options.activationPercent;e.el.style.transform="translateX("+i+"px)",e.el.style.opacity=1-Math.abs(i/n)}}},{key:"_onDragEnd",value:function(){if(o._draggedToast){var t=o._draggedToast;t.panning=!1,t.el.classList.remove("panning");var e=t.xPos-t.startingXPos,i=t.el.offsetWidth*t.options.activationPercent;Math.abs(e)>i||t.velocityX>1?(t.wasSwiped=!0,t.dismiss()):(t.el.style.transition="transform .2s, opacity .2s",t.el.style.transform="",t.el.style.opacity=""),o._draggedToast=null}}},{key:"_xPos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}},{key:"dismissAll",value:function(){for(var t in o._toasts)o._toasts[t].dismiss()}},{key:"defaults",get:function(){return i}}]),o}();o._toasts=[],o._container=null,o._draggedToast=null,M.Toast=o,M.toast=function(t){return new o(t)}}(cash,M.anime),function(t,e){var l={edge:"left",draggable:!0,inDuration:250,outDuration:200,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,preventScrolling:!0},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_Sidenav=n,n.id=n.$el.attr("id"),n.options=t.extend({},c.defaults,i),n.isOpen=!1,n.isFixed=n.el.classList.contains("sidenav-fixed"),n.isDragged=!1,n.lastWindowWidth=window.innerWidth,n.lastWindowHeight=window.innerHeight,n._createOverlay(),n._createDragTarget(),n._setupEventHandlers(),n._setupClasses(),n._setupFixed(),c._sidenavs.push(n),n}return s(c,a),n(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this._enableBodyScrolling(),this._overlay.parentNode.removeChild(this._overlay),this.dragTarget.parentNode.removeChild(this.dragTarget),this.el.M_Sidenav=void 0,this.el.style.transform="";var t=c._sidenavs.indexOf(this);t>=0&&c._sidenavs.splice(t,1)}},{key:"_createOverlay",value:function(){var t=document.createElement("div");this._closeBound=this.close.bind(this),t.classList.add("sidenav-overlay"),t.addEventListener("click",this._closeBound),document.body.appendChild(t),this._overlay=t}},{key:"_setupEventHandlers",value:function(){0===c._sidenavs.length&&document.body.addEventListener("click",this._handleTriggerClick),this._handleDragTargetDragBound=this._handleDragTargetDrag.bind(this),this._handleDragTargetReleaseBound=this._handleDragTargetRelease.bind(this),this._handleCloseDragBound=this._handleCloseDrag.bind(this),this._handleCloseReleaseBound=this._handleCloseRelease.bind(this),this._handleCloseTriggerClickBound=this._handleCloseTriggerClick.bind(this),this.dragTarget.addEventListener("touchmove",this._handleDragTargetDragBound),this.dragTarget.addEventListener("touchend",this._handleDragTargetReleaseBound),this._overlay.addEventListener("touchmove",this._handleCloseDragBound),this._overlay.addEventListener("touchend",this._handleCloseReleaseBound),this.el.addEventListener("touchmove",this._handleCloseDragBound),this.el.addEventListener("touchend",this._handleCloseReleaseBound),this.el.addEventListener("click",this._handleCloseTriggerClickBound),this.isFixed&&(this._handleWindowResizeBound=this._handleWindowResize.bind(this),window.addEventListener("resize",this._handleWindowResizeBound))}},{key:"_removeEventHandlers",value:function(){1===c._sidenavs.length&&document.body.removeEventListener("click",this._handleTriggerClick),this.dragTarget.removeEventListener("touchmove",this._handleDragTargetDragBound),this.dragTarget.removeEventListener("touchend",this._handleDragTargetReleaseBound),this._overlay.removeEventListener("touchmove",this._handleCloseDragBound),this._overlay.removeEventListener("touchend",this._handleCloseReleaseBound),this.el.removeEventListener("touchmove",this._handleCloseDragBound),this.el.removeEventListener("touchend",this._handleCloseReleaseBound),this.el.removeEventListener("click",this._handleCloseTriggerClickBound),this.isFixed&&window.removeEventListener("resize",this._handleWindowResizeBound)}},{key:"_handleTriggerClick",value:function(e){var i=t(e.target).closest(".sidenav-trigger");if(e.target&&i.length){var n=M.getIdFromTrigger(i[0]),o=document.getElementById(n).M_Sidenav;o&&o.open(i),e.preventDefault()}}},{key:"_startDrag",value:function(t){var i=t.targetTouches[0].clientX;this.isDragged=!0,this._startingXpos=i,this._xPos=this._startingXpos,this._time=Date.now(),this._width=this.el.getBoundingClientRect().width,this._overlay.style.display="block",this._initialScrollTop=this.isOpen?this.el.scrollTop:M.getDocumentScrollTop(),this._verticallyScrolling=!1,e.remove(this.el),e.remove(this._overlay)}},{key:"_dragMoveUpdate",value:function(t){var e=t.targetTouches[0].clientX,i=this.isOpen?this.el.scrollTop:M.getDocumentScrollTop();this.deltaX=Math.abs(this._xPos-e),this._xPos=e,this.velocityX=this.deltaX/(Date.now()-this._time),this._time=Date.now(),this._initialScrollTop!==i&&(this._verticallyScrolling=!0)}},{key:"_handleDragTargetDrag",value:function(t){if(this.options.draggable&&!this._isCurrentlyFixed()&&!this._verticallyScrolling){this.isDragged||this._startDrag(t),this._dragMoveUpdate(t);var e=this._xPos-this._startingXpos,i=e>0?"right":"left";e=Math.min(this._width,Math.abs(e)),this.options.edge===i&&(e=0);var n=e,o="translateX(-100%)";"right"===this.options.edge&&(o="translateX(100%)",n=-n),this.percentOpen=Math.min(1,e/this._width),this.el.style.transform=o+" translateX("+n+"px)",this._overlay.style.opacity=this.percentOpen}}},{key:"_handleDragTargetRelease",value:function(){this.isDragged&&(this.percentOpen>.2?this.open():this._animateOut(),this.isDragged=!1,this._verticallyScrolling=!1)}},{key:"_handleCloseDrag",value:function(t){if(this.isOpen){if(!this.options.draggable||this._isCurrentlyFixed()||this._verticallyScrolling)return;this.isDragged||this._startDrag(t),this._dragMoveUpdate(t);var e=this._xPos-this._startingXpos,i=e>0?"right":"left";e=Math.min(this._width,Math.abs(e)),this.options.edge!==i&&(e=0);var n=-e;"right"===this.options.edge&&(n=-n),this.percentOpen=Math.min(1,1-e/this._width),this.el.style.transform="translateX("+n+"px)",this._overlay.style.opacity=this.percentOpen}}},{key:"_handleCloseRelease",value:function(){this.isOpen&&this.isDragged&&(this.percentOpen>.8?this._animateIn():this.close(),this.isDragged=!1,this._verticallyScrolling=!1)}},{key:"_handleCloseTriggerClick",value:function(e){t(e.target).closest(".sidenav-close").length&&!this._isCurrentlyFixed()&&this.close()}},{key:"_handleWindowResize",value:function(){this.lastWindowWidth!==window.innerWidth&&(window.innerWidth>992?this.open():this.close()),this.lastWindowWidth=window.innerWidth,this.lastWindowHeight=window.innerHeight}},{key:"_setupClasses",value:function(){"right"===this.options.edge&&(this.el.classList.add("right-aligned"),this.dragTarget.classList.add("right-aligned"))}},{key:"_removeClasses",value:function(){this.el.classList.remove("right-aligned"),this.dragTarget.classList.remove("right-aligned")}},{key:"_setupFixed",value:function(){this._isCurrentlyFixed()&&this.open()}},{key:"_isCurrentlyFixed",value:function(){return this.isFixed&&window.innerWidth>992}},{key:"_createDragTarget",value:function(){var t=document.createElement("div");t.classList.add("drag-target"),document.body.appendChild(t),this.dragTarget=t}},{key:"_preventBodyScrolling",value:function(){document.body.style.overflow="hidden"}},{key:"_enableBodyScrolling",value:function(){document.body.style.overflow=""}},{key:"open",value:function(){!0!==this.isOpen&&(this.isOpen=!0,"function"==typeof this.options.onOpenStart&&this.options.onOpenStart.call(this,this.el),this._isCurrentlyFixed()?(e.remove(this.el),e({targets:this.el,translateX:0,duration:0,easing:"easeOutQuad"}),this._enableBodyScrolling(),this._overlay.style.display="none"):(this.options.preventScrolling&&this._preventBodyScrolling(),this.isDragged&&1==this.percentOpen||this._animateIn()))}},{key:"close",value:function(){if(!1!==this.isOpen)if(this.isOpen=!1,"function"==typeof this.options.onCloseStart&&this.options.onCloseStart.call(this,this.el),this._isCurrentlyFixed()){var t="left"===this.options.edge?"-105%":"105%";this.el.style.transform="translateX("+t+")"}else this._enableBodyScrolling(),this.isDragged&&0==this.percentOpen?this._overlay.style.display="none":this._animateOut()}},{key:"_animateIn",value:function(){this._animateSidenavIn(),this._animateOverlayIn()}},{key:"_animateSidenavIn",value:function(){var t=this,i="left"===this.options.edge?-1:1;this.isDragged&&(i="left"===this.options.edge?i+this.percentOpen:i-this.percentOpen),e.remove(this.el),e({targets:this.el,translateX:[100*i+"%",0],duration:this.options.inDuration,easing:"easeOutQuad",complete:function(){"function"==typeof t.options.onOpenEnd&&t.options.onOpenEnd.call(t,t.el)}})}},{key:"_animateOverlayIn",value:function(){var i=0;this.isDragged?i=this.percentOpen:t(this._overlay).css({display:"block"}),e.remove(this._overlay),e({targets:this._overlay,opacity:[i,1],duration:this.options.inDuration,easing:"easeOutQuad"})}},{key:"_animateOut",value:function(){this._animateSidenavOut(),this._animateOverlayOut()}},{key:"_animateSidenavOut",value:function(){var t=this,i="left"===this.options.edge?-1:1,n=0;this.isDragged&&(n="left"===this.options.edge?i+this.percentOpen:i-this.percentOpen),e.remove(this.el),e({targets:this.el,translateX:[100*n+"%",105*i+"%"],duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t,t.el)}})}},{key:"_animateOverlayOut",value:function(){var i=this;e.remove(this._overlay),e({targets:this._overlay,opacity:0,duration:this.options.outDuration,easing:"easeOutQuad",complete:function(){t(i._overlay).css("display","none")}})}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Sidenav}},{key:"defaults",get:function(){return l}}]),c}(a);c._sidenavs=[],M.Sidenav=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"sidenav","M_Sidenav")}(cash,M.anime),function(t,e){var l={throttle:100,scrollOffset:200,activeClass:"active",getActiveElement:function(t){return'a[href="#'+t+'"]'}},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_ScrollSpy=n,n.options=t.extend({},c.defaults,i),c._elements.push(n),c._count++,c._increment++,n.tickId=-1,n.id=c._increment,n._setupEventHandlers(),n._handleWindowScroll(),n}return s(c,a),n(c,[{key:"destroy",value:function(){c._elements.splice(c._elements.indexOf(this),1),c._elementsInView.splice(c._elementsInView.indexOf(this),1),c._visibleElements.splice(c._visibleElements.indexOf(this.$el),1),c._count--,this._removeEventHandlers(),t(this.options.getActiveElement(this.$el.attr("id"))).removeClass(this.options.activeClass),this.el.M_ScrollSpy=void 0}},{key:"_setupEventHandlers",value:function(){var t=M.throttle(this._handleWindowScroll,200);this._handleThrottledResizeBound=t.bind(this),this._handleWindowScrollBound=this._handleWindowScroll.bind(this),1===c._count&&(window.addEventListener("scroll",this._handleWindowScrollBound),window.addEventListener("resize",this._handleThrottledResizeBound),document.body.addEventListener("click",this._handleTriggerClick))}},{key:"_removeEventHandlers",value:function(){0===c._count&&(window.removeEventListener("scroll",this._handleWindowScrollBound),window.removeEventListener("resize",this._handleThrottledResizeBound),document.body.removeEventListener("click",this._handleTriggerClick))}},{key:"_handleTriggerClick",value:function(i){for(var n=t(i.target),o=c._elements.length-1;o>=0;o--){var s=c._elements[o];if(n.is('a[href="#'+s.$el.attr("id")+'"]')){i.preventDefault();var r=s.$el.offset().top+1;e({targets:[document.documentElement,document.body],scrollTop:r-s.options.scrollOffset,duration:400,easing:"easeOutCubic"});break}}}},{key:"_handleWindowScroll",value:function(){c._ticks++;for(var t=M.getDocumentScrollTop(),e=M.getDocumentScrollLeft(),i=e+window.innerWidth,n=t+window.innerHeight,o=c._findElements(t,i,n,e),s=0;s<o.length;s++){var r=o[s];r.tickId<0&&r._enter(),r.tickId=c._ticks}for(var a=0;a<c._elementsInView.length;a++){var l=c._elementsInView[a],h=l.tickId;h>=0&&h!==c._ticks&&(l._exit(),l.tickId=-1)}c._elementsInView=o}},{key:"_enter",value:function(){c._visibleElements=c._visibleElements.filter((function(t){return 0!=t.height()})),c._visibleElements[0]?(t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).removeClass(this.options.activeClass),c._visibleElements[0][0].M_ScrollSpy&&this.id<c._visibleElements[0][0].M_ScrollSpy.id?c._visibleElements.unshift(this.$el):c._visibleElements.push(this.$el)):c._visibleElements.push(this.$el),t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).addClass(this.options.activeClass)}},{key:"_exit",value:function(){var e=this;c._visibleElements=c._visibleElements.filter((function(t){return 0!=t.height()})),c._visibleElements[0]&&(t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).removeClass(this.options.activeClass),c._visibleElements=c._visibleElements.filter((function(t){return t.attr("id")!=e.$el.attr("id")})),c._visibleElements[0]&&t(this.options.getActiveElement(c._visibleElements[0].attr("id"))).addClass(this.options.activeClass))}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_ScrollSpy}},{key:"_findElements",value:function(t,e,i,n){for(var o=[],s=0;s<c._elements.length;s++){var r=c._elements[s],a=t+r.options.scrollOffset||200;if(r.$el.height()>0){var l=r.$el.offset().top,h=r.$el.offset().left,u=h+r.$el.width(),d=l+r.$el.height();!(h>e||u<n||l>i||d<a)&&o.push(r)}}return o}},{key:"defaults",get:function(){return l}}]),c}(a);c._elements=[],c._elementsInView=[],c._visibleElements=[],c._count=0,c._increment=0,c._ticks=0,M.ScrollSpy=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"scrollSpy","M_ScrollSpy")}(cash,M.anime),function(t){var e={data:{},limit:1/0,onAutocomplete:null,minLength:1,sortFunction:function(t,e,i){return t.indexOf(i)-e.indexOf(i)}},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_Autocomplete=n,n.options=t.extend({},l.defaults,i),n.isOpen=!1,n.count=0,n.activeIndex=-1,n.oldVal,n.$inputField=n.$el.closest(".input-field"),n.$active=t(),n._mousedown=!1,n._setupDropdown(),n._setupEventHandlers(),n}return s(l,a),n(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this._removeDropdown(),this.el.M_Autocomplete=void 0}},{key:"_setupEventHandlers",value:function(){this._handleInputBlurBound=this._handleInputBlur.bind(this),this._handleInputKeyupAndFocusBound=this._handleInputKeyupAndFocus.bind(this),this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),this._handleContainerMousedownAndTouchstartBound=this._handleContainerMousedownAndTouchstart.bind(this),this._handleContainerMouseupAndTouchendBound=this._handleContainerMouseupAndTouchend.bind(this),this.el.addEventListener("blur",this._handleInputBlurBound),this.el.addEventListener("keyup",this._handleInputKeyupAndFocusBound),this.el.addEventListener("focus",this._handleInputKeyupAndFocusBound),this.el.addEventListener("keydown",this._handleInputKeydownBound),this.el.addEventListener("click",this._handleInputClickBound),this.container.addEventListener("mousedown",this._handleContainerMousedownAndTouchstartBound),this.container.addEventListener("mouseup",this._handleContainerMouseupAndTouchendBound),void 0!==window.ontouchstart&&(this.container.addEventListener("touchstart",this._handleContainerMousedownAndTouchstartBound),this.container.addEventListener("touchend",this._handleContainerMouseupAndTouchendBound))}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("blur",this._handleInputBlurBound),this.el.removeEventListener("keyup",this._handleInputKeyupAndFocusBound),this.el.removeEventListener("focus",this._handleInputKeyupAndFocusBound),this.el.removeEventListener("keydown",this._handleInputKeydownBound),this.el.removeEventListener("click",this._handleInputClickBound),this.container.removeEventListener("mousedown",this._handleContainerMousedownAndTouchstartBound),this.container.removeEventListener("mouseup",this._handleContainerMouseupAndTouchendBound),void 0!==window.ontouchstart&&(this.container.removeEventListener("touchstart",this._handleContainerMousedownAndTouchstartBound),this.container.removeEventListener("touchend",this._handleContainerMouseupAndTouchendBound))}},{key:"_setupDropdown",value:function(){var e=this;this.container=document.createElement("ul"),this.container.id="autocomplete-options-"+M.guid(),t(this.container).addClass("autocomplete-content dropdown-content"),this.$inputField.append(this.container),this.el.setAttribute("data-target",this.container.id),this.dropdown=M.Dropdown.init(this.el,{autoFocus:!1,closeOnClick:!1,coverTrigger:!1,onItemClick:function(i){e.selectOption(t(i))}}),this.el.removeEventListener("click",this.dropdown._handleClickBound)}},{key:"_removeDropdown",value:function(){this.container.parentNode.removeChild(this.container)}},{key:"_handleInputBlur",value:function(){this._mousedown||(this.close(),this._resetAutocomplete())}},{key:"_handleInputKeyupAndFocus",value:function(t){"keyup"===t.type&&(l._keydown=!1),this.count=0;var e=this.el.value.toLowerCase();13!==t.keyCode&&38!==t.keyCode&&40!==t.keyCode&&(this.oldVal===e||!M.tabPressed&&"focus"===t.type||this.open(),this.oldVal=e)}},{key:"_handleInputKeydown",value:function(e){l._keydown=!0;var i=e.keyCode,n=void 0,o=t(this.container).children("li").length;i===M.keys.ENTER&&this.activeIndex>=0?(n=t(this.container).children("li").eq(this.activeIndex)).length&&(this.selectOption(n),e.preventDefault()):i!==M.keys.ARROW_UP&&i!==M.keys.ARROW_DOWN||(e.preventDefault(),i===M.keys.ARROW_UP&&this.activeIndex>0&&this.activeIndex--,i===M.keys.ARROW_DOWN&&this.activeIndex<o-1&&this.activeIndex++,this.$active.removeClass("active"),this.activeIndex>=0&&(this.$active=t(this.container).children("li").eq(this.activeIndex),this.$active.addClass("active")))}},{key:"_handleInputClick",value:function(t){this.open()}},{key:"_handleContainerMousedownAndTouchstart",value:function(t){this._mousedown=!0}},{key:"_handleContainerMouseupAndTouchend",value:function(t){this._mousedown=!1}},{key:"_highlight",value:function(t,e){var i=e.find("img"),n=e.text().toLowerCase().indexOf(""+t.toLowerCase()),o=n+t.length-1,s=e.text().slice(0,n),r=e.text().slice(n,o+1),a=e.text().slice(o+1);e.html("<span>"+s+"<span class='highlight'>"+r+"</span>"+a+"</span>"),i.length&&e.prepend(i)}},{key:"_resetCurrentElement",value:function(){this.activeIndex=-1,this.$active.removeClass("active")}},{key:"_resetAutocomplete",value:function(){t(this.container).empty(),this._resetCurrentElement(),this.oldVal=null,this.isOpen=!1,this._mousedown=!1}},{key:"selectOption",value:function(t){var e=t.text().trim();this.el.value=e,this.$el.trigger("change"),this._resetAutocomplete(),this.close(),"function"==typeof this.options.onAutocomplete&&this.options.onAutocomplete.call(this,e)}},{key:"_renderDropdown",value:function(e,i){var n=this;this._resetAutocomplete();var o=[];for(var s in e)if(e.hasOwnProperty(s)&&-1!==s.toLowerCase().indexOf(i)){if(this.count>=this.options.limit)break;var r={data:e[s],key:s};o.push(r),this.count++}if(this.options.sortFunction){o.sort((function(t,e){return n.options.sortFunction(t.key.toLowerCase(),e.key.toLowerCase(),i.toLowerCase())}))}for(var a=0;a<o.length;a++){var l=o[a],c=t("<li></li>");l.data?c.append('<img src="'+l.data+'" class="right circle"><span>'+l.key+"</span>"):c.append("<span>"+l.key+"</span>"),t(this.container).append(c),this._highlight(i,c)}}},{key:"open",value:function(){var t=this.el.value.toLowerCase();this._resetAutocomplete(),t.length>=this.options.minLength&&(this.isOpen=!0,this._renderDropdown(this.options.data,t)),this.dropdown.isOpen?this.dropdown.recalculateDimensions():this.dropdown.open()}},{key:"close",value:function(){this.dropdown.close()}},{key:"updateData",value:function(t){var e=this.el.value.toLowerCase();this.options.data=t,this.isOpen&&this._renderDropdown(t,e)}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Autocomplete}},{key:"defaults",get:function(){return e}}]),l}(a);l._keydown=!1,M.Autocomplete=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"autocomplete","M_Autocomplete")}(cash),function(t){M.updateTextFields=function(){t("input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], input[type=date], input[type=time], textarea").each((function(e,i){var n=t(this);e.value.length>0||t(e).is(":focus")||e.autofocus||null!==n.attr("placeholder")?n.siblings("label").addClass("active"):e.validity?n.siblings("label").toggleClass("active",!0===e.validity.badInput):n.siblings("label").removeClass("active")}))},M.validate_field=function(t){var e=null!==t.attr("data-length"),i=parseInt(t.attr("data-length")),n=t[0].value.length;0!==n||!1!==t[0].validity.badInput||t.is(":required")?t.hasClass("validate")&&(t.is(":valid")&&e&&n<=i||t.is(":valid")&&!e?(t.removeClass("invalid"),t.addClass("valid")):(t.removeClass("valid"),t.addClass("invalid"))):t.hasClass("validate")&&(t.removeClass("valid"),t.removeClass("invalid"))},M.textareaAutoResize=function(e){if(e instanceof Element&&(e=t(e)),e.length){var i=t(".hiddendiv").first();i.length||(i=t('<div class="hiddendiv common"></div>'),t("body").append(i));var n=e.css("font-family"),o=e.css("font-size"),s=e.css("line-height"),r=e.css("padding-top"),a=e.css("padding-right"),l=e.css("padding-bottom"),c=e.css("padding-left");o&&i.css("font-size",o),n&&i.css("font-family",n),s&&i.css("line-height",s),r&&i.css("padding-top",r),a&&i.css("padding-right",a),l&&i.css("padding-bottom",l),c&&i.css("padding-left",c),e.data("original-height")||e.data("original-height",e.height()),"off"===e.attr("wrap")&&i.css("overflow-wrap","normal").css("white-space","pre"),i.text(e[0].value+"\n");var h=i.html().replace(/\n/g,"<br>");i.html(h),e[0].offsetWidth>0&&e[0].offsetHeight>0?i.css("width",e.width()+"px"):i.css("width",window.innerWidth/2+"px"),e.data("original-height")<=i.innerHeight()?e.css("height",i.innerHeight()+"px"):e[0].value.length<e.data("previous-length")&&e.css("height",e.data("original-height")+"px"),e.data("previous-length",e[0].value.length)}else console.error("No textarea element found")},t(document).ready((function(){var e="input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], input[type=date], input[type=time], textarea";t(document).on("change",e,(function(){0===this.value.length&&null===t(this).attr("placeholder")||t(this).siblings("label").addClass("active"),M.validate_field(t(this))})),t(document).ready((function(){M.updateTextFields()})),t(document).on("reset",(function(i){var n=t(i.target);n.is("form")&&(n.find(e).removeClass("valid").removeClass("invalid"),n.find(e).each((function(e){this.value.length&&t(this).siblings("label").removeClass("active")})),setTimeout((function(){n.find("select").each((function(){this.M_FormSelect&&t(this).trigger("change")}))}),0))})),document.addEventListener("focus",(function(i){t(i.target).is(e)&&t(i.target).siblings("label, .prefix").addClass("active")}),!0),document.addEventListener("blur",(function(i){var n=t(i.target);if(n.is(e)){var o=".prefix";0===n[0].value.length&&!0!==n[0].validity.badInput&&null===n.attr("placeholder")&&(o+=", label"),n.siblings(o).removeClass("active"),M.validate_field(n)}}),!0);t(document).on("keyup","input[type=radio], input[type=checkbox]",(function(e){if(e.which===M.keys.TAB)return t(this).addClass("tabbed"),void t(this).one("blur",(function(e){t(this).removeClass("tabbed")}))}));var i=".materialize-textarea";t(i).each((function(){var e=t(this);e.data("original-height",e.height()),e.data("previous-length",this.value.length),M.textareaAutoResize(e)})),t(document).on("keyup",i,(function(){M.textareaAutoResize(t(this))})),t(document).on("keydown",i,(function(){M.textareaAutoResize(t(this))})),t(document).on("change",'.file-field input[type="file"]',(function(){for(var e=t(this).closest(".file-field").find("input.file-path"),i=t(this)[0].files,n=[],o=0;o<i.length;o++)n.push(i[o].name);e[0].value=n.join(", "),e.trigger("change")}))}))}(cash),function(t,e){var l={indicators:!0,height:400,duration:500,interval:6e3},c=function(a){function c(i,n){r(this,c);var s=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,i,n));return s.el.M_Slider=s,s.options=t.extend({},c.defaults,n),s.$slider=s.$el.find(".slides"),s.$slides=s.$slider.children("li"),s.activeIndex=s.$slides.filter((function(e){return t(e).hasClass("active")})).first().index(),-1!=s.activeIndex&&(s.$active=s.$slides.eq(s.activeIndex)),s._setSliderHeight(),s.$slides.find(".caption").each((function(t){s._animateCaptionIn(t,0)})),s.$slides.find("img").each((function(e){var i="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";t(e).attr("src")!==i&&(t(e).css("background-image",'url("'+t(e).attr("src")+'")'),t(e).attr("src",i))})),s._setupIndicators(),s.$active?s.$active.css("display","block"):(s.$slides.first().addClass("active"),e({targets:s.$slides.first()[0],opacity:1,duration:s.options.duration,easing:"easeOutQuad"}),s.activeIndex=0,s.$active=s.$slides.eq(s.activeIndex),s.options.indicators&&s.$indicators.eq(s.activeIndex).addClass("active")),s.$active.find("img").each((function(t){e({targets:s.$active.find(".caption")[0],opacity:1,translateX:0,translateY:0,duration:s.options.duration,easing:"easeOutQuad"})})),s._setupEventHandlers(),s.start(),s}return s(c,a),n(c,[{key:"destroy",value:function(){this.pause(),this._removeIndicators(),this._removeEventHandlers(),this.el.M_Slider=void 0}},{key:"_setupEventHandlers",value:function(){var t=this;this._handleIntervalBound=this._handleInterval.bind(this),this._handleIndicatorClickBound=this._handleIndicatorClick.bind(this),this.options.indicators&&this.$indicators.each((function(e){e.addEventListener("click",t._handleIndicatorClickBound)}))}},{key:"_removeEventHandlers",value:function(){var t=this;this.options.indicators&&this.$indicators.each((function(e){e.removeEventListener("click",t._handleIndicatorClickBound)}))}},{key:"_handleIndicatorClick",value:function(e){var i=t(e.target).index();this.set(i)}},{key:"_handleInterval",value:function(){var t=this.$slider.find(".active").index();this.$slides.length===t+1?t=0:t+=1,this.set(t)}},{key:"_animateCaptionIn",value:function(i,n){var o={targets:i,opacity:0,duration:n,easing:"easeOutQuad"};t(i).hasClass("center-align")?o.translateY=-100:t(i).hasClass("right-align")?o.translateX=100:t(i).hasClass("left-align")&&(o.translateX=-100),e(o)}},{key:"_setSliderHeight",value:function(){this.$el.hasClass("fullscreen")||(this.options.indicators?this.$el.css("height",this.options.height+40+"px"):this.$el.css("height",this.options.height+"px"),this.$slider.css("height",this.options.height+"px"))}},{key:"_setupIndicators",value:function(){var e=this;this.options.indicators&&(this.$indicators=t('<ul class="indicators"></ul>'),this.$slides.each((function(i,n){var o=t('<li class="indicator-item"></li>');e.$indicators.append(o[0])})),this.$el.append(this.$indicators[0]),this.$indicators=this.$indicators.children("li.indicator-item"))}},{key:"_removeIndicators",value:function(){this.$el.find("ul.indicators").remove()}},{key:"set",value:function(t){var i=this;if(t>=this.$slides.length?t=0:t<0&&(t=this.$slides.length-1),this.activeIndex!=t){this.$active=this.$slides.eq(this.activeIndex);var n=this.$active.find(".caption");this.$active.removeClass("active"),e({targets:this.$active[0],opacity:0,duration:this.options.duration,easing:"easeOutQuad",complete:function(){i.$slides.not(".active").each((function(t){e({targets:t,opacity:0,translateX:0,translateY:0,duration:0,easing:"easeOutQuad"})}))}}),this._animateCaptionIn(n[0],this.options.duration),this.options.indicators&&(this.$indicators.eq(this.activeIndex).removeClass("active"),this.$indicators.eq(t).addClass("active")),e({targets:this.$slides.eq(t)[0],opacity:1,duration:this.options.duration,easing:"easeOutQuad"}),e({targets:this.$slides.eq(t).find(".caption")[0],opacity:1,translateX:0,translateY:0,duration:this.options.duration,delay:this.options.duration,easing:"easeOutQuad"}),this.$slides.eq(t).addClass("active"),this.activeIndex=t,this.start()}}},{key:"pause",value:function(){clearInterval(this.interval)}},{key:"start",value:function(){clearInterval(this.interval),this.interval=setInterval(this._handleIntervalBound,this.options.duration+this.options.interval)}},{key:"next",value:function(){var t=this.activeIndex+1;t>=this.$slides.length?t=0:t<0&&(t=this.$slides.length-1),this.set(t)}},{key:"prev",value:function(){var t=this.activeIndex-1;t>=this.$slides.length?t=0:t<0&&(t=this.$slides.length-1),this.set(t)}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Slider}},{key:"defaults",get:function(){return l}}]),c}(a);M.Slider=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"slider","M_Slider")}(cash,M.anime),function(t,e){t(document).on("click",".card",(function(i){if(t(this).children(".card-reveal").length){var n=t(i.target).closest(".card");void 0===n.data("initialOverflow")&&n.data("initialOverflow",void 0===n.css("overflow")?"":n.css("overflow"));var o=t(this).find(".card-reveal");t(i.target).is(t(".card-reveal .card-title"))||t(i.target).is(t(".card-reveal .card-title i"))?e({targets:o[0],translateY:0,duration:225,easing:"easeInOutQuad",complete:function(e){var i=e.animatables[0].target;t(i).css({display:"none"}),n.css("overflow",n.data("initialOverflow"))}}):(t(i.target).is(t(".card .activator"))||t(i.target).is(t(".card .activator i")))&&(n.css("overflow","hidden"),o.css({display:"block"}),e({targets:o[0],translateY:"-100%",duration:300,easing:"easeInOutQuad"}))}}))}(cash,M.anime),function(t){var e={data:[],placeholder:"",secondaryPlaceholder:"",autocompleteOptions:{},limit:1/0,onChipAdd:null,onChipSelect:null,onChipDelete:null},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_Chips=n,n.options=t.extend({},l.defaults,i),n.$el.addClass("chips input-field"),n.chipsData=[],n.$chips=t(),n._setupInput(),n.hasAutocomplete=Object.keys(n.options.autocompleteOptions).length>0,n.$input.attr("id")||n.$input.attr("id",M.guid()),n.options.data.length&&(n.chipsData=n.options.data,n._renderChips(n.chipsData)),n.hasAutocomplete&&n._setupAutocomplete(),n._setPlaceholder(),n._setupLabel(),n._setupEventHandlers(),n}return s(l,a),n(l,[{key:"getData",value:function(){return this.chipsData}},{key:"destroy",value:function(){this._removeEventHandlers(),this.$chips.remove(),this.el.M_Chips=void 0}},{key:"_setupEventHandlers",value:function(){this._handleChipClickBound=this._handleChipClick.bind(this),this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputFocusBound=this._handleInputFocus.bind(this),this._handleInputBlurBound=this._handleInputBlur.bind(this),this.el.addEventListener("click",this._handleChipClickBound),document.addEventListener("keydown",l._handleChipsKeydown),document.addEventListener("keyup",l._handleChipsKeyup),this.el.addEventListener("blur",l._handleChipsBlur,!0),this.$input[0].addEventListener("focus",this._handleInputFocusBound),this.$input[0].addEventListener("blur",this._handleInputBlurBound),this.$input[0].addEventListener("keydown",this._handleInputKeydownBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleChipClickBound),document.removeEventListener("keydown",l._handleChipsKeydown),document.removeEventListener("keyup",l._handleChipsKeyup),this.el.removeEventListener("blur",l._handleChipsBlur,!0),this.$input[0].removeEventListener("focus",this._handleInputFocusBound),this.$input[0].removeEventListener("blur",this._handleInputBlurBound),this.$input[0].removeEventListener("keydown",this._handleInputKeydownBound)}},{key:"_handleChipClick",value:function(e){var i=t(e.target).closest(".chip"),n=t(e.target).is(".close");if(i.length){var o=i.index();n?(this.deleteChip(o),this.$input[0].focus()):this.selectChip(o)}else this.$input[0].focus()}},{key:"_handleInputFocus",value:function(){this.$el.addClass("focus")}},{key:"_handleInputBlur",value:function(){this.$el.removeClass("focus")}},{key:"_handleInputKeydown",value:function(t){if(l._keydown=!0,13===t.keyCode){if(this.hasAutocomplete&&this.autocomplete&&this.autocomplete.isOpen)return;t.preventDefault(),this.addChip({tag:this.$input[0].value}),this.$input[0].value=""}else 8!==t.keyCode&&37!==t.keyCode||""!==this.$input[0].value||!this.chipsData.length||(t.preventDefault(),this.selectChip(this.chipsData.length-1))}},{key:"_renderChip",value:function(e){if(e.tag){var i=document.createElement("div"),n=document.createElement("i");if(i.classList.add("chip"),i.textContent=e.tag,i.setAttribute("tabindex",0),t(n).addClass("material-icons close"),n.textContent="close",e.image){var o=document.createElement("img");o.setAttribute("src",e.image),i.insertBefore(o,i.firstChild)}return i.appendChild(n),i}}},{key:"_renderChips",value:function(){this.$chips.remove();for(var t=0;t<this.chipsData.length;t++){var e=this._renderChip(this.chipsData[t]);this.$el.append(e),this.$chips.add(e)}this.$el.append(this.$input[0])}},{key:"_setupAutocomplete",value:function(){var t=this;this.options.autocompleteOptions.onAutocomplete=function(e){t.addChip({tag:e}),t.$input[0].value="",t.$input[0].focus()},this.autocomplete=M.Autocomplete.init(this.$input[0],this.options.autocompleteOptions)}},{key:"_setupInput",value:function(){this.$input=this.$el.find("input"),this.$input.length||(this.$input=t("<input></input>"),this.$el.append(this.$input)),this.$input.addClass("input")}},{key:"_setupLabel",value:function(){this.$label=this.$el.find("label"),this.$label.length&&this.$label.setAttribute("for",this.$input.attr("id"))}},{key:"_setPlaceholder",value:function(){void 0!==this.chipsData&&!this.chipsData.length&&this.options.placeholder?t(this.$input).prop("placeholder",this.options.placeholder):(void 0===this.chipsData||this.chipsData.length)&&this.options.secondaryPlaceholder&&t(this.$input).prop("placeholder",this.options.secondaryPlaceholder)}},{key:"_isValid",value:function(t){if(t.hasOwnProperty("tag")&&""!==t.tag){for(var e=!1,i=0;i<this.chipsData.length;i++)if(this.chipsData[i].tag===t.tag){e=!0;break}return!e}return!1}},{key:"addChip",value:function(e){if(this._isValid(e)&&!(this.chipsData.length>=this.options.limit)){var i=this._renderChip(e);this.$chips.add(i),this.chipsData.push(e),t(this.$input).before(i),this._setPlaceholder(),"function"==typeof this.options.onChipAdd&&this.options.onChipAdd.call(this,this.$el,i)}}},{key:"deleteChip",value:function(e){var i=this.$chips.eq(e);this.$chips.eq(e).remove(),this.$chips=this.$chips.filter((function(e){return t(e).index()>=0})),this.chipsData.splice(e,1),this._setPlaceholder(),"function"==typeof this.options.onChipDelete&&this.options.onChipDelete.call(this,this.$el,i[0])}},{key:"selectChip",value:function(t){var e=this.$chips.eq(t);this._selectedChip=e,e[0].focus(),"function"==typeof this.options.onChipSelect&&this.options.onChipSelect.call(this,this.$el,e[0])}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Chips}},{key:"_handleChipsKeydown",value:function(e){l._keydown=!0;var i=t(e.target).closest(".chips"),n=e.target&&i.length;if(!t(e.target).is("input, textarea")&&n){var o=i[0].M_Chips;if(8===e.keyCode||46===e.keyCode){e.preventDefault();var s=o.chipsData.length;if(o._selectedChip){var r=o._selectedChip.index();o.deleteChip(r),o._selectedChip=null,s=Math.max(r-1,0)}o.chipsData.length&&o.selectChip(s)}else if(37===e.keyCode){if(o._selectedChip){var a=o._selectedChip.index()-1;if(a<0)return;o.selectChip(a)}}else if(39===e.keyCode&&o._selectedChip){var c=o._selectedChip.index()+1;c>=o.chipsData.length?o.$input[0].focus():o.selectChip(c)}}}},{key:"_handleChipsKeyup",value:function(t){l._keydown=!1}},{key:"_handleChipsBlur",value:function(e){l._keydown||(t(e.target).closest(".chips")[0].M_Chips._selectedChip=null)}},{key:"defaults",get:function(){return e}}]),l}(a);l._keydown=!1,M.Chips=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"chips","M_Chips"),t(document).ready((function(){t(document.body).on("click",".chip .close",(function(){var e=t(this).closest(".chips");e.length&&e[0].M_Chips||t(this).closest(".chip").remove()}))}))}(cash),function(t){var e={top:0,bottom:1/0,offset:0,onPositionChange:null},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_Pushpin=n,n.options=t.extend({},l.defaults,i),n.originalOffset=n.el.offsetTop,l._pushpins.push(n),n._setupEventHandlers(),n._updatePosition(),n}return s(l,a),n(l,[{key:"destroy",value:function(){this.el.style.top=null,this._removePinClasses(),this._removeEventHandlers();var t=l._pushpins.indexOf(this);l._pushpins.splice(t,1)}},{key:"_setupEventHandlers",value:function(){document.addEventListener("scroll",l._updateElements)}},{key:"_removeEventHandlers",value:function(){document.removeEventListener("scroll",l._updateElements)}},{key:"_updatePosition",value:function(){var t=M.getDocumentScrollTop()+this.options.offset;this.options.top<=t&&this.options.bottom>=t&&!this.el.classList.contains("pinned")&&(this._removePinClasses(),this.el.style.top=this.options.offset+"px",this.el.classList.add("pinned"),"function"==typeof this.options.onPositionChange&&this.options.onPositionChange.call(this,"pinned")),t<this.options.top&&!this.el.classList.contains("pin-top")&&(this._removePinClasses(),this.el.style.top=0,this.el.classList.add("pin-top"),"function"==typeof this.options.onPositionChange&&this.options.onPositionChange.call(this,"pin-top")),t>this.options.bottom&&!this.el.classList.contains("pin-bottom")&&(this._removePinClasses(),this.el.classList.add("pin-bottom"),this.el.style.top=this.options.bottom-this.originalOffset+"px","function"==typeof this.options.onPositionChange&&this.options.onPositionChange.call(this,"pin-bottom"))}},{key:"_removePinClasses",value:function(){this.el.classList.remove("pin-top"),this.el.classList.remove("pinned"),this.el.classList.remove("pin-bottom")}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Pushpin}},{key:"_updateElements",value:function(){for(var t in l._pushpins){l._pushpins[t]._updatePosition()}}},{key:"defaults",get:function(){return e}}]),l}(a);l._pushpins=[],M.Pushpin=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"pushpin","M_Pushpin")}(cash),function(t,e){var l={direction:"top",hoverEnabled:!0,toolbarEnabled:!1};t.fn.reverse=[].reverse;var c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_FloatingActionButton=n,n.options=t.extend({},c.defaults,i),n.isOpen=!1,n.$anchor=n.$el.children("a").first(),n.$menu=n.$el.children("ul").first(),n.$floatingBtns=n.$el.find("ul .btn-floating"),n.$floatingBtnsReverse=n.$el.find("ul .btn-floating").reverse(),n.offsetY=0,n.offsetX=0,n.$el.addClass("direction-"+n.options.direction),"top"===n.options.direction?n.offsetY=40:"right"===n.options.direction?n.offsetX=-40:"bottom"===n.options.direction?n.offsetY=-40:n.offsetX=40,n._setupEventHandlers(),n}return s(c,a),n(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_FloatingActionButton=void 0}},{key:"_setupEventHandlers",value:function(){this._handleFABClickBound=this._handleFABClick.bind(this),this._handleOpenBound=this.open.bind(this),this._handleCloseBound=this.close.bind(this),this.options.hoverEnabled&&!this.options.toolbarEnabled?(this.el.addEventListener("mouseenter",this._handleOpenBound),this.el.addEventListener("mouseleave",this._handleCloseBound)):this.el.addEventListener("click",this._handleFABClickBound)}},{key:"_removeEventHandlers",value:function(){this.options.hoverEnabled&&!this.options.toolbarEnabled?(this.el.removeEventListener("mouseenter",this._handleOpenBound),this.el.removeEventListener("mouseleave",this._handleCloseBound)):this.el.removeEventListener("click",this._handleFABClickBound)}},{key:"_handleFABClick",value:function(){this.isOpen?this.close():this.open()}},{key:"_handleDocumentClick",value:function(e){t(e.target).closest(this.$menu).length||this.close()}},{key:"open",value:function(){this.isOpen||(this.options.toolbarEnabled?this._animateInToolbar():this._animateInFAB(),this.isOpen=!0)}},{key:"close",value:function(){this.isOpen&&(this.options.toolbarEnabled?(window.removeEventListener("scroll",this._handleCloseBound,!0),document.body.removeEventListener("click",this._handleDocumentClickBound,!0),this._animateOutToolbar()):this._animateOutFAB(),this.isOpen=!1)}},{key:"_animateInFAB",value:function(){var t=this;this.$el.addClass("active");var i=0;this.$floatingBtnsReverse.each((function(n){e({targets:n,opacity:1,scale:[.4,1],translateY:[t.offsetY,0],translateX:[t.offsetX,0],duration:275,delay:i,easing:"easeInOutQuad"}),i+=40}))}},{key:"_animateOutFAB",value:function(){var t=this;this.$floatingBtnsReverse.each((function(i){e.remove(i),e({targets:i,opacity:0,scale:.4,translateY:t.offsetY,translateX:t.offsetX,duration:175,easing:"easeOutQuad",complete:function(){t.$el.removeClass("active")}})}))}},{key:"_animateInToolbar",value:function(){var e,i=this,n=window.innerWidth,o=window.innerHeight,s=this.el.getBoundingClientRect(),r=t('<div class="fab-backdrop"></div>'),a=this.$anchor.css("background-color");this.$anchor.append(r),this.offsetX=s.left-n/2+s.width/2,this.offsetY=o-s.bottom,e=n/r[0].clientWidth,this.btnBottom=s.bottom,this.btnLeft=s.left,this.btnWidth=s.width,this.$el.addClass("active"),this.$el.css({"text-align":"center",width:"100%",bottom:0,left:0,transform:"translateX("+this.offsetX+"px)",transition:"none"}),this.$anchor.css({transform:"translateY("+-this.offsetY+"px)",transition:"none"}),r.css({"background-color":a}),setTimeout((function(){i.$el.css({transform:"",transition:"transform .2s cubic-bezier(0.550, 0.085, 0.680, 0.530), background-color 0s linear .2s"}),i.$anchor.css({overflow:"visible",transform:"",transition:"transform .2s"}),setTimeout((function(){i.$el.css({overflow:"hidden","background-color":a}),r.css({transform:"scale("+e+")",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"}),i.$menu.children("li").children("a").css({opacity:1}),i._handleDocumentClickBound=i._handleDocumentClick.bind(i),window.addEventListener("scroll",i._handleCloseBound,!0),document.body.addEventListener("click",i._handleDocumentClickBound,!0)}),100)}),0)}},{key:"_animateOutToolbar",value:function(){var t=this,e=window.innerWidth,i=window.innerHeight,n=this.$el.find(".fab-backdrop"),o=this.$anchor.css("background-color");this.offsetX=this.btnLeft-e/2+this.btnWidth/2,this.offsetY=i-this.btnBottom,this.$el.removeClass("active"),this.$el.css({"background-color":"transparent",transition:"none"}),this.$anchor.css({transition:"none"}),n.css({transform:"scale(0)","background-color":o}),this.$menu.children("li").children("a").css({opacity:""}),setTimeout((function(){n.remove(),t.$el.css({"text-align":"",width:"",bottom:"",left:"",overflow:"","background-color":"",transform:"translate3d("+-t.offsetX+"px,0,0)"}),t.$anchor.css({overflow:"",transform:"translate3d(0,"+t.offsetY+"px,0)"}),setTimeout((function(){t.$el.css({transform:"translate3d(0,0,0)",transition:"transform .2s"}),t.$anchor.css({transform:"translate3d(0,0,0)",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"})}),20)}),200)}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_FloatingActionButton}},{key:"defaults",get:function(){return l}}]),c}(a);M.FloatingActionButton=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"floatingActionButton","M_FloatingActionButton")}(cash,M.anime),function(t){var e={autoClose:!1,format:"mmm dd, yyyy",parse:null,defaultDate:null,setDefaultDate:!1,disableWeekends:!1,disableDayFn:null,firstDay:0,minDate:null,maxDate:null,yearRange:10,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,container:null,showClearBtn:!1,i18n:{cancel:"Cancel",clear:"Clear",done:"Ok",previousMonth:"",nextMonth:"",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysAbbrev:["S","M","T","W","T","F","S"]},events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));n.el.M_Datepicker=n,n.options=t.extend({},l.defaults,i),i&&i.hasOwnProperty("i18n")&&"object"==typeof i.i18n&&(n.options.i18n=t.extend({},l.defaults.i18n,i.i18n)),n.options.minDate&&n.options.minDate.setHours(0,0,0,0),n.options.maxDate&&n.options.maxDate.setHours(0,0,0,0),n.id=M.guid(),n._setupVariables(),n._insertHTMLIntoDOM(),n._setupModal(),n._setupEventHandlers(),n.options.defaultDate||(n.options.defaultDate=new Date(Date.parse(n.el.value)));var s=n.options.defaultDate;return l._isDate(s)?n.options.setDefaultDate?(n.setDate(s,!0),n.setInputValue()):n.gotoDate(s):n.gotoDate(new Date),n.isOpen=!1,n}return s(l,a),n(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.modal.destroy(),t(this.modalEl).remove(),this.destroySelects(),this.el.M_Datepicker=void 0}},{key:"destroySelects",value:function(){var t=this.calendarEl.querySelector(".orig-select-year");t&&M.FormSelect.getInstance(t).destroy();var e=this.calendarEl.querySelector(".orig-select-month");e&&M.FormSelect.getInstance(e).destroy()}},{key:"_insertHTMLIntoDOM",value:function(){this.options.showClearBtn&&(t(this.clearBtn).css({visibility:""}),this.clearBtn.innerHTML=this.options.i18n.clear),this.doneBtn.innerHTML=this.options.i18n.done,this.cancelBtn.innerHTML=this.options.i18n.cancel,this.options.container?this.$modalEl.appendTo(this.options.container):this.$modalEl.insertBefore(this.el)}},{key:"_setupModal",value:function(){var t=this;this.modalEl.id="modal-"+this.id,this.modal=M.Modal.init(this.modalEl,{onCloseEnd:function(){t.isOpen=!1}})}},{key:"toString",value:function(t){var e=this;return t=t||this.options.format,l._isDate(this.date)?t.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g).map((function(t){return e.formats[t]?e.formats[t]():t})).join(""):""}},{key:"setDate",value:function(t,e){if(!t)return this.date=null,this._renderDateDisplay(),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),l._isDate(t)){var i=this.options.minDate,n=this.options.maxDate;l._isDate(i)&&t<i?t=i:l._isDate(n)&&t>n&&(t=n),this.date=new Date(t.getTime()),this._renderDateDisplay(),l._setToStartOfDay(this.date),this.gotoDate(this.date),e||"function"!=typeof this.options.onSelect||this.options.onSelect.call(this,this.date)}}},{key:"setInputValue",value:function(){this.el.value=this.toString(),this.$el.trigger("change",{firedBy:this})}},{key:"_renderDateDisplay",value:function(){var t=l._isDate(this.date)?this.date:new Date,e=this.options.i18n,i=e.weekdaysShort[t.getDay()],n=e.monthsShort[t.getMonth()],o=t.getDate();this.yearTextEl.innerHTML=t.getFullYear(),this.dateTextEl.innerHTML=i+", "+n+" "+o}},{key:"gotoDate",value:function(t){var e=!0;if(l._isDate(t)){if(this.calendars){var i=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=o<i.getTime()||n.getTime()<o}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}]),this.adjustCalendars()}}},{key:"adjustCalendars",value:function(){this.calendars[0]=this.adjustCalendar(this.calendars[0]),this.draw()}},{key:"adjustCalendar",value:function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t}},{key:"nextMonth",value:function(){this.calendars[0].month++,this.adjustCalendars()}},{key:"prevMonth",value:function(){this.calendars[0].month--,this.adjustCalendars()}},{key:"render",value:function(t,e,i){var n=this.options,o=new Date,s=l._getDaysInMonth(t,e),r=new Date(t,e,1).getDay(),a=[],c=[];l._setToStartOfDay(o),n.firstDay>0&&(r-=n.firstDay)<0&&(r+=7);for(var h=0===e?11:e-1,u=11===e?0:e+1,d=0===e?t-1:t,p=11===e?t+1:t,_=l._getDaysInMonth(d,h),m=s+r,f=m;f>7;)f-=7;m+=7-f;for(var g=!1,y=0,v=0;y<m;y++){var b=new Date(t,e,y-r+1),k=!!l._isDate(this.date)&&l._compareDates(b,this.date),w=l._compareDates(b,o),L=-1!==n.events.indexOf(b.toDateString()),x=y<r||y>=s+r,$=y-r+1,C=e,M=t,E=n.startRange&&l._compareDates(n.startRange,b),T=n.endRange&&l._compareDates(n.endRange,b),P=n.startRange&&n.endRange&&n.startRange<b&&b<n.endRange;x&&(y<r?($=_+$,C=h,M=d):($-=s,C=u,M=p));var S={day:$,month:C,year:M,hasEvent:L,isSelected:k,isToday:w,isDisabled:n.minDate&&b<n.minDate||n.maxDate&&b>n.maxDate||n.disableWeekends&&l._isWeekend(b)||n.disableDayFn&&n.disableDayFn(b),isEmpty:x,isStartRange:E,isEndRange:T,isInRange:P,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths};c.push(this.renderDay(S)),7==++v&&(a.push(this.renderRow(c,n.isRTL,g)),c=[],v=0,g=!1)}return this.renderTable(n,a,i)}},{key:"renderDay",value:function(t){var e=[],i="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),i="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+i+'"><button class="datepicker-day-button" type="button" data-year="'+t.year+'" data-month="'+t.month+'" data-day="'+t.day+'">'+t.day+"</button></td>"}},{key:"renderRow",value:function(t,e,i){return'<tr class="datepicker-row'+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"}},{key:"renderTable",value:function(t,e,i){return'<div class="datepicker-table-wrapper"><table cellpadding="0" cellspacing="0" class="datepicker-table" role="grid" aria-labelledby="'+i+'">'+this.renderHead(t)+this.renderBody(e)+"</table></div>"}},{key:"renderHead",value:function(t){var e=void 0,i=[];for(e=0;e<7;e++)i.push('<th scope="col"><abbr title="'+this.renderDayName(t,e)+'">'+this.renderDayName(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?i.reverse():i).join("")+"</tr></thead>"}},{key:"renderBody",value:function(t){return"<tbody>"+t.join("")+"</tbody>"}},{key:"renderTitle",value:function(e,i,n,o,s,r){var a,l,c=void 0,h=void 0,u=void 0,d=this.options,p=n===d.minYear,_=n===d.maxYear,m='<div id="'+r+'" class="datepicker-controls" role="heading" aria-live="assertive">',f=!0,g=!0;for(u=[],c=0;c<12;c++)u.push('<option value="'+(n===s?c-i:12+c-i)+'"'+(c===o?' selected="selected"':"")+(p&&c<d.minMonth||_&&c>d.maxMonth?'disabled="disabled"':"")+">"+d.i18n.months[c]+"</option>");for(a='<select class="datepicker-select orig-select-month" tabindex="-1">'+u.join("")+"</select>",t.isArray(d.yearRange)?(c=d.yearRange[0],h=d.yearRange[1]+1):(c=n-d.yearRange,h=1+n+d.yearRange),u=[];c<h&&c<=d.maxYear;c++)c>=d.minYear&&u.push('<option value="'+c+'" '+(c===n?'selected="selected"':"")+">"+c+"</option>");l='<select class="datepicker-select orig-select-year" tabindex="-1">'+u.join("")+"</select>";m+='<button class="month-prev'+(f?"":" is-disabled")+'" type="button"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"/><path d="M0-.5h24v24H0z" fill="none"/></svg></button>',m+='<div class="selects-container">',d.showMonthAfterYear?m+=l+a:m+=a+l,m+="</div>",p&&(0===o||d.minMonth>=o)&&(f=!1),_&&(11===o||d.maxMonth<=o)&&(g=!1);return(m+='<button class="month-next'+(g?"":" is-disabled")+'" type="button"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"/><path d="M0-.25h24v24H0z" fill="none"/></svg></button>')+"</div>"}},{key:"draw",value:function(t){if(this.isOpen||t){var e,i=this.options,n=i.minYear,o=i.maxYear,s=i.minMonth,r=i.maxMonth,a="";this._y<=n&&(this._y=n,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=o&&(this._y=o,!isNaN(r)&&this._m>r&&(this._m=r)),e="datepicker-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var l=0;l<1;l++)this._renderDateDisplay(),a+=this.renderTitle(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,e)+this.render(this.calendars[l].year,this.calendars[l].month,e);this.destroySelects(),this.calendarEl.innerHTML=a;var c=this.calendarEl.querySelector(".orig-select-year"),h=this.calendarEl.querySelector(".orig-select-month");M.FormSelect.init(c,{classes:"select-year",dropdownOptions:{container:document.body,constrainWidth:!1}}),M.FormSelect.init(h,{classes:"select-month",dropdownOptions:{container:document.body,constrainWidth:!1}}),c.addEventListener("change",this._handleYearChange.bind(this)),h.addEventListener("change",this._handleMonthChange.bind(this)),"function"==typeof this.options.onDraw&&this.options.onDraw(this)}}},{key:"_setupEventHandlers",value:function(){this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),this._handleInputChangeBound=this._handleInputChange.bind(this),this._handleCalendarClickBound=this._handleCalendarClick.bind(this),this._finishSelectionBound=this._finishSelection.bind(this),this._handleMonthChange=this._handleMonthChange.bind(this),this._closeBound=this.close.bind(this),this.el.addEventListener("click",this._handleInputClickBound),this.el.addEventListener("keydown",this._handleInputKeydownBound),this.el.addEventListener("change",this._handleInputChangeBound),this.calendarEl.addEventListener("click",this._handleCalendarClickBound),this.doneBtn.addEventListener("click",this._finishSelectionBound),this.cancelBtn.addEventListener("click",this._closeBound),this.options.showClearBtn&&(this._handleClearClickBound=this._handleClearClick.bind(this),this.clearBtn.addEventListener("click",this._handleClearClickBound))}},{key:"_setupVariables",value:function(){var e=this;this.$modalEl=t(l._template),this.modalEl=this.$modalEl[0],this.calendarEl=this.modalEl.querySelector(".datepicker-calendar"),this.yearTextEl=this.modalEl.querySelector(".year-text"),this.dateTextEl=this.modalEl.querySelector(".date-text"),this.options.showClearBtn&&(this.clearBtn=this.modalEl.querySelector(".datepicker-clear")),this.doneBtn=this.modalEl.querySelector(".datepicker-done"),this.cancelBtn=this.modalEl.querySelector(".datepicker-cancel"),this.formats={d:function(){return e.date.getDate()},dd:function(){var t=e.date.getDate();return(t<10?"0":"")+t},ddd:function(){return e.options.i18n.weekdaysShort[e.date.getDay()]},dddd:function(){return e.options.i18n.weekdays[e.date.getDay()]},m:function(){return e.date.getMonth()+1},mm:function(){var t=e.date.getMonth()+1;return(t<10?"0":"")+t},mmm:function(){return e.options.i18n.monthsShort[e.date.getMonth()]},mmmm:function(){return e.options.i18n.months[e.date.getMonth()]},yy:function(){return(""+e.date.getFullYear()).slice(2)},yyyy:function(){return e.date.getFullYear()}}}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleInputClickBound),this.el.removeEventListener("keydown",this._handleInputKeydownBound),this.el.removeEventListener("change",this._handleInputChangeBound),this.calendarEl.removeEventListener("click",this._handleCalendarClickBound)}},{key:"_handleInputClick",value:function(){this.open()}},{key:"_handleInputKeydown",value:function(t){t.which===M.keys.ENTER&&(t.preventDefault(),this.open())}},{key:"_handleCalendarClick",value:function(e){if(this.isOpen){var i=t(e.target);i.hasClass("is-disabled")||(!i.hasClass("datepicker-day-button")||i.hasClass("is-empty")||i.parent().hasClass("is-disabled")?i.closest(".month-prev").length?this.prevMonth():i.closest(".month-next").length&&this.nextMonth():(this.setDate(new Date(e.target.getAttribute("data-year"),e.target.getAttribute("data-month"),e.target.getAttribute("data-day"))),this.options.autoClose&&this._finishSelection()))}}},{key:"_handleClearClick",value:function(){this.date=null,this.setInputValue(),this.close()}},{key:"_handleMonthChange",value:function(t){this.gotoMonth(t.target.value)}},{key:"_handleYearChange",value:function(t){this.gotoYear(t.target.value)}},{key:"gotoMonth",value:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())}},{key:"gotoYear",value:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())}},{key:"_handleInputChange",value:function(t){var e=void 0;t.firedBy!==this&&(e=this.options.parse?this.options.parse(this.el.value,this.options.format):new Date(Date.parse(this.el.value)),l._isDate(e)&&this.setDate(e))}},{key:"renderDayName",value:function(t,e,i){for(e+=t.firstDay;e>=7;)e-=7;return i?t.i18n.weekdaysAbbrev[e]:t.i18n.weekdays[e]}},{key:"_finishSelection",value:function(){this.setInputValue(),this.close()}},{key:"open",value:function(){if(!this.isOpen)return this.isOpen=!0,"function"==typeof this.options.onOpen&&this.options.onOpen.call(this),this.draw(),this.modal.open(),this}},{key:"close",value:function(){if(this.isOpen)return this.isOpen=!1,"function"==typeof this.options.onClose&&this.options.onClose.call(this),this.modal.close(),this}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"_isDate",value:function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())}},{key:"_isWeekend",value:function(t){var e=t.getDay();return 0===e||6===e}},{key:"_setToStartOfDay",value:function(t){l._isDate(t)&&t.setHours(0,0,0,0)}},{key:"_getDaysInMonth",value:function(t,e){return[31,l._isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]}},{key:"_isLeapYear",value:function(t){return t%4==0&&t%100!=0||t%400==0}},{key:"_compareDates",value:function(t,e){return t.getTime()===e.getTime()}},{key:"_setToStartOfDay",value:function(t){l._isDate(t)&&t.setHours(0,0,0,0)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Datepicker}},{key:"defaults",get:function(){return e}}]),l}(a);l._template=['<div class= "modal datepicker-modal">','<div class="modal-content datepicker-container">','<div class="datepicker-date-display">','<span class="year-text"></span>','<span class="date-text"></span>',"</div>",'<div class="datepicker-calendar-container">','<div class="datepicker-calendar"></div>','<div class="datepicker-footer">','<button class="btn-flat datepicker-clear waves-effect" style="visibility: hidden;" type="button"></button>','<div class="confirmation-btns">','<button class="btn-flat datepicker-cancel waves-effect" type="button"></button>','<button class="btn-flat datepicker-done waves-effect" type="button"></button>',"</div>","</div>","</div>","</div>","</div>"].join(""),M.Datepicker=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"datepicker","M_Datepicker")}(cash),function(t){var e={dialRadius:135,outerRadius:105,innerRadius:70,tickRadius:20,duration:350,container:null,defaultTime:"now",fromNow:0,showClearBtn:!1,i18n:{cancel:"Cancel",clear:"Clear",done:"Ok"},autoClose:!1,twelveHour:!0,vibrate:!0,onOpenStart:null,onOpenEnd:null,onCloseStart:null,onCloseEnd:null,onSelect:null},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_Timepicker=n,n.options=t.extend({},l.defaults,i),n.id=M.guid(),n._insertHTMLIntoDOM(),n._setupModal(),n._setupVariables(),n._setupEventHandlers(),n._clockSetup(),n._pickerSetup(),n}return s(l,a),n(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.modal.destroy(),t(this.modalEl).remove(),this.el.M_Timepicker=void 0}},{key:"_setupEventHandlers",value:function(){this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),this._handleClockClickStartBound=this._handleClockClickStart.bind(this),this._handleDocumentClickMoveBound=this._handleDocumentClickMove.bind(this),this._handleDocumentClickEndBound=this._handleDocumentClickEnd.bind(this),this.el.addEventListener("click",this._handleInputClickBound),this.el.addEventListener("keydown",this._handleInputKeydownBound),this.plate.addEventListener("mousedown",this._handleClockClickStartBound),this.plate.addEventListener("touchstart",this._handleClockClickStartBound),t(this.spanHours).on("click",this.showView.bind(this,"hours")),t(this.spanMinutes).on("click",this.showView.bind(this,"minutes"))}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleInputClickBound),this.el.removeEventListener("keydown",this._handleInputKeydownBound)}},{key:"_handleInputClick",value:function(){this.open()}},{key:"_handleInputKeydown",value:function(t){t.which===M.keys.ENTER&&(t.preventDefault(),this.open())}},{key:"_handleClockClickStart",value:function(t){t.preventDefault();var e=this.plate.getBoundingClientRect(),i=e.left,n=e.top;this.x0=i+this.options.dialRadius,this.y0=n+this.options.dialRadius,this.moved=!1;var o=l._Pos(t);this.dx=o.x-this.x0,this.dy=o.y-this.y0,this.setHand(this.dx,this.dy,!1),document.addEventListener("mousemove",this._handleDocumentClickMoveBound),document.addEventListener("touchmove",this._handleDocumentClickMoveBound),document.addEventListener("mouseup",this._handleDocumentClickEndBound),document.addEventListener("touchend",this._handleDocumentClickEndBound)}},{key:"_handleDocumentClickMove",value:function(t){t.preventDefault();var e=l._Pos(t),i=e.x-this.x0,n=e.y-this.y0;this.moved=!0,this.setHand(i,n,!1,!0)}},{key:"_handleDocumentClickEnd",value:function(e){var i=this;e.preventDefault(),document.removeEventListener("mouseup",this._handleDocumentClickEndBound),document.removeEventListener("touchend",this._handleDocumentClickEndBound);var n=l._Pos(e),o=n.x-this.x0,s=n.y-this.y0;this.moved&&o===this.dx&&s===this.dy&&this.setHand(o,s),"hours"===this.currentView?this.showView("minutes",this.options.duration/2):this.options.autoClose&&(t(this.minutesView).addClass("timepicker-dial-out"),setTimeout((function(){i.done()}),this.options.duration/2)),"function"==typeof this.options.onSelect&&this.options.onSelect.call(this,this.hours,this.minutes),document.removeEventListener("mousemove",this._handleDocumentClickMoveBound),document.removeEventListener("touchmove",this._handleDocumentClickMoveBound)}},{key:"_insertHTMLIntoDOM",value:function(){this.$modalEl=t(l._template),this.modalEl=this.$modalEl[0],this.modalEl.id="modal-"+this.id;var e=document.querySelector(this.options.container);this.options.container&&e?this.$modalEl.appendTo(e):this.$modalEl.insertBefore(this.el)}},{key:"_setupModal",value:function(){var t=this;this.modal=M.Modal.init(this.modalEl,{onOpenStart:this.options.onOpenStart,onOpenEnd:this.options.onOpenEnd,onCloseStart:this.options.onCloseStart,onCloseEnd:function(){"function"==typeof t.options.onCloseEnd&&t.options.onCloseEnd.call(t),t.isOpen=!1}})}},{key:"_setupVariables",value:function(){this.currentView="hours",this.vibrate=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,this._canvas=this.modalEl.querySelector(".timepicker-canvas"),this.plate=this.modalEl.querySelector(".timepicker-plate"),this.hoursView=this.modalEl.querySelector(".timepicker-hours"),this.minutesView=this.modalEl.querySelector(".timepicker-minutes"),this.spanHours=this.modalEl.querySelector(".timepicker-span-hours"),this.spanMinutes=this.modalEl.querySelector(".timepicker-span-minutes"),this.spanAmPm=this.modalEl.querySelector(".timepicker-span-am-pm"),this.footer=this.modalEl.querySelector(".timepicker-footer"),this.amOrPm="PM"}},{key:"_pickerSetup",value:function(){var e=t('<button class="btn-flat timepicker-clear waves-effect" style="visibility: hidden;" type="button" tabindex="'+(this.options.twelveHour?"3":"1")+'">'+this.options.i18n.clear+"</button>").appendTo(this.footer).on("click",this.clear.bind(this));this.options.showClearBtn&&e.css({visibility:""});var i=t('<div class="confirmation-btns"></div>');t('<button class="btn-flat timepicker-close waves-effect" type="button" tabindex="'+(this.options.twelveHour?"3":"1")+'">'+this.options.i18n.cancel+"</button>").appendTo(i).on("click",this.close.bind(this)),t('<button class="btn-flat timepicker-close waves-effect" type="button" tabindex="'+(this.options.twelveHour?"3":"1")+'">'+this.options.i18n.done+"</button>").appendTo(i).on("click",this.done.bind(this)),i.appendTo(this.footer)}},{key:"_clockSetup",value:function(){this.options.twelveHour&&(this.$amBtn=t('<div class="am-btn">AM</div>'),this.$pmBtn=t('<div class="pm-btn">PM</div>'),this.$amBtn.on("click",this._handleAmPmClick.bind(this)).appendTo(this.spanAmPm),this.$pmBtn.on("click",this._handleAmPmClick.bind(this)).appendTo(this.spanAmPm)),this._buildHoursView(),this._buildMinutesView(),this._buildSVGClock()}},{key:"_buildSVGClock",value:function(){var t=this.options.dialRadius,e=this.options.tickRadius,i=2*t,n=l._createSVGEl("svg");n.setAttribute("class","timepicker-svg"),n.setAttribute("width",i),n.setAttribute("height",i);var o=l._createSVGEl("g");o.setAttribute("transform","translate("+t+","+t+")");var s=l._createSVGEl("circle");s.setAttribute("class","timepicker-canvas-bearing"),s.setAttribute("cx",0),s.setAttribute("cy",0),s.setAttribute("r",4);var r=l._createSVGEl("line");r.setAttribute("x1",0),r.setAttribute("y1",0);var a=l._createSVGEl("circle");a.setAttribute("class","timepicker-canvas-bg"),a.setAttribute("r",e),o.appendChild(r),o.appendChild(a),o.appendChild(s),n.appendChild(o),this._canvas.appendChild(n),this.hand=r,this.bg=a,this.bearing=s,this.g=o}},{key:"_buildHoursView",value:function(){var e=t('<div class="timepicker-tick"></div>');if(this.options.twelveHour)for(var i=1;i<13;i+=1){var n=e.clone(),o=i/6*Math.PI,s=this.options.outerRadius;n.css({left:this.options.dialRadius+Math.sin(o)*s-this.options.tickRadius+"px",top:this.options.dialRadius-Math.cos(o)*s-this.options.tickRadius+"px"}),n.html(0===i?"00":i),this.hoursView.appendChild(n[0])}else for(var r=0;r<24;r+=1){var a=e.clone(),l=r/6*Math.PI,c=r>0&&r<13?this.options.innerRadius:this.options.outerRadius;a.css({left:this.options.dialRadius+Math.sin(l)*c-this.options.tickRadius+"px",top:this.options.dialRadius-Math.cos(l)*c-this.options.tickRadius+"px"}),a.html(0===r?"00":r),this.hoursView.appendChild(a[0])}}},{key:"_buildMinutesView",value:function(){for(var e=t('<div class="timepicker-tick"></div>'),i=0;i<60;i+=5){var n=e.clone(),o=i/30*Math.PI;n.css({left:this.options.dialRadius+Math.sin(o)*this.options.outerRadius-this.options.tickRadius+"px",top:this.options.dialRadius-Math.cos(o)*this.options.outerRadius-this.options.tickRadius+"px"}),n.html(l._addLeadingZero(i)),this.minutesView.appendChild(n[0])}}},{key:"_handleAmPmClick",value:function(e){var i=t(e.target);this.amOrPm=i.hasClass("am-btn")?"AM":"PM",this._updateAmPmView()}},{key:"_updateAmPmView",value:function(){this.options.twelveHour&&(this.$amBtn.toggleClass("text-primary","AM"===this.amOrPm),this.$pmBtn.toggleClass("text-primary","PM"===this.amOrPm))}},{key:"_updateTimeFromInput",value:function(){var t=((this.el.value||this.options.defaultTime||"")+"").split(":");if(this.options.twelveHour&&void 0!==t[1]&&(t[1].toUpperCase().indexOf("AM")>0?this.amOrPm="AM":this.amOrPm="PM",t[1]=t[1].replace("AM","").replace("PM","")),"now"===t[0]){var e=new Date(+new Date+this.options.fromNow);t=[e.getHours(),e.getMinutes()],this.options.twelveHour&&(this.amOrPm=t[0]>=12&&t[0]<24?"PM":"AM")}this.hours=+t[0]||0,this.minutes=+t[1]||0,this.spanHours.innerHTML=this.hours,this.spanMinutes.innerHTML=l._addLeadingZero(this.minutes),this._updateAmPmView()}},{key:"showView",value:function(e,i){"minutes"===e&&t(this.hoursView).css("visibility");var n="hours"===e,o=n?this.hoursView:this.minutesView,s=n?this.minutesView:this.hoursView;this.currentView=e,t(this.spanHours).toggleClass("text-primary",n),t(this.spanMinutes).toggleClass("text-primary",!n),s.classList.add("timepicker-dial-out"),t(o).css("visibility","visible").removeClass("timepicker-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout((function(){t(s).css("visibility","hidden")}),this.options.duration)}},{key:"resetClock",value:function(e){var i=this.currentView,n=this[i],o="hours"===i,s=n*(Math.PI/(o?6:30)),r=o&&n>0&&n<13?this.options.innerRadius:this.options.outerRadius,a=Math.sin(s)*r,l=-Math.cos(s)*r,c=this;e?(t(this.canvas).addClass("timepicker-canvas-out"),setTimeout((function(){t(c.canvas).removeClass("timepicker-canvas-out"),c.setHand(a,l)}),e)):this.setHand(a,l)}},{key:"setHand",value:function(t,e,i){var n=this,o=Math.atan2(t,-e),s="hours"===this.currentView,r=Math.PI/(s||i?6:30),a=Math.sqrt(t*t+e*e),c=s&&a<(this.options.outerRadius+this.options.innerRadius)/2,h=c?this.options.innerRadius:this.options.outerRadius;this.options.twelveHour&&(h=this.options.outerRadius),o<0&&(o=2*Math.PI+o);var u=Math.round(o/r);o=u*r,this.options.twelveHour?s?0===u&&(u=12):(i&&(u*=5),60===u&&(u=0)):s?(12===u&&(u=0),u=c?0===u?12:u:0===u?0:u+12):(i&&(u*=5),60===u&&(u=0)),this[this.currentView]!==u&&this.vibrate&&this.options.vibrate&&(this.vibrateTimer||(navigator[this.vibrate](10),this.vibrateTimer=setTimeout((function(){n.vibrateTimer=null}),100))),this[this.currentView]=u,s?this.spanHours.innerHTML=u:this.spanMinutes.innerHTML=l._addLeadingZero(u);var d=Math.sin(o)*(h-this.options.tickRadius),p=-Math.cos(o)*(h-this.options.tickRadius),_=Math.sin(o)*h,m=-Math.cos(o)*h;this.hand.setAttribute("x2",d),this.hand.setAttribute("y2",p),this.bg.setAttribute("cx",_),this.bg.setAttribute("cy",m)}},{key:"open",value:function(){this.isOpen||(this.isOpen=!0,this._updateTimeFromInput(),this.showView("hours"),this.modal.open())}},{key:"close",value:function(){this.isOpen&&(this.isOpen=!1,this.modal.close())}},{key:"done",value:function(t,e){var i=this.el.value,n=e?"":l._addLeadingZero(this.hours)+":"+l._addLeadingZero(this.minutes);this.time=n,!e&&this.options.twelveHour&&(n=n+" "+this.amOrPm),this.el.value=n,n!==i&&this.$el.trigger("change"),this.close(),this.el.focus()}},{key:"clear",value:function(){this.done(null,!0)}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"_addLeadingZero",value:function(t){return(t<10?"0":"")+t}},{key:"_createSVGEl",value:function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}},{key:"_Pos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?{x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY}:{x:t.clientX,y:t.clientY}}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Timepicker}},{key:"defaults",get:function(){return e}}]),l}(a);l._template=['<div class= "modal timepicker-modal">','<div class="modal-content timepicker-container">','<div class="timepicker-digital-display">','<div class="timepicker-text-container">','<div class="timepicker-display-column">','<span class="timepicker-span-hours text-primary"></span>',":",'<span class="timepicker-span-minutes"></span>',"</div>",'<div class="timepicker-display-column timepicker-display-am-pm">','<div class="timepicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="timepicker-analog-display">','<div class="timepicker-plate">','<div class="timepicker-canvas"></div>','<div class="timepicker-dial timepicker-hours"></div>','<div class="timepicker-dial timepicker-minutes timepicker-dial-out"></div>',"</div>",'<div class="timepicker-footer"></div>',"</div>","</div>","</div>"].join(""),M.Timepicker=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"timepicker","M_Timepicker")}(cash),function(t){var e={},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_CharacterCounter=n,n.options=t.extend({},l.defaults,i),n.isInvalid=!1,n.isValidLength=!1,n._setupCounter(),n._setupEventHandlers(),n}return s(l,a),n(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.CharacterCounter=void 0,this._removeCounter()}},{key:"_setupEventHandlers",value:function(){this._handleUpdateCounterBound=this.updateCounter.bind(this),this.el.addEventListener("focus",this._handleUpdateCounterBound,!0),this.el.addEventListener("input",this._handleUpdateCounterBound,!0)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("focus",this._handleUpdateCounterBound,!0),this.el.removeEventListener("input",this._handleUpdateCounterBound,!0)}},{key:"_setupCounter",value:function(){this.counterEl=document.createElement("span"),t(this.counterEl).addClass("character-counter").css({float:"right","font-size":"12px",height:1}),this.$el.parent().append(this.counterEl)}},{key:"_removeCounter",value:function(){t(this.counterEl).remove()}},{key:"updateCounter",value:function(){var e=+this.$el.attr("data-length"),i=this.el.value.length;this.isValidLength=i<=e;var n=i;e&&(n+="/"+e,this._validateInput()),t(this.counterEl).html(n)}},{key:"_validateInput",value:function(){this.isValidLength&&this.isInvalid?(this.isInvalid=!1,this.$el.removeClass("invalid")):this.isValidLength||this.isInvalid||(this.isInvalid=!0,this.$el.removeClass("valid"),this.$el.addClass("invalid"))}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_CharacterCounter}},{key:"defaults",get:function(){return e}}]),l}(a);M.CharacterCounter=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"characterCounter","M_CharacterCounter")}(cash),function(t){var e={duration:200,dist:-100,shift:0,padding:0,numVisible:5,fullWidth:!1,indicators:!1,noWrap:!1,onCycleTo:null},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_Carousel=n,n.options=t.extend({},l.defaults,i),n.hasMultipleSlides=n.$el.find(".carousel-item").length>1,n.showIndicators=n.options.indicators&&n.hasMultipleSlides,n.noWrap=n.options.noWrap||!n.hasMultipleSlides,n.pressed=!1,n.dragged=!1,n.offset=n.target=0,n.images=[],n.itemWidth=n.$el.find(".carousel-item").first().innerWidth(),n.itemHeight=n.$el.find(".carousel-item").first().innerHeight(),n.dim=2*n.itemWidth+n.options.padding||1,n._autoScrollBound=n._autoScroll.bind(n),n._trackBound=n._track.bind(n),n.options.fullWidth&&(n.options.dist=0,n._setCarouselHeight(),n.showIndicators&&n.$el.find(".carousel-fixed-item").addClass("with-indicators")),n.$indicators=t('<ul class="indicators"></ul>'),n.$el.find(".carousel-item").each((function(e,i){if(n.images.push(e),n.showIndicators){var o=t('<li class="indicator-item"></li>');0===i&&o[0].classList.add("active"),n.$indicators.append(o)}})),n.showIndicators&&n.$el.append(n.$indicators),n.count=n.images.length,n.options.numVisible=Math.min(n.count,n.options.numVisible),n.xform="transform",["webkit","Moz","O","ms"].every((function(t){var e=t+"Transform";return void 0===document.body.style[e]||(n.xform=e,!1)})),n._setupEventHandlers(),n._scroll(n.offset),n}return s(l,a),n(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.M_Carousel=void 0}},{key:"_setupEventHandlers",value:function(){var t=this;this._handleCarouselTapBound=this._handleCarouselTap.bind(this),this._handleCarouselDragBound=this._handleCarouselDrag.bind(this),this._handleCarouselReleaseBound=this._handleCarouselRelease.bind(this),this._handleCarouselClickBound=this._handleCarouselClick.bind(this),void 0!==window.ontouchstart&&(this.el.addEventListener("touchstart",this._handleCarouselTapBound),this.el.addEventListener("touchmove",this._handleCarouselDragBound),this.el.addEventListener("touchend",this._handleCarouselReleaseBound)),this.el.addEventListener("mousedown",this._handleCarouselTapBound),this.el.addEventListener("mousemove",this._handleCarouselDragBound),this.el.addEventListener("mouseup",this._handleCarouselReleaseBound),this.el.addEventListener("mouseleave",this._handleCarouselReleaseBound),this.el.addEventListener("click",this._handleCarouselClickBound),this.showIndicators&&this.$indicators&&(this._handleIndicatorClickBound=this._handleIndicatorClick.bind(this),this.$indicators.find(".indicator-item").each((function(e,i){e.addEventListener("click",t._handleIndicatorClickBound)})));var e=M.throttle(this._handleResize,200);this._handleThrottledResizeBound=e.bind(this),window.addEventListener("resize",this._handleThrottledResizeBound)}},{key:"_removeEventHandlers",value:function(){var t=this;void 0!==window.ontouchstart&&(this.el.removeEventListener("touchstart",this._handleCarouselTapBound),this.el.removeEventListener("touchmove",this._handleCarouselDragBound),this.el.removeEventListener("touchend",this._handleCarouselReleaseBound)),this.el.removeEventListener("mousedown",this._handleCarouselTapBound),this.el.removeEventListener("mousemove",this._handleCarouselDragBound),this.el.removeEventListener("mouseup",this._handleCarouselReleaseBound),this.el.removeEventListener("mouseleave",this._handleCarouselReleaseBound),this.el.removeEventListener("click",this._handleCarouselClickBound),this.showIndicators&&this.$indicators&&this.$indicators.find(".indicator-item").each((function(e,i){e.removeEventListener("click",t._handleIndicatorClickBound)})),window.removeEventListener("resize",this._handleThrottledResizeBound)}},{key:"_handleCarouselTap",value:function(e){"mousedown"===e.type&&t(e.target).is("img")&&e.preventDefault(),this.pressed=!0,this.dragged=!1,this.verticalDragged=!1,this.reference=this._xpos(e),this.referenceY=this._ypos(e),this.velocity=this.amplitude=0,this.frame=this.offset,this.timestamp=Date.now(),clearInterval(this.ticker),this.ticker=setInterval(this._trackBound,100)}},{key:"_handleCarouselDrag",value:function(t){var e=void 0,i=void 0,n=void 0;if(this.pressed)if(e=this._xpos(t),i=this._ypos(t),n=this.reference-e,Math.abs(this.referenceY-i)<30&&!this.verticalDragged)(n>2||n<-2)&&(this.dragged=!0,this.reference=e,this._scroll(this.offset+n));else{if(this.dragged)return t.preventDefault(),t.stopPropagation(),!1;this.verticalDragged=!0}if(this.dragged)return t.preventDefault(),t.stopPropagation(),!1}},{key:"_handleCarouselRelease",value:function(t){if(this.pressed)return this.pressed=!1,clearInterval(this.ticker),this.target=this.offset,(this.velocity>10||this.velocity<-10)&&(this.amplitude=.9*this.velocity,this.target=this.offset+this.amplitude),this.target=Math.round(this.target/this.dim)*this.dim,this.noWrap&&(this.target>=this.dim*(this.count-1)?this.target=this.dim*(this.count-1):this.target<0&&(this.target=0)),this.amplitude=this.target-this.offset,this.timestamp=Date.now(),requestAnimationFrame(this._autoScrollBound),this.dragged&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"_handleCarouselClick",value:function(e){if(this.dragged)return e.preventDefault(),e.stopPropagation(),!1;if(!this.options.fullWidth){var i=t(e.target).closest(".carousel-item").index();0!==this._wrap(this.center)-i&&(e.preventDefault(),e.stopPropagation()),this._cycleTo(i)}}},{key:"_handleIndicatorClick",value:function(e){e.stopPropagation();var i=t(e.target).closest(".indicator-item");i.length&&this._cycleTo(i.index())}},{key:"_handleResize",value:function(t){this.options.fullWidth?(this.itemWidth=this.$el.find(".carousel-item").first().innerWidth(),this.imageHeight=this.$el.find(".carousel-item.active").height(),this.dim=2*this.itemWidth+this.options.padding,this.offset=2*this.center*this.itemWidth,this.target=this.offset,this._setCarouselHeight(!0)):this._scroll()}},{key:"_setCarouselHeight",value:function(t){var e=this,i=this.$el.find(".carousel-item.active").length?this.$el.find(".carousel-item.active").first():this.$el.find(".carousel-item").first(),n=i.find("img").first();if(n.length)if(n[0].complete){var o=n.height();if(o>0)this.$el.css("height",o+"px");else{var s=n[0].naturalWidth,r=n[0].naturalHeight,a=this.$el.width()/s*r;this.$el.css("height",a+"px")}}else n.one("load",(function(t,i){e.$el.css("height",t.offsetHeight+"px")}));else if(!t){var l=i.height();this.$el.css("height",l+"px")}}},{key:"_xpos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}},{key:"_ypos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}},{key:"_wrap",value:function(t){return t>=this.count?t%this.count:t<0?this._wrap(this.count+t%this.count):t}},{key:"_track",value:function(){var t,e,i,n;e=(t=Date.now())-this.timestamp,this.timestamp=t,i=this.offset-this.frame,this.frame=this.offset,n=1e3*i/(1+e),this.velocity=.8*n+.2*this.velocity}},{key:"_autoScroll",value:function(){var t=void 0,e=void 0;this.amplitude&&(t=Date.now()-this.timestamp,(e=this.amplitude*Math.exp(-t/this.options.duration))>2||e<-2?(this._scroll(this.target-e),requestAnimationFrame(this._autoScrollBound)):this._scroll(this.target))}},{key:"_scroll",value:function(e){var i=this;this.$el.hasClass("scrolling")||this.el.classList.add("scrolling"),null!=this.scrollingTimeout&&window.clearTimeout(this.scrollingTimeout),this.scrollingTimeout=window.setTimeout((function(){i.$el.removeClass("scrolling")}),this.options.duration);var n,o,s,r,a=void 0,l=void 0,c=void 0,h=void 0,u=void 0,d=void 0,p=this.center,_=1/this.options.numVisible;if(this.offset="number"==typeof e?e:this.offset,this.center=Math.floor((this.offset+this.dim/2)/this.dim),r=-(s=(o=this.offset-this.center*this.dim)<0?1:-1)*o*2/this.dim,n=this.count>>1,this.options.fullWidth?(c="translateX(0)",d=1):(c="translateX("+(this.el.clientWidth-this.itemWidth)/2+"px) ",c+="translateY("+(this.el.clientHeight-this.itemHeight)/2+"px)",d=1-_*r),this.showIndicators){var m=this.center%this.count,f=this.$indicators.find(".indicator-item.active");f.index()!==m&&(f.removeClass("active"),this.$indicators.find(".indicator-item").eq(m)[0].classList.add("active"))}if(!this.noWrap||this.center>=0&&this.center<this.count){l=this.images[this._wrap(this.center)],t(l).hasClass("active")||(this.$el.find(".carousel-item").removeClass("active"),l.classList.add("active"));var g=c+" translateX("+-o/2+"px) translateX("+s*this.options.shift*r*a+"px) translateZ("+this.options.dist*r+"px)";this._updateItemStyle(l,d,0,g)}for(a=1;a<=n;++a){if(this.options.fullWidth?(h=this.options.dist,u=a===n&&o<0?1-r:1):(h=this.options.dist*(2*a+r*s),u=1-_*(2*a+r*s)),!this.noWrap||this.center+a<this.count){l=this.images[this._wrap(this.center+a)];var y=c+" translateX("+(this.options.shift+(this.dim*a-o)/2)+"px) translateZ("+h+"px)";this._updateItemStyle(l,u,-a,y)}if(this.options.fullWidth?(h=this.options.dist,u=a===n&&o>0?1-r:1):(h=this.options.dist*(2*a-r*s),u=1-_*(2*a-r*s)),!this.noWrap||this.center-a>=0){l=this.images[this._wrap(this.center-a)];var v=c+" translateX("+(-this.options.shift+(-this.dim*a-o)/2)+"px) translateZ("+h+"px)";this._updateItemStyle(l,u,-a,v)}}if(!this.noWrap||this.center>=0&&this.center<this.count){l=this.images[this._wrap(this.center)];var b=c+" translateX("+-o/2+"px) translateX("+s*this.options.shift*r+"px) translateZ("+this.options.dist*r+"px)";this._updateItemStyle(l,d,0,b)}var k=this.$el.find(".carousel-item").eq(this._wrap(this.center));p!==this.center&&"function"==typeof this.options.onCycleTo&&this.options.onCycleTo.call(this,k[0],this.dragged),"function"==typeof this.oneTimeCallback&&(this.oneTimeCallback.call(this,k[0],this.dragged),this.oneTimeCallback=null)}},{key:"_updateItemStyle",value:function(t,e,i,n){t.style[this.xform]=n,t.style.zIndex=i,t.style.opacity=e,t.style.visibility="visible"}},{key:"_cycleTo",value:function(t,e){var i=this.center%this.count-t;this.noWrap||(i<0?Math.abs(i+this.count)<Math.abs(i)&&(i+=this.count):i>0&&Math.abs(i-this.count)<i&&(i-=this.count)),this.target=this.dim*Math.round(this.offset/this.dim),i<0?this.target+=this.dim*Math.abs(i):i>0&&(this.target-=this.dim*i),"function"==typeof e&&(this.oneTimeCallback=e),this.offset!==this.target&&(this.amplitude=this.target-this.offset,this.timestamp=Date.now(),requestAnimationFrame(this._autoScrollBound))}},{key:"next",value:function(t){(void 0===t||isNaN(t))&&(t=1);var e=this.center+t;if(e>=this.count||e<0){if(this.noWrap)return;e=this._wrap(e)}this._cycleTo(e)}},{key:"prev",value:function(t){(void 0===t||isNaN(t))&&(t=1);var e=this.center-t;if(e>=this.count||e<0){if(this.noWrap)return;e=this._wrap(e)}this._cycleTo(e)}},{key:"set",value:function(t,e){if((void 0===t||isNaN(t))&&(t=0),t>this.count||t<0){if(this.noWrap)return;t=this._wrap(t)}this._cycleTo(t,e)}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Carousel}},{key:"defaults",get:function(){return e}}]),l}(a);M.Carousel=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"carousel","M_Carousel")}(cash),function(t){var e={onOpen:void 0,onClose:void 0},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.el.M_TapTarget=n,n.options=t.extend({},l.defaults,i),n.isOpen=!1,n.$origin=t("#"+n.$el.attr("data-target")),n._setup(),n._calculatePositioning(),n._setupEventHandlers(),n}return s(l,a),n(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this.el.TapTarget=void 0}},{key:"_setupEventHandlers",value:function(){this._handleDocumentClickBound=this._handleDocumentClick.bind(this),this._handleTargetClickBound=this._handleTargetClick.bind(this),this._handleOriginClickBound=this._handleOriginClick.bind(this),this.el.addEventListener("click",this._handleTargetClickBound),this.originEl.addEventListener("click",this._handleOriginClickBound);var t=M.throttle(this._handleResize,200);this._handleThrottledResizeBound=t.bind(this),window.addEventListener("resize",this._handleThrottledResizeBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("click",this._handleTargetClickBound),this.originEl.removeEventListener("click",this._handleOriginClickBound),window.removeEventListener("resize",this._handleThrottledResizeBound)}},{key:"_handleTargetClick",value:function(t){this.open()}},{key:"_handleOriginClick",value:function(t){this.close()}},{key:"_handleResize",value:function(t){this._calculatePositioning()}},{key:"_handleDocumentClick",value:function(e){t(e.target).closest(".tap-target-wrapper").length||(this.close(),e.preventDefault(),e.stopPropagation())}},{key:"_setup",value:function(){this.wrapper=this.$el.parent()[0],this.waveEl=t(this.wrapper).find(".tap-target-wave")[0],this.originEl=t(this.wrapper).find(".tap-target-origin")[0],this.contentEl=this.$el.find(".tap-target-content")[0],t(this.wrapper).hasClass(".tap-target-wrapper")||(this.wrapper=document.createElement("div"),this.wrapper.classList.add("tap-target-wrapper"),this.$el.before(t(this.wrapper)),this.wrapper.append(this.el)),this.contentEl||(this.contentEl=document.createElement("div"),this.contentEl.classList.add("tap-target-content"),this.$el.append(this.contentEl)),this.waveEl||(this.waveEl=document.createElement("div"),this.waveEl.classList.add("tap-target-wave"),this.originEl||(this.originEl=this.$origin.clone(!0,!0),this.originEl.addClass("tap-target-origin"),this.originEl.removeAttr("id"),this.originEl.removeAttr("style"),this.originEl=this.originEl[0],this.waveEl.append(this.originEl)),this.wrapper.append(this.waveEl))}},{key:"_calculatePositioning",value:function(){var e="fixed"===this.$origin.css("position");if(!e)for(var i=this.$origin.parents(),n=0;n<i.length&&!(e="fixed"==t(i[n]).css("position"));n++);var o=this.$origin.outerWidth(),s=this.$origin.outerHeight(),r=e?this.$origin.offset().top-M.getDocumentScrollTop():this.$origin.offset().top,a=e?this.$origin.offset().left-M.getDocumentScrollLeft():this.$origin.offset().left,l=window.innerWidth,c=window.innerHeight,h=l/2,u=c/2,d=a<=h,p=a>h,_=r<=u,m=r>u,f=a>=.25*l&&a<=.75*l,g=this.$el.outerWidth(),y=this.$el.outerHeight(),v=r+s/2-y/2,b=a+o/2-g/2,k=e?"fixed":"absolute",w=f?g:g/2+o,L=y/2,x=_?y/2:0,$=d&&!f?g/2-o:0,C=o,E=m?"bottom":"top",T=2*o,P=T,S=y/2-P/2,O=g/2-T/2,D={};D.top=_?v+"px":"",D.right=p?l-b-g+"px":"",D.bottom=m?c-v-y+"px":"",D.left=d?b+"px":"",D.position=k,t(this.wrapper).css(D),t(this.contentEl).css({width:w+"px",height:L+"px",top:x+"px",right:"0px",bottom:"0px",left:$+"px",padding:C+"px",verticalAlign:E}),t(this.waveEl).css({top:S+"px",left:O+"px",width:T+"px",height:P+"px"})}},{key:"open",value:function(){this.isOpen||("function"==typeof this.options.onOpen&&this.options.onOpen.call(this,this.$origin[0]),this.isOpen=!0,this.wrapper.classList.add("open"),document.body.addEventListener("click",this._handleDocumentClickBound,!0),document.body.addEventListener("touchend",this._handleDocumentClickBound))}},{key:"close",value:function(){this.isOpen&&("function"==typeof this.options.onClose&&this.options.onClose.call(this,this.$origin[0]),this.isOpen=!1,this.wrapper.classList.remove("open"),document.body.removeEventListener("click",this._handleDocumentClickBound,!0),document.body.removeEventListener("touchend",this._handleDocumentClickBound))}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_TapTarget}},{key:"defaults",get:function(){return e}}]),l}(a);M.TapTarget=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"tapTarget","M_TapTarget")}(cash),function(t){var e={classes:"",dropdownOptions:{}},l=function(a){function l(e,i){r(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,l,e,i));return n.$el.hasClass("browser-default")?o(n):(n.el.M_FormSelect=n,n.options=t.extend({},l.defaults,i),n.isMultiple=n.$el.prop("multiple"),n.el.tabIndex=-1,n._keysSelected={},n._valueDict={},n._setupDropdown(),n._setupEventHandlers(),n)}return s(l,a),n(l,[{key:"destroy",value:function(){this._removeEventHandlers(),this._removeDropdown(),this.el.M_FormSelect=void 0}},{key:"_setupEventHandlers",value:function(){var e=this;this._handleSelectChangeBound=this._handleSelectChange.bind(this),this._handleOptionClickBound=this._handleOptionClick.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),t(this.dropdownOptions).find("li:not(.optgroup)").each((function(t){t.addEventListener("click",e._handleOptionClickBound)})),this.el.addEventListener("change",this._handleSelectChangeBound),this.input.addEventListener("click",this._handleInputClickBound)}},{key:"_removeEventHandlers",value:function(){var e=this;t(this.dropdownOptions).find("li:not(.optgroup)").each((function(t){t.removeEventListener("click",e._handleOptionClickBound)})),this.el.removeEventListener("change",this._handleSelectChangeBound),this.input.removeEventListener("click",this._handleInputClickBound)}},{key:"_handleSelectChange",value:function(t){this._setValueToInput()}},{key:"_handleOptionClick",value:function(e){e.preventDefault();var i=t(e.target).closest("li")[0],n=i.id;if(!t(i).hasClass("disabled")&&!t(i).hasClass("optgroup")&&n.length){var o=!0;if(this.isMultiple){var s=t(this.dropdownOptions).find("li.disabled.selected");s.length&&(s.removeClass("selected"),s.find('input[type="checkbox"]').prop("checked",!1),this._toggleEntryFromArray(s[0].id)),o=this._toggleEntryFromArray(n)}else t(this.dropdownOptions).find("li").removeClass("selected"),t(i).toggleClass("selected",o);t(this._valueDict[n].el).prop("selected")!==o&&(t(this._valueDict[n].el).prop("selected",o),this.$el.trigger("change"))}e.stopPropagation()}},{key:"_handleInputClick",value:function(){this.dropdown&&this.dropdown.isOpen&&(this._setValueToInput(),this._setSelectedStates())}},{key:"_setupDropdown",value:function(){var e=this;this.wrapper=document.createElement("div"),t(this.wrapper).addClass("select-wrapper "+this.options.classes),this.$el.before(t(this.wrapper)),this.wrapper.appendChild(this.el),this.el.disabled&&this.wrapper.classList.add("disabled"),this.$selectOptions=this.$el.children("option, optgroup"),this.dropdownOptions=document.createElement("ul"),this.dropdownOptions.id="select-options-"+M.guid(),t(this.dropdownOptions).addClass("dropdown-content select-dropdown "+(this.isMultiple?"multiple-select-dropdown":"")),this.$selectOptions.length&&this.$selectOptions.each((function(i){if(t(i).is("option")){var n=void 0;n=e.isMultiple?e._appendOptionWithIcon(e.$el,i,"multiple"):e._appendOptionWithIcon(e.$el,i),e._addOptionToValueDict(i,n)}else if(t(i).is("optgroup")){var o=t(i).children("option");t(e.dropdownOptions).append(t('<li class="optgroup"><span>'+i.getAttribute("label")+"</span></li>")[0]),o.each((function(t){var i=e._appendOptionWithIcon(e.$el,t,"optgroup-option");e._addOptionToValueDict(t,i)}))}})),this.$el.after(this.dropdownOptions),this.input=document.createElement("input"),t(this.input).addClass("select-dropdown dropdown-trigger"),this.input.setAttribute("type","text"),this.input.setAttribute("readonly","true"),this.input.setAttribute("data-target",this.dropdownOptions.id),this.el.disabled&&t(this.input).prop("disabled","true"),this.$el.before(this.input),this._setValueToInput();var i=t('<svg class="caret" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');if(this.$el.before(i[0]),!this.el.disabled){var n=t.extend({},this.options.dropdownOptions);n.onOpenEnd=function(i){var n=t(e.dropdownOptions).find(".selected").first();if(n.length&&(M.keyDown=!0,e.dropdown.focusedIndex=n.index(),e.dropdown._focusFocusedItem(),M.keyDown=!1,e.dropdown.isScrollable)){var o=n[0].getBoundingClientRect().top-e.dropdownOptions.getBoundingClientRect().top;o-=e.dropdownOptions.clientHeight/2,e.dropdownOptions.scrollTop=o}},this.isMultiple&&(n.closeOnClick=!1),this.dropdown=M.Dropdown.init(this.input,n)}this._setSelectedStates()}},{key:"_addOptionToValueDict",value:function(t,e){var i=Object.keys(this._valueDict).length,n=this.dropdownOptions.id+i,o={};e.id=n,o.el=t,o.optionEl=e,this._valueDict[n]=o}},{key:"_removeDropdown",value:function(){t(this.wrapper).find(".caret").remove(),t(this.input).remove(),t(this.dropdownOptions).remove(),t(this.wrapper).before(this.$el),t(this.wrapper).remove()}},{key:"_appendOptionWithIcon",value:function(e,i,n){var o=i.disabled?"disabled ":"",s="optgroup-option"===n?"optgroup-option ":"",r=this.isMultiple?'<label><input type="checkbox"'+o+'"/><span>'+i.innerHTML+"</span></label>":i.innerHTML,a=t("<li></li>"),l=t("<span></span>");l.html(r),a.addClass(o+" "+s),a.append(l);var c=i.getAttribute("data-icon");if(c){var h=t('<img alt="" src="'+c+'">');a.prepend(h)}return t(this.dropdownOptions).append(a[0]),a[0]}},{key:"_toggleEntryFromArray",value:function(e){var i=!this._keysSelected.hasOwnProperty(e),n=t(this._valueDict[e].optionEl);return i?this._keysSelected[e]=!0:delete this._keysSelected[e],n.toggleClass("selected",i),n.find('input[type="checkbox"]').prop("checked",i),n.prop("selected",i),i}},{key:"_setValueToInput",value:function(){var e=[];if(this.$el.find("option").each((function(i){if(t(i).prop("selected")){var n=t(i).text();e.push(n)}})),!e.length){var i=this.$el.find("option:disabled").eq(0);i.length&&""===i[0].value&&e.push(i.text())}this.input.value=e.join(", ")}},{key:"_setSelectedStates",value:function(){for(var e in this._keysSelected={},this._valueDict){var i=this._valueDict[e],n=t(i.el).prop("selected");t(i.optionEl).find('input[type="checkbox"]').prop("checked",n),n?(this._activateOption(t(this.dropdownOptions),t(i.optionEl)),this._keysSelected[e]=!0):t(i.optionEl).removeClass("selected")}}},{key:"_activateOption",value:function(e,i){i&&(this.isMultiple||e.find("li.selected").removeClass("selected"),t(i).addClass("selected"))}},{key:"getSelectedValues",value:function(){var t=[];for(var e in this._keysSelected)t.push(this._valueDict[e].el.value);return t}}],[{key:"init",value:function(t,e){return i(l.__proto__||Object.getPrototypeOf(l),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_FormSelect}},{key:"defaults",get:function(){return e}}]),l}(a);M.FormSelect=l,M.jQueryLoaded&&M.initializeJqueryWrapper(l,"formSelect","M_FormSelect")}(cash),function(t,e){var l={},c=function(a){function c(e,i){r(this,c);var n=o(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,c,e,i));return n.el.M_Range=n,n.options=t.extend({},c.defaults,i),n._mousedown=!1,n._setupThumb(),n._setupEventHandlers(),n}return s(c,a),n(c,[{key:"destroy",value:function(){this._removeEventHandlers(),this._removeThumb(),this.el.M_Range=void 0}},{key:"_setupEventHandlers",value:function(){this._handleRangeChangeBound=this._handleRangeChange.bind(this),this._handleRangeMousedownTouchstartBound=this._handleRangeMousedownTouchstart.bind(this),this._handleRangeInputMousemoveTouchmoveBound=this._handleRangeInputMousemoveTouchmove.bind(this),this._handleRangeMouseupTouchendBound=this._handleRangeMouseupTouchend.bind(this),this._handleRangeBlurMouseoutTouchleaveBound=this._handleRangeBlurMouseoutTouchleave.bind(this),this.el.addEventListener("change",this._handleRangeChangeBound),this.el.addEventListener("mousedown",this._handleRangeMousedownTouchstartBound),this.el.addEventListener("touchstart",this._handleRangeMousedownTouchstartBound),this.el.addEventListener("input",this._handleRangeInputMousemoveTouchmoveBound),this.el.addEventListener("mousemove",this._handleRangeInputMousemoveTouchmoveBound),this.el.addEventListener("touchmove",this._handleRangeInputMousemoveTouchmoveBound),this.el.addEventListener("mouseup",this._handleRangeMouseupTouchendBound),this.el.addEventListener("touchend",this._handleRangeMouseupTouchendBound),this.el.addEventListener("blur",this._handleRangeBlurMouseoutTouchleaveBound),this.el.addEventListener("mouseout",this._handleRangeBlurMouseoutTouchleaveBound),this.el.addEventListener("touchleave",this._handleRangeBlurMouseoutTouchleaveBound)}},{key:"_removeEventHandlers",value:function(){this.el.removeEventListener("change",this._handleRangeChangeBound),this.el.removeEventListener("mousedown",this._handleRangeMousedownTouchstartBound),this.el.removeEventListener("touchstart",this._handleRangeMousedownTouchstartBound),this.el.removeEventListener("input",this._handleRangeInputMousemoveTouchmoveBound),this.el.removeEventListener("mousemove",this._handleRangeInputMousemoveTouchmoveBound),this.el.removeEventListener("touchmove",this._handleRangeInputMousemoveTouchmoveBound),this.el.removeEventListener("mouseup",this._handleRangeMouseupTouchendBound),this.el.removeEventListener("touchend",this._handleRangeMouseupTouchendBound),this.el.removeEventListener("blur",this._handleRangeBlurMouseoutTouchleaveBound),this.el.removeEventListener("mouseout",this._handleRangeBlurMouseoutTouchleaveBound),this.el.removeEventListener("touchleave",this._handleRangeBlurMouseoutTouchleaveBound)}},{key:"_handleRangeChange",value:function(){t(this.value).html(this.$el.val()),t(this.thumb).hasClass("active")||this._showRangeBubble();var e=this._calcRangeOffset();t(this.thumb).addClass("active").css("left",e+"px")}},{key:"_handleRangeMousedownTouchstart",value:function(e){if(t(this.value).html(this.$el.val()),this._mousedown=!0,this.$el.addClass("active"),t(this.thumb).hasClass("active")||this._showRangeBubble(),"input"!==e.type){var i=this._calcRangeOffset();t(this.thumb).addClass("active").css("left",i+"px")}}},{key:"_handleRangeInputMousemoveTouchmove",value:function(){if(this._mousedown){t(this.thumb).hasClass("active")||this._showRangeBubble();var e=this._calcRangeOffset();t(this.thumb).addClass("active").css("left",e+"px"),t(this.value).html(this.$el.val())}}},{key:"_handleRangeMouseupTouchend",value:function(){this._mousedown=!1,this.$el.removeClass("active")}},{key:"_handleRangeBlurMouseoutTouchleave",value:function(){if(!this._mousedown){var i=7+parseInt(this.$el.css("padding-left"))+"px";t(this.thumb).hasClass("active")&&(e.remove(this.thumb),e({targets:this.thumb,height:0,width:0,top:10,easing:"easeOutQuad",marginLeft:i,duration:100})),t(this.thumb).removeClass("active")}}},{key:"_setupThumb",value:function(){this.thumb=document.createElement("span"),this.value=document.createElement("span"),t(this.thumb).addClass("thumb"),t(this.value).addClass("value"),t(this.thumb).append(this.value),this.$el.after(this.thumb)}},{key:"_removeThumb",value:function(){t(this.thumb).remove()}},{key:"_showRangeBubble",value:function(){var i=-7+parseInt(t(this.thumb).parent().css("padding-left"))+"px";e.remove(this.thumb),e({targets:this.thumb,height:30,width:30,top:-30,marginLeft:i,duration:300,easing:"easeOutQuint"})}},{key:"_calcRangeOffset",value:function(){var t=this.$el.width()-15,e=parseFloat(this.$el.attr("max"))||100,i=parseFloat(this.$el.attr("min"))||0;return(parseFloat(this.$el.val())-i)/(e-i)*t}}],[{key:"init",value:function(t,e){return i(c.__proto__||Object.getPrototypeOf(c),"init",this).call(this,this,t,e)}},{key:"getInstance",value:function(t){return(t.jquery?t[0]:t).M_Range}},{key:"defaults",get:function(){return l}}]),c}(a);M.Range=c,M.jQueryLoaded&&M.initializeJqueryWrapper(c,"range","M_Range"),c.init(t("input[type=range]"))}(cash,M.anime)}));class PreloadBox extends SvelteComponent{constructor(t){super(),init(this,t,instance$x,create_fragment$z,safe_not_equal,{})}}function create_fragment$y(t){let e,i;return{c(){e=element("i"),i=text(t[1]),attr(e,"class","material-icons svelte-fs63yz"),set_style(e,"font-size",t[0])},m(t,n){insert(t,e,n),append(e,i)},p(t,[n]){2&n&&set_data(i,t[1]),1&n&&set_style(e,"font-size",t[0])},i:noop,o:noop,d(t){t&&detach(e)}}}function instance$w(t,e,i){let{name:n="person"}=e,{size:o=24}=e;if(isNaN(o))switch(o){case"tiny":o="1rem";break;case"small":o="2rem";break;case"medium":o="4rem";break;case"large":o="6rem"}else o+="px";return t.$$set=t=>{"name"in t&&i(1,n=t.name),"size"in t&&i(0,o=t.size)},[o,n]}class Icon extends SvelteComponent{constructor(t){super(),init(this,t,instance$w,create_fragment$y,safe_not_equal,{name:1,size:0})}get name(){return this.$$.ctx[1]}set name(t){this.$$set({name:t}),flush()}get size(){return this.$$.ctx[0]}set size(t){this.$$set({size:t}),flush()}}function create_if_block_1$f(t){let e;return{c(){e=element("div"),attr(e,"id","vertical_divider"),attr(e,"class","svelte-awq91h")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_if_block$l(t){let e;return{c(){e=element("hr"),attr(e,"id","horizontal_divider"),attr(e,"class","svelte-awq91h")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_fragment$x(t){let e;function i(t,e){return"horizontal"==t[0]?create_if_block$l:"vertical"==t[0]?create_if_block_1$f:void 0}let n=i(t),o=n&&n(t);return{c(){o&&o.c(),e=empty()},m(t,i){o&&o.m(t,i),insert(t,e,i)},p(t,[s]){n!==(n=i(t))&&(o&&o.d(1),o=n&&n(t),o&&(o.c(),o.m(e.parentNode,e)))},i:noop,o:noop,d(t){o&&o.d(t),t&&detach(e)}}}function instance$v(t,e,i){let{direction:n="horizontal"}=e;return t.$$set=t=>{"direction"in t&&i(0,n=t.direction)},[n]}class Divider extends SvelteComponent{constructor(t){super(),init(this,t,instance$v,create_fragment$x,safe_not_equal,{direction:0})}get direction(){return this.$$.ctx[0]}set direction(t){this.$$set({direction:t}),flush()}}function create_default_slot$7(t){let e,i,n,o,s,r,a,l,c,h,u,d,p;return i=new Icon({props:{name:"error",size:"medium"}}),c=new Divider({props:{direction:"horizontal"}}),{c(){e=element("span"),create_component(i.$$.fragment),n=element("br"),o=space(),s=element("b"),s.textContent="Something went wrong.",r=space(),a=element("p"),l=space(),create_component(c.$$.fragment),h=space(),u=element("p"),d=text(t[0]),set_style(s,"margin-bottom","10px"),attr(e,"class","error_title svelte-1962d2f"),attr(u,"id","error_box_reason")},m(t,_){insert(t,e,_),mount_component(i,e,null),append(e,n),append(e,o),append(e,s),insert(t,r,_),insert(t,a,_),insert(t,l,_),mount_component(c,t,_),insert(t,h,_),insert(t,u,_),append(u,d),p=!0},p(t,e){(!p||1&e)&&set_data(d,t[0])},i(t){p||(transition_in(i.$$.fragment,t),transition_in(c.$$.fragment,t),p=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(c.$$.fragment,t),p=!1},d(t){t&&detach(e),destroy_component(i),t&&detach(r),t&&detach(a),t&&detach(l),destroy_component(c,t),t&&detach(h),t&&detach(u)}}}function create_fragment$w(t){let e,i;return e=new PreloadBox({props:{$$slots:{default:[create_default_slot$7]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,[i]){const n={};3&i&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function instance$u(t,e,i){let{reason:n="Try refreshing and try again."}=e;return t.$$set=t=>{"reason"in t&&i(0,n=t.reason)},[n]}class ErrorBox extends SvelteComponent{constructor(t){super(),init(this,t,instance$u,create_fragment$w,safe_not_equal,{reason:0})}get reason(){return this.$$.ctx[0]}set reason(t){this.$$set({reason:t}),flush()}}function cubicInOut(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1}function cubicOut(t){const e=t-1;return e*e*e+1}function fade(t,{delay:e=0,duration:i=400,easing:n=identity}={}){const o=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:n,css:t=>"opacity: "+t*o}}function fly(t,{delay:e=0,duration:i=400,easing:n=cubicOut,x:o=0,y:s=0,opacity:r=0}={}){const a=getComputedStyle(t),l=+a.opacity,c="none"===a.transform?"":a.transform,h=l*(1-r),[u,d]=split_css_unit(o),[p,_]=split_css_unit(s);return{delay:e,duration:i,easing:n,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*u}${d}, ${(1-t)*p}${_});\n\t\t\topacity: ${l-h*e}`}}function slide(t,{delay:e=0,duration:i=400,easing:n=cubicOut,axis:o="y"}={}){const s=getComputedStyle(t),r=+s.opacity,a="y"===o?"height":"width",l=parseFloat(s[a]),c="y"===o?["top","bottom"]:["left","right"],h=c.map((t=>`${t[0].toUpperCase()}${t.slice(1)}`)),u=parseFloat(s[`padding${h[0]}`]),d=parseFloat(s[`padding${h[1]}`]),p=parseFloat(s[`margin${h[0]}`]),_=parseFloat(s[`margin${h[1]}`]),m=parseFloat(s[`border${h[0]}Width`]),f=parseFloat(s[`border${h[1]}Width`]);return{delay:e,duration:i,easing:n,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*r};${a}: ${t*l}px;padding-${c[0]}: ${t*u}px;padding-${c[1]}: ${t*d}px;margin-${c[0]}: ${t*p}px;margin-${c[1]}: ${t*_}px;border-${c[0]}-width: ${t*m}px;border-${c[1]}-width: ${t*f}px;`}}function scale(t,{delay:e=0,duration:i=400,easing:n=cubicOut,start:o=0,opacity:s=0}={}){const r=getComputedStyle(t),a=+r.opacity,l="none"===r.transform?"":r.transform,c=1-o,h=a*(1-s);return{delay:e,duration:i,easing:n,css:(t,e)=>`\n\t\t\ttransform: ${l} scale(${1-c*e});\n\t\t\topacity: ${a-h*e}\n\t\t`}}function create_fragment$v(t){let e,i,n;return{c(){e=element("div"),e.innerHTML='<div class="progress svelte-mcnasa"><div class="indeterminate svelte-mcnasa"></div></div>',attr(e,"class","progress_bar svelte-mcnasa")},m(t,i){insert(t,e,i),n=!0},p:noop,i(t){n||(i&&i.end(1),n=!0)},o(t){i=create_out_transition(e,fade,{duration:100}),n=!1},d(t){t&&detach(e),t&&i&&i.end()}}}class ProgressBar extends SvelteComponent{constructor(t){super(),init(this,t,null,create_fragment$v,safe_not_equal,{})}}function create_fragment$u(t){let e,i,n;return{c(){e=element("div"),i=svg_element("svg"),n=svg_element("circle"),attr(n,"cx","50"),attr(n,"cy","50"),attr(n,"r","20"),attr(n,"class","svelte-i4e2xa"),attr(i,"viewBox","0 0 100 100"),attr(i,"class","svelte-i4e2xa"),attr(e,"class","spinner svelte-i4e2xa"),set_style(e,"height",t[0])},m(t,o){insert(t,e,o),append(e,i),append(i,n)},p(t,[i]){1&i&&set_style(e,"height",t[0])},i:noop,o:noop,d(t){t&&detach(e)}}}function instance$t(t,e,i){let{size:n="140px"}=e;return t.$$set=t=>{"size"in t&&i(0,n=t.size)},[n]}class LoadingSpinner extends SvelteComponent{constructor(t){super(),init(this,t,instance$t,create_fragment$u,safe_not_equal,{size:0})}get size(){return this.$$.ctx[0]}set size(t){this.$$set({size:t}),flush()}}function create_default_slot$6(t){let e,i,n,o,s;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment),i=space(),n=element("p"),o=text(t[0]),attr(n,"id","loading_reason"),attr(n,"class","svelte-1kw42f5")},m(t,r){mount_component(e,t,r),insert(t,i,r),insert(t,n,r),append(n,o),s=!0},p(t,e){(!s||1&e)&&set_data(o,t[0])},i(t){s||(transition_in(e.$$.fragment,t),s=!0)},o(t){transition_out(e.$$.fragment,t),s=!1},d(t){destroy_component(e,t),t&&detach(i),t&&detach(n)}}}function create_fragment$t(t){let e,i;return e=new PreloadBox({props:{$$slots:{default:[create_default_slot$6]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,[i]){const n={};3&i&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function instance$s(t,e,i){let{reason:n="Loading..."}=e;return t.$$set=t=>{"reason"in t&&i(0,n=t.reason)},[n]}class LoadingBox extends SvelteComponent{constructor(t){super(),init(this,t,instance$s,create_fragment$t,safe_not_equal,{reason:0})}get reason(){return this.$$.ctx[0]}set reason(t){this.$$set({reason:t}),flush()}}
/*!
     * long-press-event - v@version@
     * Pure JavaScript long-press-event
     * https://github.com/john-doherty/long-press-event
     * @author John Doherty <www.johndoherty.info>
     * @license MIT
     */function create_fragment$s(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m;return n=new Icon({props:{name:"add"}}),r=new Divider({}),c=new Icon({props:{name:"remove"}}),{c(){e=element("div"),i=element("button"),create_component(n.$$.fragment),s=space(),create_component(r.$$.fragment),a=space(),l=element("button"),create_component(c.$$.fragment),attr(i,"class","btn_zoom waves-effect long-press svelte-1pdle62"),attr(i,"id","btn_zoom_in"),attr(i,"tabindex","-1"),attr(i,"title","Zoom in"),i.disabled=o=!t[2],attr(i,"data-long-press-delay","600"),attr(l,"class","btn_zoom waves-effect long-press svelte-1pdle62"),attr(l,"id","btn_zoom_out"),attr(l,"tabindex","-1"),attr(l,"title","Zoom out"),l.disabled=h=!t[1],attr(l,"data-long-press-delay","600"),attr(e,"id","zoom_widget"),attr(e,"class","svelte-1pdle62"),toggle_class(e,"lock",t[0]==MAPLOCK.FULL),toggle_class(e,"disabled",t[0]==MAPLOCK.FULL)},m(o,h){insert(o,e,h),append(e,i),mount_component(n,i,null),append(e,s),mount_component(r,e,null),append(e,a),append(e,l),mount_component(c,l,null),p=!0,_||(m=[listen(i,"click",t[4]),listen(l,"click",t[5]),listen(e,"contextmenu",contextmenu_handler$7)],_=!0)},p(t,[n]){(!p||4&n&&o!==(o=!t[2]))&&(i.disabled=o),(!p||2&n&&h!==(h=!t[1]))&&(l.disabled=h),(!p||1&n)&&toggle_class(e,"lock",t[0]==MAPLOCK.FULL),(!p||1&n)&&toggle_class(e,"disabled",t[0]==MAPLOCK.FULL)},i(t){p||(transition_in(n.$$.fragment,t),transition_in(r.$$.fragment,t),transition_in(c.$$.fragment,t),add_render_callback((()=>{p&&(d&&d.end(1),u=create_in_transition(e,fly,{x:5,duration:250}),u.start())})),p=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(r.$$.fragment,t),transition_out(c.$$.fragment,t),u&&u.invalidate(),d=create_out_transition(e,fade,{duration:75}),p=!1},d(t){t&&detach(e),destroy_component(n),destroy_component(r),destroy_component(c),t&&d&&d.end(),_=!1,run_all(m)}}}function zoom(t){let e,i=!0;"string"==typeof t?"out"==t?gamemap.getCurrentZoom()>gamemap.getMaxBoundsZoom()?(i=!1,gamemap.reset(!0)):e=gamemap.getMinZoom():"in"==t&&(gamemap.getCurrentZoom()<gamemap.getMaxBoundsZoom()?(i=!1,gamemap.reset(!0)):e=gamemap.getMaxZoom()):e=gamemap.getCurrentZoom()+t,i&&gamemap.setZoomTo(e)}!function(t,e){var i=null,n="PointerEvent"in t||t.navigator&&"msPointerEnabled"in t.navigator,o="ontouchstart"in t||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,s=n?"pointerdown":o?"touchstart":"mousedown",r=n?"pointerup":o?"touchend":"mouseup",a=n?"pointermove":o?"touchmove":"mousemove",l=n?"pointerleave":o?"touchleave":"mouseleave",c=0,h=0;function u(t){p(),t=function(t){if(void 0!==t.changedTouches)return t.changedTouches[0];return t}(t),this.dispatchEvent(new CustomEvent("long-press",{bubbles:!0,cancelable:!0,detail:{clientX:t.clientX,clientY:t.clientY,offsetX:t.offsetX,offsetY:t.offsetY,pageX:t.pageX,pageY:t.pageY},clientX:t.clientX,clientY:t.clientY,offsetX:t.offsetX,offsetY:t.offsetY,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY}))||e.addEventListener("click",(function t(i){e.removeEventListener("click",t,!0),function(t){t.stopImmediatePropagation(),t.preventDefault(),t.stopPropagation()}(i)}),!0)}function d(n){p();var o=n.target,s=parseInt(function(t,i,n){for(;t&&t!==e.documentElement;){var o=t.getAttribute(i);if(o)return o;t=t.parentNode}return n}(o,"data-long-press-delay","1500"),10);i=function(e,i){if(!(t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame&&t.mozCancelRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame))return t.setTimeout(e,i);var n=(new Date).getTime(),o={},s=function(){(new Date).getTime()-n>=i?e.call():o.value=requestAnimFrame(s)};return o.value=requestAnimFrame(s),o}(u.bind(o,n),s)}function p(e){var n;(n=i)&&(t.cancelAnimationFrame?t.cancelAnimationFrame(n.value):t.webkitCancelAnimationFrame?t.webkitCancelAnimationFrame(n.value):t.webkitCancelRequestAnimationFrame?t.webkitCancelRequestAnimationFrame(n.value):t.mozCancelRequestAnimationFrame?t.mozCancelRequestAnimationFrame(n.value):t.oCancelRequestAnimationFrame?t.oCancelRequestAnimationFrame(n.value):t.msCancelRequestAnimationFrame?t.msCancelRequestAnimationFrame(n.value):clearTimeout(n)),i=null}"function"!=typeof t.CustomEvent&&(t.CustomEvent=function(t,i){i=i||{bubbles:!1,cancelable:!1,detail:void 0};var n=e.createEvent("CustomEvent");return n.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),n},t.CustomEvent.prototype=t.Event.prototype),t.requestAnimFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},e.addEventListener(r,p,!0),e.addEventListener(l,p,!0),e.addEventListener(a,(function(t){var e=Math.abs(c-t.clientX),i=Math.abs(h-t.clientY);(e>=10||i>=10)&&p()}),!0),e.addEventListener("wheel",p,!0),e.addEventListener("scroll",p,!0),e.addEventListener("contextmenu",p,!0),e.addEventListener(s,(function(t){c=t.clientX,h=t.clientY,d(t)}),!0)}(window,document);const contextmenu_handler$7=t=>t.stopPropagation();function instance$r(t,e,i){let n,o,{currentZoom:s}=e,{lock:r}=e;createEventDispatcher(),document.addEventListener("long-press",(function(t){if(t.target.closest(".btn_zoom")){zoom(t.target.closest(".btn_zoom").id.replace("btn_zoom_",""))}}));return t.$$set=t=>{"currentZoom"in t&&i(3,s=t.currentZoom),"lock"in t&&i(0,r=t.lock)},t.$$.update=()=>{8&t.$$.dirty&&i(2,n=s<gamemap.getMaxZoom()),8&t.$$.dirty&&i(1,o=s>gamemap.getMinZoom())},[r,o,n,s,()=>zoom(gamemap.getMapObject().options.zoomDelta),()=>zoom(-gamemap.getMapObject().options.zoomDelta)]}class ZoomWidget extends SvelteComponent{constructor(t){super(),init(this,t,instance$r,create_fragment$s,safe_not_equal,{currentZoom:3,lock:0})}get currentZoom(){return this.$$.ctx[3]}set currentZoom(t){this.$$set({currentZoom:t}),flush()}get lock(){return this.$$.ctx[0]}set lock(t){this.$$set({lock:t}),flush()}}function create_if_block$k(t){let e;let i=function(t){return t[9]?create_if_block_1$e:create_else_block$9}(t),n=i(t);return{c(){n.c(),e=empty()},m(t,i){n.m(t,i),insert(t,e,i)},p(t,e){n.p(t,e)},d(t){n.d(t),t&&detach(e)}}}function create_else_block$9(t){let e,i;return{c(){e=element("i"),i=text(t[3]),attr(e,"class","material-icons svelte-19tiwnm")},m(t,n){insert(t,e,n),append(e,i)},p(t,e){8&e&&set_data(i,t[3])},d(t){t&&detach(e)}}}function create_if_block_1$e(t){let e,i,n;return{c(){e=element("div"),i=element("img"),attr(i,"class","icon-img svelte-19tiwnm"),src_url_equal(i.src,n=t[3])||attr(i,"src",n),attr(i,"width","32"),attr(i,"height","32"),set_style(e,"width","100%"),set_style(e,"height","100%")},m(t,n){insert(t,e,n),append(e,i)},p(t,e){8&e&&!src_url_equal(i.src,n=t[3])&&attr(i,"src",n)},d(t){t&&detach(e)}}}function create_fragment$r(t){let e,i,n,o,s,r,a=t[8]&&create_if_block$k(t);return{c(){e=element("div"),a&&a.c(),i=space(),n=element("p"),o=text(t[2]),attr(n,"class","layer-name svelte-19tiwnm"),attr(e,"id","btn_toggle_grid"),attr(e,"class","btn_layer_toggle layer-button waves-effect svelte-19tiwnm"),attr(e,"title",t[1]),set_style(e,"background-image","url("+(t[4]??"assets/images/transparent.png")+")"),toggle_class(e,"hasImage",!t[8]),toggle_class(e,"dark",t[5]),toggle_class(e,"isChecked",t[0]),toggle_class(e,"big",t[6]),toggle_class(e,"disabled",t[7])},m(l,c){insert(l,e,c),a&&a.m(e,null),append(e,i),append(e,n),append(n,o),s||(r=[listen(e,"click",t[10]),listen(e,"contextmenu",contextmenu_handler$6)],s=!0)},p(t,[i]){t[8]&&a.p(t,i),4&i&&set_data(o,t[2]),2&i&&attr(e,"title",t[1]),16&i&&set_style(e,"background-image","url("+(t[4]??"assets/images/transparent.png")+")"),32&i&&toggle_class(e,"dark",t[5]),1&i&&toggle_class(e,"isChecked",t[0]),64&i&&toggle_class(e,"big",t[6]),128&i&&toggle_class(e,"disabled",t[7])},i:noop,o:noop,d(t){t&&detach(e),a&&a.d(),s=!1,run_all(r)}}}const contextmenu_handler$6=t=>t.stopPropagation();function instance$q(t,e,i){let{tooltip:n=""}=e,{label:o="layer"}=e,{icon:s=null}=e,{image:r=null}=e,{checked:a}=e,{dark:l=!1}=e,{big:c}=e,{disabled:h}=e;const u=createEventDispatcher();let d=null!=s&&!r,p=d&&s.includes("/");return t.$$set=t=>{"tooltip"in t&&i(1,n=t.tooltip),"label"in t&&i(2,o=t.label),"icon"in t&&i(3,s=t.icon),"image"in t&&i(4,r=t.image),"checked"in t&&i(0,a=t.checked),"dark"in t&&i(5,l=t.dark),"big"in t&&i(6,c=t.big),"disabled"in t&&i(7,h=t.disabled)},[a,n,o,s,r,l,c,h,d,p,function(){null!=a?(i(0,a=!a),u("onClick",a)):u("onClick",o.toLowerCase())}]}class LayerButton extends SvelteComponent{constructor(t){super(),init(this,t,instance$q,create_fragment$r,safe_not_equal,{tooltip:1,label:2,icon:3,image:4,checked:0,dark:5,big:6,disabled:7})}get tooltip(){return this.$$.ctx[1]}set tooltip(t){this.$$set({tooltip:t}),flush()}get label(){return this.$$.ctx[2]}set label(t){this.$$set({label:t}),flush()}get icon(){return this.$$.ctx[3]}set icon(t){this.$$set({icon:t}),flush()}get image(){return this.$$.ctx[4]}set image(t){this.$$set({image:t}),flush()}get checked(){return this.$$.ctx[0]}set checked(t){this.$$set({checked:t}),flush()}get dark(){return this.$$.ctx[5]}set dark(t){this.$$set({dark:t}),flush()}get big(){return this.$$.ctx[6]}set big(t){this.$$set({big:t}),flush()}get disabled(){return this.$$.ctx[7]}set disabled(t){this.$$set({disabled:t}),flush()}}const get_ad_slot_changes=t=>({}),get_ad_slot_context=t=>({});function create_if_block$j(t){let e;const i=t[2].ad,n=create_slot(i,t,t[1],get_ad_slot_context);return{c(){n&&n.c()},m(t,i){n&&n.m(t,i),e=!0},p(t,o){n&&n.p&&(!e||2&o)&&update_slot_base(n,i,t,t[1],e?get_slot_changes(i,t[1],o,get_ad_slot_changes):get_all_dirty_from_scope(t[1]),get_ad_slot_context)},i(t){e||(transition_in(n,t),e=!0)},o(t){transition_out(n,t),e=!1},d(t){n&&n.d(t)}}}function create_fragment$q(t){let e,i,n,o,s,r,a;const l=t[2].default,c=create_slot(l,t,t[1],null);let h=t[0]&&create_if_block$j(t);return{c(){e=element("div"),c&&c.c(),i=space(),h&&h.c(),attr(e,"class","svelte-56aymr")},m(t,n){insert(t,e,n),c&&c.m(e,null),append(e,i),h&&h.m(e,null),s=!0,r||(a=listen(e,"contextmenu",contextmenu_handler$5),r=!0)},p(t,[i]){c&&c.p&&(!s||2&i)&&update_slot_base(c,l,t,t[1],s?get_slot_changes(l,t[1],i,null):get_all_dirty_from_scope(t[1]),null),t[0]?h?(h.p(t,i),1&i&&transition_in(h,1)):(h=create_if_block$j(t),h.c(),transition_in(h,1),h.m(e,null)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros())},i(t){s||(transition_in(c,t),transition_in(h),add_render_callback((()=>{s&&(o&&o.end(1),n=create_in_transition(e,fly,{y:5,duration:250}),n.start())})),s=!0)},o(t){transition_out(c,t),transition_out(h),n&&n.invalidate(),o=create_out_transition(e,fade,{duration:100}),s=!1},d(t){t&&detach(e),c&&c.d(t),h&&h.d(),t&&o&&o.end(),r=!1,a()}}}const contextmenu_handler$5=t=>t.stopPropagation();function instance$p(t,e,i){let{$$slots:n={},$$scope:o}=e,s=!1;return onMount((()=>{i(0,s=!0)})),t.$$set=t=>{"$$scope"in t&&i(1,o=t.$$scope)},[s,o,n]}class LayerOptionsContainer extends SvelteComponent{constructor(t){super(),init(this,t,instance$p,create_fragment$q,safe_not_equal,{})}}function create_if_block$i(t){let e,i,n,o;const s=t[5].default,r=create_slot(s,t,t[4],null);return{c(){e=element("div"),r&&r.c(),attr(e,"class","optional-component")},m(t,i){insert(t,e,i),r&&r.m(e,null),o=!0},p(t,e){r&&r.p&&(!o||16&e)&&update_slot_base(r,s,t,t[4],o?get_slot_changes(s,t[4],e,null):get_all_dirty_from_scope(t[4]),null)},i(t){o||(transition_in(r,t),t&&add_render_callback((()=>{o&&(n&&n.end(1),i=create_in_transition(e,slide,{}),i.start())})),o=!0)},o(t){transition_out(r,t),i&&i.invalidate(),t&&(n=create_out_transition(e,slide,{})),o=!1},d(t){t&&detach(e),r&&r.d(t),t&&n&&n.end()}}}function create_fragment$p(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_=!t[0]&&create_if_block$i(t);return{c(){e=element("div"),i=element("label"),n=element("p"),o=text(t[1]),s=space(),r=element("input"),a=space(),l=element("span"),c=space(),_&&_.c(),h=empty(),attr(n,"class","label svelte-4whjpe"),attr(n,"title",t[2]),attr(r,"type","checkbox"),r.checked=t[0],attr(l,"class","lever svelte-4whjpe"),attr(e,"class","switch svelte-4whjpe")},m(m,f){insert(m,e,f),append(e,i),append(i,n),append(n,o),append(i,s),append(i,r),append(i,a),append(i,l),insert(m,c,f),_&&_.m(m,f),insert(m,h,f),u=!0,d||(p=listen(r,"change",t[3]),d=!0)},p(t,[e]){(!u||2&e)&&set_data(o,t[1]),(!u||4&e)&&attr(n,"title",t[2]),(!u||1&e)&&(r.checked=t[0]),t[0]?_&&(group_outros(),transition_out(_,1,1,(()=>{_=null})),check_outros()):_?(_.p(t,e),1&e&&transition_in(_,1)):(_=create_if_block$i(t),_.c(),transition_in(_,1),_.m(h.parentNode,h))},i(t){u||(transition_in(_),u=!0)},o(t){transition_out(_),u=!1},d(t){t&&detach(e),t&&detach(c),_&&_.d(t),t&&detach(h),d=!1,p()}}}function instance$o(t,e,i){let{$$slots:n={},$$scope:o}=e,{label:s}=e,{enabled:r=!1}=e,{tooltip:a}=e;const l=createEventDispatcher();return t.$$set=t=>{"label"in t&&i(1,s=t.label),"enabled"in t&&i(0,r=t.enabled),"tooltip"in t&&i(2,a=t.tooltip),"$$scope"in t&&i(4,o=t.$$scope)},[r,s,a,function(t){i(0,r=!r),l("change",r)},o,n]}class Switch extends SvelteComponent{constructor(t){super(),init(this,t,instance$o,create_fragment$p,safe_not_equal,{label:1,enabled:0,tooltip:2})}get label(){return this.$$.ctx[1]}set label(t){this.$$set({label:t}),flush()}get enabled(){return this.$$.ctx[0]}set enabled(t){this.$$set({enabled:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}}function create_if_block_2$d(t){let e,i;return{c(){e=element("label"),i=text(t[0]),attr(e,"class","label truncate svelte-1a8fbbf"),attr(e,"title",t[2]),attr(e,"for","form-select-"+t[7])},m(t,n){insert(t,e,n),append(e,i)},p(t,n){1&n&&set_data(i,t[0]),4&n&&attr(e,"title",t[2])},d(t){t&&detach(e)}}}function create_if_block_1$d(t){let e,i;return{c(){e=element("option"),i=text(t[1]),e.__value="",e.value=e.__value,e.disabled=!0},m(t,n){insert(t,e,n),append(e,i)},p(t,e){2&e&&set_data(i,t[1])},d(t){t&&detach(e)}}}function create_if_block$h(t){let e,i;return{c(){e=element("img"),attr(e,"class","selected-icon svelte-1a8fbbf"),src_url_equal(e.src,i=t[6])||attr(e,"src",i)},m(t,i){insert(t,e,i)},p(t,n){64&n&&!src_url_equal(e.src,i=t[6])&&attr(e,"src",i)},d(t){t&&detach(e)}}}function create_fragment$o(t){let e,i,n,o,s,r,a,l,c=t[0]&&create_if_block_2$d(t),h=t[1]&&create_if_block_1$d(t);const u=t[12].default,d=create_slot(u,t,t[11],null);let p=t[6]&&!t[3]&&create_if_block$h(t);return{c(){e=element("div"),c&&c.c(),i=space(),n=element("select"),h&&h.c(),o=empty(),d&&d.c(),s=space(),p&&p.c(),attr(n,"id","form-select-"+t[7]),attr(e,"class","input-field col s12 svelte-1a8fbbf"),toggle_class(e,"invisible",t[3])},m(u,_){insert(u,e,_),c&&c.m(e,null),append(e,i),append(e,n),h&&h.m(n,null),append(n,o),d&&d.m(n,null),t[13](n),append(e,s),p&&p.m(e,null),t[14](e),r=!0,a||(l=[listen(n,"change",t[8]),listen(e,"click",t[8])],a=!0)},p(t,[s]){t[0]?c?c.p(t,s):(c=create_if_block_2$d(t),c.c(),c.m(e,i)):c&&(c.d(1),c=null),t[1]?h?h.p(t,s):(h=create_if_block_1$d(t),h.c(),h.m(n,o)):h&&(h.d(1),h=null),d&&d.p&&(!r||2048&s)&&update_slot_base(d,u,t,t[11],r?get_slot_changes(u,t[11],s,null):get_all_dirty_from_scope(t[11]),null),t[6]&&!t[3]?p?p.p(t,s):(p=create_if_block$h(t),p.c(),p.m(e,null)):p&&(p.d(1),p=null),(!r||8&s)&&toggle_class(e,"invisible",t[3])},i(t){r||(transition_in(d,t),r=!0)},o(t){transition_out(d,t),r=!1},d(i){i&&detach(e),c&&c.d(),h&&h.d(),d&&d.d(i),t[13](null),p&&p.d(),t[14](null),a=!1,run_all(l)}}}function instance$n(t,e,i){let n,o,s,r,{$$slots:a={},$$scope:l}=e,{label:c}=e,{hint:h}=e,{tooltip:u}=e,{align:d="left"}=e,{invisible:p}=e,{selected:_}=e,m=Math.random().toString(36).substr(2,10);const f=createEventDispatcher();function g(t){s&&null!=t&&(i(5,o.value=t,o),s.value=o.querySelector(`[value='${t}']`).innerText)}function y(t){t&&"click"!=t.type&&f("change",t.target.value);let e=n.querySelector(".selected");if(e&&e.querySelector("img")){let t=e.querySelector("img");i(6,r=t.src)}else i(6,r=null)}return onMount((async()=>{M.FormSelect.init(document.querySelectorAll(`#form-select-${m}`),{dropdownOptions:{alignment:d,constrainWidth:!1}}),s=n.querySelector(".select-dropdown.dropdown-trigger"),g(_),y()})),t.$$set=t=>{"label"in t&&i(0,c=t.label),"hint"in t&&i(1,h=t.hint),"tooltip"in t&&i(2,u=t.tooltip),"align"in t&&i(9,d=t.align),"invisible"in t&&i(3,p=t.invisible),"selected"in t&&i(10,_=t.selected),"$$scope"in t&&i(11,l=t.$$scope)},t.$$.update=()=>{1024&t.$$.dirty&&g(_)},[c,h,u,p,n,o,r,m,y,d,_,l,a,function(t){binding_callbacks[t?"unshift":"push"]((()=>{o=t,i(5,o)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{n=t,i(4,n)}))}]}class DropdownMenu extends SvelteComponent{constructor(t){super(),init(this,t,instance$n,create_fragment$o,safe_not_equal,{label:0,hint:1,tooltip:2,align:9,invisible:3,selected:10})}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),flush()}get hint(){return this.$$.ctx[1]}set hint(t){this.$$set({hint:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}get align(){return this.$$.ctx[9]}set align(t){this.$$set({align:t}),flush()}get invisible(){return this.$$.ctx[3]}set invisible(t){this.$$set({invisible:t}),flush()}get selected(){return this.$$.ctx[10]}set selected(t){this.$$set({selected:t}),flush()}}function get_each_context$8(t,e,i){const n=t.slice();n[21]=e[i],n[24]=i;return n[22]=["<2","~5","~10","~20","~40","50+"],n}function get_context$2(t){const e=Object.keys(gamemap.getMapConfig().cellResources);t[25]=e;const i=Object.values(gamemap.getMapConfig().cellResources);t[26]=i}function get_each_context_1$2(t,e,i){const n=t.slice();return n[27]=e[i],n[24]=i,n}function get_each_context_2(t,e,i){const n=t.slice();return n[29]=e[i],n}function create_if_block_7$4(t){let e,i,n=t[1].toSentenceCase()+"";return{c(){e=element("p"),i=text(n),attr(e,"id","layer-name"),attr(e,"class","layer-name svelte-9op5do"),set_style(e,"bottom","12px")},m(t,n){insert(t,e,n),append(e,i)},p(t,e){2&e[0]&&n!==(n=t[1].toSentenceCase()+"")&&set_data(i,n)},d(t){t&&detach(e)}}}function create_if_block_3$a(t){let e,i,n,o,s,r,a,l,c=t[2].hasGrid(),h=t[3]&&create_if_block_5$5(t),u=c&&create_if_block_4$6(t);return{c(){e=element("div"),i=element("span"),n=space(),o=element("div"),h&&h.c(),s=space(),u&&u.c(),attr(i,"id","pip"),attr(i,"class","svelte-9op5do"),attr(o,"class","layer_widget_options svelte-9op5do"),attr(e,"id","layer_options_container"),attr(e,"class","svelte-9op5do")},m(t,r){insert(t,e,r),append(e,i),append(e,n),append(e,o),h&&h.m(o,null),append(o,s),u&&u.m(o,null),l=!0},p(t,e){t[3]?h?(h.p(t,e),8&e[0]&&transition_in(h,1)):(h=create_if_block_5$5(t),h.c(),transition_in(h,1),h.m(o,s)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros()),4&e[0]&&(c=t[2].hasGrid()),c?u?(u.p(t,e),4&e[0]&&transition_in(u,1)):(u=create_if_block_4$6(t),u.c(),transition_in(u,1),u.m(o,null)):u&&(group_outros(),transition_out(u,1,1,(()=>{u=null})),check_outros())},i(t){l||(transition_in(h),transition_in(u),add_render_callback((()=>{l&&(a&&a.end(1),r=create_in_transition(e,fly,{x:-15,duration:200}),r.start())})),l=!0)},o(t){transition_out(h),transition_out(u),r&&r.invalidate(),a=create_out_transition(e,fade,{duration:125}),l=!1},d(t){t&&detach(e),h&&h.d(),u&&u.d(),t&&a&&a.end()}}}function create_if_block_5$5(t){let e,i,n,o=t[2].hasGrid(),s=t[8],r=[];for(let e=0;e<s.length;e+=1)r[e]=create_each_block_2(get_each_context_2(t,s,e));const a=t=>transition_out(r[t],1,1,(()=>{r[t]=null}));let l=o&&create_if_block_6$4();return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=space(),l&&l.c(),i=empty()},m(t,o){for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,o);insert(t,e,o),l&&l.m(t,o),insert(t,i,o),n=!0},p(t,n){if(4352&n[0]){let i;for(s=t[8],i=0;i<s.length;i+=1){const o=get_each_context_2(t,s,i);r[i]?(r[i].p(o,n),transition_in(r[i],1)):(r[i]=create_each_block_2(o),r[i].c(),transition_in(r[i],1),r[i].m(e.parentNode,e))}for(group_outros(),i=s.length;i<r.length;i+=1)a(i);check_outros()}4&n[0]&&(o=t[2].hasGrid()),o?l?4&n[0]&&transition_in(l,1):(l=create_if_block_6$4(),l.c(),transition_in(l,1),l.m(i.parentNode,i)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){if(!n){for(let t=0;t<s.length;t+=1)transition_in(r[t]);transition_in(l),n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)transition_out(r[t]);transition_out(l),n=!1},d(t){destroy_each(r,t),t&&detach(e),l&&l.d(t),t&&detach(i)}}}function create_each_block_2(t){let e,i;return e=new LayerButton({props:{label:t[29].name.toSentenceCase(),image:gamemap.getMapTileImageURL(gamemap.getCurrentWorld(),t[29].name,!0)}}),e.$on("onClick",t[12]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};256&i[0]&&(n.label=t[29].name.toSentenceCase()),256&i[0]&&(n.image=gamemap.getMapTileImageURL(gamemap.getCurrentWorld(),t[29].name,!0)),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_6$4(t){let e,i;return e=new Divider({props:{direction:"vertical"}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_4$6(t){let e,i;return e=new LayerButton({props:{label:"Cell Grid",tooltip:"Toggle cell grid",icon:"grid_on",checked:t[10]}}),e.$on("onClick",t[14]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};1024&i[0]&&(n.checked=t[10]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block$g(t){let e,i;return e=new LayerOptionsContainer({props:{$$slots:{default:[create_default_slot$5]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};1124&i[0]|2&i[1]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$c(t){let e,i,n,o,s,r,a=t[2].hasCellResources();i=new Switch({props:{label:"Show Cell Grid",tooltip:"Toggle cell grid",enabled:t[10]}}),i.$on("change",t[19]);let l=a&&create_if_block_2$c(t);return{c(){e=element("div"),create_component(i.$$.fragment),n=space(),l&&l.c()},m(t,o){insert(t,e,o),mount_component(i,e,null),append(e,n),l&&l.m(e,null),r=!0},p(t,n){const o={};1024&n[0]&&(o.enabled=t[10]),i.$set(o),4&n[0]&&(a=t[2].hasCellResources()),a?l?(l.p(t,n),4&n[0]&&transition_in(l,1)):(l=create_if_block_2$c(t),l.c(),transition_in(l,1),l.m(e,null)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){r||(transition_in(i.$$.fragment,t),transition_in(l),add_render_callback((()=>{r&&(s&&s.end(1),o=create_in_transition(e,slide,{}),o.start())})),r=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(l),o&&o.invalidate(),s=create_out_transition(e,slide,{}),r=!1},d(t){t&&detach(e),destroy_component(i),l&&l.d(),t&&s&&s.end()}}}function create_if_block_2$c(t){let e,i,n,o,s,r;e=new DropdownMenu({props:{label:"Show Resource",hint:"Select resource...",tooltip:"Select cell resource",selected:t[6].cellResource,align:"right",$$slots:{default:[create_default_slot_1$3]},$$scope:{ctx:t}}}),e.$on("change",t[20]);let a=gamemap.getMapConfig().cellResourceColours,l=[];for(let e=0;e<a.length;e+=1)l[e]=create_each_block$8(get_each_context$8(t,a,e));return{c(){create_component(e.$$.fragment),i=space(),n=element("div"),o=element("b"),o.textContent="Key:",s=space();for(let t=0;t<l.length;t+=1)l[t].c();set_style(o,"display","flex"),set_style(o,"padding-right","4px"),attr(o,"title","Cell resource count"),attr(n,"id","cell_resource_key"),attr(n,"class","svelte-9op5do")},m(t,a){mount_component(e,t,a),insert(t,i,a),insert(t,n,a),append(n,o),append(n,s);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(n,null);r=!0},p(t,i){const n={};64&i[0]&&(n.selected=t[6].cellResource),64&i[0]|2&i[1]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){r||(transition_in(e.$$.fragment,t),r=!0)},o(t){transition_out(e.$$.fragment,t),r=!1},d(t){destroy_component(e,t),t&&detach(i),t&&detach(n),destroy_each(l,t)}}}function create_each_block_1$2(t){let e,i,n,o=t[26][t[24]]+"";return{c(){e=element("option"),i=text(o),e.__value=t[27].toLowerCase(),e.value=e.__value,e.selected=n=t[6].cellResource==t[27].toLowerCase()},m(t,n){insert(t,e,n),append(e,i)},p(t,i){64&i[0]&&n!==(n=t[6].cellResource==t[27].toLowerCase())&&(e.selected=n)},d(t){t&&detach(e)}}}function create_default_slot_1$3(t){let e;get_context$2(t);let i=t[25],n=[];for(let e=0;e<i.length;e+=1)n[e]=create_each_block_1$2(get_each_context_1$2(t,i,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=empty()},m(t,i){for(let e=0;e<n.length;e+=1)n[e]&&n[e].m(t,i);insert(t,e,i)},p(t,o){if(get_context$2(t),64&o[0]){let s;for(i=t[25],s=0;s<i.length;s+=1){const r=get_each_context_1$2(t,i,s);n[s]?n[s].p(r,o):(n[s]=create_each_block_1$2(r),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){destroy_each(n,t),t&&detach(e)}}}function create_each_block$8(t){let e,i,n=t[22][t[24]]+"";return{c(){e=element("div"),i=text(n),attr(e,"class","cell_resource_key_item svelte-9op5do"),set_style(e,"background-color",t[21])},m(t,n){insert(t,e,n),append(e,i)},p:noop,d(t){t&&detach(e)}}}function create_default_slot$5(t){let e,i,n,o,s,r,a,l,c,h,u;n=new Icon({props:{name:"close",size:"tiny"}}),a=new Icon({props:{name:t[5]?"expand_less":"expand_more",size:"tiny"}});let d=t[5]&&create_if_block_1$c(t);return{c(){e=element("div"),i=element("div"),create_component(n.$$.fragment),o=space(),s=element("b"),r=text("Grid Options "),create_component(a.$$.fragment),l=space(),d&&d.c(),attr(i,"id","close_button"),attr(i,"class","waves-effect svelte-9op5do"),attr(i,"title","Close"),attr(s,"class","waves-effect"),attr(s,"title","Click to show/hide grid options"),set_style(s,"display","-webkit-box"),set_style(s,"width","fit-content"),attr(e,"class","cell_grid_options svelte-9op5do")},m(p,_){insert(p,e,_),append(e,i),mount_component(n,i,null),append(e,o),append(e,s),append(s,r),mount_component(a,s,null),append(e,l),d&&d.m(e,null),c=!0,h||(u=[listen(i,"click",t[17]),listen(s,"click",t[18]),listen(e,"contextmenu",contextmenu_handler_1$1)],h=!0)},p(t,i){const n={};32&i[0]&&(n.name=t[5]?"expand_less":"expand_more"),a.$set(n),t[5]?d?(d.p(t,i),32&i[0]&&transition_in(d,1)):(d=create_if_block_1$c(t),d.c(),transition_in(d,1),d.m(e,null)):d&&(group_outros(),transition_out(d,1,1,(()=>{d=null})),check_outros())},i(t){c||(transition_in(n.$$.fragment,t),transition_in(a.$$.fragment,t),transition_in(d),c=!0)},o(t){transition_out(n.$$.fragment,t),transition_out(a.$$.fragment,t),transition_out(d),c=!1},d(t){t&&detach(e),destroy_component(n),destroy_component(a),d&&d.d(),h=!1,run_all(u)}}}function create_fragment$n(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_=t[3]&&create_if_block_7$4(t),m=t[4]&&create_if_block_3$a(t),f=t[9]&&create_if_block$g(t);return{c(){e=element("div"),i=element("button"),n=text("Layers\n            "),o=element("i"),o.textContent="layers",s=space(),_&&_.c(),r=space(),m&&m.c(),c=space(),f&&f.c(),h=empty(),attr(o,"class","small material-icons svelte-9op5do"),set_style(o,"position","relative"),set_style(o,"bottom","45px"),attr(i,"id","btn_layer_widget_switcher"),attr(i,"class","waves-effect svelte-9op5do"),set_style(i,"background-image","url("+(t[7]??"assets/images/transparent.png")+")"),toggle_class(i,"hasLayerImage",t[3]),attr(e,"class","layer_widget_root svelte-9op5do"),toggle_class(e,"lock",t[0])},m(a,l){insert(a,e,l),append(e,i),append(i,n),append(i,o),append(i,s),_&&_.m(i,null),append(e,r),m&&m.m(e,null),insert(a,c,l),f&&f.m(a,l),insert(a,h,l),u=!0,d||(p=[listen(i,"click",t[12]),listen(e,"mouseenter",t[15]),listen(e,"mouseleave",t[16]),listen(e,"contextmenu",contextmenu_handler$4)],d=!0)},p(t,n){t[3]?_?_.p(t,n):(_=create_if_block_7$4(t),_.c(),_.m(i,null)):_&&(_.d(1),_=null),(!u||128&n[0])&&set_style(i,"background-image","url("+(t[7]??"assets/images/transparent.png")+")"),(!u||8&n[0])&&toggle_class(i,"hasLayerImage",t[3]),t[4]?m?(m.p(t,n),16&n[0]&&transition_in(m,1)):(m=create_if_block_3$a(t),m.c(),transition_in(m,1),m.m(e,null)):m&&(group_outros(),transition_out(m,1,1,(()=>{m=null})),check_outros()),(!u||1&n[0])&&toggle_class(e,"lock",t[0]),t[9]?f?(f.p(t,n),512&n[0]&&transition_in(f,1)):(f=create_if_block$g(t),f.c(),transition_in(f,1),f.m(h.parentNode,h)):f&&(group_outros(),transition_out(f,1,1,(()=>{f=null})),check_outros())},i(t){u||(transition_in(m),add_render_callback((()=>{u&&(l&&l.end(1),a=create_in_transition(e,fly,{x:-5,duration:250}),a.start())})),transition_in(f),u=!0)},o(t){transition_out(m),a&&a.invalidate(),l=create_out_transition(e,fade,{duration:75}),transition_out(f),u=!1},d(t){t&&detach(e),_&&_.d(),m&&m.d(),t&&l&&l.end(),t&&detach(c),f&&f.d(t),t&&detach(h),d=!1,run_all(p)}}}const contextmenu_handler$4=t=>t.stopPropagation(),contextmenu_handler_1$1=t=>t.stopPropagation();function instance$m(t,e,i){let n,o,s,r,a,l,c,h,{mapState:u}=e,{lock:d}=e,p=!1,_=getPrefs("expandgridoptions",!0);function m(t){if(1==t)gamemap.toggleGrid(o);else if(0==t||null==t)gamemap.toggleGrid(null);else{let e={...o,...t};gamemap.toggleGrid(e)}i(4,p=!1)}return t.$$set=t=>{"mapState"in t&&i(13,u=t.mapState),"lock"in t&&i(0,d=t.lock)},t.$$.update=()=>{8192&t.$$.dirty[0]&&i(2,n=u.world),8196&t.$$.dirty[0]&&i(6,o=u.gridData??{gridShown:!0,cellResource:n.hasCellResources()?"none":null}),8192&t.$$.dirty[0]&&i(10,s=u.gridData?.gridShown??u.isGridShown()),8192&t.$$.dirty[0]&&i(9,r=u.isGridEnabled()),4&t.$$.dirty[0]&&i(3,a=n.hasMultipleLayers()),4&t.$$.dirty[0]&&i(8,l=n.layers),8192&t.$$.dirty[0]&&i(1,c=u&&gamemap.getNextTileLayerName()),8206&t.$$.dirty[0]&&i(7,h=u&&a?gamemap.getMapTileImageURL(n,c,!0):null)},[d,c,n,a,p,_,o,h,l,r,s,m,function(t){null==t.target?(isMobile&&i(4,p=!1),gamemap.setTileLayerTo(t.detail)):gamemap.setTileLayerTo(gamemap.getNextTileLayerIndex()),i(1,c=gamemap.getNextTileLayerName())},u,t=>m(t.detail),()=>i(4,p=!0),()=>i(4,p=!1),()=>m(null),()=>{setPrefs("expandgridoptions",!getPrefs("expandgridoptions")),i(5,_=getPrefs("expandgridoptions"))},t=>{m({gridShown:t.detail})},t=>m({cellResource:t.detail})]}class LayerSwitcher extends SvelteComponent{constructor(t){super(),init(this,t,instance$m,create_fragment$n,safe_not_equal,{mapState:13,lock:0},null,[-1,-1])}get mapState(){return this.$$.ctx[13]}set mapState(t){this.$$set({mapState:t}),flush()}get lock(){return this.$$.ctx[0]}set lock(t){this.$$set({lock:t}),flush()}}function create_else_block_1$1(t){let e,i,n,o;return n=new Icon({props:{name:"open_in_new",size:"tiny"}}),{c(){e=element("b"),i=text("View larger map "),create_component(n.$$.fragment)},m(t,s){insert(t,e,s),append(e,i),mount_component(n,e,null),o=!0},p:noop,i(t){o||(transition_in(n.$$.fragment,t),o=!0)},o(t){transition_out(n.$$.fragment,t),o=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_if_block$f(t){let e,i,n,o;const s=[create_if_block_1$b,create_if_block_2$b,create_if_block_3$9,create_else_block$8],r=[];function a(t,e){return t[2]==MAPLOCK.FULL?0:t[2]==MAPLOCK.PARTIAL?1:t[2]>=MAPLOCK.PARTIAL_MARKER?2:3}return e=a(t),i=r[e]=s[e](t),{c(){i.c(),n=empty()},m(t,i){r[e].m(t,i),insert(t,n,i),o=!0},p(t,o){let l=e;e=a(t),e===l?r[e].p(t,o):(group_outros(),transition_out(r[l],1,1,(()=>{r[l]=null})),check_outros(),i=r[e],i?i.p(t,o):(i=r[e]=s[e](t),i.c()),transition_in(i,1),i.m(n.parentNode,n))},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){r[e].d(t),t&&detach(n)}}}function create_else_block$8(t){let e,i,n,o,s=MAPCONFIG.wikiName&&create_if_block_9$3();return{c(){e=element("b"),s&&s.c(),i=space(),n=element("a"),o=text(t[0]),attr(n,"title","Reset this map"),attr(n,"href","javascript:void(0);"),attr(n,"onclick","gamemap.reset();"),attr(n,"class","svelte-vn5qvj")},m(t,r){insert(t,e,r),s&&s.m(e,null),append(e,i),append(e,n),append(n,o)},p(t,e){MAPCONFIG.wikiName&&s.p(t,e),1&e&&set_data(o,t[0])},i:noop,o:noop,d(t){t&&detach(e),s&&s.d()}}}function create_if_block_3$9(t){let e,i,n,o,s,r,a,l,c,h,u;i=new Icon({props:{name:"info",size:16}});let d=t[2]==MAPLOCK.PARTIAL_MARKER&&create_if_block_8$3(),p=t[2]==MAPLOCK.PARTIAL_NEW_MARKER&&create_if_block_7$3(),_=t[2]==MAPLOCK.PARTIAL_POLYGON&&create_if_block_6$3(),m=t[2]==MAPLOCK.PARTIAL_NEW_POLYGON&&create_if_block_5$4(),f=t[2]==MAPLOCK.PARTIAL_NEW_LINE&&create_if_block_4$5();return{c(){e=element("span"),create_component(i.$$.fragment),n=space(),o=element("small"),o.innerHTML="<b>Editing Tip</b>",s=space(),d&&d.c(),r=space(),p&&p.c(),a=space(),_&&_.c(),l=space(),m&&m.c(),c=space(),f&&f.c(),h=empty(),attr(o,"class","svelte-vn5qvj"),attr(e,"class","highlight svelte-vn5qvj")},m(t,g){insert(t,e,g),mount_component(i,e,null),append(e,n),append(e,o),insert(t,s,g),d&&d.m(t,g),insert(t,r,g),p&&p.m(t,g),insert(t,a,g),_&&_.m(t,g),insert(t,l,g),m&&m.m(t,g),insert(t,c,g),f&&f.m(t,g),insert(t,h,g),u=!0},p(t,e){t[2]==MAPLOCK.PARTIAL_MARKER?d||(d=create_if_block_8$3(),d.c(),d.m(r.parentNode,r)):d&&(d.d(1),d=null),t[2]==MAPLOCK.PARTIAL_NEW_MARKER?p||(p=create_if_block_7$3(),p.c(),p.m(a.parentNode,a)):p&&(p.d(1),p=null),t[2]==MAPLOCK.PARTIAL_POLYGON?_||(_=create_if_block_6$3(),_.c(),_.m(l.parentNode,l)):_&&(_.d(1),_=null),t[2]==MAPLOCK.PARTIAL_NEW_POLYGON?m||(m=create_if_block_5$4(),m.c(),m.m(c.parentNode,c)):m&&(m.d(1),m=null),t[2]==MAPLOCK.PARTIAL_NEW_LINE?f||(f=create_if_block_4$5(),f.c(),f.m(h.parentNode,h)):f&&(f.d(1),f=null)},i(t){u||(transition_in(i.$$.fragment,t),u=!0)},o(t){transition_out(i.$$.fragment,t),u=!1},d(t){t&&detach(e),destroy_component(i),t&&detach(s),d&&d.d(t),t&&detach(r),p&&p.d(t),t&&detach(a),_&&_.d(t),t&&detach(l),m&&m.d(t),t&&detach(c),f&&f.d(t),t&&detach(h)}}}function create_if_block_2$b(t){let e,i,n,o;return e=new Icon({props:{name:"lock",size:16}}),{c(){create_component(e.$$.fragment),i=space(),n=element("b"),n.textContent="Map locked",attr(n,"title","Map is partially locked whilst reverting locations.")},m(t,s){mount_component(e,t,s),insert(t,i,s),insert(t,n,s),o=!0},p:noop,i(t){o||(transition_in(e.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(i),t&&detach(n)}}}function create_if_block_1$b(t){let e,i,n,o;return e=new Icon({props:{name:"lock",size:16}}),{c(){create_component(e.$$.fragment),i=space(),n=element("b"),n.textContent="Map locked",attr(n,"title","Map is locked whilst editing worlds.")},m(t,s){mount_component(e,t,s),insert(t,i,s),insert(t,n,s),o=!0},p:noop,i(t){o||(transition_in(e.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(i),t&&detach(n)}}}function create_if_block_9$3(t){let e,i,n,o,s=MAPCONFIG.wikiName+"";return{c(){e=element("span"),i=element("a"),n=text(s),o=text(" "),attr(i,"href",MAPCONFIG.wikiHomeURL),attr(i,"title","Go to "+MAPCONFIG.wikiName+" home"),attr(i,"target","_top"),attr(i,"class","svelte-vn5qvj"),attr(e,"class","wikiTitle")},m(t,s){insert(t,e,s),append(e,i),append(i,n),insert(t,o,s)},p:noop,d(t){t&&detach(e),t&&detach(o)}}}function create_if_block_8$3(t){let e;return{c(){e=text("You can drag the selected marker to move it to a new position.")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_if_block_7$3(t){let e;return{c(){e=text("Click to add the new marker to the map.")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_if_block_6$3(t){let e,i,n;return{c(){e=text("Drag handles to move them, right click to remove them."),i=element("br"),n=text("\n                     Click the green plus (+) to add new points.")},m(t,o){insert(t,e,o),insert(t,i,o),insert(t,n,o)},d(t){t&&detach(e),t&&detach(i),t&&detach(n)}}}function create_if_block_5$4(t){let e;return{c(){e=text("Click to add new points. Close the shape when you're done.")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_if_block_4$5(t){let e;return{c(){e=text("Click to add new points. Click any handle again when you're done.")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_fragment$m(t){let e,i,n,o,s,r;const a=[create_if_block$f,create_else_block_1$1],l=[];function c(t,e){return t[1]?1:0}return i=c(t),n=l[i]=a[i](t),{c(){e=element("div"),n.c(),attr(e,"id","watermark"),attr(e,"class","svelte-vn5qvj"),toggle_class(e,"watermark",!t[1]&&!t[2])},m(t,n){insert(t,e,n),l[i].m(e,null),o=!0,s||(r=listen(e,"contextmenu",contextmenu_handler$3),s=!0)},p(t,[s]){let r=i;i=c(t),i===r?l[i].p(t,s):(group_outros(),transition_out(l[r],1,1,(()=>{l[r]=null})),check_outros(),n=l[i],n?n.p(t,s):(n=l[i]=a[i](t),n.c()),transition_in(n,1),n.m(e,null)),(!o||6&s)&&toggle_class(e,"watermark",!t[1]&&!t[2])},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){t&&detach(e),l[i].d(),s=!1,r()}}}const contextmenu_handler$3=t=>t.stopPropagation();function instance$l(t,e,i){let{mapName:n="Gamemap"}=e,{embedded:o=!1}=e,{lock:s}=e;return t.$$set=t=>{"mapName"in t&&i(0,n=t.mapName),"embedded"in t&&i(1,o=t.embedded),"lock"in t&&i(2,s=t.lock)},[n,o,s]}class Infobar extends SvelteComponent{constructor(t){super(),init(this,t,instance$l,create_fragment$m,safe_not_equal,{mapName:0,embedded:1,lock:2})}get mapName(){return this.$$.ctx[0]}set mapName(t){this.$$set({mapName:t}),flush()}get embedded(){return this.$$.ctx[1]}set embedded(t){this.$$set({embedded:t}),flush()}get lock(){return this.$$.ctx[2]}set lock(t){this.$$set({lock:t}),flush()}}function get_each_context$7(t,e,i){const n=t.slice();return n[4]=e[i],n}function get_each_context_1$1(t,e,i){const n=t.slice();return n[4]=e[i],n}function create_else_block$7(t){let e,i;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p:noop,i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block$e(t){let e,i,n,o,s,r,a,l,c=t[0],h=[];for(let e=0;e<c.length;e+=1)h[e]=create_each_block_1$1(get_each_context_1$1(t,c,e));const u=t=>transition_out(h[t],1,1,(()=>{h[t]=null}));o=new Divider({props:{direction:"horizontal"}});let d=t[0],p=[];for(let e=0;e<d.length;e+=1)p[e]=create_each_block$7(get_each_context$7(t,d,e));const _=t=>transition_out(p[t],1,1,(()=>{p[t]=null}));return{c(){e=element("div");for(let t=0;t<h.length;t+=1)h[t].c();i=space(),n=element("div"),create_component(o.$$.fragment),s=element("p"),r=space(),a=element("div");for(let t=0;t<p.length;t+=1)p[t].c();attr(e,"class","options_container"),set_style(n,"margin","10px"),attr(a,"class","options_container")},m(t,c){insert(t,e,c);for(let t=0;t<h.length;t+=1)h[t]&&h[t].m(e,null);insert(t,i,c),insert(t,n,c),mount_component(o,n,null),append(n,s),insert(t,r,c),insert(t,a,c);for(let t=0;t<p.length;t+=1)p[t]&&p[t].m(a,null);l=!0},p(t,i){if(1&i){let n;for(c=t[0],n=0;n<c.length;n+=1){const o=get_each_context_1$1(t,c,n);h[n]?(h[n].p(o,i),transition_in(h[n],1)):(h[n]=create_each_block_1$1(o),h[n].c(),transition_in(h[n],1),h[n].m(e,null))}for(group_outros(),n=c.length;n<h.length;n+=1)u(n);check_outros()}if(1&i){let e;for(d=t[0],e=0;e<d.length;e+=1){const n=get_each_context$7(t,d,e);p[e]?(p[e].p(n,i),transition_in(p[e],1)):(p[e]=create_each_block$7(n),p[e].c(),transition_in(p[e],1),p[e].m(a,null))}for(group_outros(),e=d.length;e<p.length;e+=1)_(e);check_outros()}},i(t){if(!l){for(let t=0;t<c.length;t+=1)transition_in(h[t]);transition_in(o.$$.fragment,t);for(let t=0;t<d.length;t+=1)transition_in(p[t]);l=!0}},o(t){h=h.filter(Boolean);for(let t=0;t<h.length;t+=1)transition_out(h[t]);transition_out(o.$$.fragment,t),p=p.filter(Boolean);for(let t=0;t<p.length;t+=1)transition_out(p[t]);l=!1},d(t){t&&detach(e),destroy_each(h,t),t&&detach(i),t&&detach(n),destroy_component(o),t&&detach(r),t&&detach(a),destroy_each(p,t)}}}function create_if_block_2$a(t){let e,i;return e=new LayerButton({props:{label:t[4].name,icon:MAPS_DIR+t[4].database+"/icons/favicon.png",dark:"true",big:"true",disabled:t[4].disabled}}),e.$on("onClick",(function(){return t[1](t[4])})),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(i,n){t=i;const o={};1&n&&(o.label=t[4].name),1&n&&(o.icon=MAPS_DIR+t[4].database+"/icons/favicon.png"),1&n&&(o.disabled=t[4].disabled),e.$set(o)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_each_block_1$1(t){let e,i,n=!t[4].isModded&&create_if_block_2$a(t);return{c(){n&&n.c(),e=empty()},m(t,o){n&&n.m(t,o),insert(t,e,o),i=!0},p(t,i){t[4].isModded?n&&(group_outros(),transition_out(n,1,1,(()=>{n=null})),check_outros()):n?(n.p(t,i),1&i&&transition_in(n,1)):(n=create_if_block_2$a(t),n.c(),transition_in(n,1),n.m(e.parentNode,e))},i(t){i||(transition_in(n),i=!0)},o(t){transition_out(n),i=!1},d(t){n&&n.d(t),t&&detach(e)}}}function create_if_block_1$a(t){let e,i;return e=new LayerButton({props:{label:t[4].name,icon:MAPS_DIR+t[4].database+"/icons/favicon.png",dark:"true",big:"true",disabled:t[4].disabled}}),e.$on("onClick",(function(){return t[2](t[4])})),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(i,n){t=i;const o={};1&n&&(o.label=t[4].name),1&n&&(o.icon=MAPS_DIR+t[4].database+"/icons/favicon.png"),1&n&&(o.disabled=t[4].disabled),e.$set(o)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_each_block$7(t){let e,i,n=t[4].isModded&&create_if_block_1$a(t);return{c(){n&&n.c(),e=empty()},m(t,o){n&&n.m(t,o),insert(t,e,o),i=!0},p(t,i){t[4].isModded?n?(n.p(t,i),1&i&&transition_in(n,1)):(n=create_if_block_1$a(t),n.c(),transition_in(n,1),n.m(e.parentNode,e)):n&&(group_outros(),transition_out(n,1,1,(()=>{n=null})),check_outros())},i(t){i||(transition_in(n),i=!0)},o(t){transition_out(n),i=!1},d(t){n&&n.d(t),t&&detach(e)}}}function create_default_slot$4(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f,g,y;i=new Icon({props:{name:"map",size:"medium"}}),c=new Divider({props:{direction:"horizontal"}});const v=[create_if_block$e,create_else_block$7],b=[];function k(t,e){return t[0]?.length>0?0:1}return m=k(t),f=b[m]=v[m](t),{c(){e=element("span"),create_component(i.$$.fragment),n=element("br"),o=space(),s=element("b"),s.textContent="Choose a game map",r=space(),a=element("p"),l=space(),create_component(c.$$.fragment),h=space(),u=element("p"),d=text("\n        Please choose a game from the options below.\n        "),p=element("p"),_=space(),f.c(),g=empty(),set_style(s,"margin-bottom","10px"),attr(e,"class","info_title svelte-ch4cvt")},m(t,f){insert(t,e,f),mount_component(i,e,null),append(e,n),append(e,o),append(e,s),insert(t,r,f),insert(t,a,f),insert(t,l,f),mount_component(c,t,f),insert(t,h,f),insert(t,u,f),insert(t,d,f),insert(t,p,f),insert(t,_,f),b[m].m(t,f),insert(t,g,f),y=!0},p(t,e){let i=m;m=k(t),m===i?b[m].p(t,e):(group_outros(),transition_out(b[i],1,1,(()=>{b[i]=null})),check_outros(),f=b[m],f?f.p(t,e):(f=b[m]=v[m](t),f.c()),transition_in(f,1),f.m(g.parentNode,g))},i(t){y||(transition_in(i.$$.fragment,t),transition_in(c.$$.fragment,t),transition_in(f),y=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(c.$$.fragment,t),transition_out(f),y=!1},d(t){t&&detach(e),destroy_component(i),t&&detach(r),t&&detach(a),t&&detach(l),destroy_component(c,t),t&&detach(h),t&&detach(u),t&&detach(d),t&&detach(p),t&&detach(_),b[m].d(t),t&&detach(g)}}}function create_fragment$l(t){let e,i;return e=new PreloadBox({props:{$$slots:{default:[create_default_slot$4]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,[i]){const n={};513&i&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function instance$k(t,e,i){let n=null;print("Getting available maps...");let o={action:"get_maps"};getJSON(GAME_DATA_SCRIPT+queryify(o)).then((t=>{i(0,n=[]),t.maps.forEach((e=>{let i={},o=t.mapInfos[e];i.name=o?.mapTitle.replace("Gamemap","").replace("Map","").trim()??e.toUpperCase(),i.database=e,i.disabled=null==o,i.isModded=1==o?.isModded||i.disabled,i.releaseDate=o?Date.parse(new Date(o.releaseDate.split("/")[2],o.releaseDate.split("/")[1]-1,o.releaseDate.split("/")[0])):0,n.push(i)})),n.sort(((t,e)=>new Date(e.releaseDate).getTime()-new Date(t.releaseDate).getTime())),print(n)}));return[n,t=>location.pathname=t.database,t=>location.pathname=t.database]}class MapChooser extends SvelteComponent{constructor(t){super(),init(this,t,instance$k,create_fragment$l,safe_not_equal,{})}}function create_fragment$k(t){let e,i,n,o,s,r,a;return{c(){e=element("label"),i=element("input"),n=space(),o=element("span"),s=text(t[1]),attr(i,"type","checkbox"),attr(i,"class","filled-in"),i.checked=t[0],attr(o,"class","svelte-xt39e3"),attr(e,"class","waves-effect"),set_style(e,"width","100%"),set_style(e,"padding-top","8px"),attr(e,"title",t[2])},m(l,c){insert(l,e,c),append(e,i),append(e,n),append(e,o),append(o,s),r||(a=listen(i,"change",t[3]),r=!0)},p(t,[n]){1&n&&(i.checked=t[0]),2&n&&set_data(s,t[1]),4&n&&attr(e,"title",t[2])},i:noop,o:noop,d(t){t&&detach(e),r=!1,a()}}}function instance$j(t,e,i){let{label:n}=e,{checked:o=!1}=e,{title:s}=e;const r=createEventDispatcher();return t.$$set=t=>{"label"in t&&i(1,n=t.label),"checked"in t&&i(0,o=t.checked),"title"in t&&i(2,s=t.title)},[o,n,s,function(){i(0,o=!o),r("change",o)}]}class Checkbox extends SvelteComponent{constructor(t){super(),init(this,t,instance$j,create_fragment$k,safe_not_equal,{label:1,checked:0,title:2})}get label(){return this.$$.ctx[1]}set label(t){this.$$set({label:t}),flush()}get checked(){return this.$$.ctx[0]}set checked(t){this.$$set({checked:t}),flush()}get title(){return this.$$.ctx[2]}set title(t){this.$$set({title:t}),flush()}}function create_if_block_2$9(t){let e,i;return e=new Icon({props:{name:t[4],size:t[8]}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16&i&&(n.name=t[4]),256&i&&(n.size=t[8]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$9(t){let e,i;return{c(){e=element("b"),i=text(t[0]),attr(e,"class","icon_btn_label nomobile svelte-1qvcls6")},m(t,n){insert(t,e,n),append(e,i)},p(t,e){1&e&&set_data(i,t[0])},d(t){t&&detach(e)}}}function create_if_block$d(t){let e;return{c(){e=element("i"),e.textContent="expand_more",attr(e,"id","dropdown_icon"),attr(e,"class","material-icons nomobile svelte-1qvcls6")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_fragment$j(t){let e,i,n,o,s,r,a,l=t[4]&&create_if_block_2$9(t),c=t[0]&&create_if_block_1$9(t),h=t[6]&&create_if_block$d();const u=t[12].default,d=create_slot(u,t,t[11],null);return{c(){e=element("button"),l&&l.c(),i=space(),c&&c.c(),n=space(),h&&h.c(),o=space(),d&&d.c(),attr(e,"class","btn_icon_button waves-effect mdc-ripple-surface svelte-1qvcls6"),attr(e,"title",t[3]),attr(e,"data-target",t[7]),toggle_class(e,"lock",t[9]),toggle_class(e,"checked",t[2]),toggle_class(e,"hasBackground",t[1]),toggle_class(e,"bgless",!t[1]),toggle_class(e,"nomobile",t[5]),toggle_class(e,"dropdown",t[6]),toggle_class(e,"dropdown-trigger",null!=t[7])},m(u,p){insert(u,e,p),l&&l.m(e,null),append(e,i),c&&c.m(e,null),append(e,n),h&&h.m(e,null),insert(u,o,p),d&&d.m(u,p),s=!0,r||(a=[listen(e,"click",t[10]),listen(e,"auxclick",t[10]),listen(e,"contextmenu",contextmenu_handler$2)],r=!0)},p(t,[o]){t[4]?l?(l.p(t,o),16&o&&transition_in(l,1)):(l=create_if_block_2$9(t),l.c(),transition_in(l,1),l.m(e,i)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros()),t[0]?c?c.p(t,o):(c=create_if_block_1$9(t),c.c(),c.m(e,n)):c&&(c.d(1),c=null),t[6]?h||(h=create_if_block$d(),h.c(),h.m(e,null)):h&&(h.d(1),h=null),(!s||8&o)&&attr(e,"title",t[3]),(!s||128&o)&&attr(e,"data-target",t[7]),(!s||512&o)&&toggle_class(e,"lock",t[9]),(!s||4&o)&&toggle_class(e,"checked",t[2]),(!s||2&o)&&toggle_class(e,"hasBackground",t[1]),(!s||2&o)&&toggle_class(e,"bgless",!t[1]),(!s||32&o)&&toggle_class(e,"nomobile",t[5]),(!s||64&o)&&toggle_class(e,"dropdown",t[6]),(!s||128&o)&&toggle_class(e,"dropdown-trigger",null!=t[7]),d&&d.p&&(!s||2048&o)&&update_slot_base(d,u,t,t[11],s?get_slot_changes(u,t[11],o,null):get_all_dirty_from_scope(t[11]),null)},i(t){s||(transition_in(l),transition_in(d,t),s=!0)},o(t){transition_out(l),transition_out(d,t),s=!1},d(t){t&&detach(e),l&&l.d(),c&&c.d(),h&&h.d(),t&&detach(o),d&&d.d(t),r=!1,run_all(a)}}}const contextmenu_handler$2=t=>t.stopPropagation();function instance$i(t,e,i){let{$$slots:n={},$$scope:o}=e,{tooltip:s}=e,{icon:r}=e,{label:a}=e,{hasBackground:l=!0}=e,{checked:c}=e,{noMobile:h}=e,{dropdown:u}=e,{menu:d}=e,{size:p}=e,{lock:_}=e;c=null!=c?JSON.parse(c):null,l=null!=l?JSON.parse(l):null;const m=createEventDispatcher();return null!=u&&(c=!1),null!=c&&(l=!0),l||(a=null),null==a&&u&&(a="Loading..."),onMount((async()=>{if(null!=d){var t=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(t,{constrainWidth:!1,closeOnClick:!0,alignment:"right"})}})),t.$$set=t=>{"tooltip"in t&&i(3,s=t.tooltip),"icon"in t&&i(4,r=t.icon),"label"in t&&i(0,a=t.label),"hasBackground"in t&&i(1,l=t.hasBackground),"checked"in t&&i(2,c=t.checked),"noMobile"in t&&i(5,h=t.noMobile),"dropdown"in t&&i(6,u=t.dropdown),"menu"in t&&i(7,d=t.menu),"size"in t&&i(8,p=t.size),"lock"in t&&i(9,_=t.lock),"$$scope"in t&&i(11,o=t.$$scope)},[a,l,c,s,r,h,u,d,p,_,function(t){null!=c?(i(2,c=!c),m("checked",{checked:c,shift:t.shiftKey})):t.shiftKey?m("shiftClicked","clicked"):m("click","clicked")},o,n]}class IconButton extends SvelteComponent{constructor(t){super(),init(this,t,instance$i,create_fragment$j,safe_not_equal,{tooltip:3,icon:4,label:0,hasBackground:1,checked:2,noMobile:5,dropdown:6,menu:7,size:8,lock:9})}get tooltip(){return this.$$.ctx[3]}set tooltip(t){this.$$set({tooltip:t}),flush()}get icon(){return this.$$.ctx[4]}set icon(t){this.$$set({icon:t}),flush()}get label(){return this.$$.ctx[0]}set label(t){this.$$set({label:t}),flush()}get hasBackground(){return this.$$.ctx[1]}set hasBackground(t){this.$$set({hasBackground:t}),flush()}get checked(){return this.$$.ctx[2]}set checked(t){this.$$set({checked:t}),flush()}get noMobile(){return this.$$.ctx[5]}set noMobile(t){this.$$set({noMobile:t}),flush()}get dropdown(){return this.$$.ctx[6]}set dropdown(t){this.$$set({dropdown:t}),flush()}get menu(){return this.$$.ctx[7]}set menu(t){this.$$set({menu:t}),flush()}get size(){return this.$$.ctx[8]}set size(t){this.$$set({size:t}),flush()}get lock(){return this.$$.ctx[9]}set lock(t){this.$$set({lock:t}),flush()}}function get_if_ctx$2(t){const e=t.slice(),i=new Date(Date.parse(e[5]));e[14]=i;const n=UTCtoLocalDate(e[14]);return e[15]=n,e}function get_if_ctx_1$1(t){const e=t.slice(),i=e[8].includes("edit")?"edit":e[8].includes("delete")?"delete_forever":e[8].includes("add")?"add":e[8].includes("revert")?"history":"add";return e[11]=i,e}function get_if_ctx_2$1(t){const e=t.slice(),i=e[11].includes("/")?gamemap.getMapConfig().icons.get(Number(e[11].replace(/\D/g,""))):e[3]>0?"World":"Location";return e[16]=i,e}function create_if_block_3$8(t){let e,i,n,o;function s(t,i){return 2048&i&&(e=null),null==e&&(e=!!t[11].includes("/")),e?create_if_block_5$3:create_else_block$6}let r=s(t,-1),a=r(t),l=t[8]&&create_if_block_4$4(get_if_ctx_1$1(t));return{c(){a.c(),i=space(),l&&l.c(),n=empty()},m(t,e){a.m(t,e),insert(t,i,e),l&&l.m(t,e),insert(t,n,e),o=!0},p(t,e){r===(r=s(t,e))&&a?a.p(t,e):(a.d(1),a=r(t),a&&(a.c(),a.m(i.parentNode,i))),t[8]?l?(l.p(get_if_ctx_1$1(t),e),256&e&&transition_in(l,1)):(l=create_if_block_4$4(get_if_ctx_1$1(t)),l.c(),transition_in(l,1),l.m(n.parentNode,n)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){o||(transition_in(l),o=!0)},o(t){transition_out(l),o=!1},d(t){a.d(t),t&&detach(i),l&&l.d(t),t&&detach(n)}}}function create_else_block$6(t){let e,i,n;return{c(){e=element("i"),i=text(t[11]),attr(e,"class","material-icons circle svelte-1igwy1o"),attr(e,"title",n=t[16])},m(t,n){insert(t,e,n),append(e,i)},p(t,o){2048&o&&set_data(i,t[11]),2056&o&&n!==(n=t[16])&&attr(e,"title",n)},d(t){t&&detach(e)}}}function create_if_block_5$3(t){let e,i,n;return{c(){e=element("img"),attr(e,"class","circle svelte-1igwy1o"),src_url_equal(e.src,i=t[11])||attr(e,"src",i),attr(e,"width",gamemap.getMapConfig().iconSize),attr(e,"height",gamemap.getMapConfig().iconSize),attr(e,"title",n=t[16])},m(t,i){insert(t,e,i)},p(t,o){2048&o&&!src_url_equal(e.src,i=t[11])&&attr(e,"src",i),2056&o&&n!==(n=t[16])&&attr(e,"title",n)},d(t){t&&detach(e)}}}function create_if_block_4$4(t){let e,i,n;return i=new Icon({props:{name:t[11],size:"13"}}),{c(){e=element("div"),create_component(i.$$.fragment),attr(e,"title",t[9]),attr(e,"class","action svelte-1igwy1o"),toggle_class(e,"add",t[8].includes("add")),toggle_class(e,"delete",t[8].includes("delete")),toggle_class(e,"edit",t[8].includes("edit")),toggle_class(e,"revert",t[8].includes("revert"))},m(t,o){insert(t,e,o),mount_component(i,e,null),n=!0},p(t,o){const s={};256&o&&(s.name=t[11]),i.$set(s),(!n||512&o)&&attr(e,"title",t[9]),(!n||256&o)&&toggle_class(e,"add",t[8].includes("add")),(!n||256&o)&&toggle_class(e,"delete",t[8].includes("delete")),(!n||256&o)&&toggle_class(e,"edit",t[8].includes("edit")),(!n||256&o)&&toggle_class(e,"revert",t[8].includes("revert"))},i(t){n||(transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(i.$$.fragment,t),n=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_if_block_2$8(t){let e,i,n,o=getTimeAgo(Date.parse(t[15]))+"";return{c(){e=element("small"),i=text(o),attr(e,"class","timestamp svelte-1igwy1o"),attr(e,"title",n=t[15])},m(t,n){insert(t,e,n),append(e,i)},p(t,s){32&s&&o!==(o=getTimeAgo(Date.parse(t[15]))+"")&&set_data(i,o),32&s&&n!==(n=t[15])&&attr(e,"title",n)},d(t){t&&detach(e)}}}function create_if_block_1$8(t){let e,i,n=(t[7]&&!t[1]?"":t[1])+"";return{c(){e=element("small"),i=text(n),attr(e,"class","list_subtitle svelte-1igwy1o"),set_style(e,"color","var(--text_low_emphasis)")},m(t,n){insert(t,e,n),append(e,i)},p(t,e){130&e&&n!==(n=(t[7]&&!t[1]?"":t[1])+"")&&set_data(i,n)},d(t){t&&detach(e)}}}function create_if_block$c(t){let e,i,n,o,s,r=("bot"==t[7].toLowerCase()?""+t[7]:t[7])+"";return i=new Icon({props:{name:"bot"==t[7].toLowerCase()?"smart_toy":"person",size:"tiny"}}),{c(){e=element("small"),create_component(i.$$.fragment),n=space(),o=text(r),attr(e,"class","author svelte-1igwy1o")},m(t,r){insert(t,e,r),mount_component(i,e,null),append(e,n),append(e,o),s=!0},p(t,e){const n={};128&e&&(n.name="bot"==t[7].toLowerCase()?"smart_toy":"person"),i.$set(n),(!s||128&e)&&r!==(r=("bot"==t[7].toLowerCase()?""+t[7]:t[7])+"")&&set_data(o,r)},i(t){s||(transition_in(i.$$.fragment,t),s=!0)},o(t){transition_out(i.$$.fragment,t),s=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_fragment$i(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m=t[11]&&create_if_block_3$8(get_if_ctx_2$1(t)),f=t[5]&&create_if_block_2$8(get_if_ctx$2(t)),g=(t[1]||t[7])&&create_if_block_1$8(t),y=t[7]&&create_if_block$c(t);return{c(){e=element("div"),i=element("a"),m&&m.c(),n=space(),o=element("div"),s=element("div"),r=element("b"),a=text(t[0]),l=space(),f&&f.c(),c=space(),h=element("div"),g&&g.c(),u=space(),y&&y.c(),attr(r,"class","list_title svelte-1igwy1o"),attr(r,"title",t[0]),toggle_class(r,"bold",t[2]),attr(s,"class","title svelte-1igwy1o"),attr(h,"class","subtitle svelte-1igwy1o"),attr(o,"class","text"),attr(i,"class","collection-item waves-effect mdc-ripple-surface list-item svelte-1igwy1o"),toggle_class(i,"avatar",null!=t[11]),toggle_class(i,"compact",t[6]),attr(e,"class","collection svelte-1igwy1o"),attr(e,"title",t[10]),toggle_class(e,"selected",t[4])},m(v,b){insert(v,e,b),append(e,i),m&&m.m(i,null),append(i,n),append(i,o),append(o,s),append(s,r),append(r,a),append(s,l),f&&f.m(s,null),append(o,c),append(o,h),g&&g.m(h,null),append(h,u),y&&y.m(h,null),d=!0,p||(_=[listen(i,"click",t[12]),listen(i,"auxclick",t[12])],p=!0)},p(t,[o]){t[11]?m?(m.p(get_if_ctx_2$1(t),o),2048&o&&transition_in(m,1)):(m=create_if_block_3$8(get_if_ctx_2$1(t)),m.c(),transition_in(m,1),m.m(i,n)):m&&(group_outros(),transition_out(m,1,1,(()=>{m=null})),check_outros()),(!d||1&o)&&set_data(a,t[0]),(!d||1&o)&&attr(r,"title",t[0]),(!d||4&o)&&toggle_class(r,"bold",t[2]),t[5]?f?f.p(get_if_ctx$2(t),o):(f=create_if_block_2$8(get_if_ctx$2(t)),f.c(),f.m(s,null)):f&&(f.d(1),f=null),t[1]||t[7]?g?g.p(t,o):(g=create_if_block_1$8(t),g.c(),g.m(h,u)):g&&(g.d(1),g=null),t[7]?y?(y.p(t,o),128&o&&transition_in(y,1)):(y=create_if_block$c(t),y.c(),transition_in(y,1),y.m(h,null)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros()),(!d||2048&o)&&toggle_class(i,"avatar",null!=t[11]),(!d||64&o)&&toggle_class(i,"compact",t[6]),(!d||1024&o)&&attr(e,"title",t[10]),(!d||16&o)&&toggle_class(e,"selected",t[4])},i(t){d||(transition_in(m),transition_in(y),d=!0)},o(t){transition_out(m),transition_out(y),d=!1},d(t){t&&detach(e),m&&m.d(),f&&f.d(),g&&g.d(),y&&y.d(),p=!1,run_all(_)}}}function instance$h(t,e,i){let{title:n}=e,{subtitle:o}=e,{icon:s}=e,{bold:r}=e,{destinationID:a}=e,{selected:l}=e,{timestamp:c}=e,{compact:h}=e,{user:u}=e,{action:d}=e,{comment:p}=e,{tooltip:_}=e;const m=createEventDispatcher();return t.$$set=t=>{"title"in t&&i(0,n=t.title),"subtitle"in t&&i(1,o=t.subtitle),"icon"in t&&i(11,s=t.icon),"bold"in t&&i(2,r=t.bold),"destinationID"in t&&i(3,a=t.destinationID),"selected"in t&&i(4,l=t.selected),"timestamp"in t&&i(5,c=t.timestamp),"compact"in t&&i(6,h=t.compact),"user"in t&&i(7,u=t.user),"action"in t&&i(8,d=t.action),"comment"in t&&i(9,p=t.comment),"tooltip"in t&&i(10,_=t.tooltip)},[n,o,r,a,l,c,h,u,d,p,_,s,function(t){t.shiftKey?m("shiftClick",a):"auxclick"==t.type?m("middleClick",a):m("click",a)}]}class ListItem extends SvelteComponent{constructor(t){super(),init(this,t,instance$h,create_fragment$i,safe_not_equal,{title:0,subtitle:1,icon:11,bold:2,destinationID:3,selected:4,timestamp:5,compact:6,user:7,action:8,comment:9,tooltip:10})}get title(){return this.$$.ctx[0]}set title(t){this.$$set({title:t}),flush()}get subtitle(){return this.$$.ctx[1]}set subtitle(t){this.$$set({subtitle:t}),flush()}get icon(){return this.$$.ctx[11]}set icon(t){this.$$set({icon:t}),flush()}get bold(){return this.$$.ctx[2]}set bold(t){this.$$set({bold:t}),flush()}get destinationID(){return this.$$.ctx[3]}set destinationID(t){this.$$set({destinationID:t}),flush()}get selected(){return this.$$.ctx[4]}set selected(t){this.$$set({selected:t}),flush()}get timestamp(){return this.$$.ctx[5]}set timestamp(t){this.$$set({timestamp:t}),flush()}get compact(){return this.$$.ctx[6]}set compact(t){this.$$set({compact:t}),flush()}get user(){return this.$$.ctx[7]}set user(t){this.$$set({user:t}),flush()}get action(){return this.$$.ctx[8]}set action(t){this.$$set({action:t}),flush()}get comment(){return this.$$.ctx[9]}set comment(t){this.$$set({comment:t}),flush()}get tooltip(){return this.$$.ctx[10]}set tooltip(t){this.$$set({tooltip:t}),flush()}}const{window:window_1$4}=globals;function get_each_context$6(t,e,i){const n=t.slice();n[31]=e[i];const o=n[31].destinationID>0;return n[32]=o,n}function create_if_block_9$2(t){let e,i;return e=new IconButton({props:{icon:"close",tooltip:"Clear the current search",hasBackground:!1}}),e.$on("click",t[13]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p:noop,i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_8$2(t){let e,i,n;return i=new ProgressBar({}),{c(){e=element("div"),create_component(i.$$.fragment),set_style(e,"top","46px"),set_style(e,"position","absolute"),set_style(e,"left","0px"),set_style(e,"width","100%")},m(t,o){insert(t,e,o),mount_component(i,e,null),n=!0},i(t){n||(transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(i.$$.fragment,t),n=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_if_block$b(t){let e,i,n,o,s,r,a,l,c,h,u,d;s=new Icon({props:{name:t[8]?"expand_less":"expand_more",size:"tiny"}});let p=t[7]&&t[10]&&create_if_block_7$2(),_=t[8]&&create_if_block_5$2(t),m=t[10]&&create_if_block_1$7(t);return{c(){e=element("div"),i=element("div"),n=element("b"),o=text("Search Options "),create_component(s.$$.fragment),r=element("br"),a=space(),p&&p.c(),l=space(),_&&_.c(),c=space(),m&&m.c(),set_style(n,"font-size","1.0rem"),attr(n,"class","waves-effect"),attr(n,"title","Click to show/hide search options"),attr(i,"id","search_options"),attr(i,"class","svelte-1agzzz"),toggle_class(i,"fullPane",t[10]),attr(e,"id","search_content_container"),attr(e,"class","svelte-1agzzz"),toggle_class(e,"fullPane",t[10])},m(f,g){insert(f,e,g),append(e,i),append(i,n),append(n,o),mount_component(s,n,null),append(i,r),append(i,a),p&&p.m(i,null),append(i,l),_&&_.m(i,null),append(e,c),m&&m.m(e,null),h=!0,u||(d=listen(n,"click",t[22]),u=!0)},p(t,n){const o={};256&n[0]&&(o.name=t[8]?"expand_less":"expand_more"),s.$set(o),t[7]&&t[10]?p?1152&n[0]&&transition_in(p,1):(p=create_if_block_7$2(),p.c(),transition_in(p,1),p.m(i,l)):p&&(group_outros(),transition_out(p,1,1,(()=>{p=null})),check_outros()),t[8]?_?(_.p(t,n),256&n[0]&&transition_in(_,1)):(_=create_if_block_5$2(t),_.c(),transition_in(_,1),_.m(i,null)):_&&(group_outros(),transition_out(_,1,1,(()=>{_=null})),check_outros()),(!h||1024&n[0])&&toggle_class(i,"fullPane",t[10]),t[10]?m?(m.p(t,n),1024&n[0]&&transition_in(m,1)):(m=create_if_block_1$7(t),m.c(),transition_in(m,1),m.m(e,null)):m&&(group_outros(),transition_out(m,1,1,(()=>{m=null})),check_outros()),(!h||1024&n[0])&&toggle_class(e,"fullPane",t[10])},i(t){h||(transition_in(s.$$.fragment,t),transition_in(p),transition_in(_),transition_in(m),h=!0)},o(t){transition_out(s.$$.fragment,t),transition_out(p),transition_out(_),transition_out(m),h=!1},d(t){t&&detach(e),destroy_component(s),p&&p.d(),_&&_.d(),m&&m.d(),u=!1,d()}}}function create_if_block_7$2(t){let e,i,n;return i=new Icon({props:{name:"push_pin",size:"tiny"}}),{c(){e=element("div"),create_component(i.$$.fragment),attr(e,"id","search_pin_status"),attr(e,"title","Search is pinned"),attr(e,"class","svelte-1agzzz")},m(t,o){insert(t,e,o),mount_component(i,e,null),n=!0},i(t){n||(transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(i.$$.fragment,t),n=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_if_block_5$2(t){let e,i,n,o=gamemap.hasMultipleWorlds(),s=o&&create_if_block_6$2(t);return i=new Checkbox({props:{label:"Pin search window over map",title:"Toggle to pin the search window over the map",checked:t[7]}}),i.$on("change",t[24]),{c(){s&&s.c(),e=space(),create_component(i.$$.fragment)},m(t,o){s&&s.m(t,o),insert(t,e,o),mount_component(i,t,o),n=!0},p(t,e){o&&s.p(t,e);const n={};128&e[0]&&(n.checked=t[7]),i.$set(n)},i(t){n||(transition_in(s),transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(s),transition_out(i.$$.fragment,t),n=!1},d(t){s&&s.d(t),t&&detach(e),destroy_component(i,t)}}}function create_if_block_6$2(t){let e,i;return e=new Checkbox({props:{label:"Only show results from this map",title:"Toggle to only search locations in the current map",checked:t[6]}}),e.$on("change",t[23]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};64&i[0]&&(n.checked=t[6]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$7(t){let e,i,n,o,s,r=!t[9]&&create_if_block_4$3(),a=null!=t[9]&&create_if_block_2$7(t);return{c(){e=element("hr"),i=space(),r&&r.c(),n=space(),a&&a.c(),o=empty(),attr(e,"id","search_divider")},m(t,l){insert(t,e,l),insert(t,i,l),r&&r.m(t,l),insert(t,n,l),a&&a.m(t,l),insert(t,o,l),s=!0},p(t,e){t[9]?r&&(r.d(1),r=null):r||(r=create_if_block_4$3(),r.c(),r.m(n.parentNode,n)),null!=t[9]?a?(a.p(t,e),512&e[0]&&transition_in(a,1)):(a=create_if_block_2$7(t),a.c(),transition_in(a,1),a.m(o.parentNode,o)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros())},i(t){s||(transition_in(a),s=!0)},o(t){transition_out(a),s=!1},d(t){t&&detach(e),t&&detach(i),r&&r.d(t),t&&detach(n),a&&a.d(t),t&&detach(o)}}}function create_if_block_4$3(t){let e;return{c(){e=element("b"),e.textContent="Searching...",set_style(e,"font-size","1.0rem"),set_style(e,"width","100%"),set_style(e,"text-align","center"),set_style(e,"display","inline-block"),set_style(e,"padding","var(--padding_small) ")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_if_block_2$7(t){let e,i,n,o;const s=[create_if_block_3$7,create_else_block$5],r=[];function a(t,e){return t[9].length>0?0:1}return i=a(t),n=r[i]=s[i](t),{c(){e=element("div"),n.c(),attr(e,"id","search_results"),attr(e,"class","search_results svelte-1agzzz")},m(t,n){insert(t,e,n),r[i].m(e,null),o=!0},p(t,o){let l=i;i=a(t),i===l?r[i].p(t,o):(group_outros(),transition_out(r[l],1,1,(()=>{r[l]=null})),check_outros(),n=r[i],n?n.p(t,o):(n=r[i]=s[i](t),n.c()),transition_in(n,1),n.m(e,null))},i(t){o||(transition_in(n),o=!0)},o(t){transition_out(n),o=!1},d(t){t&&detach(e),r[i].d()}}}function create_else_block$5(t){let e;return{c(){e=element("b"),e.textContent="No results found.",set_style(e,"font-size","1.0rem"),set_style(e,"width","100%"),set_style(e,"text-align","center"),set_style(e,"display","inline-block"),set_style(e,"padding","var(--padding_small)")},m(t,i){insert(t,e,i)},p:noop,i:noop,o:noop,d(t){t&&detach(e)}}}function create_if_block_3$7(t){let e,i,n=t[9],o=[];for(let e=0;e<n.length;e+=1)o[e]=create_each_block$6(get_each_context$6(t,n,e));const s=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=empty()},m(t,n){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,n);insert(t,e,n),i=!0},p(t,i){if(16896&i[0]){let r;for(n=t[9],r=0;r<n.length;r+=1){const s=get_each_context$6(t,n,r);o[r]?(o[r].p(s,i),transition_in(o[r],1)):(o[r]=create_each_block$6(s),o[r].c(),transition_in(o[r],1),o[r].m(e.parentNode,e))}for(group_outros(),r=n.length;r<o.length;r+=1)s(r);check_outros()}},i(t){if(!i){for(let t=0;t<n.length;t+=1)transition_in(o[t]);i=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);i=!1},d(t){destroy_each(o,t),t&&detach(e)}}}function create_each_block$6(t){let e,i;return e=new ListItem({props:{title:t[31].name,subtitle:!t[32]&&gamemap.hasMultipleWorlds()?t[31].description:null,icon:null!=t[31].icon?gamemap.getMapConfig().iconPath+t[31].icon+".png":t[32]?"public":"location_on",destinationID:t[31].destinationID,bold:t[32]}}),e.$on("click",t[25]),e.$on("middleClick",t[26]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};512&i[0]&&(n.title=t[31].name),512&i[0]&&(n.subtitle=!t[32]&&gamemap.hasMultipleWorlds()?t[31].description:null),512&i[0]&&(n.icon=null!=t[31].icon?gamemap.getMapConfig().iconPath+t[31].icon+".png":t[32]?"public":"location_on"),512&i[0]&&(n.destinationID=t[31].destinationID),512&i[0]&&(n.bold=t[32]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_fragment$h(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f;s=new Icon({props:{name:"search"}});let g=t[0].length>0&&""!=t[3].value&&create_if_block_9$2(t),y=t[10]&&t[5]&&create_if_block_8$2(),v=t[4]&&create_if_block$b(t);return{c(){e=element("div"),i=element("div"),n=element("div"),o=element("div"),create_component(s.$$.fragment),r=space(),a=element("div"),l=element("input"),c=space(),g&&g.c(),h=space(),y&&y.c(),u=space(),v&&v.c(),attr(o,"id","search_icon"),attr(o,"class","svelte-1agzzz"),attr(l,"id","searchbox"),attr(l,"type","search"),attr(l,"placeholder","Where would you like to go?"),attr(l,"maxlength","100"),set_style(l,"border-bottom","none",1),set_style(l,"box-shadow","none",1),attr(l,"autocomplete","off"),attr(a,"id","searchbox_container"),attr(a,"class","svelte-1agzzz"),attr(n,"id","searchbar"),attr(n,"title","Type here to search"),attr(n,"class","waves-effect svelte-1agzzz"),toggle_class(n,"fullPane",t[10]),toggle_class(n,"lockNoFade",t[1]),attr(i,"id","search_container"),attr(i,"class","svelte-1agzzz"),attr(e,"id","search_pane"),attr(e,"class","svelte-1agzzz"),toggle_class(e,"lock",t[1])},m(d,p){insert(d,e,p),append(e,i),append(i,n),append(n,o),mount_component(s,o,null),append(n,r),append(n,a),append(a,l),t[18](l),set_input_value(l,t[0]),append(n,c),g&&g.m(n,null),append(n,h),y&&y.m(n,null),append(i,u),v&&v.m(i,null),_=!0,m||(f=[listen(window_1$4,"keydown",t[12]),listen(window_1$4,"mousedown",t[16]),listen(l,"focus",t[17]),listen(l,"input",t[19]),listen(l,"input",t[20]),listen(n,"click",t[21]),listen(e,"contextmenu",stop_propagation(t[15]))],m=!0)},p(t,o){1&o[0]&&l.value!==t[0]&&set_input_value(l,t[0]),t[0].length>0&&""!=t[3].value?g?(g.p(t,o),9&o[0]&&transition_in(g,1)):(g=create_if_block_9$2(t),g.c(),transition_in(g,1),g.m(n,h)):g&&(group_outros(),transition_out(g,1,1,(()=>{g=null})),check_outros()),t[10]&&t[5]?y?1056&o[0]&&transition_in(y,1):(y=create_if_block_8$2(),y.c(),transition_in(y,1),y.m(n,null)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros()),(!_||1024&o[0])&&toggle_class(n,"fullPane",t[10]),(!_||2&o[0])&&toggle_class(n,"lockNoFade",t[1]),t[4]?v?(v.p(t,o),16&o[0]&&transition_in(v,1)):(v=create_if_block$b(t),v.c(),transition_in(v,1),v.m(i,null)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros()),(!_||2&o[0])&&toggle_class(e,"lock",t[1])},i(t){_||(transition_in(s.$$.fragment,t),transition_in(g),transition_in(y),transition_in(v),add_render_callback((()=>{_&&(p&&p.end(1),d=create_in_transition(e,fly,{x:-5,duration:250}),d.start())})),_=!0)},o(t){transition_out(s.$$.fragment,t),transition_out(g),transition_out(y),transition_out(v),d&&d.invalidate(),p=create_out_transition(e,fade,{duration:75}),_=!1},d(i){i&&detach(e),destroy_component(s),t[18](null),g&&g.d(),y&&y.d(),v&&v.d(),i&&p&&p.end(),m=!1,run_all(f)}}}const DELAY_AMOUNT=500;function selectSearchResult(t){let e=document.querySelectorAll(".list-item.selected");[].forEach.call(e,(function(t){t.classList.remove("selected")}));let i=document.getElementsByClassName("list-item");i[t].classList.add("selected"),i[t].scrollIntoView({behavior:"auto",block:"nearest"})}function instance$g(t,e,i){let n,o,{lock:s}=e,{searchQuery:r=""}=e,a=null,l=!1,c=!1,h=getPrefs("pinsearch"),u=getPrefs("expandsearchoptions"),d=null,p=null,_=0,m=class{constructor(t,e,i,n){this.name=t,this.description=e,this.icon=i||null,this.destinationID=n}};function f(t,e){i(0,r=t),i(3,a.value=t,a),i(4,p=!0),e=null!=e&&e,null!=t&&t.length>0?(i(9,d=null),_=0,i(5,l=!0),null!=o&&clearTimeout(o),o=setTimeout((()=>function(t,e){let n={action:"search"};n.search=encodeURIComponent(t),print("search query: "+n.search+", search in map: "+e),1==e&&(n.world=gamemap.getCurrentWorldID());if(n.db=gamemap.getMapConfig().database,"type:"===t.substring(0,5)){let e=gamemap.getIconByName(t.substring(5));null!=e&&(n.searchtype=e)}else if("name:"===t.substring(0,5)){null!=(o=t.substring(5).trim())&&""!=o&&(n.searchname=o)}else if("world:"===t.substring(0,6)){var o;null!=(o=t.substring(6).trim())&&""!=o&&(n.searchname=o)}getJSON(GAME_DATA_SCRIPT+queryify(n)).then((t=>{let e=[].concat(t.worlds,t.locations),n=[];for(let t in e){let i=e[t];if(null!=i){let t;if(null!=i.tilesX)t=new m(i.displayName,null,null,i.id);else{let e=gamemap.getWorldFromID(i.worldId);null!=e&&(t=new m(i.name,e.displayName,i.iconType,-i.id))}null!=t&&n.push(t)}}i(9,d=n),i(5,l=!1),print(d)})).catch((t=>print.warn(`There was an error getting search results: ${t}`)))}(t,e)),DELAY_AMOUNT)):y()}function g(t,e){if("focus"!=t.type){let e=document.querySelector("#search_pane"),n=null!=t.relatedTarget?t.relatedTarget:null!=t.explicitOriginalTarget?t.explicitOriginalTarget:document.elementsFromPoint(t.clientX,t.clientY)[0],o=e!==n&&e.contains(n);h?""==r&&i(4,p=o):i(4,p=o)}else i(4,p=e)}function y(){i(3,a.value="",a),_=0,i(5,l=!1),i(9,d=null)}function v(t){gamemap.goto(t),h||i(4,p=!1)}return t.$$set=t=>{"lock"in t&&i(1,s=t.lock),"searchQuery"in t&&i(0,r=t.searchQuery)},t.$$.update=()=>{27&t.$$.dirty[0]&&i(10,n=r.length>0&&""!=r&&p&&""!=a.value&&!s)},[r,s,f,a,p,l,c,h,u,d,n,g,function(t){(t.ctrlKey||t.metaKey)&&70===t.keyCode&&(t.preventDefault(),a.focus()),p&&n&&null!=d&&d.length>0&&("Enter"!=t.key&&13!=t.keyCode||(v(d[_].destinationID),selectSearchResult(_),t.preventDefault()),"ArrowUp"!=t.key&&38!=t.keyCode||(_=_-1>=0?_-1:0,0==_&&document.getElementById("search_content_container").scroll({top:0,behavior:"auto"}),selectSearchResult(_),t.preventDefault()),"ArrowDown"!=t.key&&40!=t.keyCode||(_=_+1!=d.length?_+1:_,selectSearchResult(_),t.preventDefault())),p&&("Escape"!=t.key&&27!=t.keyCode||(i(4,p=!1),gamemap.mapRoot.focus()))},y,v,function(e){bubble.call(this,t,e)},t=>g(t,null),t=>g(t,!0),function(t){binding_callbacks[t?"unshift":"push"]((()=>{a=t,i(3,a)}))},function(){r=this.value,i(0,r)},()=>f(a.value,c),()=>a.focus(),()=>{setPrefs("expandsearchoptions",!getPrefs("expandsearchoptions")),i(8,u=getPrefs("expandsearchoptions"))},t=>{i(6,c=t.detail),f(r,c)},t=>{setPrefs("pinsearch",t.detail),i(7,h=getPrefs("pinsearch"))},t=>{v(t.detail)},t=>{window.open(`${location.origin}${location.pathname}?${t.detail>0?`world=${t.detail}`:`centeron=${Math.abs(t.detail)}`}`)}]}class SearchPane extends SvelteComponent{constructor(t){super(),init(this,t,instance$g,create_fragment$h,safe_not_equal,{lock:1,searchQuery:0,updateSearch:2},null,[-1,-1])}get lock(){return this.$$.ctx[1]}set lock(t){this.$$set({lock:t}),flush()}get searchQuery(){return this.$$.ctx[0]}set searchQuery(t){this.$$set({searchQuery:t}),flush()}get updateSearch(){return this.$$.ctx[2]}}const ALIGNMENT={AUTO:"auto",START:"start",CENTER:"center",END:"end"},DIRECTION={HORIZONTAL:"horizontal",VERTICAL:"vertical"},SCROLL_CHANGE_REASON={OBSERVED:0,REQUESTED:1},SCROLL_PROP={[DIRECTION.VERTICAL]:"top",[DIRECTION.HORIZONTAL]:"left"},SCROLL_PROP_LEGACY={[DIRECTION.VERTICAL]:"scrollTop",[DIRECTION.HORIZONTAL]:"scrollLeft"};class SizeAndPositionManager{constructor({itemSize:t,itemCount:e,estimatedItemSize:i}){this.itemSize=t,this.itemCount=e,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return"function"==typeof this.itemSize}updateConfig({itemSize:t,itemCount:e,estimatedItemSize:i}){null!=e&&(this.itemCount=e),null!=i&&(this.estimatedItemSize=i),null!=t&&(this.itemSize=t),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&null!=this.totalSize?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(t){const{itemSize:e}=this;return"function"==typeof e?e(t):Array.isArray(e)?e[t]:e}computeTotalSizeAndPositionData(){let t=0;for(let e=0;e<this.itemCount;e++){const i=this.getSize(e),n=t;t+=i,this.itemSizeAndPositionData[e]={offset:n,size:i}}this.totalSize=t}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(t){if(t<0||t>=this.itemCount)throw Error(`Requested index ${t} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(t):this.itemSizeAndPositionData[t]}getJustInTimeSizeAndPositionForIndex(t){if(t>this.lastMeasuredIndex){const e=this.getSizeAndPositionOfLastMeasuredItem();let i=e.offset+e.size;for(let e=this.lastMeasuredIndex+1;e<=t;e++){const t=this.getSize(e);if(null==t||isNaN(t))throw Error(`Invalid size returned for index ${e} of value ${t}`);this.itemSizeAndPositionData[e]={offset:i,size:t},i+=t}this.lastMeasuredIndex=t}return this.itemSizeAndPositionData[t]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const t=this.getSizeAndPositionOfLastMeasuredItem();return t.offset+t.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:t=ALIGNMENT.START,containerSize:e,currentOffset:i,targetIndex:n}){if(e<=0)return 0;const o=this.getSizeAndPositionForIndex(n),s=o.offset,r=s-e+o.size;let a;switch(t){case ALIGNMENT.END:a=r;break;case ALIGNMENT.CENTER:a=s-(e-o.size)/2;break;case ALIGNMENT.START:a=s;break;default:a=Math.max(r,Math.min(s,i))}const l=this.getTotalSize();return Math.max(0,Math.min(l-e,a))}getVisibleRange({containerSize:t=0,offset:e,overscanCount:i}){if(0===this.getTotalSize())return{};const n=e+t;let o=this.findNearestItem(e);if(void 0===o)throw Error(`Invalid offset ${e} specified`);const s=this.getSizeAndPositionForIndex(o);e=s.offset+s.size;let r=o;for(;e<n&&r<this.itemCount-1;)r++,e+=this.getSizeAndPositionForIndex(r).size;return i&&(o=Math.max(0,o-i),r=Math.min(r+i,this.itemCount-1)),{start:o,stop:r}}resetItem(t){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,t-1)}findNearestItem(t){if(isNaN(t))throw Error(`Invalid offset ${t} specified`);t=Math.max(0,t);const e=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return e.offset>=t?this.binarySearch({high:i,low:0,offset:t}):this.exponentialSearch({index:i,offset:t})}binarySearch({low:t,high:e,offset:i}){let n=0,o=0;for(;t<=e;){if(n=t+Math.floor((e-t)/2),o=this.getSizeAndPositionForIndex(n).offset,o===i)return n;o<i?t=n+1:o>i&&(e=n-1)}return t>0?t-1:0}exponentialSearch({index:t,offset:e}){let i=1;for(;t<this.itemCount&&this.getSizeAndPositionForIndex(t).offset<e;)t+=i,i*=2;return this.binarySearch({high:Math.min(t,this.itemCount-1),low:Math.floor(t/2),offset:e})}}const get_footer_slot_changes=t=>({}),get_footer_slot_context=t=>({});function get_each_context$5(t,e,i){const n=t.slice();return n[37]=e[i],n}const get_item_slot_changes=t=>({style:4&t[0],index:4&t[0]}),get_item_slot_context=t=>({style:t[37].style,index:t[37].index}),get_header_slot_changes=t=>({}),get_header_slot_context=t=>({});function create_each_block$5(t,e){let i,n;const o=e[21].item,s=create_slot(o,e,e[20],get_item_slot_context);return{key:t,first:null,c(){i=empty(),s&&s.c(),this.first=i},m(t,e){insert(t,i,e),s&&s.m(t,e),n=!0},p(t,i){e=t,s&&s.p&&(!n||1048580&i[0])&&update_slot_base(s,o,e,e[20],n?get_slot_changes(o,e[20],i,get_item_slot_changes):get_all_dirty_from_scope(e[20]),get_item_slot_context)},i(t){n||(transition_in(s,t),n=!0)},o(t){transition_out(s,t),n=!1},d(t){t&&detach(i),s&&s.d(t)}}}function create_fragment$g(t){let e,i,n,o,s,r=[],a=new Map;const l=t[21].header,c=create_slot(l,t,t[20],get_header_slot_context);let h=t[2];const u=t=>t[0]?t[0](t[37].index):t[37].index;for(let e=0;e<h.length;e+=1){let i=get_each_context$5(t,h,e),n=u(i);a.set(n,r[e]=create_each_block$5(n,i))}const d=t[21].footer,p=create_slot(d,t,t[20],get_footer_slot_context);return{c(){e=element("div"),c&&c.c(),i=space(),n=element("div");for(let t=0;t<r.length;t+=1)r[t].c();o=space(),p&&p.c(),attr(n,"class","virtual-list-inner svelte-dwpad5"),attr(n,"style",t[4]),attr(e,"class","virtual-list-wrapper svelte-dwpad5"),attr(e,"style",t[3])},m(a,l){insert(a,e,l),c&&c.m(e,null),append(e,i),append(e,n);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(n,null);append(e,o),p&&p.m(e,null),t[22](e),s=!0},p(t,i){c&&c.p&&(!s||1048576&i[0])&&update_slot_base(c,l,t,t[20],s?get_slot_changes(l,t[20],i,get_header_slot_changes):get_all_dirty_from_scope(t[20]),get_header_slot_context),1048581&i[0]&&(h=t[2],group_outros(),r=update_keyed_each(r,i,u,1,t,h,a,n,outro_and_destroy_block,create_each_block$5,null,get_each_context$5),check_outros()),(!s||16&i[0])&&attr(n,"style",t[4]),p&&p.p&&(!s||1048576&i[0])&&update_slot_base(p,d,t,t[20],s?get_slot_changes(d,t[20],i,get_footer_slot_changes):get_all_dirty_from_scope(t[20]),get_footer_slot_context),(!s||8&i[0])&&attr(e,"style",t[3])},i(t){if(!s){transition_in(c,t);for(let t=0;t<h.length;t+=1)transition_in(r[t]);transition_in(p,t),s=!0}},o(t){transition_out(c,t);for(let t=0;t<r.length;t+=1)transition_out(r[t]);transition_out(p,t),s=!1},d(i){i&&detach(e),c&&c.d(i);for(let t=0;t<r.length;t+=1)r[t].d();p&&p.d(i),t[22](null)}}}const thirdEventArg=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get:()=>(t={passive:!0},!0)});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch(t){}return t})();function instance$f(t,e,i){let{$$slots:n={},$$scope:o}=e,{height:s}=e,{width:r="100%"}=e,{itemCount:a}=e,{itemSize:l}=e,{estimatedItemSize:c=null}=e,{stickyIndices:h=null}=e,{getKey:u=null}=e,{scrollDirection:d=DIRECTION.VERTICAL}=e,{scrollOffset:p=null}=e,{scrollToIndex:_=null}=e,{scrollToAlignment:m=null}=e,{scrollToBehaviour:f="instant"}=e,{overscanCount:g=3}=e;const y=createEventDispatcher(),v=new SizeAndPositionManager({itemCount:a,itemSize:l,estimatedItemSize:I()});let b,k=!1,w=[],L={offset:p||null!=_&&w.length&&O(_)||0,scrollChangeReason:SCROLL_CHANGE_REASON.REQUESTED},x=L,$={scrollToIndex:_,scrollToAlignment:m,scrollOffset:p,itemCount:a,itemSize:l,estimatedItemSize:c},C={},M="",E="";function T(){const{offset:t}=L,{start:e,stop:n}=v.getVisibleRange({containerSize:d===DIRECTION.VERTICAL?s:r,offset:t,overscanCount:g});let o=[];const a=v.getTotalSize();if(d===DIRECTION.VERTICAL){i(3,M=`height:${s}${"number"==typeof s?"px":""};width:${r};`),i(4,E=`flex-direction:column;height:${a}px;`)}else{i(3,M=`height:${s};width:${r}${"number"==typeof r?"px":""}`),i(4,E=`min-height:100%;width:${a}px;`)}const l=null!=h&&0!==h.length;if(l)for(let t=0;t<h.length;t++){const e=h[t];o.push({index:e,style:B(e,!0)})}if(void 0!==e&&void 0!==n){for(let t=e;t<=n;t++)l&&h.includes(t)||o.push({index:t,style:B(t,!1)});y("itemsUpdated",{start:e,end:n})}i(2,w=o)}function P(t){"scroll"in b?b.scroll({[SCROLL_PROP[d]]:t,behavior:f}):i(1,b[SCROLL_PROP_LEGACY[d]]=t,b)}function S(t=0){C={},v.resetItem(t),T()}function O(t,e=m,i=a){return(t<0||t>=i)&&(t=0),v.getUpdatedOffsetForIndex({align:e,containerSize:d===DIRECTION.VERTICAL?s:r,currentOffset:L.offset||0,targetIndex:t})}function D(t){const e=b[SCROLL_PROP_LEGACY[d]];e<0||L.offset===e||t.target!==b||(i(19,L={offset:e,scrollChangeReason:SCROLL_CHANGE_REASON.OBSERVED}),y("afterScroll",{offset:e,event:t}))}function I(){return c||"number"==typeof l&&l||50}function B(t,e){if(C[t])return C[t];const{size:i,offset:n}=v.getSizeAndPositionForIndex(t);let o;return d===DIRECTION.VERTICAL?(o=`left:0;width:100%;height:${i}px;`,o+=e?`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${n}px;margin-bottom:${-(n+i)}px;`:`position:absolute;top:${n}px;`):(o=`top:0;width:${i}px;`,o+=e?`position:sticky;z-index:1;left:0;margin-left:${n}px;margin-right:${-(n+i)}px;`:`position:absolute;height:100%;left:${n}px;`),C[t]=o}return T(),onMount((()=>{i(18,k=!0),b.addEventListener("scroll",D,thirdEventArg),null!=p?P(p):null!=_&&P(O(_))})),onDestroy((()=>{k&&b.removeEventListener("scroll",D)})),t.$$set=t=>{"height"in t&&i(5,s=t.height),"width"in t&&i(6,r=t.width),"itemCount"in t&&i(7,a=t.itemCount),"itemSize"in t&&i(8,l=t.itemSize),"estimatedItemSize"in t&&i(9,c=t.estimatedItemSize),"stickyIndices"in t&&i(10,h=t.stickyIndices),"getKey"in t&&i(0,u=t.getKey),"scrollDirection"in t&&i(11,d=t.scrollDirection),"scrollOffset"in t&&i(12,p=t.scrollOffset),"scrollToIndex"in t&&i(13,_=t.scrollToIndex),"scrollToAlignment"in t&&i(14,m=t.scrollToAlignment),"scrollToBehaviour"in t&&i(15,f=t.scrollToBehaviour),"overscanCount"in t&&i(16,g=t.overscanCount),"$$scope"in t&&i(20,o=t.$$scope)},t.$$.update=()=>{29568&t.$$.dirty[0]&&function(){if(!k)return;const t=$.scrollToIndex!==_||$.scrollToAlignment!==m,e=$.itemCount!==a||$.itemSize!==l||$.estimatedItemSize!==c;e&&(v.updateConfig({itemSize:l,itemCount:a,estimatedItemSize:I()}),S()),$.scrollOffset!==p?i(19,L={offset:p||0,scrollChangeReason:SCROLL_CHANGE_REASON.REQUESTED}):"number"==typeof _&&(t||e)&&i(19,L={offset:O(_,m,a),scrollChangeReason:SCROLL_CHANGE_REASON.REQUESTED}),$={scrollToIndex:_,scrollToAlignment:m,scrollOffset:p,itemCount:a,itemSize:l,estimatedItemSize:c}}(),524288&t.$$.dirty[0]&&function(){if(!k)return;const{offset:t,scrollChangeReason:e}=L;x.offset===t&&x.scrollChangeReason===e||T(),x.offset!==t&&e===SCROLL_CHANGE_REASON.REQUESTED&&P(t),x=L}(),263264&t.$$.dirty[0]&&k&&S(0)},[u,b,w,M,E,s,r,a,l,c,h,d,p,_,m,f,g,S,k,L,o,n,function(t){binding_callbacks[t?"unshift":"push"]((()=>{b=t,i(1,b)}))}]}class VirtualList extends SvelteComponent{constructor(t){super(),init(this,t,instance$f,create_fragment$g,safe_not_equal,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(t){this.$$set({height:t}),flush()}get width(){return this.$$.ctx[6]}set width(t){this.$$set({width:t}),flush()}get itemCount(){return this.$$.ctx[7]}set itemCount(t){this.$$set({itemCount:t}),flush()}get itemSize(){return this.$$.ctx[8]}set itemSize(t){this.$$set({itemSize:t}),flush()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(t){this.$$set({estimatedItemSize:t}),flush()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(t){this.$$set({stickyIndices:t}),flush()}get getKey(){return this.$$.ctx[0]}set getKey(t){this.$$set({getKey:t}),flush()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(t){this.$$set({scrollDirection:t}),flush()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(t){this.$$set({scrollOffset:t}),flush()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(t){this.$$set({scrollToIndex:t}),flush()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(t){this.$$set({scrollToAlignment:t}),flush()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(t){this.$$set({scrollToBehaviour:t}),flush()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(t){this.$$set({overscanCount:t}),flush()}get recomputeSizes(){return this.$$.ctx[17]}}function get_if_ctx$1(t){const e=t.slice(),i=e[1].id;e[10]=i;const n=gamemap.getWorldByID(e[10]).displayName;return e[11]=n,e}function get_each_context$4(t,e,i){const n=t.slice();n[9]=e[i],n[13]=i;const o=n[9].id;n[10]=o;const s=gamemap.getWorldByID(n[10]).displayName;return n[11]=s,n}function create_if_block_2$6(t){let e,i,n,o,s,r,a,l,c=t[0]&&create_if_block_3$6(t);return{c(){e=element("div"),i=element("div"),n=text(t[2]),o=element("i"),o.textContent="expand_more",s=space(),c&&c.c(),attr(o,"class","material-icons svelte-jmp7xr"),attr(i,"class","collapsible-header waves-effect svelte-jmp7xr"),toggle_class(i,"expanded",t[0]),attr(e,"class","collapsible svelte-jmp7xr")},m(h,u){insert(h,e,u),append(e,i),append(i,n),append(i,o),append(e,s),c&&c.m(e,null),r=!0,a||(l=listen(i,"click",t[6]),a=!0)},p(t,o){(!r||4&o)&&set_data(n,t[2]),(!r||1&o)&&toggle_class(i,"expanded",t[0]),t[0]?c?(c.p(t,o),1&o&&transition_in(c,1)):(c=create_if_block_3$6(t),c.c(),transition_in(c,1),c.m(e,null)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros())},i(t){r||(transition_in(c),r=!0)},o(t){transition_out(c),r=!1},d(t){t&&detach(e),c&&c.d(),a=!1,l()}}}function create_if_block$a(t){let e,i,n=t[1],o=[];for(let e=0;e<n.length;e+=1)o[e]=create_each_block$4(get_each_context$4(t,n,e));const s=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=empty()},m(t,n){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,n);insert(t,e,n),i=!0},p(t,i){if(2&i){let r;for(n=t[1],r=0;r<n.length;r+=1){const s=get_each_context$4(t,n,r);o[r]?(o[r].p(s,i),transition_in(o[r],1)):(o[r]=create_each_block$4(s),o[r].c(),transition_in(o[r],1),o[r].m(e.parentNode,e))}for(group_outros(),r=n.length;r<o.length;r+=1)s(r);check_outros()}},i(t){if(!i){for(let t=0;t<n.length;t+=1)transition_in(o[t]);i=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);i=!1},d(t){destroy_each(o,t),t&&detach(e)}}}function create_if_block_3$6(t){let e,i,n,o,s,r,a=t[1].id>0&&create_if_block_4$2(get_if_ctx$1(t));return n=new LocationCollapsible({props:{data:t[1].children}}),{c(){e=element("div"),a&&a.c(),i=space(),create_component(n.$$.fragment),attr(e,"class","collapsible-body svelte-jmp7xr")},m(t,o){insert(t,e,o),a&&a.m(e,null),append(e,i),mount_component(n,e,null),r=!0},p(t,o){t[1].id>0?a?(a.p(get_if_ctx$1(t),o),2&o&&transition_in(a,1)):(a=create_if_block_4$2(get_if_ctx$1(t)),a.c(),transition_in(a,1),a.m(e,i)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros());const s={};2&o&&(s.data=t[1].children),n.$set(s)},i(t){r||(transition_in(a),transition_in(n.$$.fragment,t),t&&add_render_callback((()=>{r&&(s&&s.end(1),o=create_in_transition(e,slide,{}),o.start())})),r=!0)},o(t){transition_out(a),transition_out(n.$$.fragment,t),o&&o.invalidate(),t&&(s=create_out_transition(e,slide,{})),r=!1},d(t){t&&detach(e),a&&a.d(),destroy_component(n),t&&s&&s.end()}}}function create_if_block_4$2(t){let e,i;return e=new ListItem({props:{title:t[11],selected:gamemap.getCurrentWorld().displayName==t[11]}}),e.$on("click",(function(){return t[7](t[10])})),e.$on("middleClick",(function(){return t[8](t[10])})),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(i,n){t=i;const o={};2&n&&(o.title=t[11]),2&n&&(o.selected=gamemap.getCurrentWorld().displayName==t[11]),e.$set(o)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_else_block$4(t){let e,i;return e=new ListItem({props:{title:t[11],selected:gamemap.getCurrentWorld().displayName==t[11]}}),e.$on("click",(function(){return t[4](t[10])})),e.$on("middleClick",(function(){return t[5](t[10])})),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(i,n){t=i;const o={};2&n&&(o.title=t[11]),2&n&&(o.selected=gamemap.getCurrentWorld().displayName==t[11]),e.$set(o)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$6(t){let e,i;return e=new LocationCollapsible({props:{data:t[1][t[13]],title:t[11]}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};2&i&&(n.data=t[1][t[13]]),2&i&&(n.title=t[11]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_each_block$4(t){let e,i,n,o;const s=[create_if_block_1$6,create_else_block$4],r=[];function a(t,e){return t[9].children?0:1}return e=a(t),i=r[e]=s[e](t),{c(){i.c(),n=empty()},m(t,i){r[e].m(t,i),insert(t,n,i),o=!0},p(t,o){let l=e;e=a(t),e===l?r[e].p(t,o):(group_outros(),transition_out(r[l],1,1,(()=>{r[l]=null})),check_outros(),i=r[e],i?i.p(t,o):(i=r[e]=s[e](t),i.c()),transition_in(i,1),i.m(n.parentNode,n))},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){r[e].d(t),t&&detach(n)}}}function create_fragment$f(t){let e,i,n,o;const s=[create_if_block$a,create_if_block_2$6],r=[];function a(t,e){return t[3]?0:t[2]?1:-1}return~(e=a(t))&&(i=r[e]=s[e](t)),{c(){i&&i.c(),n=empty()},m(t,i){~e&&r[e].m(t,i),insert(t,n,i),o=!0},p(t,[o]){let l=e;e=a(t),e===l?~e&&r[e].p(t,o):(i&&(group_outros(),transition_out(r[l],1,1,(()=>{r[l]=null})),check_outros()),~e?(i=r[e],i?i.p(t,o):(i=r[e]=s[e](t),i.c()),transition_in(i,1),i.m(n.parentNode,n)):i=null)},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){~e&&r[e].d(t),t&&detach(n)}}}function instance$e(t,e,i){let{data:n}=e,{expanded:o=!1}=e,{title:s}=e,r=Array.isArray(n);return t.$$set=t=>{"data"in t&&i(1,n=t.data),"expanded"in t&&i(0,o=t.expanded),"title"in t&&i(2,s=t.title)},[o,n,s,r,t=>gamemap.goto(t),t=>window.open(`${location.origin}${location.pathname}?world=${t}`),()=>i(0,o=!o),t=>gamemap.goto(t),t=>window.open(`${location.origin}${location.pathname}?world=${t}`)]}class LocationCollapsible extends SvelteComponent{constructor(t){super(),init(this,t,instance$e,create_fragment$f,safe_not_equal,{data:1,expanded:0,title:2})}get data(){return this.$$.ctx[1]}set data(t){this.$$set({data:t}),flush()}get expanded(){return this.$$.ctx[0]}set expanded(t){this.$$set({expanded:t}),flush()}get title(){return this.$$.ctx[2]}set title(t){this.$$set({title:t}),flush()}}const{window:window_1$3}=globals;function get_context$1(t){const e=gamemap.getWorldFromDisplayName(t[7][t[30]]);t[31]=e}function get_each_context$3(t,e,i){const n=t.slice();n[32]=e[i],n[36]=i;const o=n[32].id;n[33]=o;const s=n[33]<0?-1==n[33]?"Orphaned Maps":"Beta Maps":gamemap.getWorldDisplayNameFromID(n[33]);return n[34]=s,n}function create_if_block$9(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f=t[9]?"ABC":"Worlds",g=t[9]&&create_if_block_3$5(t),y=0==t[2]&&create_if_block_2$5(t),v=1==t[2]&&t[4]&&create_if_block_1$5(t);return{c(){e=element("div"),i=element("ul"),g&&g.c(),n=space(),o=element("li"),s=element("a"),r=text(f),a=space(),l=element("div"),y&&y.c(),c=space(),v&&v.c(),attr(s,"href","#tab_alphabetical"),attr(s,"class","svelte-lezg6c"),toggle_class(s,"active",1==t[2]),attr(o,"id","abc_tab"),attr(o,"class","tab svelte-lezg6c"),attr(i,"id","location_list_tab_bar"),attr(i,"class","tabs svelte-lezg6c"),toggle_class(i,"singleTab",!t[9]),attr(l,"id","location_list_content"),attr(l,"class","svelte-lezg6c"),add_render_callback((()=>t[22].call(l))),attr(e,"id","location_list"),attr(e,"class","svelte-lezg6c")},m(u,d){insert(u,e,d),append(e,i),g&&g.m(i,null),append(i,n),append(i,o),append(o,s),append(s,r),t[19](i),append(e,a),append(e,l),y&&y.m(l,null),append(l,c),v&&v.m(l,null),h=add_iframe_resize_listener(l,t[22].bind(l)),t[23](e),p=!0,_||(m=[listen(o,"click",t[18]),listen(e,"contextmenu",contextmenu_handler$1)],_=!0)},p(e,o){(t=e)[9]?g?g.p(t,o):(g=create_if_block_3$5(t),g.c(),g.m(i,n)):g&&(g.d(1),g=null),(!p||512&o[0])&&f!==(f=t[9]?"ABC":"Worlds")&&set_data(r,f),(!p||4&o[0])&&toggle_class(s,"active",1==t[2]),(!p||512&o[0])&&toggle_class(i,"singleTab",!t[9]),0==t[2]?y?(y.p(t,o),4&o[0]&&transition_in(y,1)):(y=create_if_block_2$5(t),y.c(),transition_in(y,1),y.m(l,c)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros()),1==t[2]&&t[4]?v?(v.p(t,o),20&o[0]&&transition_in(v,1)):(v=create_if_block_1$5(t),v.c(),transition_in(v,1),v.m(l,null)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros())},i(i){p||(transition_in(y),transition_in(v),add_render_callback((()=>{p&&(d&&d.end(1),u=create_in_transition(e,fly,t[6]?{x:15,duration:150}:{y:-15,duration:200}),u.start())})),p=!0)},o(i){transition_out(y),transition_out(v),u&&u.invalidate(),d=create_out_transition(e,fly,t[6]?{x:5,duration:150}:{y:-5,duration:150}),p=!1},d(i){i&&detach(e),g&&g.d(),t[19](null),y&&y.d(),v&&v.d(),h(),t[23](null),i&&d&&d.end(),_=!1,run_all(m)}}}function create_if_block_3$5(t){let e,i,n,o;return{c(){e=element("li"),i=element("a"),i.textContent="Grouped",attr(i,"href","#tab_categories"),attr(i,"class","svelte-lezg6c"),toggle_class(i,"active",0==t[2]),attr(e,"id","group_tab"),attr(e,"class","tab svelte-lezg6c")},m(s,r){insert(s,e,r),append(e,i),n||(o=listen(e,"click",t[17]),n=!0)},p(t,e){4&e[0]&&toggle_class(i,"active",0==t[2])},d(t){t&&detach(e),n=!1,o()}}}function create_if_block_2$5(t){let e,i,n=t[8],o=[];for(let e=0;e<n.length;e+=1)o[e]=create_each_block$3(get_each_context$3(t,n,e));const s=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){e=element("div");for(let t=0;t<o.length;t+=1)o[t].c();attr(e,"id","tab_categories"),attr(e,"class","tab-pane")},m(t,n){insert(t,e,n);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null);i=!0},p(t,i){if(256&i[0]){let r;for(n=t[8],r=0;r<n.length;r+=1){const s=get_each_context$3(t,n,r);o[r]?(o[r].p(s,i),transition_in(o[r],1)):(o[r]=create_each_block$3(s),o[r].c(),transition_in(o[r],1),o[r].m(e,null))}for(group_outros(),r=n.length;r<o.length;r+=1)s(r);check_outros()}},i(t){if(!i){for(let t=0;t<n.length;t+=1)transition_in(o[t]);i=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);i=!1},d(t){t&&detach(e),destroy_each(o,t)}}}function create_each_block$3(t){let e,i;return e=new LocationCollapsible({props:{data:t[32],expanded:0==t[36],title:t[34]}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};256&i[0]&&(n.data=t[32]),256&i[0]&&(n.title=t[34]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_1$5(t){let e,i,n;return i=new VirtualList({props:{height:t[4],itemCount:t[7].length,itemSize:42,scrollToIndex:t[7].indexOf(gamemap.getCurrentWorld().displayName),scrollToAlignment:"center",$$slots:{item:[create_item_slot$1,({style:t,index:e})=>({29:t,30:e}),({style:t,index:e})=>[(t?536870912:0)|(e?1073741824:0)]]},$$scope:{ctx:t}}}),{c(){e=element("div"),create_component(i.$$.fragment),attr(e,"id","tab_alphabetical"),attr(e,"class","tab-pane")},m(t,o){insert(t,e,o),mount_component(i,e,null),n=!0},p(t,e){const n={};16&e[0]&&(n.height=t[4]),128&e[0]&&(n.itemCount=t[7].length),128&e[0]&&(n.scrollToIndex=t[7].indexOf(gamemap.getCurrentWorld().displayName)),1610612864&e[0]|64&e[1]&&(n.$$scope={dirty:e,ctx:t}),i.$set(n)},i(t){n||(transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(i.$$.fragment,t),n=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_item_slot$1(t){let e,i,n,o;return get_context$1(t),i=new ListItem({props:{title:t[31].displayName,destinationID:t[31].id,selected:gamemap.getCurrentWorld().displayName==t[7][t[30]]}}),i.$on("click",t[20]),i.$on("middleClick",t[21]),{c(){e=element("div"),create_component(i.$$.fragment),attr(e,"slot","item"),attr(e,"style",n=t[29])},m(t,n){insert(t,e,n),mount_component(i,e,null),o=!0},p(t,s){get_context$1(t);const r={};1073741952&s[0]&&(r.title=t[31].displayName),1073741952&s[0]&&(r.destinationID=t[31].id),1073741952&s[0]&&(r.selected=gamemap.getCurrentWorld().displayName==t[7][t[30]]),i.$set(r),(!o||536870912&s[0]&&n!==(n=t[29]))&&attr(e,"style",n)},i(t){o||(transition_in(i.$$.fragment,t),o=!0)},o(t){transition_out(i.$$.fragment,t),o=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_fragment$e(t){let e,i,n,o,s=t[0]&&create_if_block$9(t);return{c(){s&&s.c(),e=empty()},m(r,a){s&&s.m(r,a),insert(r,e,a),i=!0,n||(o=[listen(window_1$3,"mousedown",t[16]),listen(window_1$3,"resize",t[10]),listen(window_1$3,"keydown",t[13])],n=!0)},p(t,i){t[0]?s?(s.p(t,i),1&i[0]&&transition_in(s,1)):(s=create_if_block$9(t),s.c(),transition_in(s,1),s.m(e.parentNode,e)):s&&(group_outros(),transition_out(s,1,1,(()=>{s=null})),check_outros())},i(t){i||(transition_in(s),i=!0)},o(t){transition_out(s),i=!1},d(t){s&&s.d(t),t&&detach(e),n=!1,run_all(o)}}}const contextmenu_handler$1=t=>t.stopPropagation();function instance$d(t,e,i){let n,o,{isShown:s=!1}=e,r=0,a=null,l=null,c=isMobile||window.innerWidth<=670,h=gamemap.getWorlds(),u=[],d=[],p=[],_=!0;const m=createEventDispatcher();function f(t){i(0,s=t),m("toggled",s),s&&setTimeout((()=>{b(r),M.Tabs.init(o,{}),gamemap.hasMultipleWorlds()&&y()}))}function g(t,e,i,n){for(var o in e)if(e.hasOwnProperty(o))if("object"==typeof e[o])g(t,e[o],i+"."+o,n);else if(null!=t[e[o]])g(t,t[e[o]],i+"."+e[o],n);else{let t=(i+"."+e[o]).split(".");if(t.shift(),t[0]==n)for(let e=0;e<t.length;e++){let i;i=0==e?{id:t[e],parentID:null}:{id:t[e],parentID:t[e-1]},p.push(i)}}}function y(){if(l=document.querySelector("#dropdown_icon")?.parentElement,i(6,c=isMobile||window.innerWidth<=670),!c&&a&&l){let t=l.getBoundingClientRect().left+l.clientWidth/2;i(3,a.style.left=t+"px",a),i(3,a.style.top=a.offsetHeight/2+l.offsetHeight+16+"px",a)}}function v(t){let e=null!=t.relatedTarget?t.relatedTarget:null!=t.explicitOriginalTarget?t.explicitOriginalTarget:document.elementsFromPoint(t.clientX,t.clientY)[0];!(a!==e&&a?.contains(e))&&!l?.contains(e)&&k()}function b(t){i(2,r=_?t:1)}function k(){f(!1)}window.getWorldLists=function(){let t={};let e=gamemap.getMapConfig().rootWorldID||gamemap.getMapConfig().defaultWorldID,n=[e,-1];if("eso"==gamemap.getMapConfig().database&&n.push(-1337),i(7,u=[]),i(8,d=[]),p=[],h.forEach((t=>{"_"!=t.displayName&&t.id>0&&u.push(t.displayName)})),i(7,u=u.sort((function(t,e){return t=t.replace("The ",""),e=e.replace("The ",""),t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))),i(9,_=u.length>5),_){for(let i=0;i<u.length;i++){let n=u[i],o=gamemap.getWorldFromDisplayName(n);if(null!=o&&0!=o.id&&!n.endsWith("(Test)")){let i=o.id,s=o.parentID;s<=0&&(s=0,i!=e&&(s=-1)),(n.endsWith("(Dev)")||n.endsWith("(Beta)"))&&(s=-1337),null!=t[s]?t[s].push(i):t[s]=[i]}}for(let e in n){p=[],g(t,t,"",n[e]),p=getUniqueListFrom(p,"id");const i=p.reduce(((t,e,i)=>(t[e.id]=i,t)),{});let o=t;p.forEach((t=>{if(null===t.parentID)return void(o=t);const e=p[i[t.parentID]];e.children=[...e.children||[],t]})),d.push(o)}}b(r)},onMount((()=>{getWorldLists()}));return t.$$set=t=>{"isShown"in t&&i(0,s=t.isShown)},[s,k,r,a,n,o,c,u,d,_,y,v,b,function(t){"Escape"!=t.key&&27!=t.keyCode||k()},f,function(){f(!s)},t=>v(t),()=>b(0),()=>b(1),function(t){binding_callbacks[t?"unshift":"push"]((()=>{o=t,i(5,o)}))},t=>{gamemap.goto(t.detail),k()},t=>window.open(`${location.origin}${location.pathname}?world=${t.detail}`),function(){n=this.clientHeight,i(4,n)},function(t){binding_callbacks[t?"unshift":"push"]((()=>{a=t,i(3,a)}))}]}class LocationList extends SvelteComponent{constructor(t){super(),init(this,t,instance$d,create_fragment$e,safe_not_equal,{isShown:0,show:14,toggle:15,dismiss:1},null,[-1,-1])}get isShown(){return this.$$.ctx[0]}set isShown(t){this.$$set({isShown:t}),flush()}get show(){return this.$$.ctx[14]}get toggle(){return this.$$.ctx[15]}get dismiss(){return this.$$.ctx[1]}}const{window:window_1$2}=globals,get_secondary_slot_changes=t=>({}),get_secondary_slot_context=t=>({}),get_primary_slot_changes=t=>({}),get_primary_slot_context=t=>({});function create_fragment$d(t){let e,i,n,o,s,r,a,l,c,h;const u=t[4].primary,d=create_slot(u,t,t[3],get_primary_slot_context),p=t[4].secondary,_=create_slot(p,t,t[3],get_secondary_slot_context);return{c(){e=element("div"),d&&d.c(),o=space(),s=element("div"),_&&_.c(),attr(e,"class","icon_bar_primary svelte-14ji8br"),attr(s,"class","icon_bar_secondary svelte-14ji8br")},m(i,n){insert(i,e,n),d&&d.m(e,null),t[5](e),insert(i,o,n),insert(i,s,n),_&&_.m(s,null),t[6](s),l=!0,c||(h=[listen(window_1$2,"resize",t[2]),listen(e,"contextmenu",contextmenu_handler),listen(s,"contextmenu",contextmenu_handler_1)],c=!0)},p(t,[e]){d&&d.p&&(!l||8&e)&&update_slot_base(d,u,t,t[3],l?get_slot_changes(u,t[3],e,get_primary_slot_changes):get_all_dirty_from_scope(t[3]),get_primary_slot_context),_&&_.p&&(!l||8&e)&&update_slot_base(_,p,t,t[3],l?get_slot_changes(p,t[3],e,get_secondary_slot_changes):get_all_dirty_from_scope(t[3]),get_secondary_slot_context)},i(t){l||(transition_in(d,t),add_render_callback((()=>{l&&(n&&n.end(1),i=create_in_transition(e,fly,{x:5,duration:250}),i.start())})),transition_in(_,t),add_render_callback((()=>{l&&(a&&a.end(1),r=create_in_transition(s,fly,{x:5,duration:250}),r.start())})),l=!0)},o(t){transition_out(d,t),i&&i.invalidate(),n=create_out_transition(e,fade,{duration:75}),transition_out(_,t),r&&r.invalidate(),a=create_out_transition(s,fade,{duration:75}),l=!1},d(i){i&&detach(e),d&&d.d(i),t[5](null),i&&n&&n.end(),i&&detach(o),i&&detach(s),_&&_.d(i),t[6](null),i&&a&&a.end(),c=!1,run_all(h)}}}const contextmenu_handler=t=>t.stopPropagation(),contextmenu_handler_1=t=>t.stopPropagation();function instance$c(t,e,i){let n,{$$slots:o={},$$scope:s}=e,r=null,a=null,l=null;function c(){n=window.innerWidth<=670,l=document.querySelector("#search_pane").clientWidth+4;let t=window.innerWidth;if(n?(a.style.removeProperty("left"),i(1,a.style.right="8px",a),i(1,a.style.top=r.clientHeight+8+"px",a)):(i(1,a.style.left=l+"px",a),a.style.removeProperty("right"),i(1,a.style.top="8px",a)),!n){let e=t-(l+(t-r.getBoundingClientRect().left)+19);i(1,a.style.width=e+"px",a)}}return onMount((async()=>{c()})),t.$$set=t=>{"$$scope"in t&&i(3,s=t.$$scope)},n=!1,[r,a,c,s,o,function(t){binding_callbacks[t?"unshift":"push"]((()=>{r=t,i(0,r)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{a=t,i(1,a)}))}]}class IconBar extends SvelteComponent{constructor(t){super(),init(this,t,instance$c,create_fragment$d,safe_not_equal,{})}}function create_if_block_1$4(t){let e,i,n,o;const s=[create_if_block_2$4,create_if_block_3$4],r=[];function a(t,e){return"loading"!=t[1]?0:"loading"==t[1]?1:-1}return~(e=a(t))&&(i=r[e]=s[e](t)),{c(){i&&i.c(),n=empty()},m(t,i){~e&&r[e].m(t,i),insert(t,n,i),o=!0},p(t,o){let l=e;e=a(t),e===l?~e&&r[e].p(t,o):(i&&(group_outros(),transition_out(r[l],1,1,(()=>{r[l]=null})),check_outros()),~e?(i=r[e],i?i.p(t,o):(i=r[e]=s[e](t),i.c()),transition_in(i,1),i.m(n.parentNode,n)):i=null)},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){~e&&r[e].d(t),t&&detach(n)}}}function create_if_block_3$4(t){let e,i,n;return i=new LoadingSpinner({props:{size:"36px"}}),{c(){e=element("div"),create_component(i.$$.fragment),attr(e,"class","spinner svelte-1kncten")},m(t,o){insert(t,e,o),mount_component(i,e,null),n=!0},p:noop,i(t){n||(transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(i.$$.fragment,t),n=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_if_block_2$4(t){let e,i,n;return{c(){e=element("i"),i=text(t[1]),attr(e,"class",n="material-icons "+t[2]+" svelte-1kncten")},m(t,n){insert(t,e,n),append(e,i)},p(t,o){2&o&&set_data(i,t[1]),4&o&&n!==(n="material-icons "+t[2]+" svelte-1kncten")&&attr(e,"class",n)},i:noop,o:noop,d(t){t&&detach(e)}}}function create_else_block$3(t){let e;const i=t[12].default,n=create_slot(i,t,t[11],null);return{c(){n&&n.c()},m(t,i){n&&n.m(t,i),e=!0},p(t,o){n&&n.p&&(!e||2048&o)&&update_slot_base(n,i,t,t[11],e?get_slot_changes(i,t[11],o,null):get_all_dirty_from_scope(t[11]),null)},i(t){e||(transition_in(n,t),e=!0)},o(t){transition_out(n,t),e=!1},d(t){n&&n.d(t)}}}function create_if_block$8(t){let e,i;return{c(){e=element("p"),i=text(t[3]),attr(e,"class","svelte-1kncten")},m(t,n){insert(t,e,n),append(e,i)},p(t,e){8&e&&set_data(i,t[3])},i:noop,o:noop,d(t){t&&detach(e)}}}function create_fragment$c(t){let e,i,n,o,s,r,a,l,c=t[1]&&create_if_block_1$4(t);const h=[create_if_block$8,create_else_block$3],u=[];function d(t,e){return t[3]?0:1}return n=d(t),o=u[n]=h[n](t),{c(){e=element("a"),c&&c.c(),i=space(),o.c(),attr(e,"class",s="waves-effect waves-"+t[9]+" button btn"+(t[4]?"-flat":"")+(t[5]?"-"+{size:t[5]}:"")+" svelte-1kncten"),attr(e,"title",t[8]),toggle_class(e,"disabled",t[0]),toggle_class(e,"error",t[6]&&"warning"==t[1]),toggle_class(e,"light","light"==t[4]),toggle_class(e,"loadingButton","loading"==t[1]),toggle_class(e,"deleteButton","delete"==t[6]),toggle_class(e,"saveButton","save"==t[6]),toggle_class(e,"revertButton","revert"==t[6]),toggle_class(e,"bold",t[7])},m(o,s){insert(o,e,s),c&&c.m(e,null),append(e,i),u[n].m(e,null),r=!0,a||(l=listen(e,"click",t[10]),a=!0)},p(t,[a]){t[1]?c?(c.p(t,a),2&a&&transition_in(c,1)):(c=create_if_block_1$4(t),c.c(),transition_in(c,1),c.m(e,i)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros());let l=n;n=d(t),n===l?u[n].p(t,a):(group_outros(),transition_out(u[l],1,1,(()=>{u[l]=null})),check_outros(),o=u[n],o?o.p(t,a):(o=u[n]=h[n](t),o.c()),transition_in(o,1),o.m(e,null)),(!r||560&a&&s!==(s="waves-effect waves-"+t[9]+" button btn"+(t[4]?"-flat":"")+(t[5]?"-"+{size:t[5]}:"")+" svelte-1kncten"))&&attr(e,"class",s),(!r||256&a)&&attr(e,"title",t[8]),(!r||561&a)&&toggle_class(e,"disabled",t[0]),(!r||626&a)&&toggle_class(e,"error",t[6]&&"warning"==t[1]),(!r||560&a)&&toggle_class(e,"light","light"==t[4]),(!r||562&a)&&toggle_class(e,"loadingButton","loading"==t[1]),(!r||624&a)&&toggle_class(e,"deleteButton","delete"==t[6]),(!r||624&a)&&toggle_class(e,"saveButton","save"==t[6]),(!r||624&a)&&toggle_class(e,"revertButton","revert"==t[6]),(!r||688&a)&&toggle_class(e,"bold",t[7])},i(t){r||(transition_in(c),transition_in(o),r=!0)},o(t){transition_out(c),transition_out(o),r=!1},d(t){t&&detach(e),c&&c.d(),u[n].d(),a=!1,l()}}}function instance$b(t,e,i){let{$$slots:n={},$$scope:o}=e,{icon:s}=e,{iconDirection:r="left"}=e,{text:a}=e,{flat:l}=e,{size:c}=e,{disabled:h}=e,{type:u}=e,{bold:d}=e,{tooltip:p}=e,{ripple:_="light"}=e;h="loading"==s||h;const m=createEventDispatcher();return t.$$set=t=>{"icon"in t&&i(1,s=t.icon),"iconDirection"in t&&i(2,r=t.iconDirection),"text"in t&&i(3,a=t.text),"flat"in t&&i(4,l=t.flat),"size"in t&&i(5,c=t.size),"disabled"in t&&i(0,h=t.disabled),"type"in t&&i(6,u=t.type),"bold"in t&&i(7,d=t.bold),"tooltip"in t&&i(8,p=t.tooltip),"ripple"in t&&i(9,_=t.ripple),"$$scope"in t&&i(11,o=t.$$scope)},[h,s,r,a,l,c,u,d,p,_,function(t){t.shiftKey?m("shiftClick","shift clicked"):m("click","clicked")},o,n]}class Button extends SvelteComponent{constructor(t){super(),init(this,t,instance$b,create_fragment$c,safe_not_equal,{icon:1,iconDirection:2,text:3,flat:4,size:5,disabled:0,type:6,bold:7,tooltip:8,ripple:9})}get icon(){return this.$$.ctx[1]}set icon(t){this.$$set({icon:t}),flush()}get iconDirection(){return this.$$.ctx[2]}set iconDirection(t){this.$$set({iconDirection:t}),flush()}get text(){return this.$$.ctx[3]}set text(t){this.$$set({text:t}),flush()}get flat(){return this.$$.ctx[4]}set flat(t){this.$$set({flat:t}),flush()}get size(){return this.$$.ctx[5]}set size(t){this.$$set({size:t}),flush()}get disabled(){return this.$$.ctx[0]}set disabled(t){this.$$set({disabled:t}),flush()}get type(){return this.$$.ctx[6]}set type(t){this.$$set({type:t}),flush()}get bold(){return this.$$.ctx[7]}set bold(t){this.$$set({bold:t}),flush()}get tooltip(){return this.$$.ctx[8]}set tooltip(t){this.$$set({tooltip:t}),flush()}get ripple(){return this.$$.ctx[9]}set ripple(t){this.$$set({ripple:t}),flush()}}function create_if_block$7(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_;const m=t[12].default,f=create_slot(m,t,t[16],null),g=f||fallback_block();l=new Button({props:{flat:!0,ripple:"dark",$$slots:{default:[create_default_slot_1$2]},$$scope:{ctx:t}}}),l.$on("click",t[13]);let y=t[4]&&create_if_block_1$3(t);return{c(){e=element("dialog"),i=element("div"),n=element("h4"),o=text(t[1]),s=space(),g&&g.c(),r=space(),a=element("div"),create_component(l.$$.fragment),c=space(),y&&y.c(),attr(i,"class","modal-content"),attr(a,"class","modal-footer svelte-iat1fa"),attr(e,"class","modal svelte-iat1fa"),toggle_class(e,"modal-fixed-footer",t[2])},m(h,u){insert(h,e,u),append(e,i),append(i,n),append(n,o),append(i,s),g&&g.m(i,null),append(e,r),append(e,a),mount_component(l,a,null),append(a,c),y&&y.m(a,null),t[15](e),d=!0,p||(_=listen(e,"keyup",t[8]),p=!0)},p(t,i){(!d||2&i)&&set_data(o,t[1]),f&&f.p&&(!d||65536&i)&&update_slot_base(f,m,t,t[16],d?get_slot_changes(m,t[16],i,null):get_all_dirty_from_scope(t[16]),null);const n={};65544&i&&(n.$$scope={dirty:i,ctx:t}),l.$set(n),t[4]?y?(y.p(t,i),16&i&&transition_in(y,1)):(y=create_if_block_1$3(t),y.c(),transition_in(y,1),y.m(a,null)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros()),(!d||4&i)&&toggle_class(e,"modal-fixed-footer",t[2])},i(t){d||(transition_in(g,t),transition_in(l.$$.fragment,t),transition_in(y),add_render_callback((()=>{d&&(u&&u.end(1),h=create_in_transition(e,scale,{}),h.start())})),d=!0)},o(t){transition_out(g,t),transition_out(l.$$.fragment,t),transition_out(y),h&&h.invalidate(),u=create_out_transition(e,scale,{duration:250,opacity:0}),d=!1},d(i){i&&detach(e),g&&g.d(i),destroy_component(l),y&&y.d(),t[15](null),i&&u&&u.end(),p=!1,_()}}}function fallback_block(t){let e;return{c(){e=element("p"),e.textContent="Loading..."},m(t,i){insert(t,e,i)},p:noop,d(t){t&&detach(e)}}}function create_default_slot_1$2(t){let e,i=t[3]?.toSentenceCase()+"";return{c(){e=text(i)},m(t,i){insert(t,e,i)},p(t,n){8&n&&i!==(i=t[3]?.toSentenceCase()+"")&&set_data(e,i)},d(t){t&&detach(e)}}}function create_if_block_1$3(t){let e,i;return e=new Button({props:{$$slots:{default:[create_default_slot$3]},$$scope:{ctx:t}}}),e.$on("click",t[14]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};65536&i&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_default_slot$3(t){let e;return{c(){e=text("Confirm")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_fragment$b(t){let e,i,n=t[0]&&create_if_block$7(t);return{c(){n&&n.c(),e=empty()},m(t,o){n&&n.m(t,o),insert(t,e,o),i=!0},p(t,[i]){t[0]?n?(n.p(t,i),1&i&&transition_in(n,1)):(n=create_if_block$7(t),n.c(),transition_in(n,1),n.m(e.parentNode,e)):n&&(group_outros(),transition_out(n,1,1,(()=>{n=null})),check_outros())},i(t){i||(transition_in(n),i=!0)},o(t){transition_out(n),i=!1},d(t){n&&n.d(t),t&&detach(e)}}}function instance$a(t,e,i){let n,o,{$$slots:s={},$$scope:r}=e,{title:a="Dialog title"}=e,{fixedFooter:l=!1}=e,{cancel:c="Cancel"}=e,{confirm:h}=e,{dismissible:u=!0}=e,{isShown:d=!1}=e;const p=createEventDispatcher();function _(t){i(0,d=!0),o=t,setTimeout((()=>{n?.showModal(),u&&n.addEventListener("click",(({target:t})=>{"DIALOG"===t.nodeName&&m()}))}),1)}function m(){i(0,d=!1),p("dismiss"),print("going away"),o&&o("dismiss")}function f(){i(0,d=!1),o&&o("confirm"),p("confirm")}return t.$$set=t=>{"title"in t&&i(1,a=t.title),"fixedFooter"in t&&i(2,l=t.fixedFooter),"cancel"in t&&i(3,c=t.cancel),"confirm"in t&&i(4,h=t.confirm),"dismissible"in t&&i(9,u=t.dismissible),"isShown"in t&&i(0,d=t.isShown),"$$scope"in t&&i(16,r=t.$$scope)},[d,a,l,c,h,m,n,f,function(t){"Escape"==t.key&&m()},u,_,function(t){_(t)},s,()=>m(),()=>f(),function(t){binding_callbacks[t?"unshift":"push"]((()=>{n=t,i(6,n)}))},r]}class Dialog extends SvelteComponent{constructor(t){super(),init(this,t,instance$a,create_fragment$b,safe_not_equal,{title:1,fixedFooter:2,cancel:3,confirm:4,dismissible:9,isShown:0,show:10,showWithCallback:11,dismiss:5})}get title(){return this.$$.ctx[1]}set title(t){this.$$set({title:t}),flush()}get fixedFooter(){return this.$$.ctx[2]}set fixedFooter(t){this.$$set({fixedFooter:t}),flush()}get cancel(){return this.$$.ctx[3]}set cancel(t){this.$$set({cancel:t}),flush()}get confirm(){return this.$$.ctx[4]}set confirm(t){this.$$set({confirm:t}),flush()}get dismissible(){return this.$$.ctx[9]}set dismissible(t){this.$$set({dismissible:t}),flush()}get isShown(){return this.$$.ctx[0]}set isShown(t){this.$$set({isShown:t}),flush()}get show(){return this.$$.ctx[10]}get showWithCallback(){return this.$$.ctx[11]}get dismiss(){return this.$$.ctx[5]}}class World{constructor(t){this.displayName=t?.displayName??"",this.name=t?.name?.toLowerCase()??"",this.description=t?.description??"",this.locations=null,this.id=t?.id??0,this.parentID=-1==t?.parentId?null:t?.parentId??null,this.revisionID=t?.revisionId??0,this.revertID=t?.revertId??null,this.wikiPage=t?.wikiPage&&""!=t.wikiPage?t.wikiPage:this.displayName,this.cellSize=t?.cellSize??-1,this.zoomOffset=MAPCONFIG.zoomOffset??t?.zoomOffset,this.defaultZoom=t?.defaultZoom-this.zoomOffset,this.maxZoomLevel=t?.maxZoom-this.zoomOffset,this.minZoomLevel=t?.minZoom-this.zoomOffset??0,this.minX=MAPCONFIG.minX??t.posLeft,this.maxX=MAPCONFIG.maxX??t.posRight,this.minY=MAPCONFIG.minY??t.posBottom,this.maxY=MAPCONFIG.maxY??t.posTop,this.maxRangeX=Math.abs(this.maxX-this.minX),this.maxRangeY=Math.abs(this.maxY-this.minY),this.numTilesX=Math.pow(2,this.maxZoomLevel),this.numTilesY=Math.pow(2,this.maxZoomLevel),this.dbNumTilesX=0!=t?.maxTilesX?t?.maxTilesX:this.numTilesX,this.dbNumTilesY=0!=t?.maxTilesY?t?.maxTilesY:this.numTilesY,this.width=(MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.dbNumTilesX:this.numTilesX*MAPCONFIG.tileSize)*Math.pow(2,0),this.height=(MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.dbNumTilesY:this.numTilesY*MAPCONFIG.tileSize)*Math.pow(2,0),this.legacy=t,this.displayData=t?.displayData?JSON.parse(t.displayData):null,this.layers=this.displayData?.layers??MAPCONFIG.layers,this.gridStart=this.displayData?.gridStart,this.editing=!1}hasGrid(){return this.displayData?.hasGrid&&this.displayData?.gridStart}hasCellResources(){return this.hasGrid()&&this.displayData?.hasCellResource}hasMultipleLayers(){return this.layers.length>1}hasLayerMenu(){return this.hasMultipleLayers()||this.hasGrid()}getWorldDimensions(){return{width:this.width,height:this.height,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY}}getSaveQuery(){var t="action=set_world";return t+="&worldid="+this.id,t+="&db="+MAPCONFIG.database,t+="&parentid="+encodeURI(this.parentID),t+="&revisionid="+this.revisionID,t+="&name="+encodeURI(this.name),t+="&displayname="+encodeURI(this.displayName),t+="&description="+encodeURI(this.description),t+="&wikipage="+encodeURI(this.linkWikiPage()?this.displayName:this.wikiPage),t+="&minzoom="+(+this.minZoomLevel+ +this.zoomOffset),t+="&maxzoom="+(+this.maxZoomLevel+ +this.zoomOffset),t+="&posleft="+this.minX,t+="&posright="+this.maxX,t+="&postop="+this.maxY,t+="&posbottom="+this.minY,t+="&zoomoffset="+this.zoomOffset}getDeleteQuery(){var t="action=enable_world";return t+="&worldid="+this.id,t+="&db="+MAPCONFIG.database,t+="&enabled=0"}getRevertQuery(){return encodeURI(`action=revert_world&db=${MAPCONFIG.db}&worldid=${this.id}&revertid=${this.revertID??this.revisionID}`)}setEditing(t){this.editing=t,gamemap.getElement().classList.add("editing")}linkWikiPage(){return this.wikiPage?.toLowerCase()==this.displayName?.toLowerCase()||null==this.wikiPage}getLocation(t){if(!isNaN(t)||t.id){let e=Math.abs(t?.id??t);if(this.locations?.has(e))return this.locations.get(e)}else{if(!("string"==typeof t||t instanceof String))return null;this.locations?.forEach((e=>{if(e.name.toLowerCase()==t)return e}))}}hasLocation(t){return null!=this.getLocation(t)}getWikiLink(){return`${MAPCONFIG.wikiURL}${MAPCONFIG.wikiNamespace}:${encodeURIComponent(this.wikiPage)}`}}class Location{constructor(t,e){this.locType=t?.locType??LOCTYPES.MARKER,this.id=t.id??-100,this.unsavedLocation=this.id<0,this.name=this.unsavedLocation?this.locType==LOCTYPES.MARKER?"New Marker":this.locType==LOCTYPES.AREA?"New Area":"New Path":t.name,this.revisionID=t.revisionId||0,this.worldID=e?.id??t?.worldId??gamemap.getCurrentWorld().id,this.destinationID=-t?.destinationId||null,this.editing=this.unsavedLocation??!1,this.revertID=t?.revertId,this.wasVisible=this.editing??null!=this.revertID??null,this.legacy=t,this.wikiPage=t?.wikiPage||this.name,this.description=t?.description||null,this.displayData=t?.displayData?JSON.parse(t.displayData):{},this.displayLevel=this.unsavedLocation?Number(Math.floor(gamemap.getCurrentZoom())):parseFloat(t.displayLevel-gamemap.getWorldFromID(this.worldID).zoomOffset||0),this.bounds=null,this.icon=this.unsavedLocation&&this.locType==LOCTYPES.MARKER?Math.min(...Array.from(MAPCONFIG.icons.keys())):t.iconType||null,this.width=this.icon?t.width||MAPCONFIG.iconSize:t.width,this.height=this.icon?t.height||MAPCONFIG.iconSize:t.height,this.coords=(()=>{let e=[],i=this.displayData?.points;if(i?.length>0){let[t,n]=[[],[]];for(let e=0;e<i.length;e++)e%2==0||0==e?t.push(i[e]):n.push(i[e]);for(let i=0;i<n.length;i++){let o=[t[i],n[i]];e.push(this.makePoint(o))}}else e.push(this.makePoint([t.x,t.y]));return t?.coords??e})(),this.labelPos=(()=>{if(this.unsavedLocation){if(this.locType==LOCTYPES.MARKER)return 6;if(this.locType==LOCTYPES.AREA)return 5;if(this.locType==LOCTYPES.LINE)return 0}else switch(this?.displayData?.labelPos){case 0:return 0;case 1:case 4:case 7:return 4;case 2:return 2;case 3:case 6:case 9:return 6;case 5:return 5;case 8:return 8;default:return 10}})(),this.isPolygon()&&(this.displayData?.lineWidth||(this.displayData.lineWidth=0),this.displayData?.hover||(this.displayData.hover=structuredClone(this.displayData)),this.fillColour=this.displayData?.fillStyle??MAPCONFIG.defaultFillColour,this.fillColourHover=this.displayData?.hover.fillStyle??MAPCONFIG.defaultFillColourHover,this.strokeColour=this.displayData?.strokeStyle??MAPCONFIG.defaultStrokeColour,this.strokeColourHover=this.displayData?.hover.strokeStyle??MAPCONFIG.defaultStrokeColourHover,this.strokeWidth=this.unsavedLocation?MAPCONFIG.defaultStrokeWidth:this.displayData?.lineWidth,this.strokeWidthHover=this.unsavedLocation?MAPCONFIG.defaultStrokeWidthHover:this.displayData?.hover?.lineWidth)}getCentre(t){return(t=t??this.coords).length>1?polygonCenter(t):t[0]}makePoint(t){let e=t[0],i=t[1];if(MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED){let t=gamemap.getWorldFromID(this.worldID);e=(e-t.minX)/t.maxRangeX,i=Math.abs((i-t.maxY)/t.maxRangeY),e=(e*nextPowerOfTwo(t.dbNumTilesX)/t.dbNumTilesX).toFixed(3),i=(i*nextPowerOfTwo(t.dbNumTilesY)/t.dbNumTilesY).toFixed(3)}return new Point(e,i,MAPCONFIG.coordType)}getTooltipContent(){return`<span>${this.name} ${this.isClickable()?"<i class='tiny material-icons'>open_in_browser</i>":""}</span>\n\t\t\t\t<div class='tooltip-desc'>\n\t\t\t\t\t${this.description?this.name!=this.wikiPage&&this.wikiPage?this.description+"</br>"+this.wikiPage:this.description:""}\n\t\t\t\t</div>\n\t\t\t\t${this.isClickable()?"<small class='tooltip-tip'>Click to enter</small>":""}\n\t\t\t\t${this.editing&&!this.isPolygon()&&gamemap.getMapLock()!=MAPLOCK.PARTIAL?"<small class='tooltip-tip'>Click to drag</small>":""}`}getPopupContent(){let t=`<div class='popupTitle'><a ${this.createWikiLink()} target='_top'> ${this.name} </a></div>\n\t\t\t\t\t\t\t<div class='popupDesc'>${this.description?this.description:""}</div><hr/>\n\t\t\t\t\t\t\t<div class='popupInfo'><b>Location ID:</b> ${this.id}</div>`;if(1==this.coords.length&&(t+=`<div class='popupInfo'><b>Coords: </b> X: ${this.coords[0].x}, Y: ${this.coords[0].y} </div>`),null!=this.destinationID&&(t+=`<div class='popupInfo'><b>Destination ID:</b> ${this.destinationID} ${this.destinationID<0?" (Location)":" (World)"} </div>`),MAPCONFIG.editingEnabled){t+=`<hr/> <a style='${"text-align: center; height: unset; margin-bottom: -8px; width: inherit; line-height: 26px;"}' class='btn-flat waves-effect' onclick=" gamemap.getLocation(${this.id}).then(location => gamemap.edit(location));">Edit</a>`}return t}openPopup(){let t=gamemap.findMarkers(this)[0];t?t.openPopup():gamemap.getMap().openPopup(this.getPopupContent(),gamemap.getLatLngs(this.getCentre()))}isPolygon(){return this.locType==LOCTYPES.AREA||this.locType==LOCTYPES.PATH}hasIcon(){return null!=this.icon&&this.locType!=LOCTYPES.PATH}hasLabel(){return this.labelPos&&this.labelPos>=1&&""!=this.name&&this.locType!=LOCTYPES.PATH}isLabel(){return!this.hasIcon()&&!this.isPolygon()&&this.hasLabel()}getLabel(){let t=[0,0];const[e,i]=[MAPCONFIG.labelOffset,MAPCONFIG.labelOffset/2];switch(LABEL_POSITIONS[this.labelPos]){case"top":t=[0,-i];break;case"bottom":t=[0,i];break;case"left":t=[-e,0];break;case"right":t=[e,0];break;case"auto":t=[i,0]}return{className:"location-label",permanent:!0,direction:LABEL_POSITIONS[this.labelPos],interactive:!0,offset:t,riseOnHover:!0}}isClickable(){return this.destinationID&&0!=this.destinationID&&!gamemap.mapLock&&this.locType!=LOCTYPES.PATH}createWikiLink(){let t="";return null!=MAPCONFIG.wikiNamespace&&MAPCONFIG.wikiNamespace.length>0?this.wikiPage&&(t=this.wikiPage.indexOf(":")>=0?MAPCONFIG.wikiURL+encodeURIComponent(this.wikiPage).replace("%3A",":").replace("%2F","/"):MAPCONFIG.wikiURL+MAPCONFIG.wikiNamespace+":"+encodeURIComponent(this.wikiPage)):t=MAPCONFIG.wikiURL+encodeURIComponent(this.wikiPage),""!=t&&(t=`href="${t}"`),t}setEditing(t){this.editing=t}getWasVisible(){return this.wasVisible}setWasVisible(t){this.wasVisible=t}isVisible(t){if(this.editing)return!0;if((gamemap.getZoom()+.5>=gamemap.getMaxZoom()?gamemap.getMaxZoom():gamemap.getZoom())+.001<this.displayLevel)return!1;t=t??gamemap.getViewBounds();let[e,i]=[!1,[this.getCentre()].concat(structuredClone(this.coords))];return i.every((i=>!(Number(i.x)>=Number(t.minX)&&Number(i.x)<=Number(t.maxX)&&Number(i.y)>=Number(t.minY)&&Number(i.y)<=Number(t.maxY))||(e=!0,!1))),e}getSaveQuery(){var t="action=set_loc";let e=MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.convPseudoNormalisedCoords(this.coords):this.coords;return t+=`&name=${encodeURI(this.name)}`,t+=`&description=${encodeURI(this.description)}`,t+=`&wikipage=${encodeURI(this.linkWikiPage()?this.name:this.wikiPage)}`,t+=`&loctype=${this.locType}`,t+=`&locid=${this.id}`,t+=`&worldid=${this.worldID}`,t+="&destid="+-this.destinationID,t+=`&revisionid=${this.revisionID}`,t+=`&db=${MAPCONFIG.database}&visible=1`,this.updateDisplayData(e),t+=`&x=${Number(this.isPolygon()?this.getMaxBounds().minX:e[0].x).toFixed(3)}`,t+=`&y=${Number(this.isPolygon()?this.getMaxBounds().maxY:e[0].y).toFixed(3)}`,t+=`&locwidth=${this.width.toFixed(3)}&locheight=${this.height.toFixed(3)}`,t+="&displaylevel="+(+this.displayLevel+ +gamemap.getWorldFromID(this.worldID).zoomOffset),t+=`&displaydata=${encodeURI(JSON.stringify(this.displayData))}`,this.hasIcon()&&(t+=`&icontype=${encodeURI(this.icon)}`),print(objectify(t)),encodeURI(t)}getRevertQuery(){return encodeURI(`action=revert_loc&db=${MAPCONFIG.db}&locid=${this.id}&revertid=${this.revertID??this.revisionID}`)}getDeleteQuery(){var t="action=enable_loc";return t+=`&locid=${this.id}`,t+=`&worldid=${this.worldID}`,t+=`&db=${MAPCONFIG.database}&visible=0`}updateDisplayData(t){if(this.displayData.labelPos=this.labelPos,this.displayData.points=(()=>{let e=[];return t.forEach((t=>{e.push(Number(t.x).toFixed(3),Number(t.y).toFixed(3))})),e})(),this.isPolygon()){this.displayData.fillStyle=this.fillColour,this.displayData.hover.fillStyle=this.fillColourHover,this.displayData.strokeStyle=this.strokeColour,this.displayData.hover.strokeStyle=this.strokeColourHover,this.displayData.lineWidth=this.strokeWidth,this.displayData.hover.lineWidth=this.strokeWidthHover;let t=this.getMaxBounds(!0);this.width=t.maxX-t.minX,this.height=t.maxY-t.minY}}convPseudoNormalisedCoords(t){let e=gamemap.getWorldFromID(this.worldID);return t=Array.isArray(t)?structuredClone(t):[structuredClone(t)],print(e),t.forEach((t=>{t.x=t.x/nextPowerOfTwo(e.dbNumTilesX)*e.dbNumTilesX,t.y=t.y/nextPowerOfTwo(e.dbNumTilesY)*e.dbNumTilesY,t.x=t.x*e.maxRangeX+e.minX,t.y=(1-t.y)*e.maxRangeY+e.minY})),t}getMaxBounds(t){if(t??null==this.bounds){let t=MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?this.convPseudoNormalisedCoords(this.coords):this.coords,e={};return[e.minX,e.maxX,e.minY,e.maxY]=[t[0].x,t[0].x,t[0].y,t[0].y],t.forEach((t=>{e.minX=t.x<e.minX?t.x:e.minX,e.maxX=t.x>e.maxX?t.x:e.maxX,e.minY=t.y<e.minY?t.y:e.minY,e.maxY=t.y>e.maxY?t.y:e.maxY})),this.bounds=e,e}return this.bounds}linkWikiPage(){return this.wikiPage?.toLowerCase()==this.name.toLowerCase()||null==this.wikiPage}getMarker(){return L.marker(gamemap.getLatLngs(this.getCentre()),{icon:gamemap.getIcon(this.icon),riseOnHover:!0})}}function create_if_block$6(t){let e,i;return{c(){e=element("small"),i=text(t[2]),attr(e,"class","svelte-6vgbo4")},m(t,n){insert(t,e,n),append(e,i)},p(t,e){4&e&&set_data(i,t[2])},d(t){t&&detach(e)}}}function create_fragment$a(t){let e,i,n,o,s,r,a,l,c,h,u=t[5]?" *":"";i=new IconButton({props:{icon:t[0],hasBackground:"false",tooltip:t[4]}}),i.$on("click",t[6]);let d=null!=t[2]&&create_if_block$6(t);return{c(){e=element("div"),create_component(i.$$.fragment),n=space(),o=element("div"),s=element("b"),r=text(t[1]),a=space(),l=text(u),c=space(),d&&d.c(),attr(s,"class","appbar-title svelte-6vgbo4"),attr(s,"title",t[3]),attr(o,"class","title-container svelte-6vgbo4"),attr(e,"class","appbar svelte-6vgbo4")},m(t,u){insert(t,e,u),mount_component(i,e,null),append(e,n),append(e,o),append(o,s),append(s,r),append(s,a),append(s,l),append(o,c),d&&d.m(o,null),h=!0},p(t,[e]){const n={};1&e&&(n.icon=t[0]),16&e&&(n.tooltip=t[4]),i.$set(n),(!h||2&e)&&set_data(r,t[1]),(!h||32&e)&&u!==(u=t[5]?" *":"")&&set_data(l,u),(!h||8&e)&&attr(s,"title",t[3]),null!=t[2]?d?d.p(t,e):(d=create_if_block$6(t),d.c(),d.m(o,null)):d&&(d.d(1),d=null)},i(t){h||(transition_in(i.$$.fragment,t),h=!0)},o(t){transition_out(i.$$.fragment,t),h=!1},d(t){t&&detach(e),destroy_component(i),d&&d.d()}}}function instance$9(t,e,i){let{icon:n="arrow_back"}=e,{title:o="This is an appbar."}=e,{subtitle:s}=e,{tooltip:r}=e,{buttonTooltip:a}=e,{unsavedChanges:l}=e;const c=createEventDispatcher();return t.$$set=t=>{"icon"in t&&i(0,n=t.icon),"title"in t&&i(1,o=t.title),"subtitle"in t&&i(2,s=t.subtitle),"tooltip"in t&&i(3,r=t.tooltip),"buttonTooltip"in t&&i(4,a=t.buttonTooltip),"unsavedChanges"in t&&i(5,l=t.unsavedChanges)},[n,o,s,r,a,l,function(){c("back","clicked")}]}class AppBar extends SvelteComponent{constructor(t){super(),init(this,t,instance$9,create_fragment$a,safe_not_equal,{icon:0,title:1,subtitle:2,tooltip:3,buttonTooltip:4,unsavedChanges:5})}get icon(){return this.$$.ctx[0]}set icon(t){this.$$set({icon:t}),flush()}get title(){return this.$$.ctx[1]}set title(t){this.$$set({title:t}),flush()}get subtitle(){return this.$$.ctx[2]}set subtitle(t){this.$$set({subtitle:t}),flush()}get tooltip(){return this.$$.ctx[3]}set tooltip(t){this.$$set({tooltip:t}),flush()}get buttonTooltip(){return this.$$.ctx[4]}set buttonTooltip(t){this.$$set({buttonTooltip:t}),flush()}get unsavedChanges(){return this.$$.ctx[5]}set unsavedChanges(t){this.$$set({unsavedChanges:t}),flush()}}function create_if_block_3$3(t){let e,i;return{c(){e=element("p"),i=text(t[2]),attr(e,"class","label svelte-andd5u"),toggle_class(e,"hasSubtext",t[5])},m(t,n){insert(t,e,n),append(e,i)},p(t,n){4&n&&set_data(i,t[2]),32&n&&toggle_class(e,"hasSubtext",t[5])},d(t){t&&detach(e)}}}function create_else_block$2(t){let e,i,n,o;return{c(){e=element("input"),attr(e,"id",t[14]),attr(e,"placeholder",i=null!=t[4]?t[4]:null),attr(e,"type","text"),attr(e,"class","input svelte-andd5u"),attr(e,"min",t[10]),attr(e,"max",t[11]),e.value=t[6],attr(e,"step","any"),toggle_class(e,"hideSpinner",t[9])},m(i,s){insert(i,e,s),t[20](e),n||(o=[action_destroyer(t[17].call(null,e)),listen(e,"input",t[15])],n=!0)},p(t,n){16&n&&i!==(i=null!=t[4]?t[4]:null)&&attr(e,"placeholder",i),1024&n&&attr(e,"min",t[10]),2048&n&&attr(e,"max",t[11]),64&n&&e.value!==t[6]&&(e.value=t[6]),512&n&&toggle_class(e,"hideSpinner",t[9])},d(i){i&&detach(e),t[20](null),n=!1,run_all(o)}}}function create_if_block_2$3(t){let e,i,n,o;return{c(){e=element("textarea"),attr(e,"id",t[14]),e.value=t[6],attr(e,"placeholder",i=null!=t[4]?t[4]:null),attr(e,"class","materialize-textarea input svelte-andd5u"),set_style(e,"margin-left","-8px"),set_style(e,"padding-left","8px"),set_style(e,"width","calc(100%)"),set_style(e,"padding-right","8px")},m(i,s){insert(i,e,s),t[19](e),n||(o=[listen(e,"input",t[15]),listen(e,"click",t[16])],n=!0)},p(t,n){64&n&&(e.value=t[6]),16&n&&i!==(i=null!=t[4]?t[4]:null)&&attr(e,"placeholder",i)},d(i){i&&detach(e),t[19](null),n=!1,run_all(o)}}}function create_if_block_1$2(t){let e,i;return{c(){e=element("label"),i=text(t[3]),attr(e,"for",t[14]),attr(e,"class","svelte-andd5u"),toggle_class(e,"active",null!=t[6]||null!=t[13]&&t[13]===document.activeElement)},m(t,n){insert(t,e,n),append(e,i)},p(t,n){8&n&&set_data(i,t[3]),8256&n&&toggle_class(e,"active",null!=t[6]||null!=t[13]&&t[13]===document.activeElement)},d(t){t&&detach(e)}}}function create_if_block$5(t){let e,i;return{c(){e=element("span"),i=text(t[5]),attr(e,"class","supporting-text subtext svelte-andd5u"),attr(e,"title",t[5])},m(t,n){insert(t,e,n),append(e,i)},p(t,n){32&n&&set_data(i,t[5]),32&n&&attr(e,"title",t[5])},d(t){t&&detach(e)}}}function create_fragment$9(t){let e,i,n,o,s,r=t[2]&&create_if_block_3$3(t);function a(t,e){return t[7]?create_if_block_2$3:create_else_block$2}let l=a(t),c=l(t),h=!t[4]&&create_if_block_1$2(t),u=t[5]&&create_if_block$5(t);return{c(){e=element("div"),r&&r.c(),i=space(),n=element("div"),c.c(),o=space(),h&&h.c(),s=space(),u&&u.c(),attr(n,"class","input-field svelte-andd5u"),toggle_class(n,"inline",!t[0]),toggle_class(n,"isNumber","number"==t[1]),toggle_class(n,"compact",!t[2]&&"number"==t[1]),attr(e,"class","textbox svelte-andd5u"),attr(e,"title",t[8]),toggle_class(e,"inline",!t[0]),toggle_class(e,"column",t[12])},m(t,a){insert(t,e,a),r&&r.m(e,null),append(e,i),append(e,n),c.m(n,null),append(n,o),h&&h.m(n,null),append(n,s),u&&u.m(n,null)},p(t,[d]){t[2]?r?r.p(t,d):(r=create_if_block_3$3(t),r.c(),r.m(e,i)):r&&(r.d(1),r=null),l===(l=a(t))&&c?c.p(t,d):(c.d(1),c=l(t),c&&(c.c(),c.m(n,o))),t[4]?h&&(h.d(1),h=null):h?h.p(t,d):(h=create_if_block_1$2(t),h.c(),h.m(n,s)),t[5]?u?u.p(t,d):(u=create_if_block$5(t),u.c(),u.m(n,null)):u&&(u.d(1),u=null),1&d&&toggle_class(n,"inline",!t[0]),2&d&&toggle_class(n,"isNumber","number"==t[1]),6&d&&toggle_class(n,"compact",!t[2]&&"number"==t[1]),256&d&&attr(e,"title",t[8]),1&d&&toggle_class(e,"inline",!t[0]),4096&d&&toggle_class(e,"column",t[12])},i:noop,o:noop,d(t){t&&detach(e),r&&r.d(),c.d(),h&&h.d(),u&&u.d()}}}function instance$8(t,e,i){let{label:n}=e,{hint:o="Enter text..."}=e,{placeholder:s}=e,{block:r=!1}=e,{subtext:a}=e,{text:l}=e,{textArea:c}=e,{tooltip:h}=e,{type:u="text"}=e,{hideSpinner:d="float"==u}=e,{min:p}=e,{max:_}=e,{column:m}=e,{focus:f=!1}=e;u="float"==u?"number":u;const g=createEventDispatcher();let y,v=l,b=Math.random().toString(36).substr(2,10);return r=null!=c||r,onMount((async()=>{y&&f&&y.focus()})),t.$$set=t=>{"label"in t&&i(2,n=t.label),"hint"in t&&i(3,o=t.hint),"placeholder"in t&&i(4,s=t.placeholder),"block"in t&&i(0,r=t.block),"subtext"in t&&i(5,a=t.subtext),"text"in t&&i(6,l=t.text),"textArea"in t&&i(7,c=t.textArea),"tooltip"in t&&i(8,h=t.tooltip),"type"in t&&i(1,u=t.type),"hideSpinner"in t&&i(9,d=t.hideSpinner),"min"in t&&i(10,p=t.min),"max"in t&&i(11,_=t.max),"column"in t&&i(12,m=t.column),"focus"in t&&i(18,f=t.focus)},[r,u,n,o,s,a,l,c,h,d,p,_,m,y,b,function(t){v=t.target.value,g("change","number"==u?Number(v):v)},function(){var t=document.createEvent("KeyboardEvent");t[void 0!==t.initKeyboardEvent?"initKeyboardEvent":"initKeyEvent"]("keydown",!0,!0,window,!1,!1,!1,!1,40,0),y.dispatchEvent(t)},function(t){t.type=u},f,function(t){binding_callbacks[t?"unshift":"push"]((()=>{y=t,i(13,y)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{y=t,i(13,y)}))}]}class Textbox extends SvelteComponent{constructor(t){super(),init(this,t,instance$8,create_fragment$9,safe_not_equal,{label:2,hint:3,placeholder:4,block:0,subtext:5,text:6,textArea:7,tooltip:8,type:1,hideSpinner:9,min:10,max:11,column:12,focus:18})}get label(){return this.$$.ctx[2]}set label(t){this.$$set({label:t}),flush()}get hint(){return this.$$.ctx[3]}set hint(t){this.$$set({hint:t}),flush()}get placeholder(){return this.$$.ctx[4]}set placeholder(t){this.$$set({placeholder:t}),flush()}get block(){return this.$$.ctx[0]}set block(t){this.$$set({block:t}),flush()}get subtext(){return this.$$.ctx[5]}set subtext(t){this.$$set({subtext:t}),flush()}get text(){return this.$$.ctx[6]}set text(t){this.$$set({text:t}),flush()}get textArea(){return this.$$.ctx[7]}set textArea(t){this.$$set({textArea:t}),flush()}get tooltip(){return this.$$.ctx[8]}set tooltip(t){this.$$set({tooltip:t}),flush()}get type(){return this.$$.ctx[1]}set type(t){this.$$set({type:t}),flush()}get hideSpinner(){return this.$$.ctx[9]}set hideSpinner(t){this.$$set({hideSpinner:t}),flush()}get min(){return this.$$.ctx[10]}set min(t){this.$$set({min:t}),flush()}get max(){return this.$$.ctx[11]}set max(t){this.$$set({max:t}),flush()}get column(){return this.$$.ctx[12]}set column(t){this.$$set({column:t}),flush()}get focus(){return this.$$.ctx[18]}set focus(t){this.$$set({focus:t}),flush()}}function create_if_block$4(t){let e,i;return e=new Icon({props:{name:t[1],size:"16"}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};2&i&&(n.name=t[1]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_fragment$8(t){let e,i,n,o,s,r,a,l=t[1]&&create_if_block$4(t);const c=t[5].default,h=create_slot(c,t,t[4],null);return{c(){e=element("div"),i=element("span"),l&&l.c(),n=space(),o=element("b"),s=text(t[0]),r=space(),h&&h.c(),attr(i,"class","title svelte-1vcz7cq"),attr(i,"title",t[2]),attr(e,"class","group svelte-1vcz7cq"),toggle_class(e,"disabled",t[3])},m(t,c){insert(t,e,c),append(e,i),l&&l.m(i,null),append(i,n),append(i,o),append(o,s),append(e,r),h&&h.m(e,null),a=!0},p(t,[o]){t[1]?l?(l.p(t,o),2&o&&transition_in(l,1)):(l=create_if_block$4(t),l.c(),transition_in(l,1),l.m(i,n)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros()),(!a||1&o)&&set_data(s,t[0]),(!a||4&o)&&attr(i,"title",t[2]),h&&h.p&&(!a||16&o)&&update_slot_base(h,c,t,t[4],a?get_slot_changes(c,t[4],o,null):get_all_dirty_from_scope(t[4]),null),(!a||8&o)&&toggle_class(e,"disabled",t[3])},i(t){a||(transition_in(l),transition_in(h,t),a=!0)},o(t){transition_out(l),transition_out(h,t),a=!1},d(t){t&&detach(e),l&&l.d(),h&&h.d(t)}}}function instance$7(t,e,i){let{$$slots:n={},$$scope:o}=e,{title:s="Form group"}=e,{icon:r}=e,{tooltip:a}=e,{disabled:l}=e;return t.$$set=t=>{"title"in t&&i(0,s=t.title),"icon"in t&&i(1,r=t.icon),"tooltip"in t&&i(2,a=t.tooltip),"disabled"in t&&i(3,l=t.disabled),"$$scope"in t&&i(4,o=t.$$scope)},[s,r,a,l,o,n]}class FormGroup extends SvelteComponent{constructor(t){super(),init(this,t,instance$7,create_fragment$8,safe_not_equal,{title:0,icon:1,tooltip:2,disabled:3})}get title(){return this.$$.ctx[0]}set title(t){this.$$set({title:t}),flush()}get icon(){return this.$$.ctx[1]}set icon(t){this.$$set({icon:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}get disabled(){return this.$$.ctx[3]}set disabled(t){this.$$set({disabled:t}),flush()}}function create_fragment$7(t){let e,i,n,o,s,r,a,l;return{c(){e=element("div"),i=element("span"),n=element("b"),o=text(t[0]),s=text(":"),r=space(),a=element("span"),l=text(t[1]),attr(i,"class","key svelte-rh4r3"),attr(a,"class","value svelte-rh4r3"),attr(e,"title",t[2]),attr(e,"class","svelte-rh4r3")},m(t,c){insert(t,e,c),append(e,i),append(i,n),append(n,o),append(n,s),append(e,r),append(e,a),append(a,l)},p(t,[i]){1&i&&set_data(o,t[0]),2&i&&set_data(l,t[1]),4&i&&attr(e,"title",t[2])},i:noop,o:noop,d(t){t&&detach(e)}}}function instance$6(t,e,i){let{name:n="Info:"}=e,{value:o="Value"}=e,{tooltip:s}=e;return t.$$set=t=>{"name"in t&&i(0,n=t.name),"value"in t&&i(1,o=t.value),"tooltip"in t&&i(2,s=t.tooltip)},[n,o,s]}class InfoTextPair extends SvelteComponent{constructor(t){super(),init(this,t,instance$6,create_fragment$7,safe_not_equal,{name:0,value:1,tooltip:2})}get name(){return this.$$.ctx[0]}set name(t){this.$$set({name:t}),flush()}get value(){return this.$$.ctx[1]}set value(t){this.$$set({value:t}),flush()}get tooltip(){return this.$$.ctx[2]}set tooltip(t){this.$$set({tooltip:t}),flush()}}
/*!
     * vanilla-picker v2.12.3
     * https://vanilla-picker.js.org
     *
     * Copyright 2017-2024 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
     * Released under the ISC license.
     */var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,o=!1,s=void 0;try{for(var r,a=t[Symbol.iterator]();!(n=(r=a.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,s=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw s}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};String.prototype.startsWith=String.prototype.startsWith||function(t){return 0===this.indexOf(t)},String.prototype.padStart=String.prototype.padStart||function(t,e){for(var i=this;i.length<t;)i=e+i;return i};var colorNames={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function printNum(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e>0?t.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):t.toString())||"0"}var Color=function(){function t(e,i,n,o){classCallCheck(this,t);var s=this;if(void 0===e);else if(Array.isArray(e))this.rgba=e;else if(void 0===n){var r=e&&""+e;r&&function(e){if(e.startsWith("hsl")){var i=e.match(/([\-\d\.e]+)/g).map(Number),n=slicedToArray(i,4),o=n[0],r=n[1],a=n[2],l=n[3];void 0===l&&(l=1),o/=360,r/=100,a/=100,s.hsla=[o,r,a,l]}else if(e.startsWith("rgb")){var c=e.match(/([\-\d\.e]+)/g).map(Number),h=slicedToArray(c,4),u=h[0],d=h[1],p=h[2],_=h[3];void 0===_&&(_=1),s.rgba=[u,d,p,_]}else e.startsWith("#")?s.rgba=t.hexToRgb(e):s.rgba=t.nameToRgb(e)||t.hexToRgb(e)}(r.toLowerCase())}else this.rgba=[e,i,n,void 0===o?1:o]}return createClass(t,[{key:"printRGB",value:function(t){var e=(t?this.rgba:this.rgba.slice(0,3)).map((function(t,e){return printNum(t,3===e?3:0)}));return t?"rgba("+e+")":"rgb("+e+")"}},{key:"printHSL",value:function(t){var e=[360,100,100,1],i=["","%","%",""],n=(t?this.hsla:this.hsla.slice(0,3)).map((function(t,n){return printNum(t*e[n],3===n?3:1)+i[n]}));return t?"hsla("+n+")":"hsl("+n+")"}},{key:"printHex",value:function(t){var e=this.hex;return t?e:e.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=t.hslToRgb(this._hsla)},set:function(t){3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=t.rgbToHsl(this._rgba)},set:function(t){3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map((function(t,e){return e<3?t.toString(16):Math.round(255*t).toString(16)})).map((function(t){return t.padStart(2,"0")})).join("")},set:function(e){this.rgba=t.hexToRgb(e)}}],[{key:"hexToRgb",value:function(t){var e=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!e.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+t);var i=e.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map((function(t){return parseInt(t,16)}));return i[3]=i[3]/255,i}},{key:"nameToRgb",value:function(e){var i=e.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),n=colorNames[i];return void 0===n?n:t.hexToRgb(n.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var e=slicedToArray(t,4),i=e[0],n=e[1],o=e[2],s=e[3];i/=255,n/=255,o/=255;var r=Math.max(i,n,o),a=Math.min(i,n,o),l=void 0,c=void 0,h=(r+a)/2;if(r===a)l=c=0;else{var u=r-a;switch(c=h>.5?u/(2-r-a):u/(r+a),r){case i:l=(n-o)/u+(n<o?6:0);break;case n:l=(o-i)/u+2;break;case o:l=(i-n)/u+4}l/=6}return[l,c,h,s]}},{key:"hslToRgb",value:function(t){var e=slicedToArray(t,4),i=e[0],n=e[1],o=e[2],s=e[3],r=void 0,a=void 0,l=void 0;if(0===n)r=a=l=o;else{var c=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},h=o<.5?o*(1+n):o+n-o*n,u=2*o-h;r=c(u,h,i+1/3),a=c(u,h,i),l=c(u,h,i-1/3)}var d=[255*r,255*a,255*l].map(Math.round);return d[3]=s,d}}]),t}(),EventBucket=function(){function t(){classCallCheck(this,t),this._events=[]}return createClass(t,[{key:"add",value:function(t,e,i){t.addEventListener(e,i,!1),this._events.push({target:t,type:e,handler:i})}},{key:"remove",value:function(e,i,n){this._events=this._events.filter((function(o){var s=!0;return e&&e!==o.target&&(s=!1),i&&i!==o.type&&(s=!1),n&&n!==o.handler&&(s=!1),s&&t._doRemove(o.target,o.type,o.handler),!s}))}},{key:"destroy",value:function(){this._events.forEach((function(e){return t._doRemove(e.target,e.type,e.handler)})),this._events=[]}}],[{key:"_doRemove",value:function(t,e,i){t.removeEventListener(e,i,!1)}}]),t}();function parseHTML(t){var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}function dragTrack(t,e,i){var n=!1;function o(t,e,i){return Math.max(e,Math.min(t,i))}function s(t,s,r){if(r&&(n=!0),n){t.preventDefault();var a=e.getBoundingClientRect(),l=a.width,c=a.height,h=s.clientX,u=s.clientY,d=o(h-a.left,0,l),p=o(u-a.top,0,c);i(d/l,p/c)}}function r(t,e){1===(void 0===t.buttons?t.which:t.buttons)?s(t,t,e):n=!1}function a(t,e){1===t.touches.length?s(t,t.touches[0],e):n=!1}t.add(e,"mousedown",(function(t){r(t,!0)})),t.add(e,"touchstart",(function(t){a(t,!0)})),t.add(window,"mousemove",r),t.add(e,"touchmove",a),t.add(window,"mouseup",(function(t){n=!1})),t.add(e,"touchend",(function(t){n=!1})),t.add(e,"touchcancel",(function(t){n=!1}))}var BG_TRANSP="linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",HUES=360,EVENT_KEY="keydown",EVENT_CLICK_OUTSIDE="mousedown",EVENT_TAB_MOVE="focusin";function $$1(t,e){return(e||document).querySelector(t)}function stopEvent(t){t.preventDefault(),t.stopPropagation()}function onKey(t,e,i,n,o){t.add(e,EVENT_KEY,(function(t){i.indexOf(t.key)>=0&&(o&&stopEvent(t),n(t))}))}var Picker=function(){function t(e){classCallCheck(this,t),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new EventBucket,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}return createClass(t,[{key:"setOptions",value:function(t){var e=this;if(t){var i=this.settings;if(t instanceof HTMLElement)i.parent=t;else{i.parent&&t.parent&&i.parent!==t.parent&&(this._events.remove(i.parent),this._popupInited=!1),function(t,e,i){for(var n in t)i&&i.indexOf(n)>=0||(e[n]=t[n])}(t,i),t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose);var n=t.color||t.colour;n&&this._setColor(n)}var o=i.parent;if(o&&i.popup&&!this._popupInited){var s=function(t){return e.openHandler(t)};this._events.add(o,"click",s),onKey(this._events,o,[" ","Spacebar","Enter"],s),this._popupInited=!0}else t.parent&&!i.popup&&this.show()}}},{key:"openHandler",value:function(t){if(this.show()){t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none";var e=t&&t.type===EVENT_KEY?this._domEdit:this.domElement;setTimeout((function(){return e.focus()}),100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(t){var e=t&&t.type,i=!1;if(t)if(e===EVENT_CLICK_OUTSIDE||e===EVENT_TAB_MOVE){var n=(this.__containedEvent||0)+100;t.timeStamp>n&&(i=!0)}else stopEvent(t),i=!0;else i=!0;i&&this.hide()&&(this.settings.parent.style.pointerEvents="",e!==EVENT_CLICK_OUTSIDE&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(t,e){this.closeHandler(),this.setOptions(t),e&&this.openHandler()}},{key:"setColor",value:function(t,e){this._setColor(t,{silent:e})}},{key:"_setColor",value:function(t,e){if("string"==typeof t&&(t=t.trim()),t){e=e||{};var i=void 0;try{i=new Color(t)}catch(t){if(e.failSilently)return;throw t}if(!this.settings.alpha){var n=i.hsla;n[3]=1,i.hsla=n}this.colour=this.color=i,this._setHSLA(null,null,null,null,e)}}},{key:"setColour",value:function(t,e){this.setColor(t,e)}},{key:"show",value:function(){if(!this.settings.parent)return!1;if(this.domElement){var t=this._toggleDOM(!0);return this._setPosition(),t}var e=parseHTML(this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>');return this.domElement=e,this._domH=$$1(".picker_hue",e),this._domSL=$$1(".picker_sl",e),this._domA=$$1(".picker_alpha",e),this._domEdit=$$1(".picker_editor input",e),this._domSample=$$1(".picker_sample",e),this._domOkay=$$1(".picker_done button",e),this._domCancel=$$1(".picker_cancel button",e),e.classList.add("layout_"+this.settings.layout),this.settings.alpha||e.classList.add("no_alpha"),this.settings.editor||e.classList.add("no_editor"),this.settings.cancelButton||e.classList.add("no_cancel"),this._ifPopup((function(){return e.classList.add("popup")})),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var t=this,e=this,i=this.domElement,n=this._events;function o(t,e,i){n.add(t,e,i)}o(i,"click",(function(t){return t.preventDefault()})),dragTrack(n,this._domH,(function(t,i){return e._setHSLA(t)})),dragTrack(n,this._domSL,(function(t,i){return e._setHSLA(null,t,1-i)})),this.settings.alpha&&dragTrack(n,this._domA,(function(t,i){return e._setHSLA(null,null,null,1-i)}));var s=this._domEdit;o(s,"input",(function(t){e._setColor(this.value,{fromEditor:!0,failSilently:!0})})),o(s,"focus",(function(t){var e=this;e.selectionStart===e.selectionEnd&&e.select()})),this._ifPopup((function(){var e=function(e){return t.closeHandler(e)};o(window,EVENT_CLICK_OUTSIDE,e),o(window,EVENT_TAB_MOVE,e),onKey(n,i,["Esc","Escape"],e);var s=function(e){t.__containedEvent=e.timeStamp};o(i,EVENT_CLICK_OUTSIDE,s),o(i,EVENT_TAB_MOVE,s),o(t._domCancel,"click",e)}));var r=function(e){t._ifPopup((function(){return t.closeHandler(e)})),t.onDone&&t.onDone(t.colour)};o(this._domOkay,"click",r),onKey(n,i,["Enter"],r)}},{key:"_setPosition",value:function(){var t=this.settings.parent,e=this.domElement;t!==e.parentNode&&t.appendChild(e),this._ifPopup((function(i){"static"===getComputedStyle(t).position&&(t.style.position="relative");var n=!0===i?"popup_right":"popup_"+i;["popup_top","popup_bottom","popup_left","popup_right"].forEach((function(t){t===n?e.classList.add(t):e.classList.remove(t)})),e.classList.add(n)}))}},{key:"_setHSLA",value:function(t,e,i,n,o){o=o||{};var s=this.colour,r=s.hsla;[t,e,i,n].forEach((function(t,e){(t||0===t)&&(r[e]=t)})),s.hsla=r,this._updateUI(o),this.onChange&&!o.silent&&this.onChange(s)}},{key:"_updateUI",value:function(t){if(this.domElement){t=t||{};var e=this.colour,i=e.hsla,n="hsl("+i[0]*HUES+", 100%, 50%)",o=e.hslString,s=e.hslaString,r=this._domH,a=this._domSL,l=this._domA,c=$$1(".picker_selector",r),h=$$1(".picker_selector",a),u=$$1(".picker_selector",l);y(0,c,i[0]),this._domSL.style.backgroundColor=this._domH.style.color=n,y(0,h,i[1]),v(0,h,1-i[2]),a.style.color=o,v(0,u,1-i[3]);var d=o,p=d.replace("hsl","hsla").replace(")",", 0)"),_="linear-gradient("+[d,p]+")";if(this._domA.style.background=_+", "+BG_TRANSP,!t.fromEditor){var m=this.settings.editorFormat,f=this.settings.alpha,g=void 0;switch(m){case"rgb":g=e.printRGB(f);break;case"hsl":g=e.printHSL(f);break;default:g=e.printHex(f)}this._domEdit.value=g}this._domSample.style.color=s}function y(t,e,i){e.style.left=100*i+"%"}function v(t,e,i){e.style.top=100*i+"%"}}},{key:"_ifPopup",value:function(t,e){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):e&&e()}},{key:"_toggleDOM",value:function(t){var e=this.domElement;if(!e)return!1;var i=t?"":"none",n=e.style.display!==i;return n&&(e.style.display=i),n}}]),t}(),style=document.createElement("style");function create_if_block$3(t){let e,i,n;function o(e){t[8](e)}let s={placeholder:t[2],block:!0,label:t[1],text:t[0]};return void 0!==t[0]&&(s.value=t[0]),e=new Textbox({props:s}),binding_callbacks.push((()=>bind(e,"value",o))),e.$on("change",t[9]),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const o={};4&n&&(o.placeholder=t[2]),2&n&&(o.label=t[1]),1&n&&(o.text=t[0]),!i&&1&n&&(i=!0,o.value=t[0],add_flush_callback((()=>i=!1))),e.$set(o)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(t){destroy_component(e,t)}}}function create_fragment$6(t){let e,i,n,o,s,r,a,l,c,h=t[3]&&create_if_block$3(t);return{c(){e=element("div"),h&&h.c(),i=space(),n=element("div"),o=element("div"),s=space(),r=element("a"),attr(o,"class","colour-preview svelte-98yqir"),attr(n,"class","colour-picker svelte-98yqir"),attr(n,"title","Select colour"),toggle_class(n,"hasTextbox",t[3]),attr(r,"id","colour-picker-anchor"),attr(r,"class","svelte-98yqir"),attr(e,"class","colour-picker-container"),set_style(e,"position","relative"),attr(e,"title",t[4]),toggle_class(e,"isEmpty",null==t[0]||""==t[0]||0==t[0].length)},m(u,d){insert(u,e,d),h&&h.m(e,null),append(e,i),append(e,n),append(n,o),t[10](o),append(e,s),append(e,r),t[12](r),a=!0,l||(c=listen(n,"click",t[11]),l=!0)},p(t,[o]){t[3]?h?(h.p(t,o),8&o&&transition_in(h,1)):(h=create_if_block$3(t),h.c(),transition_in(h,1),h.m(e,i)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros()),(!a||8&o)&&toggle_class(n,"hasTextbox",t[3]),(!a||16&o)&&attr(e,"title",t[4]),(!a||1&o)&&toggle_class(e,"isEmpty",null==t[0]||""==t[0]||0==t[0].length)},i(t){a||(transition_in(h),a=!0)},o(t){transition_out(h),a=!1},d(i){i&&detach(e),h&&h.d(),t[10](null),t[12](null),l=!1,c()}}}function instance$5(t,e,i){let n,o,s,{label:r}=e,{placeholder:a}=e,{showTextBox:l=!0}=e,{colour:c="rgba(0, 0, 0, 0)"}=e,{tooltip:h}=e;const u=createEventDispatcher();onMount((async()=>{i(7,s.style.background=c,s),i(5,n=new Picker({parent:o,popup:"left",editorFormat:"rgb"})),n.setColor(""!=c?c:"rgba(0, 0, 0, 0)"),i(5,n.onChange=function(t){i(7,s.style.background=t.rgbaString,s),i(0,c=t.rgbaString)},n)}));return t.$$set=t=>{"label"in t&&i(1,r=t.label),"placeholder"in t&&i(2,a=t.placeholder),"showTextBox"in t&&i(3,l=t.showTextBox),"colour"in t&&i(0,c=t.colour),"tooltip"in t&&i(4,h=t.tooltip)},t.$$.update=()=>{33&t.$$.dirty&&n&&(n.setColour(c),u("change",c))},[c,r,a,l,h,n,o,s,function(t){c=t,i(0,c)},t=>i(0,c=t.detail),function(t){binding_callbacks[t?"unshift":"push"]((()=>{s=t,i(7,s)}))},()=>n.show(),function(t){binding_callbacks[t?"unshift":"push"]((()=>{o=t,i(6,o)}))}]}style.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(style),Picker.StyleElement=style;class ColourPicker extends SvelteComponent{constructor(t){super(),init(this,t,instance$5,create_fragment$6,safe_not_equal,{label:1,placeholder:2,showTextBox:3,colour:0,tooltip:4})}get label(){return this.$$.ctx[1]}set label(t){this.$$set({label:t}),flush()}get placeholder(){return this.$$.ctx[2]}set placeholder(t){this.$$set({placeholder:t}),flush()}get showTextBox(){return this.$$.ctx[3]}set showTextBox(t){this.$$set({showTextBox:t}),flush()}get colour(){return this.$$.ctx[0]}set colour(t){this.$$set({colour:t}),flush()}get tooltip(){return this.$$.ctx[4]}set tooltip(t){this.$$set({tooltip:t}),flush()}}function get_each_context$2(t,e,i){const n=t.slice();return n[14]=e[i][0],n[15]=e[i][1],n}function create_if_block_2$2(t){let e,i,n,o,s;const r=[create_if_block_3$2,create_else_block$1],a=[];function l(t,i){return 1&i&&(e=null),null==e&&(e=!!t[0].includes("/")),e?0:1}return i=l(t,-1),n=a[i]=r[i](t),{c(){n.c(),o=empty()},m(t,e){a[i].m(t,e),insert(t,o,e),s=!0},p(t,e){let s=i;i=l(t,e),i===s?a[i].p(t,e):(group_outros(),transition_out(a[s],1,1,(()=>{a[s]=null})),check_outros(),n=a[i],n?n.p(t,e):(n=a[i]=r[i](t),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(t){s||(transition_in(n),s=!0)},o(t){transition_out(n),s=!1},d(t){a[i].d(t),t&&detach(o)}}}function create_else_block$1(t){let e,i;return e=new Icon({props:{size:"medium",name:t[0]}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};1&i&&(n.name=t[0]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_3$2(t){let e,i;return{c(){e=element("img"),src_url_equal(e.src,i=t[0])||attr(e,"src",i),attr(e,"class","svelte-149pcwa")},m(t,i){insert(t,e,i)},p(t,n){1&n&&!src_url_equal(e.src,i=t[0])&&attr(e,"src",i)},i:noop,o:noop,d(t){t&&detach(e)}}}function create_if_block_1$1(t){let e,i;return e=new DropdownMenu({props:{hint:"Select icon...",invisible:!0,$$slots:{default:[create_default_slot$2]},$$scope:{ctx:t}}}),e.$on("change",t[9]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};4112&i&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_each_block$2(t){let e,i,n,o=t[15]+"";return{c(){e=element("option"),i=text(o),e.__value=t[14],e.value=e.__value,e.selected=n=t[14]==t[4],attr(e,"data-icon",gamemap.getMapConfig().iconPath+t[14]+".png"),attr(e,"title",t[15])},m(t,n){insert(t,e,n),append(e,i)},p(t,i){16&i&&n!==(n=t[14]==t[4])&&(e.selected=n)},d(t){t&&detach(e)}}}function create_default_slot$2(t){let e,i,n,o,s,r=[...gamemap.getMapConfig().icons],a=[];for(let e=0;e<r.length;e+=1)a[e]=create_each_block$2(get_each_context$2(t,r,e));return{c(){e=element("option"),i=text("None"),o=space();for(let t=0;t<a.length;t+=1)a[t].c();s=empty(),e.__value=null,e.value=e.__value,e.selected=n=null==t[4]},m(t,n){insert(t,e,n),append(e,i),insert(t,o,n);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(t,n);insert(t,s,n)},p(t,i){if(16&i&&n!==(n=null==t[4])&&(e.selected=n),16&i){let e;for(r=[...gamemap.getMapConfig().icons],e=0;e<r.length;e+=1){const n=get_each_context$2(t,r,e);a[e]?a[e].p(n,i):(a[e]=create_each_block$2(n),a[e].c(),a[e].m(s.parentNode,s))}for(;e<a.length;e+=1)a[e].d(1);a.length=r.length}},d(t){t&&detach(e),t&&detach(o),destroy_each(a,t),t&&detach(s)}}}function create_if_block$2(t){let e;return{c(){e=element("div"),e.innerHTML='<b class="overlay-text svelte-149pcwa">Select Icon</b>',attr(e,"class","overlay svelte-149pcwa")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_fragment$5(t){let e,i,n,o,s,r,a,l,c,h=t[0]&&create_if_block_2$2(t),u=t[1]&&create_if_block_1$1(t),d=t[2]&&create_if_block$2();const p=t[8].default,_=create_slot(p,t,t[12],null);return{c(){e=element("div"),i=element("div"),h&&h.c(),n=space(),u&&u.c(),o=space(),d&&d.c(),s=space(),r=element("div"),_&&_.c(),attr(i,"class","avatar circle svelte-149pcwa"),attr(i,"title",t[3]),toggle_class(i,"waves-effect",t[1]),attr(r,"class","form_container svelte-149pcwa"),attr(e,"class","avatar_container svelte-149pcwa")},m(p,m){insert(p,e,m),append(e,i),h&&h.m(i,null),append(i,n),u&&u.m(i,null),append(i,o),d&&d.m(i,null),append(e,s),append(e,r),_&&_.m(r,null),a=!0,l||(c=[listen(i,"mouseover",t[10]),listen(i,"mouseout",t[11])],l=!0)},p(t,[e]){t[0]?h?(h.p(t,e),1&e&&transition_in(h,1)):(h=create_if_block_2$2(t),h.c(),transition_in(h,1),h.m(i,n)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros()),t[1]?u?(u.p(t,e),2&e&&transition_in(u,1)):(u=create_if_block_1$1(t),u.c(),transition_in(u,1),u.m(i,o)):u&&(group_outros(),transition_out(u,1,1,(()=>{u=null})),check_outros()),t[2]?d||(d=create_if_block$2(),d.c(),d.m(i,null)):d&&(d.d(1),d=null),(!a||8&e)&&attr(i,"title",t[3]),(!a||2&e)&&toggle_class(i,"waves-effect",t[1]),_&&_.p&&(!a||4096&e)&&update_slot_base(_,p,t,t[12],a?get_slot_changes(p,t[12],e,null):get_all_dirty_from_scope(t[12]),null)},i(t){a||(transition_in(h),transition_in(u),transition_in(_,t),a=!0)},o(t){transition_out(h),transition_out(u),transition_out(_,t),a=!1},d(t){t&&detach(e),h&&h.d(),u&&u.d(),d&&d.d(),_&&_.d(t),l=!1,run_all(c)}}}function instance$4(t,e,i){let n,o,{$$slots:s={},$$scope:r}=e,{icon:a}=e,{isWorld:l}=e,{locType:c}=e,h=!0,u=!1;const d=createEventDispatcher();function p(t){print(t),"null"!=t||null==t?(d("change",Number(t)),i(0,a=t)):(d("change",null),i(0,a=null))}return t.$$set=t=>{"icon"in t&&i(0,a=t.icon),"isWorld"in t&&i(6,l=t.isWorld),"locType"in t&&i(7,c=t.locType),"$$scope"in t&&i(12,r=t.$$scope)},t.$$.update=()=>{195&t.$$.dirty&&(i(4,o=a),i(0,a=null!=a?i(0,a=gamemap.getMapConfig().iconPath+a+".png"):l?"public":c!=LOCTYPES.PATH?"add":"location_on"),i(1,h=c!=LOCTYPES.PATH&&!l),i(3,n=h?a.includes("/")?gamemap.getMapConfig().icons.get(Number(a.replace(/\D/g,""))):"Add Icon":l?"World":"Location"))},[a,h,u,n,o,p,l,c,s,t=>p(t.detail),()=>{i(2,u=h)},()=>i(2,u=!1),r]}class AvatarComponent extends SvelteComponent{constructor(t){super(),init(this,t,instance$4,create_fragment$5,safe_not_equal,{icon:0,isWorld:6,locType:7})}get icon(){return this.$$.ctx[0]}set icon(t){this.$$set({icon:t}),flush()}get isWorld(){return this.$$.ctx[6]}set isWorld(t){this.$$set({isWorld:t}),flush()}get locType(){return this.$$.ctx[7]}set locType(t){this.$$set({locType:t}),flush()}}function create_fragment$4(t){let e,i,n,o,s,r,a;return{c(){e=element("div"),i=element("div"),n=element("div"),o=space(),s=element("small"),s.textContent="Preview",attr(n,"class","colour-preview svelte-1ix00hy"),set_style(n,"--fillColour",t[3]),set_style(n,"--strokeColour",t[2]),set_style(n,"--strokeWidth",t[1]+"px"),attr(i,"class","colour-picker svelte-1ix00hy"),attr(i,"title","Colour preview"),attr(s,"class","label svelte-1ix00hy"),attr(e,"id","colour-preview-container"),attr(e,"class","svelte-1ix00hy")},m(l,c){insert(l,e,c),append(e,i),append(i,n),append(e,o),append(e,s),r||(a=[listen(n,"mouseenter",t[5]),listen(n,"mouseleave",t[6])],r=!0)},p(t,[e]){8&e&&set_style(n,"--fillColour",t[3]),4&e&&set_style(n,"--strokeColour",t[2]),2&e&&set_style(n,"--strokeWidth",t[1]+"px")},i:noop,o:noop,d(t){t&&detach(e),r=!1,run_all(a)}}}function instance$3(t,e,i){let n,o,s,{data:r}=e,a=!1;return t.$$set=t=>{"data"in t&&i(4,r=t.data)},t.$$.update=()=>{17&t.$$.dirty&&i(3,n=a?r.fillColourHover:r.fillColour),17&t.$$.dirty&&i(2,o=a?r.strokeColourHover:r.strokeColour),17&t.$$.dirty&&i(1,s=a?r.strokeWidthHover:r.strokeWidth)},[a,s,o,n,r,()=>i(0,a=!0),()=>i(0,a=!1)]}class ColourPreview extends SvelteComponent{constructor(t){super(),init(this,t,instance$3,create_fragment$4,safe_not_equal,{data:4})}get data(){return this.$$.ctx[4]}set data(t){this.$$set({data:t}),flush()}}function create_fragment$3(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f,g,y,v,b,k;return a=new Icon({props:{name:"emoji_objects"}}),_=new Button({props:{text:"OK",flat:!0}}),_.$on("click",t[1]),{c(){e=element("div"),i=element("hr"),s=space(),r=element("div"),create_component(a.$$.fragment),l=space(),c=element("b"),h=text('Use suggested settings for "'),u=text(t[0]),d=text('"?'),p=space(),create_component(_.$$.fragment),m=space(),f=element("hr"),set_style(i,"margin-top","12px"),attr(i,"class","svelte-12u17ry"),set_style(c,"flex-grow","1"),attr(r,"id","suggestion_container"),attr(r,"class","svelte-12u17ry"),attr(f,"class","svelte-12u17ry"),attr(e,"id","suggestion_bar"),set_style(e,"margin-bottom","6px")},m(t,n){insert(t,e,n),append(e,i),append(e,s),append(e,r),mount_component(a,r,null),append(r,l),append(r,c),append(c,h),append(c,u),append(c,d),append(r,p),mount_component(_,r,null),append(e,m),append(e,f),k=!0},p(t,[e]){(!k||1&e)&&set_data(u,t[0])},i(t){k||(add_render_callback((()=>{k&&(o&&o.end(1),n=create_in_transition(i,scale,{}),n.start())})),transition_in(a.$$.fragment,t),transition_in(_.$$.fragment,t),add_render_callback((()=>{k&&(y&&y.end(1),g=create_in_transition(f,scale,{}),g.start())})),add_render_callback((()=>{k&&(b&&b.end(1),v=create_in_transition(e,slide,{}),v.start())})),k=!0)},o(t){n&&n.invalidate(),o=create_out_transition(i,scale,{}),transition_out(a.$$.fragment,t),transition_out(_.$$.fragment,t),g&&g.invalidate(),y=create_out_transition(f,scale,{}),v&&v.invalidate(),b=create_out_transition(e,slide,{}),k=!1},d(t){t&&detach(e),t&&o&&o.end(),destroy_component(a),destroy_component(_),t&&y&&y.end(),t&&b&&b.end()}}}function instance$2(t,e,i){let{suggestion:n="suggestion"}=e;const o=createEventDispatcher();return t.$$set=t=>{"suggestion"in t&&i(0,n=t.suggestion)},[n,function(){o("confirm")}]}class SuggestionBar extends SvelteComponent{constructor(t){super(),init(this,t,instance$2,create_fragment$3,safe_not_equal,{suggestion:0})}get suggestion(){return this.$$.ctx[0]}set suggestion(t){this.$$set({suggestion:t}),flush()}}const{window:window_1$1}=globals;function get_context_1(t){const e=t[5]?"world":"loc";t[103]=e}function get_each_context$1(t,e,i){const n=t.slice();n[104]=e[i];const o=n[38](n[104]);n[105]=o;const s=n[104].revisionId==n[4].revisionID;return n[106]=s,n}function get_each_context_1(t,e,i){const n=t.slice();return n[111]=e[i],n[113]=i,n}function get_if_ctx(t){const e=t.slice(),i=Object.keys(LABEL_POSITIONS);e[109]=i;const n=Object.values(LABEL_POSITIONS);return e[110]=n,e}function get_if_ctx_1(t){const e=t.slice(),i=MAPCONFIG.editTemplates[e[22]][e[25].toLowerCase()];return e[114]=i,e}function get_context(t){const e=t[18][t[101]];t[102]=e}function get_if_ctx_2(t){const e=t.slice(),i=Object.keys(LOCTYPES).find((t=>LOCTYPES[t]===e[11]));return e[115]=i,e}function create_if_block$1(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m=t[11]&&create_if_block_19$1(get_if_ctx_2(t));s=new AppBar({props:{title:t[23]?`${EDIT_TYPES[t[24]].toSentenceCase()} ${t[22].toSentenceCase()}`:"Map Editor",subtitle:t[23]?t[5]?t[4].displayName+" ("+t[4].name+")":t[4].name:null,unsavedChanges:t[2],icon:t[23]&&!t[21]?"arrow_back":"close",tooltip:t[2]?"You have unsaved changes":null,buttonTooltip:t[23]&&!t[21]?"Go back":"Close"}}),s.$on("back",t[45]);const f=[create_if_block_1,create_else_block_1],g=[];function y(t,e){return t[23]?1:0}return l=y(t),c=g[l]=f[l](t),{c(){e=element("aside"),m&&m.c(),i=space(),n=element("div"),o=space(),create_component(s.$$.fragment),r=space(),a=element("div"),c.c(),attr(n,"id","window-resizer"),attr(n,"class","svelte-ru701"),attr(a,"id","edit-panel-content"),set_style(a,"max-width","inherit"),set_style(a,"width","inherit"),attr(a,"class","svelte-ru701"),toggle_class(a,"isEditing",t[23]),attr(e,"id","edit-panel"),attr(e,"class","svelte-ru701")},m(c,h){insert(c,e,h),m&&m.m(e,null),append(e,i),append(e,n),append(e,o),mount_component(s,e,null),append(e,r),append(e,a),g[l].m(a,null),t[86](a),t[87](e),d=!0,p||(_=listen(n,"mousedown",t[27]),p=!0)},p(t,n){t[11]?m?(m.p(get_if_ctx_2(t),n),2048&n[0]&&transition_in(m,1)):(m=create_if_block_19$1(get_if_ctx_2(t)),m.c(),transition_in(m,1),m.m(e,i)):m&&(group_outros(),transition_out(m,1,1,(()=>{m=null})),check_outros());const o={};29360128&n[0]&&(o.title=t[23]?`${EDIT_TYPES[t[24]].toSentenceCase()} ${t[22].toSentenceCase()}`:"Map Editor"),8388656&n[0]&&(o.subtitle=t[23]?t[5]?t[4].displayName+" ("+t[4].name+")":t[4].name:null),4&n[0]&&(o.unsavedChanges=t[2]),10485760&n[0]&&(o.icon=t[23]&&!t[21]?"arrow_back":"close"),4&n[0]&&(o.tooltip=t[2]?"You have unsaved changes":null),10485760&n[0]&&(o.buttonTooltip=t[23]&&!t[21]?"Go back":"Close"),s.$set(o);let r=l;l=y(t),l===r?g[l].p(t,n):(group_outros(),transition_out(g[r],1,1,(()=>{g[r]=null})),check_outros(),c=g[l],c?c.p(t,n):(c=g[l]=f[l](t),c.c()),transition_in(c,1),c.m(a,null)),(!d||8388608&n[0])&&toggle_class(a,"isEditing",t[23])},i(i){d||(transition_in(m),transition_in(s.$$.fragment,i),transition_in(c),add_render_callback((()=>{d&&(u&&u.end(1),h=create_in_transition(e,t[29],{}),h.start())})),d=!0)},o(i){transition_out(m),transition_out(s.$$.fragment,i),transition_out(c),h&&h.invalidate(),u=create_out_transition(e,t[29],{}),d=!1},d(i){i&&detach(e),m&&m.d(),destroy_component(s),g[l].d(),t[86](null),t[87](null),i&&u&&u.end(),p=!1,_()}}}function create_if_block_19$1(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f,g=t[115].toSentenceCase()+"",y=t[115].toLowerCase()+"";return _=new Button({props:{text:"Cancel",icon:"close",flat:"light",ripple:"light"}}),_.$on("click",t[34]),{c(){e=element("div"),i=element("b"),n=text("Adding "),o=text(g),s=space(),r=element("p"),a=text("Begin adding the new "),l=text(y),c=text(" to the map."),h=space(),u=element("div"),u.innerHTML='<div class="arrow svelte-ru701"><span class="svelte-ru701"></span><span class="svelte-ru701"></span><span class="svelte-ru701"></span></div>',d=space(),p=element("div"),create_component(_.$$.fragment),attr(i,"class","subheading svelte-ru701"),set_style(r,"color","white"),set_style(r,"text-align","center"),set_style(r,"margin","12px"),attr(u,"id","arrow_container"),attr(u,"class","svelte-ru701"),set_style(p,"display","flex"),set_style(p,"gap","var(--padding_medium)"),set_style(p,"padding-top","6px"),attr(e,"id","edit-overlay"),attr(e,"class","svelte-ru701")},m(t,m){insert(t,e,m),append(e,i),append(i,n),append(i,o),append(e,s),append(e,r),append(r,a),append(r,l),append(r,c),append(e,h),append(e,u),append(e,d),append(e,p),mount_component(_,p,null),f=!0},p(t,e){(!f||2048&e[0])&&g!==(g=t[115].toSentenceCase()+"")&&set_data(o,g),(!f||2048&e[0])&&y!==(y=t[115].toLowerCase()+"")&&set_data(l,y)},i(t){f||(transition_in(_.$$.fragment,t),m||add_render_callback((()=>{m=create_in_transition(e,fade,{duration:100}),m.start()})),f=!0)},o(t){transition_out(_.$$.fragment,t),f=!1},d(t){t&&detach(e),destroy_component(_)}}}function create_else_block_1(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f,g,y,v,b,k,w=MAPCONFIG?.editTemplates[t[22]]?.[t[25].toLowerCase()]&&(t[2]||t[4]?.unsavedLocation)&&!t[4]?.acceptedSuggestion&&t[25].toLowerCase()!=(t[5]?t[3].displayName:t[3].name).toLowerCase(),L=w&&create_if_block_18$1(get_if_ctx_1(t));s=new FormGroup({props:{title:"General",icon:"description",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_8]},$$scope:{ctx:t}}});let x=t[5]&&create_if_block_13$1(t),$=t[5]&&create_if_block_12$1(t),C=t[6]&&create_if_block_9$1(t),M=(t[24]==EDIT_TYPES.EDIT||t[24]==EDIT_TYPES.REVERT)&&create_if_block_4$1(t),E={text:t[24]!=EDIT_TYPES.REVERT?"Save":"Revert",icon:t[24]!=EDIT_TYPES.REVERT?"save":"history",type:t[24]!=EDIT_TYPES.REVERT?"save":"revert",bold:"true",ripple:t[24]==EDIT_TYPES.REVERT?"dark":null};p=new Button({props:E}),t[80](p),p.$on("click",t[81]),f=new Button({props:{text:t[2]||t[4]?.unsavedLocation?"Cancel":"Close",icon:"close"}}),f.$on("click",t[82]);let T=(t[6]&&!t[4].unsavedLocation||t[5]&&MAPCONFIG.isAdmin)&&create_if_block_3$1(t);return{c(){e=element("div"),i=element("div"),L&&L.c(),n=space(),o=element("div"),create_component(s.$$.fragment),r=space(),x&&x.c(),a=space(),$&&$.c(),l=space(),C&&C.c(),c=space(),M&&M.c(),h=space(),u=element("footer"),d=element("div"),create_component(p.$$.fragment),_=space(),m=element("div"),create_component(f.$$.fragment),g=space(),T&&T.c(),attr(o,"id","editor_pane"),set_style(o,"max-width","inherit"),set_style(o,"width","inherit"),attr(o,"class","svelte-ru701"),attr(i,"class","editor_window svelte-ru701"),set_style(i,"max-width","inherit"),set_style(i,"width","inherit"),attr(d,"class","footer-buttons svelte-ru701"),attr(m,"class","footer-buttons svelte-ru701"),attr(u,"id","footer"),attr(u,"class","svelte-ru701"),attr(e,"id","editor"),set_style(e,"max-width","inherit"),set_style(e,"width","inherit"),attr(e,"class","svelte-ru701")},m(y,v){insert(y,e,v),append(e,i),L&&L.m(i,null),append(i,n),append(i,o),mount_component(s,o,null),append(o,r),x&&x.m(o,null),append(o,a),$&&$.m(o,null),append(o,l),C&&C.m(o,null),append(o,c),M&&M.m(o,null),t[79](i),append(e,h),append(e,u),append(u,d),mount_component(p,d,null),append(u,_),append(u,m),mount_component(f,m,null),append(m,g),T&&T.m(m,null),t[85](e),k=!0},p(t,e){37748796&e[0]&&(w=MAPCONFIG?.editTemplates[t[22]]?.[t[25].toLowerCase()]&&(t[2]||t[4]?.unsavedLocation)&&!t[4]?.acceptedSuggestion&&t[25].toLowerCase()!=(t[5]?t[3].displayName:t[3].name).toLowerCase()),w?L?(L.p(get_if_ctx_1(t),e),37748796&e[0]&&transition_in(L,1)):(L=create_if_block_18$1(get_if_ctx_1(t)),L.c(),transition_in(L,1),L.m(i,n)):L&&(group_outros(),transition_out(L,1,1,(()=>{L=null})),check_outros());const r={};16777216&e[0]&&(r.disabled=t[24]==EDIT_TYPES.REVERT),37748848&e[0]|8388608&e[3]&&(r.$$scope={dirty:e,ctx:t}),s.$set(r),t[5]?x?(x.p(t,e),32&e[0]&&transition_in(x,1)):(x=create_if_block_13$1(t),x.c(),transition_in(x,1),x.m(o,a)):x&&(group_outros(),transition_out(x,1,1,(()=>{x=null})),check_outros()),t[5]?$?($.p(t,e),32&e[0]&&transition_in($,1)):($=create_if_block_12$1(t),$.c(),transition_in($,1),$.m(o,l)):$&&(group_outros(),transition_out($,1,1,(()=>{$=null})),check_outros()),t[6]?C?(C.p(t,e),64&e[0]&&transition_in(C,1)):(C=create_if_block_9$1(t),C.c(),transition_in(C,1),C.m(o,c)):C&&(group_outros(),transition_out(C,1,1,(()=>{C=null})),check_outros()),t[24]==EDIT_TYPES.EDIT||t[24]==EDIT_TYPES.REVERT?M?(M.p(t,e),16777216&e[0]&&transition_in(M,1)):(M=create_if_block_4$1(t),M.c(),transition_in(M,1),M.m(o,null)):M&&(group_outros(),transition_out(M,1,1,(()=>{M=null})),check_outros());const h={};16777216&e[0]&&(h.text=t[24]!=EDIT_TYPES.REVERT?"Save":"Revert"),16777216&e[0]&&(h.icon=t[24]!=EDIT_TYPES.REVERT?"save":"history"),16777216&e[0]&&(h.type=t[24]!=EDIT_TYPES.REVERT?"save":"revert"),16777216&e[0]&&(h.ripple=t[24]==EDIT_TYPES.REVERT?"dark":null),p.$set(h);const u={};20&e[0]&&(u.text=t[2]||t[4]?.unsavedLocation?"Cancel":"Close"),f.$set(u),t[6]&&!t[4].unsavedLocation||t[5]&&MAPCONFIG.isAdmin?T?(T.p(t,e),112&e[0]&&transition_in(T,1)):(T=create_if_block_3$1(t),T.c(),transition_in(T,1),T.m(m,null)):T&&(group_outros(),transition_out(T,1,1,(()=>{T=null})),check_outros())},i(i){k||(transition_in(L),transition_in(s.$$.fragment,i),transition_in(x),transition_in($),transition_in(C),transition_in(M),transition_in(p.$$.fragment,i),transition_in(f.$$.fragment,i),transition_in(T),y||add_render_callback((()=>{y=create_in_transition(u,fly,{y:10,duration:250}),y.start()})),add_render_callback((()=>{k&&(b&&b.end(1),v=create_in_transition(e,t[40],{}),v.start())})),k=!0)},o(i){transition_out(L),transition_out(s.$$.fragment,i),transition_out(x),transition_out($),transition_out(C),transition_out(M),transition_out(p.$$.fragment,i),transition_out(f.$$.fragment,i),transition_out(T),v&&v.invalidate(),b=create_out_transition(e,t[34],{}),k=!1},d(i){i&&detach(e),L&&L.d(),destroy_component(s),x&&x.d(),$&&$.d(),C&&C.d(),M&&M.d(),t[79](null),t[80](null),destroy_component(p),destroy_component(f),T&&T.d(),t[85](null),i&&b&&b.end()}}}function create_if_block_1(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f,g,y,v,b,k,w,L=t[18];s=new Button({props:{text:"Add Marker",icon:"add_location_alt"}}),s.$on("click",t[46]),a=new Button({props:{text:"Add Path",icon:"polyline"}}),a.$on("click",t[47]),c=new Button({props:{text:"Add Area",icon:"add_circle"}}),c.$on("click",t[48]),u=new Button({props:{text:"Edit World",icon:"public"}}),u.$on("click",t[49]),g=new Icon({props:{name:"refresh",size:"20"}});let x=create_key_block(t);return{c(){e=element("b"),e.textContent="Actions",i=element("br"),n=space(),o=element("div"),create_component(s.$$.fragment),r=space(),create_component(a.$$.fragment),l=space(),create_component(c.$$.fragment),h=space(),create_component(u.$$.fragment),d=space(),p=element("div"),_=element("b"),_.textContent="Recent Changes",m=space(),f=element("div"),create_component(g.$$.fragment),y=space(),v=element("div"),x.c(),attr(e,"class","svelte-ru701"),attr(o,"id","actions-container"),attr(o,"class","svelte-ru701"),attr(_,"class","svelte-ru701"),attr(f,"id","refresh-button"),attr(f,"title","Refresh the Recent Changes list"),attr(f,"class","waves-effect svelte-ru701"),attr(p,"id","recent-changes-titlebar"),attr(p,"class","svelte-ru701"),attr(v,"id","recent-changes-container"),attr(v,"class","svelte-ru701")},m(L,$){insert(L,e,$),insert(L,i,$),insert(L,n,$),insert(L,o,$),mount_component(s,o,null),append(o,r),mount_component(a,o,null),append(o,l),mount_component(c,o,null),append(o,h),mount_component(u,o,null),insert(L,d,$),insert(L,p,$),append(p,_),append(p,m),append(p,f),mount_component(g,f,null),t[50](p),insert(L,y,$),insert(L,v,$),x.m(v,null),b=!0,k||(w=listen(f,"click",t[37]),k=!0)},p(t,e){262144&e[0]&&safe_not_equal(L,L=t[18])?(group_outros(),transition_out(x,1,1,noop),check_outros(),x=create_key_block(t),x.c(),transition_in(x,1),x.m(v,null)):x.p(t,e)},i(t){b||(transition_in(s.$$.fragment,t),transition_in(a.$$.fragment,t),transition_in(c.$$.fragment,t),transition_in(u.$$.fragment,t),transition_in(g.$$.fragment,t),transition_in(x),b=!0)},o(t){transition_out(s.$$.fragment,t),transition_out(a.$$.fragment,t),transition_out(c.$$.fragment,t),transition_out(u.$$.fragment,t),transition_out(g.$$.fragment,t),transition_out(x),b=!1},d(r){r&&detach(e),r&&detach(i),r&&detach(n),r&&detach(o),destroy_component(s),destroy_component(a),destroy_component(c),destroy_component(u),r&&detach(d),r&&detach(p),destroy_component(g),t[50](null),r&&detach(y),r&&detach(v),x.d(r),k=!1,w()}}}function create_if_block_18$1(t){let e,i;return e=new SuggestionBar({props:{suggestion:t[25].toTitleCase()}}),e.$on("confirm",(function(){return t[54](t[114])})),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(i,n){t=i;const o={};33554432&n[0]&&(o.suggestion=t[25].toTitleCase()),e.$set(o)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_16$1(t){let e,i,n=t[4].locType!=LOCTYPES.PATH&&create_if_block_17$1(t);return{c(){n&&n.c(),e=empty()},m(t,o){n&&n.m(t,o),insert(t,e,o),i=!0},p(t,i){t[4].locType!=LOCTYPES.PATH?n?(n.p(t,i),16&i[0]&&transition_in(n,1)):(n=create_if_block_17$1(t),n.c(),transition_in(n,1),n.m(e.parentNode,e)):n&&(group_outros(),transition_out(n,1,1,(()=>{n=null})),check_outros())},i(t){i||(transition_in(n),i=!0)},o(t){transition_out(n),i=!1},d(t){n&&n.d(t),t&&detach(e)}}}function create_if_block_15$1(t){let e,i;return e=new Textbox({props:{hint:"Parent ID",text:t[4].parentID,tooltip:"Parent world ID",type:"number",subtext:gamemap.isWorldValid(t[4].parentID)?gamemap.getWorldDisplayNameFromID(t[4].parentID):null!=t[4].parentID&&""!=t[4].parentID?"Invalid World ID!":null}}),e.$on("change",t[56]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16&i[0]&&(n.text=t[4].parentID),16&i[0]&&(n.subtext=gamemap.isWorldValid(t[4].parentID)?gamemap.getWorldDisplayNameFromID(t[4].parentID):null!=t[4].parentID&&""!=t[4].parentID?"Invalid World ID!":null),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_17$1(t){let e,i;return e=new Textbox({props:{hint:"Destination ID",text:t[4].destinationID,subtext:"+ for world, - for location",tooltip:"Location/world destination ID",type:"number"}}),e.$on("change",t[57]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16&i[0]&&(n.text=t[4].destinationID),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_default_slot_11(t){let e,i,n,o,s,r;e=new Textbox({props:{text:t[5]?t[4].displayName:t[4].name,hint:(t[5]?"Display ":"")+"Name",tooltip:t[22].toSentenceCase()+" name",focus:!0}}),e.$on("change",t[55]);const a=[create_if_block_15$1,create_if_block_16$1],l=[];function c(t,e){return t[5]?0:t[6]?1:-1}return~(n=c(t))&&(o=l[n]=a[n](t)),{c(){create_component(e.$$.fragment),i=space(),o&&o.c(),s=empty()},m(t,o){mount_component(e,t,o),insert(t,i,o),~n&&l[n].m(t,o),insert(t,s,o),r=!0},p(t,i){const r={};48&i[0]&&(r.text=t[5]?t[4].displayName:t[4].name),32&i[0]&&(r.hint=(t[5]?"Display ":"")+"Name"),4194304&i[0]&&(r.tooltip=t[22].toSentenceCase()+" name"),e.$set(r);let h=n;n=c(t),n===h?~n&&l[n].p(t,i):(o&&(group_outros(),transition_out(l[h],1,1,(()=>{l[h]=null})),check_outros()),~n?(o=l[n],o?o.p(t,i):(o=l[n]=a[n](t),o.c()),transition_in(o,1),o.m(s.parentNode,s)):o=null)},i(t){r||(transition_in(e.$$.fragment,t),transition_in(o),r=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(o),r=!1},d(t){destroy_component(e,t),t&&detach(i),~n&&l[n].d(t),t&&detach(s)}}}function create_default_slot_10(t){let e,i;return e=new Textbox({props:{label:"Wiki Page",text:t[4].wikiPage,placeholder:"Enter wiki page...",tooltip:"Wiki page name"}}),e.$on("change",t[59]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16&i[0]&&(n.text=t[4].wikiPage),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_14$1(t){let e,i;return e=new DropdownMenu({props:{label:"Label Direction",hint:"Select label direction...",align:"right",selected:t[4].labelPos,$$slots:{default:[create_default_slot_9]},$$scope:{ctx:t}}}),e.$on("change",t[61]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16&i[0]&&(n.selected=t[4].labelPos),16&i[0]|8388608&i[3]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_each_block_1(t){let e,i,n,o=t[111].toSentenceCase()+"";return{c(){e=element("option"),i=text(o),e.__value=t[109][t[113]],e.value=e.__value,e.selected=n=t[4].labelPos==t[109][t[113]]},m(t,n){insert(t,e,n),append(e,i)},p(t,i){16&i[0]&&n!==(n=t[4].labelPos==t[109][t[113]])&&(e.selected=n)},d(t){t&&detach(e)}}}function create_default_slot_9(t){let e,i=t[110],n=[];for(let e=0;e<i.length;e+=1)n[e]=create_each_block_1(get_each_context_1(t,i,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=empty()},m(t,i){for(let e=0;e<n.length;e+=1)n[e]&&n[e].m(t,i);insert(t,e,i)},p(t,o){if(16&o[0]){let s;for(i=t[110],s=0;s<i.length;s+=1){const r=get_each_context_1(t,i,s);n[s]?n[s].p(r,o):(n[s]=create_each_block_1(r),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){destroy_each(n,t),t&&detach(e)}}}function create_default_slot_8(t){let e,i,n,o,s,r,a,l;i=new AvatarComponent({props:{icon:t[4].icon,locType:t[4].locType,isWorld:t[5],$$slots:{default:[create_default_slot_11]},$$scope:{ctx:t}}}),i.$on("change",t[58]),o=new Switch({props:{enabled:t[4].linkWikiPage(),label:"Use "+(t[5]?"Display Name":"Name")+" as Wiki Page",tooltip:`Use this ${t[22]}'s ${t[5]?"display name":"name"} as its wiki page`,$$slots:{default:[create_default_slot_10]},$$scope:{ctx:t}}}),o.$on("change",t[60]);let c=t[4].locType!=LOCTYPES.PATH&&t[6]&&create_if_block_14$1(get_if_ctx(t));return a=new Textbox({props:{label:"Description",text:t[4].description,placeholder:"Enter description...",tooltip:"Description of this "+t[22],textArea:"true"}}),a.$on("change",t[62]),{c(){e=element("header"),create_component(i.$$.fragment),n=space(),create_component(o.$$.fragment),s=space(),c&&c.c(),r=space(),create_component(a.$$.fragment),attr(e,"class","header")},m(t,h){insert(t,e,h),mount_component(i,e,null),insert(t,n,h),mount_component(o,t,h),insert(t,s,h),c&&c.m(t,h),insert(t,r,h),mount_component(a,t,h),l=!0},p(t,e){const n={};16&e[0]&&(n.icon=t[4].icon),16&e[0]&&(n.locType=t[4].locType),32&e[0]&&(n.isWorld=t[5]),4194416&e[0]|8388608&e[3]&&(n.$$scope={dirty:e,ctx:t}),i.$set(n);const s={};16&e[0]&&(s.enabled=t[4].linkWikiPage()),32&e[0]&&(s.label="Use "+(t[5]?"Display Name":"Name")+" as Wiki Page"),4194336&e[0]&&(s.tooltip=`Use this ${t[22]}'s ${t[5]?"display name":"name"} as its wiki page`),33554448&e[0]|8388608&e[3]&&(s.$$scope={dirty:e,ctx:t}),o.$set(s),t[4].locType!=LOCTYPES.PATH&&t[6]?c?(c.p(get_if_ctx(t),e),80&e[0]&&transition_in(c,1)):(c=create_if_block_14$1(get_if_ctx(t)),c.c(),transition_in(c,1),c.m(r.parentNode,r)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros());const l={};16&e[0]&&(l.text=t[4].description),4194304&e[0]&&(l.tooltip="Description of this "+t[22]),a.$set(l)},i(t){l||(transition_in(i.$$.fragment,t),transition_in(o.$$.fragment,t),transition_in(c),transition_in(a.$$.fragment,t),l=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(o.$$.fragment,t),transition_out(c),transition_out(a.$$.fragment,t),l=!1},d(t){t&&detach(e),destroy_component(i),t&&detach(n),destroy_component(o,t),t&&detach(s),c&&c.d(t),t&&detach(r),destroy_component(a,t)}}}function create_if_block_13$1(t){let e,i;return e=new FormGroup({props:{title:"Zoom",icon:"zoom_in",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_7]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16777216&i[0]&&(n.disabled=t[24]==EDIT_TYPES.REVERT),16&i[0]|8388608&i[3]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_default_slot_7(t){let e,i,n,o,s;return i=new Textbox({props:{text:t[4].minZoomLevel,type:"number",hint:"Min Zoom",tooltip:"Minimum zoom level for this world",min:"0"}}),i.$on("change",t[63]),o=new Textbox({props:{text:t[4].maxZoomLevel,type:"number",hint:"Max Zoom",tooltip:"Maximum zoom level for this world",min:"0"}}),o.$on("change",t[64]),{c(){e=element("div"),create_component(i.$$.fragment),n=space(),create_component(o.$$.fragment),attr(e,"class","row svelte-ru701")},m(t,r){insert(t,e,r),mount_component(i,e,null),append(e,n),mount_component(o,e,null),s=!0},p(t,e){const n={};16&e[0]&&(n.text=t[4].minZoomLevel),i.$set(n);const s={};16&e[0]&&(s.text=t[4].maxZoomLevel),o.$set(s)},i(t){s||(transition_in(i.$$.fragment,t),transition_in(o.$$.fragment,t),s=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(o.$$.fragment,t),s=!1},d(t){t&&detach(e),destroy_component(i),destroy_component(o)}}}function create_if_block_12$1(t){let e,i;return e=new FormGroup({props:{title:"Bounds",icon:"crop_free",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_6]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16777216&i[0]&&(n.disabled=t[24]==EDIT_TYPES.REVERT),16&i[0]|8388608&i[3]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_default_slot_6(t){let e,i,n,o,s,r,a,l,c,h;return i=new Textbox({props:{text:t[4].minX,hint:"Minimum X",type:"number",hideSpinner:!0,tooltip:"Minimum X bounds for this world"}}),i.$on("change",t[65]),o=new Textbox({props:{text:t[4].maxX,hint:"Maximum X",type:"number",hideSpinner:!0,tooltip:"Maximum X bounds for this world"}}),o.$on("change",t[66]),a=new Textbox({props:{text:t[4].minY,hint:"Minimum Y",type:"number",hideSpinner:!0,tooltip:"Minimum Y bounds for this world"}}),a.$on("change",t[67]),c=new Textbox({props:{text:t[4].maxY,hint:"Maximum Y",type:"number",hideSpinner:!0,tooltip:"Maximum Y bounds for this world"}}),c.$on("change",t[68]),{c(){e=element("div"),create_component(i.$$.fragment),n=space(),create_component(o.$$.fragment),s=space(),r=element("div"),create_component(a.$$.fragment),l=space(),create_component(c.$$.fragment),attr(e,"class","row svelte-ru701"),attr(r,"class","row svelte-ru701")},m(t,u){insert(t,e,u),mount_component(i,e,null),append(e,n),mount_component(o,e,null),insert(t,s,u),insert(t,r,u),mount_component(a,r,null),append(r,l),mount_component(c,r,null),h=!0},p(t,e){const n={};16&e[0]&&(n.text=t[4].minX),i.$set(n);const s={};16&e[0]&&(s.text=t[4].maxX),o.$set(s);const r={};16&e[0]&&(r.text=t[4].minY),a.$set(r);const l={};16&e[0]&&(l.text=t[4].maxY),c.$set(l)},i(t){h||(transition_in(i.$$.fragment,t),transition_in(o.$$.fragment,t),transition_in(a.$$.fragment,t),transition_in(c.$$.fragment,t),h=!0)},o(t){transition_out(i.$$.fragment,t),transition_out(o.$$.fragment,t),transition_out(a.$$.fragment,t),transition_out(c.$$.fragment,t),h=!1},d(t){t&&detach(e),destroy_component(i),destroy_component(o),t&&detach(s),t&&detach(r),destroy_component(a),destroy_component(c)}}}function create_if_block_9$1(t){let e,i;return e=new FormGroup({props:{title:"Display",icon:"light_mode",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_5]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16777216&i[0]&&(n.disabled=t[24]==EDIT_TYPES.REVERT),1048592&i[0]|8388608&i[3]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_10$1(t){let e,i,n,o,s,r,a,l,c,h,u,d;e=new ColourPreview({props:{data:t[4]}});let p=t[4].locType==LOCTYPES.AREA&&create_if_block_11$1(t);return o=new ColourPicker({props:{label:"Stroke Colour",colour:t[4].strokeColour,placeholder:"Enter stroke colour...",tooltip:"Default stroke colour for this location"}}),o.$on("change",t[71]),r=new ColourPicker({props:{label:"Stroke Colour (Hover)",colour:t[4].strokeColourHover,placeholder:"Enter hovered stroke colour...",tooltip:"Hovered stroke colour for this location"}}),r.$on("change",t[72]),c=new Textbox({props:{text:t[4].strokeWidth,label:"Stroke Width",hint:"",column:!0,type:"number",tooltip:"Default stroke width for this location"}}),c.$on("change",t[73]),u=new Textbox({props:{text:t[4].strokeWidthHover,label:"Stroke Width (Hover)",hint:"",column:!0,type:"number",tooltip:"Hovered stroke width for this location"}}),u.$on("change",t[74]),{c(){create_component(e.$$.fragment),i=space(),p&&p.c(),n=space(),create_component(o.$$.fragment),s=space(),create_component(r.$$.fragment),a=space(),l=element("div"),create_component(c.$$.fragment),h=space(),create_component(u.$$.fragment),attr(l,"class","row svelte-ru701")},m(t,_){mount_component(e,t,_),insert(t,i,_),p&&p.m(t,_),insert(t,n,_),mount_component(o,t,_),insert(t,s,_),mount_component(r,t,_),insert(t,a,_),insert(t,l,_),mount_component(c,l,null),append(l,h),mount_component(u,l,null),d=!0},p(t,i){const s={};16&i[0]&&(s.data=t[4]),e.$set(s),t[4].locType==LOCTYPES.AREA?p?(p.p(t,i),16&i[0]&&transition_in(p,1)):(p=create_if_block_11$1(t),p.c(),transition_in(p,1),p.m(n.parentNode,n)):p&&(group_outros(),transition_out(p,1,1,(()=>{p=null})),check_outros());const a={};16&i[0]&&(a.colour=t[4].strokeColour),o.$set(a);const l={};16&i[0]&&(l.colour=t[4].strokeColourHover),r.$set(l);const h={};16&i[0]&&(h.text=t[4].strokeWidth),c.$set(h);const d={};16&i[0]&&(d.text=t[4].strokeWidthHover),u.$set(d)},i(t){d||(transition_in(e.$$.fragment,t),transition_in(p),transition_in(o.$$.fragment,t),transition_in(r.$$.fragment,t),transition_in(c.$$.fragment,t),transition_in(u.$$.fragment,t),d=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(p),transition_out(o.$$.fragment,t),transition_out(r.$$.fragment,t),transition_out(c.$$.fragment,t),transition_out(u.$$.fragment,t),d=!1},d(t){destroy_component(e,t),t&&detach(i),p&&p.d(t),t&&detach(n),destroy_component(o,t),t&&detach(s),destroy_component(r,t),t&&detach(a),t&&detach(l),destroy_component(c),destroy_component(u)}}}function create_if_block_11$1(t){let e,i,n,o;return e=new ColourPicker({props:{label:"Fill Colour",colour:t[4].fillColour,placeholder:"Enter fill colour...",tooltip:"Default fill colour for this location"}}),e.$on("change",t[69]),n=new ColourPicker({props:{label:"Fill Colour (Hover)",colour:t[4].fillColourHover,placeholder:"Enter hovered fill colour...",tooltip:"Hovered fill colour for this location"}}),n.$on("change",t[70]),{c(){create_component(e.$$.fragment),i=space(),create_component(n.$$.fragment)},m(t,s){mount_component(e,t,s),insert(t,i,s),mount_component(n,t,s),o=!0},p(t,i){const o={};16&i[0]&&(o.colour=t[4].fillColour),e.$set(o);const s={};16&i[0]&&(s.colour=t[4].fillColourHover),n.$set(s)},i(t){o||(transition_in(e.$$.fragment,t),transition_in(n.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(n.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(i),destroy_component(n,t)}}}function create_default_slot_5(t){let e,i,n,o=t[4].isPolygon(),s=o&&create_if_block_10$1(t);return i=new Textbox({props:{label:"Display Level",text:t[4].displayLevel,placeholder:"Enter display level...",tooltip:"Zoom level at which this location will appear",type:"number",subtext:"Current zoom is "+t[20],min:gamemap.getCurrentWorld().minZoomLevel,max:gamemap.getCurrentWorld().maxZoomLevel}}),i.$on("change",t[75]),{c(){s&&s.c(),e=space(),create_component(i.$$.fragment)},m(t,o){s&&s.m(t,o),insert(t,e,o),mount_component(i,t,o),n=!0},p(t,n){16&n[0]&&(o=t[4].isPolygon()),o?s?(s.p(t,n),16&n[0]&&transition_in(s,1)):(s=create_if_block_10$1(t),s.c(),transition_in(s,1),s.m(e.parentNode,e)):s&&(group_outros(),transition_out(s,1,1,(()=>{s=null})),check_outros());const r={};16&n[0]&&(r.text=t[4].displayLevel),1048576&n[0]&&(r.subtext="Current zoom is "+t[20]),i.$set(r)},i(t){n||(transition_in(s),transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(s),transition_out(i.$$.fragment,t),n=!1},d(t){s&&s.d(t),t&&detach(e),destroy_component(i,t)}}}function create_if_block_4$1(t){let e,i,n,o=t[3].id>0&&t[3].revisionID>0&&create_if_block_7$1(t);return i=new FormGroup({props:{title:"Info",icon:"info",disabled:t[24]==EDIT_TYPES.REVERT,$$slots:{default:[create_default_slot_3]},$$scope:{ctx:t}}}),{c(){o&&o.c(),e=space(),create_component(i.$$.fragment)},m(t,s){o&&o.m(t,s),insert(t,e,s),mount_component(i,t,s),n=!0},p(t,n){t[3].id>0&&t[3].revisionID>0?o?(o.p(t,n),8&n[0]&&transition_in(o,1)):(o=create_if_block_7$1(t),o.c(),transition_in(o,1),o.m(e.parentNode,e)):o&&(group_outros(),transition_out(o,1,1,(()=>{o=null})),check_outros());const s={};16777216&n[0]&&(s.disabled=t[24]==EDIT_TYPES.REVERT),4194416&n[0]|8388608&n[3]&&(s.$$scope={dirty:n,ctx:t}),i.$set(s)},i(t){n||(transition_in(o),transition_in(i.$$.fragment,t),n=!0)},o(t){transition_out(o),transition_out(i.$$.fragment,t),n=!1},d(t){o&&o.d(t),t&&detach(e),destroy_component(i,t)}}}function create_if_block_7$1(t){let e,i;return e=new FormGroup({props:{title:"Edit History",icon:"history",tooltip:"Shows the up to 5 of the most recent edits",$$slots:{default:[create_default_slot_4]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};524304&i[0]|8388608&i[3]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_else_block_2(t){let e,i;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p:noop,i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_8$1(t){let e,i,n=t[19],o=[];for(let e=0;e<n.length;e+=1)o[e]=create_each_block$1(get_each_context$1(t,n,e));const s=t=>transition_out(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=empty()},m(t,n){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,n);insert(t,e,n),i=!0},p(t,i){if(524304&i[0]|129&i[1]){let r;for(n=t[19],r=0;r<n.length;r+=1){const s=get_each_context$1(t,n,r);o[r]?(o[r].p(s,i),transition_in(o[r],1)):(o[r]=create_each_block$1(s),o[r].c(),transition_in(o[r],1),o[r].m(e.parentNode,e))}for(group_outros(),r=n.length;r<o.length;r+=1)s(r);check_outros()}},i(t){if(!i){for(let t=0;t<n.length;t+=1)transition_in(o[t]);i=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)transition_out(o[t]);i=!1},d(t){destroy_each(o,t),t&&detach(e)}}}function create_each_block$1(t){let e,i;const n=[t[105],{title:t[105].name},{bold:t[105].isWorld},{compact:!0},{selected:t[106]},{tooltip:t[106]?"This is the current revision":""}];let o={};for(let t=0;t<n.length;t+=1)o=assign(o,n[t]);return e=new ListItem({props:o}),e.$on("click",(function(){return t[76](t[105])})),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(i,o){t=i;const s=524304&o[0]|128&o[1]?get_spread_update(n,[524288&o[0]|128&o[1]&&get_spread_object(t[105]),524288&o[0]|128&o[1]&&{title:t[105].name},524288&o[0]|128&o[1]&&{bold:t[105].isWorld},n[3],524304&o[0]&&{selected:t[106]},524304&o[0]&&{tooltip:t[106]?"This is the current revision":""}]):{};e.$set(s)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_default_slot_4(t){let e,i,n,o;get_context_1(t);const s=[create_if_block_8$1,create_else_block_2],r=[];function a(t,e){return t[19].length>0?0:1}return e=a(t),i=r[e]=s[e](t),{c(){i.c(),n=empty()},m(t,i){r[e].m(t,i),insert(t,n,i),o=!0},p(t,o){get_context_1(t);let l=e;e=a(t),e===l?r[e].p(t,o):(group_outros(),transition_out(r[l],1,1,(()=>{r[l]=null})),check_outros(),i=r[e],i?i.p(t,o):(i=r[e]=s[e](t),i.c()),transition_in(i,1),i.m(n.parentNode,n))},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){r[e].d(t),t&&detach(n)}}}function create_if_block_6$1(t){let e,i,n,o;return e=new InfoTextPair({props:{name:"World Name",value:t[4].name,tooltip:"This world's internal name"}}),n=new InfoTextPair({props:{name:"Tiles",value:`${t[4].dbNumTilesX} x ${t[4].dbNumTilesY}`,tooltip:"Number of tiles at full zoom"}}),{c(){create_component(e.$$.fragment),i=space(),create_component(n.$$.fragment)},m(t,s){mount_component(e,t,s),insert(t,i,s),mount_component(n,t,s),o=!0},p(t,i){const o={};16&i[0]&&(o.value=t[4].name),e.$set(o);const s={};16&i[0]&&(s.value=`${t[4].dbNumTilesX} x ${t[4].dbNumTilesY}`),n.$set(s)},i(t){o||(transition_in(e.$$.fragment,t),transition_in(n.$$.fragment,t),o=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(n.$$.fragment,t),o=!1},d(t){destroy_component(e,t),t&&detach(i),destroy_component(n,t)}}}function create_if_block_5$1(t){let e,i,n,o,s,r;return e=new InfoTextPair({props:{name:"Location Type",value:Object.keys(LOCTYPES).find(t[77]).toLowerCase(),tooltip:"The type of location this is"}}),n=new InfoTextPair({props:{name:"In World",value:gamemap.getWorldNameFromID(t[4].worldID),tooltip:"The world this location is in"}}),s=new InfoTextPair({props:{name:"Position",value:`X: ${t[4]?.getCentre()?.x}, Y: ${t[4]?.getCentre()?.y}`,tooltip:"This location's coordinates"}}),{c(){create_component(e.$$.fragment),i=space(),create_component(n.$$.fragment),o=space(),create_component(s.$$.fragment)},m(t,a){mount_component(e,t,a),insert(t,i,a),mount_component(n,t,a),insert(t,o,a),mount_component(s,t,a),r=!0},p(t,i){const o={};16&i[0]&&(o.value=Object.keys(LOCTYPES).find(t[77]).toLowerCase()),e.$set(o);const r={};16&i[0]&&(r.value=gamemap.getWorldNameFromID(t[4].worldID)),n.$set(r);const a={};16&i[0]&&(a.value=`X: ${t[4]?.getCentre()?.x}, Y: ${t[4]?.getCentre()?.y}`),s.$set(a)},i(t){r||(transition_in(e.$$.fragment,t),transition_in(n.$$.fragment,t),transition_in(s.$$.fragment,t),r=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(n.$$.fragment,t),transition_out(s.$$.fragment,t),r=!1},d(t){destroy_component(e,t),t&&detach(i),destroy_component(n,t),t&&detach(o),destroy_component(s,t)}}}function create_default_slot_3(t){let e,i,n,o,s,r,a,l;e=new InfoTextPair({props:{name:t[22].toSentenceCase()+" ID",value:t[4].id,tooltip:"This "+t[22]+"'s ID"}});let c=t[5]&&create_if_block_6$1(t),h=t[6]&&create_if_block_5$1(t);return s=new InfoTextPair({props:{name:"Coord Type",value:Object.keys(COORD_TYPES).find(t[78]).toLowerCase(),tooltip:"Coordinate system that this "+t[22]+" is using"}}),a=new InfoTextPair({props:{name:"Revision ID",value:t[4].revisionID,tooltip:"Current revision ID"}}),{c(){create_component(e.$$.fragment),i=space(),c&&c.c(),n=space(),h&&h.c(),o=space(),create_component(s.$$.fragment),r=space(),create_component(a.$$.fragment)},m(t,u){mount_component(e,t,u),insert(t,i,u),c&&c.m(t,u),insert(t,n,u),h&&h.m(t,u),insert(t,o,u),mount_component(s,t,u),insert(t,r,u),mount_component(a,t,u),l=!0},p(t,i){const r={};4194304&i[0]&&(r.name=t[22].toSentenceCase()+" ID"),16&i[0]&&(r.value=t[4].id),4194304&i[0]&&(r.tooltip="This "+t[22]+"'s ID"),e.$set(r),t[5]?c?(c.p(t,i),32&i[0]&&transition_in(c,1)):(c=create_if_block_6$1(t),c.c(),transition_in(c,1),c.m(n.parentNode,n)):c&&(group_outros(),transition_out(c,1,1,(()=>{c=null})),check_outros()),t[6]?h?(h.p(t,i),64&i[0]&&transition_in(h,1)):(h=create_if_block_5$1(t),h.c(),transition_in(h,1),h.m(o.parentNode,o)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros());const l={};4194304&i[0]&&(l.tooltip="Coordinate system that this "+t[22]+" is using"),s.$set(l);const u={};16&i[0]&&(u.value=t[4].revisionID),a.$set(u)},i(t){l||(transition_in(e.$$.fragment,t),transition_in(c),transition_in(h),transition_in(s.$$.fragment,t),transition_in(a.$$.fragment,t),l=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(c),transition_out(h),transition_out(s.$$.fragment,t),transition_out(a.$$.fragment,t),l=!1},d(t){destroy_component(e,t),t&&detach(i),c&&c.d(t),t&&detach(n),h&&h.d(t),t&&detach(o),destroy_component(s,t),t&&detach(r),destroy_component(a,t)}}}function create_if_block_3$1(t){let e,i;return e=new Button({props:{text:"Delete",icon:"delete",disabled:t[24]==EDIT_TYPES.REVERT||t[5]&&t[3].id==MAPCONFIG.defaultWorldID,type:"delete"}}),e.$on("click",t[83]),e.$on("shiftClick",t[84]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16777256&i[0]&&(n.disabled=t[24]==EDIT_TYPES.REVERT||t[5]&&t[3].id==MAPCONFIG.defaultWorldID),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_else_block(t){let e,i;return e=new LoadingSpinner({}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p:noop,i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_2$1(t){let e,i;return e=new VirtualList({props:{width:"100%",height:t[14]-(t[13]?.getBoundingClientRect()?.bottom+10),itemCount:t[18].length,scrollToIndex:1,itemSize:60,$$slots:{item:[create_item_slot,({style:t,index:e})=>({100:t,101:e}),({style:t,index:e})=>[0,0,0,(t?128:0)|(e?256:0)]]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};24576&i[0]&&(n.height=t[14]-(t[13]?.getBoundingClientRect()?.bottom+10)),262144&i[0]&&(n.itemCount=t[18].length),262144&i[0]|8388992&i[3]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_item_slot(t){let e,i,n,o;get_context(t);const s=[t[102],{title:t[102].name},{bold:t[102].isWorld},{compact:!0}];let r={};for(let t=0;t<s.length;t+=1)r=assign(r,s[t]);return i=new ListItem({props:r}),i.$on("shiftClick",(function(){return t[51](t[102])})),i.$on("click",(function(){return t[52](t[102])})),i.$on("middleClick",t[53]),{c(){e=element("div"),create_component(i.$$.fragment),attr(e,"slot","item"),attr(e,"style",n=t[100])},m(t,n){insert(t,e,n),mount_component(i,e,null),o=!0},p(r,a){get_context(t=r);const l=262144&a[0]|256&a[3]?get_spread_update(s,[get_spread_object(t[102]),{title:t[102].name},{bold:t[102].isWorld},s[3]]):{};i.$set(l),(!o||128&a[3]&&n!==(n=t[100]))&&attr(e,"style",n)},i(t){o||(transition_in(i.$$.fragment,t),o=!0)},o(t){transition_out(i.$$.fragment,t),o=!1},d(t){t&&detach(e),destroy_component(i)}}}function create_key_block(t){let e,i,n,o;const s=[create_if_block_2$1,create_else_block],r=[];function a(t,e){return t[18].length>0?0:1}return e=a(t),i=r[e]=s[e](t),{c(){i.c(),n=empty()},m(t,i){r[e].m(t,i),insert(t,n,i),o=!0},p(t,o){let l=e;e=a(t),e===l?r[e].p(t,o):(group_outros(),transition_out(r[l],1,1,(()=>{r[l]=null})),check_outros(),i=r[e],i?i.p(t,o):(i=r[e]=s[e](t),i.c()),transition_in(i,1),i.m(n.parentNode,n))},i(t){o||(transition_in(i),o=!0)},o(t){transition_out(i),o=!1},d(t){r[e].d(t),t&&detach(n)}}}function create_default_slot_2$1(t){let e;return{c(){e=text("Are you sure you want to discard your unsaved changes? This can't be undone.")},m(t,i){insert(t,e,i)},d(t){t&&detach(e)}}}function create_default_slot_1$1(t){let e,i,n;return{c(){e=text("Are you sure you want to load an older revision of this "),i=text(t[22]),n=text("? This will replace your current edits.")},m(t,o){insert(t,e,o),insert(t,i,o),insert(t,n,o)},p(t,e){4194304&e[0]&&set_data(i,t[22])},d(t){t&&detach(e),t&&detach(i),t&&detach(n)}}}function create_default_slot$1(t){let e,i,n,o,s,r;return{c(){e=text("Are you sure you want to delete this "),i=text(t[22]),n=text("? This can't be undone.\n        "),o=element("br"),s=space(),r=element("small"),r.innerHTML='<b style="font-size: 0.8rem;" class="svelte-ru701">Tip:</b> Hold <code>Shift</code> while deleting to skip this message.',set_style(r,"color","var(--text_low_emphasis)")},m(t,a){insert(t,e,a),insert(t,i,a),insert(t,n,a),insert(t,o,a),insert(t,s,a),insert(t,r,a)},p(t,e){4194304&e[0]&&set_data(i,t[22])},d(t){t&&detach(e),t&&detach(i),t&&detach(n),t&&detach(o),t&&detach(s),t&&detach(r)}}}function create_fragment$2(t){let e,i,n,o,s,r,a,l,c;add_render_callback(t[44]);let h=t[0]&&create_if_block$1(t);i=new Dialog({props:{title:"Discard changes?",confirm:!0,$$slots:{default:[create_default_slot_2$1]},$$scope:{ctx:t}}}),t[88](i),o=new Dialog({props:{title:"Load older revision?",dismissible:!1,confirm:!0,$$slots:{default:[create_default_slot_1$1]},$$scope:{ctx:t}}}),t[89](o);let u={title:"Delete "+t[22]+"?",dismissible:!1,confirm:!0,$$slots:{default:[create_default_slot$1]},$$scope:{ctx:t}};return r=new Dialog({props:u}),t[90](r),r.$on("confirm",t[91]),{c(){h&&h.c(),e=space(),create_component(i.$$.fragment),n=space(),create_component(o.$$.fragment),s=space(),create_component(r.$$.fragment)},m(u,d){h&&h.m(u,d),insert(u,e,d),mount_component(i,u,d),insert(u,n,d),mount_component(o,u,d),insert(u,s,d),mount_component(r,u,d),a=!0,l||(c=[listen(window_1$1,"resize",t[43]),listen(window_1$1,"mouseup",t[28]),listen(window_1$1,"keyup",t[39]),listen(window_1$1,"resize",t[44])],l=!0)},p(t,n){t[0]?h?(h.p(t,n),1&n[0]&&transition_in(h,1)):(h=create_if_block$1(t),h.c(),transition_in(h,1),h.m(e.parentNode,e)):h&&(group_outros(),transition_out(h,1,1,(()=>{h=null})),check_outros());const s={};8388608&n[3]&&(s.$$scope={dirty:n,ctx:t}),i.$set(s);const a={};4194304&n[0]|8388608&n[3]&&(a.$$scope={dirty:n,ctx:t}),o.$set(a);const l={};4194304&n[0]&&(l.title="Delete "+t[22]+"?"),4194304&n[0]|8388608&n[3]&&(l.$$scope={dirty:n,ctx:t}),r.$set(l)},i(t){a||(transition_in(h),transition_in(i.$$.fragment,t),transition_in(o.$$.fragment,t),transition_in(r.$$.fragment,t),a=!0)},o(t){transition_out(h),transition_out(i.$$.fragment,t),transition_out(o.$$.fragment,t),transition_out(r.$$.fragment,t),a=!1},d(a){h&&h.d(a),a&&detach(e),t[88](null),destroy_component(i,a),a&&detach(n),t[89](null),destroy_component(o,a),a&&detach(s),t[90](null),destroy_component(r,a),l=!1,run_all(c)}}}const ANIMATION_DURATION=350,MIN_PANEL_WIDTH=350,MAX_PANEL_WIDTH=700,DEBOUNCE_AMOUNT=75;function instance$1($$self,$$props,$$invalidate){let isLocation,isWorld,objectType,isEditing,name,editType,PANEL_WIDTH=getPrefs("editpanelwidth",400);const RESIZE_OBSERVER=new ResizeObserver((()=>{window.dispatchEvent(new Event("resize"))}));let{shown:shown=!1}=$$props,editPanel,editPanelContent,editor,editorWindow,overlay=null,saveButton,refreshTitleBar,innerHeight,discardDialog,deleteDialog,revertDialog,recentChanges=[],editHistory=[],currentZoom=gamemap.getCurrentZoom()?.toFixed(3),liveEdit=!1,directEdit=null,unsavedChanges=!1,editObject=null,modEditObject=null,timer;function edit(t){show(t),$$invalidate(11,overlay=null)}function dismiss(){show(!1),window.onbeforeunload=null}function show(t){(t=null==t||t)?(null==directEdit&&(!shown&&t&&(1==t?$$invalidate(21,directEdit=!1):1!=t&&$$invalidate(21,directEdit=!0)),print("direct edit is: "+directEdit)),$$invalidate(0,shown=!0),setTimeout((function(){RESIZE_OBSERVER.observe(editPanel),0==recentChanges.length&&getRecentChanges()}),1),1!=t&&null==editObject?initEditor(t):1!=t&&editObject&&(unsavedChanges?discardDialog.showWithCallback((e=>{"confirm"==e&&initEditor(t)})):initEditor(t))):($$invalidate(0,shown=!1),$$invalidate(3,editObject=null),$$invalidate(21,directEdit=null))}function back(t){t=null!=t&&t,isEditing?(unsavedChanges&&!t&&discardDialog.showWithCallback((t=>{print(t),"confirm"==t&&back(!0)})),!t&&unsavedChanges||cancel()):dismiss()}function onResizerDown(){document.addEventListener("mousemove",onResizerDrag)}function onResizerUp(){document.removeEventListener("mousemove",onResizerDrag)}function onResizerDrag(t){let e=window.innerWidth-t.pageX;e=e<MIN_PANEL_WIDTH?MIN_PANEL_WIDTH:e,e<MAX_PANEL_WIDTH&&($$invalidate(7,editPanel.style.width=`${e}px`,editPanel),$$invalidate(7,editPanel.style.maxWidth=`${e}px`,editPanel),setPrefs("editpanelwidth",e),PANEL_WIDTH=getPrefs("editpanelwidth",480))}function slide(){return gamemap.getMapObject().invalidateSize(),{duration:ANIMATION_DURATION,easing:cubicInOut,css:t=>(1==t&&$$invalidate(7,editPanel.style.width=`${PANEL_WIDTH}px`,editPanel),`width: ${PANEL_WIDTH*t}px; opacity: ${t};)`)}}function initEditor(t){cleanUp(),$$invalidate(3,editObject=deepClone(t)),$$invalidate(4,modEditObject=deepClone(t)),$$invalidate(6,isLocation=editObject instanceof Location),$$invalidate(5,isWorld=editObject instanceof World),setTimeout((()=>{liveEdit=!0}),10),editObject.unsavedLocation||getEditHistory(editObject),editObject.setEditing(!0),modEditObject.setEditing(!0),isWorld&&editObject.id==gamemap.getCurrentWorld().id?(gamemap.reset(!0,30),gamemap.setMapLock(MAPLOCK.FULL)):isLocation&&(gamemap.setMapLock(modEditObject.isPolygon()?MAPLOCK.PARTIAL_POLYGON:MAPLOCK.PARTIAL_MARKER),gamemap.updateLocation(modEditObject))}function doDelete(t){if(t=null!=t&&t){print(`deleting ${objectType}...`),isLocation&&gamemap.deleteLocation(modEditObject),isWorld&&gamemap.deleteWorld(modEditObject);let t=queryify(objectify(modEditObject.getDeleteQuery()));getJSON(GAME_DATA_SCRIPT+t).then((()=>getRecentChanges())),cancel()}else deleteDialog.show()}function loadRevision(t,e){e=null!=e&&e,t.rev.id=0!=t.rev.locationId?t.rev.locationId:t.rev.worldId,t.rev.revertId=t.rev.revisionId;let i=t.isWorld?new World(t.rev):new Location(t.rev);print(i),i.revisionID!=editObject.revisionID?unsavedChanges&&!e?revertDialog.showWithCallback((e=>{"confirm"==e&&loadRevision(t,!0)})):unsavedChanges&&!e||(gamemap.getMap().pm.disableDraw(),gamemap.getMap().pm.disableGlobalEditMode(),i.editing=!0,$$invalidate(4,modEditObject=deepClone(i)),$$invalidate(2,unsavedChanges=!1),modify()):modEditObject.revisionID==i.revisionID?M.toast({html:"That is the current revision!"}):($$invalidate(4,modEditObject=deepClone(editObject)),$$invalidate(2,unsavedChanges=!1),modify())}function doSave(){let t=null!=modEditObject.revertID;print(`${t?"Reverting":"Saving"} ${objectType}...`);let e=objectify(t?modEditObject.getRevertQuery():modEditObject.getSaveQuery());saveButton.$set({text:""+(t?"Reverting...":"Saving..."),icon:"loading",loading:!0}),print(e),getJSON((GAME_DATA_SCRIPT+queryify(e)).replace(/=\s*$/,"")).then((e=>{e?.isError?(print(e.errorMsg),saveButton.$set({text:e.errorMsg.includes("permissions")?"Insufficient permissions!":e.errorMsg,icon:"warning",type:"warning"}),setTimeout((()=>{saveButton.$set({text:t?"Revert":"Save",type:t?"revert":"save",icon:t?"history":"save"})}),3e3)):(modEditObject?.unsavedLocation?(gamemap.deleteLocation(modEditObject),modify("unsavedLocation",!1),modify("id",e.newLocId)):t&&(modify("revertID",null),isLocation&&(gamemap.deleteLocation(modEditObject),modify("wasVisible",modEditObject?.isVisible()))),modify("revisionID",e?.newRevisionId),$$invalidate(3,editObject=deepClone(modEditObject)),isLocation&&gamemap.updateLocation(editObject),isWorld&&(gamemap.updateWorld(editObject),getWorldLists()),getRecentChanges(),$$invalidate(2,unsavedChanges=!1),saveButton.$set({text:"Save",type:"save",icon:"save"}),cancel())})).catch((()=>saveButton.$set({text:`Error saving ${objectType}!`,icon:"warning"})))}function addNewLocation(t){$$invalidate(11,overlay=t),gamemap.addLocation(t)}function cleanUp(){editObject&&(editObject.setEditing(!1),isWorld?(gamemap.reset(!0),gamemap.updateWorld(editObject)):isLocation&&(editObject?.unsavedLocation?gamemap.deleteLocation(editObject):gamemap.getCurrentWorld().locations.get(editObject.id)&&gamemap.updateLocation(editObject))),$$invalidate(19,editHistory=[]),$$invalidate(11,overlay=null),$$invalidate(3,editObject=null),$$invalidate(4,modEditObject=null),liveEdit=!1,$$invalidate(2,unsavedChanges=!1),gamemap.setMapLock(MAPLOCK.NONE),gamemap.getMap().pm.disableDraw(),gamemap.getMap().pm.disableGlobalEditMode(),Array.from(document.querySelectorAll("[class*='editing']")).forEach((t=>{t.classList.remove("editing")})),window.onbeforeunload=null,gamemap.getMap().closePopup()}function cancel(){if(cleanUp(),directEdit)directEdit&&dismiss();else{let t=setInterval((()=>{let e=document.getElementsByClassName("virtual-list-wrapper")?.[0];if(e?.clientHeight>=1e3&&e.children[0].childElementCount<=4){let t=recentChanges;$$invalidate(18,recentChanges=[]),$$invalidate(18,recentChanges=t)}else clearInterval(t)}),1)}}function modify(t,e){liveEdit&&($$invalidate(4,modEditObject),$$invalidate(3,editObject),t&&(print(`editing ${t} with value ${e}`),$$invalidate(4,modEditObject[t]=e,modEditObject),print("before edit"),print(editObject),print("after edit"),print(modEditObject)),$$invalidate(2,unsavedChanges=!modEditObject.revertID&&!modEditObject.unsavedLocation&&!(JSON.stringify(modEditObject)===JSON.stringify(editObject))),gamemap.setMapLock(isWorld?MAPLOCK.FULL:modEditObject.revertID?MAPLOCK.PARTIAL:modEditObject.isPolygon()?MAPLOCK.PARTIAL_POLYGON:MAPLOCK.PARTIAL_MARKER),null!=timer&&clearTimeout(timer),timer=setTimeout((()=>{isLocation&&gamemap.updateLocation(modEditObject),isWorld&&gamemap.updateWorld(modEditObject)}),DEBOUNCE_AMOUNT))}function fillFromTemplate(template){print("printing template"),print(template);for(let[key,value]of Object.entries(template))key?.startsWith("$")||(isNaN(value)&&value.startsWith("$")?modify(key,eval(value.substring(1))):modify(key,value));modify("acceptedSuggestion",!0)}function getRecentChanges(){print("getting recent changes..."),$$invalidate(18,recentChanges=[]);let t={action:"get_fullrc"};t.db=MAPCONFIG.database,getJSON(GAME_DATA_SCRIPT+queryify(t)).then((t=>{print("parsing data...");let e=[];print(t);for(let i=0;i<t.recentChanges.length;i++)e.push(getRCItem(t.recentChanges[i]));$$invalidate(18,recentChanges=e),print("got recent changes: "),print(recentChanges)}))}function getEditHistory(t){$$invalidate(19,editHistory=[]);let e=isWorld?"world":"loc",i=editObject;getJSON(GAME_DATA_SCRIPT+`?db=${MAPCONFIG.database}&action=get_${e}rev&${e}id=${t.id}`).then((t=>{i==editObject&&$$invalidate(19,editHistory=t.revisions?Object.values(t.revisions):[])}))}function getRCItem(t){let e=null!=t.displayName||null!=t.cellSize,i=e?t.worldId:-t.locationId;return{icon:0!=t.iconType&&t.iconType?MAPCONFIG.iconPath+t.iconType+".png":e?"public":"location_on",editID:t.id,user:t.editUserText,timestamp:t.editTimestamp,destinationID:i,name:e?t.worldDisplayName??(t.displayName?t.displayName:gamemap.getWorldDisplayNameFromID(t.worldId)):t.locationName??t.name,comment:t.editComment,action:t.editAction,worldID:t.worldId,isWorld:e,subtitle:e?null:t.worldDisplayName??gamemap.getWorldDisplayNameFromID(t.worldId),rev:t}}function onKeyPressed(t){"Escape"==t.key&&(overlay?cancel():back())}function fixEditor(){$$invalidate(9,editor.style.height=`${editor?.parentElement?.clientHeight}px`,editor),$$invalidate(10,editorWindow.scrollTop=0,editorWindow)}onMount((()=>{window.onpopstate=()=>$$invalidate(20,currentZoom=gamemap.getCurrentZoom().toFixed(3))})),window.updateMarkerCoords=function(t){modify("coords",t)};const resize_handler=()=>{null!=editPanel&&$$invalidate(8,editPanelContent.style.height=document.querySelector(".appbar")?editPanel.clientHeight-document.querySelector(".appbar").clientHeight+"px":null,editPanelContent),editor&&$$invalidate(9,editor.style.height=`${editor?.parentElement?.clientHeight}px`,editor)};function onwindowresize(){$$invalidate(14,innerHeight=window_1$1.innerHeight)}const back_handler=()=>back(),click_handler=()=>addNewLocation(LOCTYPES.MARKER),click_handler_1=()=>addNewLocation(LOCTYPES.PATH),click_handler_2=()=>addNewLocation(LOCTYPES.AREA),click_handler_3=()=>edit(gamemap.getCurrentWorld());function div2_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{refreshTitleBar=t,$$invalidate(13,refreshTitleBar)}))}const shiftClick_handler=t=>gamemap.edit(t.destinationID),click_handler_4=t=>gamemap.goto(t.destinationID),middleClick_handler=t=>{window.open(`${location.origin}${location.pathname}?${t.detail>0?`world=${t.detail}`:`centeron=${Math.abs(t.detail)}`}`)},confirm_handler=t=>fillFromTemplate(t),change_handler=t=>{modEditObject.linkWikiPage()&&modify("wikiPage",t.detail),modify(isWorld?"displayName":"name",t.detail)},change_handler_1=t=>modify("parentID",t.detail),change_handler_2=t=>modify("destinationID",t.detail),change_handler_3=t=>modify("icon",t.detail),change_handler_4=t=>{t.detail==name?modify("wikiPage",`${t.detail} `):modify("wikiPage",t.detail)},change_handler_5=t=>{t.detail?modify("wikiPage",name):modify("wikiPage","")},change_handler_6=t=>{modify("labelPos",Number(t.detail))},change_handler_7=t=>modify("description",t.detail),change_handler_8=t=>modify("minZoomLevel",t.detail),change_handler_9=t=>modify("maxZoomLevel",t.detail),change_handler_10=t=>modify("minX",t.detail),change_handler_11=t=>modify("maxX",t.detail),change_handler_12=t=>modify("minY",t.detail),change_handler_13=t=>modify("maxY",t.detail),change_handler_14=t=>modify("fillColour",t.detail),change_handler_15=t=>modify("fillColourHover",t.detail),change_handler_16=t=>modify("strokeColour",t.detail),change_handler_17=t=>modify("strokeColourHover",t.detail),change_handler_18=t=>modify("strokeWidth",t.detail),change_handler_19=t=>modify("strokeWidthHover",t.detail),change_handler_20=t=>modify("displayLevel",t.detail),click_handler_5=t=>loadRevision(t),func_1=t=>LOCTYPES[t]===modEditObject.locType,func_2=t=>COORD_TYPES[t]===MAPCONFIG.coordType;function div1_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{editorWindow=t,$$invalidate(10,editorWindow)}))}function button0_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{saveButton=t,$$invalidate(12,saveButton)}))}const click_handler_6=()=>doSave(),click_handler_7=()=>back(),click_handler_8=()=>doDelete(),shiftClick_handler_1=()=>doDelete(!0);function div4_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{editor=t,$$invalidate(9,editor)}))}function div1_binding_1(t){binding_callbacks[t?"unshift":"push"]((()=>{editPanelContent=t,$$invalidate(8,editPanelContent)}))}function aside_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{editPanel=t,$$invalidate(7,editPanel)}))}function dialog0_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{discardDialog=t,$$invalidate(15,discardDialog)}))}function dialog1_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{revertDialog=t,$$invalidate(17,revertDialog)}))}function dialog2_binding(t){binding_callbacks[t?"unshift":"push"]((()=>{deleteDialog=t,$$invalidate(16,deleteDialog)}))}const confirm_handler_1=()=>doDelete(!0);return $$self.$$set=t=>{"shown"in t&&$$invalidate(0,shown=t.shown)},$$self.$$.update=()=>{8&$$self.$$.dirty[0]&&$$invalidate(6,isLocation=editObject instanceof Location),8&$$self.$$.dirty[0]&&$$invalidate(5,isWorld=editObject instanceof World),32&$$self.$$.dirty[0]&&$$invalidate(22,objectType=isWorld?"world":"location"),104&$$self.$$.dirty[0]&&$$invalidate(23,isEditing=editObject&&isLocation||isWorld),48&$$self.$$.dirty[0]&&$$invalidate(25,name=isWorld?modEditObject?.displayName:modEditObject?.name),16&$$self.$$.dirty[0]&&$$invalidate(24,editType=modEditObject?.revertID?EDIT_TYPES.REVERT:modEditObject?.id>0?EDIT_TYPES.EDIT:EDIT_TYPES.ADD),12&$$self.$$.dirty[0]&&(window.onbeforeunload=unsavedChanges||editObject?.unsavedLocation?function(){return""}:null)},[shown,edit,unsavedChanges,editObject,modEditObject,isWorld,isLocation,editPanel,editPanelContent,editor,editorWindow,overlay,saveButton,refreshTitleBar,innerHeight,discardDialog,deleteDialog,revertDialog,recentChanges,editHistory,currentZoom,directEdit,objectType,isEditing,editType,name,back,onResizerDown,onResizerUp,slide,doDelete,loadRevision,doSave,addNewLocation,cancel,modify,fillFromTemplate,getRecentChanges,getRCItem,onKeyPressed,fixEditor,dismiss,show,resize_handler,onwindowresize,back_handler,click_handler,click_handler_1,click_handler_2,click_handler_3,div2_binding,shiftClick_handler,click_handler_4,middleClick_handler,confirm_handler,change_handler,change_handler_1,change_handler_2,change_handler_3,change_handler_4,change_handler_5,change_handler_6,change_handler_7,change_handler_8,change_handler_9,change_handler_10,change_handler_11,change_handler_12,change_handler_13,change_handler_14,change_handler_15,change_handler_16,change_handler_17,change_handler_18,change_handler_19,change_handler_20,click_handler_5,func_1,func_2,div1_binding,button0_binding,click_handler_6,click_handler_7,click_handler_8,shiftClick_handler_1,div4_binding,div1_binding_1,aside_binding,dialog0_binding,dialog1_binding,dialog2_binding,confirm_handler_1]}class Editor extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$2,safe_not_equal,{shown:0,edit:1,dismiss:41,show:42},null,[-1,-1,-1,-1])}get shown(){return this.$$.ctx[0]}set shown(t){this.$$set({shown:t}),flush()}get edit(){return this.$$.ctx[1]}get dismiss(){return this.$$.ctx[41]}get show(){return this.$$.ctx[42]}}function create_fragment$1(t){let e,i,n,o;return{c(){e=element("div"),i=space(),n=element("script"),attr(e,"id",(MAPCONFIG.altAdDivID??MAPCONFIG.adScriptName)+"_"+(isMobile?"M_1":"D_1")),set_style(e,"pointer-events","visible"),attr(e,"class","svelte-943q39"),toggle_class(e,"mobile",isMobile),src_url_equal(n.src,o="https://lngtd.com/"+MAPCONFIG.adScriptName+".js")||attr(n,"src",o)},m(t,o){insert(t,e,o),insert(t,i,o),append(document.head,n)},p(t,[e]){0},i:noop,o:noop,d(t){t&&detach(e),t&&detach(i),detach(n)}}}class AdComponent extends SvelteComponent{constructor(t){super(),init(this,t,null,create_fragment$1,safe_not_equal,{})}}
/* @preserve
     * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
     * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
     */var leafletSrc=createCommonjsModule((function(t,e){!function(t){var e="1.9.4";function i(t){var e,i,n,o;for(i=1,n=arguments.length;i<n;i++)for(e in o=arguments[i])t[e]=o[e];return t}var n=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function o(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}var s=0;function r(t){return"_leaflet_id"in t||(t._leaflet_id=++s),t._leaflet_id}function a(t,e,i){var n,o,s,r;return r=function(){n=!1,o&&(s.apply(i,o),o=!1)},s=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(r,e),n=!0)},s}function l(t,e,i){var n=e[1],o=e[0],s=n-o;return t===n&&i?t:((t-o)%s+s)%s+o}function c(){return!1}function h(t,e){if(!1===e)return t;var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function d(t){return u(t).split(/\s+/)}function p(t,e){for(var i in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?n(t.options):{}),e)t.options[i]=e[i];return t.options}function _(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}var m=/\{ *([\w_ -]+) *\}/g;function f(t,e){return t.replace(m,(function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n}))}var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function y(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var v="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function b(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var k=0;function w(t){var e=+new Date,i=Math.max(0,16-(e-k));return k=e+i,window.setTimeout(t,i)}var x=window.requestAnimationFrame||b("RequestAnimationFrame")||w,$=window.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function C(t,e,i){if(!i||x!==w)return x.call(window,o(t,e));t.call(e)}function M(t){t&&$.call(window,t)}var E={__proto__:null,extend:i,create:n,bind:o,get lastId(){return s},stamp:r,throttle:a,wrapNum:l,falseFn:c,formatNum:h,trim:u,splitWords:d,setOptions:p,getParamString:_,template:f,isArray:g,indexOf:y,emptyImageUrl:v,requestFn:x,cancelFn:$,requestAnimFrame:C,cancelAnimFrame:M};function T(){}function P(t){if("undefined"!=typeof L&&L&&L.Mixin){t=g(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}T.extend=function(t){var e=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},o=e.__super__=this.prototype,s=n(o);for(var r in s.constructor=e,e.prototype=s,this)Object.prototype.hasOwnProperty.call(this,r)&&"prototype"!==r&&"__super__"!==r&&(e[r]=this[r]);return t.statics&&i(e,t.statics),t.includes&&(P(t.includes),i.apply(null,[s].concat(t.includes))),i(s,t),delete s.statics,delete s.includes,s.options&&(s.options=o.options?n(o.options):{},i(s.options,t.options)),s._initHooks=[],s.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=s._initHooks.length;t<e;t++)s._initHooks[t].call(this)}},e},T.include=function(t){var e=this.prototype.options;return i(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},T.mergeOptions=function(t){return i(this.prototype.options,t),this},T.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var S={on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var o=0,s=(t=d(t)).length;o<s;o++)this._on(t[o],e,i);return this},off:function(t,e,i){if(arguments.length)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=d(t);for(var o=1===arguments.length,s=0,r=t.length;s<r;s++)o?this._off(t[s]):this._off(t[s],e,i)}else delete this._events;return this},_on:function(t,e,i,n){if("function"==typeof e){if(!1===this._listens(t,e,i)){i===this&&(i=void 0);var o={fn:e,ctx:i};n&&(o.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(o)}}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,i){var n,o,s;if(this._events&&(n=this._events[t]))if(1!==arguments.length)if("function"==typeof e){var r=this._listens(t,e,i);if(!1!==r){var a=n[r];this._firingCount&&(a.fn=c,this._events[t]=n=n.slice()),n.splice(r,1)}}else console.warn("wrong listener type: "+typeof e);else{if(this._firingCount)for(o=0,s=n.length;o<s;o++)n[o].fn=c;delete this._events[t]}},fire:function(t,e,n){if(!this.listens(t,n))return this;var o=i({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var s=this._events[t];if(s){this._firingCount=this._firingCount+1||1;for(var r=0,a=s.length;r<a;r++){var l=s[r],c=l.fn;l.once&&this.off(t,c,l.ctx),c.call(l.ctx||this,o)}this._firingCount--}}return n&&this._propagateEvent(o),this},listens:function(t,e,i,n){"string"!=typeof t&&console.warn('"string" type argument expected');var o=e;"function"!=typeof e&&(n=!!e,o=void 0,i=void 0);var s=this._events&&this._events[t];if(s&&s.length&&!1!==this._listens(t,o,i))return!0;if(n)for(var r in this._eventParents)if(this._eventParents[r].listens(t,e,i,n))return!0;return!1},_listens:function(t,e,i){if(!this._events)return!1;var n=this._events[t]||[];if(!e)return!!n.length;i===this&&(i=void 0);for(var o=0,s=n.length;o<s;o++)if(n[o].fn===e&&n[o].ctx===i)return o;return!1},once:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e,!0);else for(var o=0,s=(t=d(t)).length;o<s;o++)this._on(t[o],e,i,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[r(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[r(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,i({layer:t.target,propagatedFrom:t.target},t),!0)}};S.addEventListener=S.on,S.removeEventListener=S.clearAllEventListeners=S.off,S.addOneTimeEventListener=S.once,S.fireEvent=S.fire,S.hasEventListeners=S.listens;var O=T.extend(S);function D(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var I=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function B(t,e,i){return t instanceof D?t:g(t)?new D(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new D(t.x,t.y):new D(t,e,i)}function R(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])}function A(t,e){return!t||t instanceof R?t:new R(t,e)}function N(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])}function z(t,e){return t instanceof N?t:new N(t,e)}function j(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function F(t,e,i){return t instanceof j?t:g(t)&&"object"!=typeof t[0]?3===t.length?new j(t[0],t[1],t[2]):2===t.length?new j(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new j(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new j(t,e,i)}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(t){return this.clone()._add(B(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(B(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new D(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new D(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=I(this.x),this.y=I(this.y),this},distanceTo:function(t){var e=(t=B(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=B(t)).x===this.x&&t.y===this.y},contains:function(t){return t=B(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+h(this.x)+", "+h(this.y)+")"}},R.prototype={extend:function(t){var e,i;if(!t)return this;if(t instanceof D||"number"==typeof t[0]||"x"in t)e=i=B(t);else if(e=(t=A(t)).min,i=t.max,!e||!i)return this;return this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(i.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(i.y,this.max.y)):(this.min=e.clone(),this.max=i.clone()),this},getCenter:function(t){return B((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return B(this.min.x,this.max.y)},getTopRight:function(){return B(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof D?B(t):A(t))instanceof R?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=A(t);var e=this.min,i=this.max,n=t.min,o=t.max,s=o.x>=e.x&&n.x<=i.x,r=o.y>=e.y&&n.y<=i.y;return s&&r},overlaps:function(t){t=A(t);var e=this.min,i=this.max,n=t.min,o=t.max,s=o.x>e.x&&n.x<i.x,r=o.y>e.y&&n.y<i.y;return s&&r},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,i=this.max,n=Math.abs(e.x-i.x)*t,o=Math.abs(e.y-i.y)*t;return A(B(e.x-n,e.y-o),B(i.x+n,i.y+o))},equals:function(t){return!!t&&(t=A(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},N.prototype={extend:function(t){var e,i,n=this._southWest,o=this._northEast;if(t instanceof j)e=t,i=t;else{if(!(t instanceof N))return t?this.extend(F(t)||z(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||o?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),o.lat=Math.max(i.lat,o.lat),o.lng=Math.max(i.lng,o.lng)):(this._southWest=new j(e.lat,e.lng),this._northEast=new j(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new N(new j(e.lat-n,e.lng-o),new j(i.lat+n,i.lng+o))},getCenter:function(){return new j((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new j(this.getNorth(),this.getWest())},getSouthEast:function(){return new j(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof j||"lat"in t?F(t):z(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof N?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=z(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>=e.lat&&n.lat<=i.lat,r=o.lng>=e.lng&&n.lng<=i.lng;return s&&r},overlaps:function(t){t=z(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>e.lat&&n.lat<i.lat,r=o.lng>e.lng&&n.lng<i.lng;return s&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=z(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},j.prototype={equals:function(t,e){return!!t&&(t=F(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+h(this.lat,t)+", "+h(this.lng,t)+")"},distanceTo:function(t){return H.distance(this,F(t))},wrap:function(){return H.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return z([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new j(this.lat,this.lng,this.alt)}};var W,G={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new R(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new j(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,o=e.lng-i.lng;if(0===n&&0===o)return t;var s=t.getSouthWest(),r=t.getNorthEast();return new N(new j(s.lat-n,s.lng-o),new j(r.lat-n,r.lng-o))}},H=i({},G,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,s=Math.sin((e.lat-t.lat)*i/2),r=Math.sin((e.lng-t.lng)*i/2),a=s*s+Math.cos(n)*Math.cos(o)*r*r,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),Z=6378137,U={R:Z,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=Math.sin(n*e);return new D(this.R*t.lng*e,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var e=180/Math.PI;return new j((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(W=Z*Math.PI,new R([-W,-W],[W,W]))};function q(t,e,i,n){if(g(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function V(t,e,i,n){return new q(t,e,i,n)}q.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new D((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var Y=i({},H,{code:"EPSG:3857",projection:U,transformation:function(){var t=.5/(Math.PI*U.R);return V(t,.5,-t,.5)}()}),K=i({},Y,{code:"EPSG:900913"});function X(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function J(t,e){var i,n,o,s,r,a,l="";for(i=0,o=t.length;i<o;i++){for(n=0,s=(r=t[i]).length;n<s;n++)l+=(n?"L":"M")+(a=r[n]).x+" "+a.y;l+=e?Nt.svg?"z":"x":""}return l||"M0 0"}var Q,tt=document.documentElement.style,et="ActiveXObject"in window,it=et&&!document.addEventListener,nt="msLaunchUri"in navigator&&!("documentMode"in document),ot=At("webkit"),st=At("android"),rt=At("android 2")||At("android 3"),at=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),lt=st&&At("Google")&&at<537&&!("AudioNode"in window),ct=!!window.opera,ht=!nt&&At("chrome"),ut=At("gecko")&&!ot&&!ct&&!et,dt=!ht&&At("safari"),pt=At("phantom"),_t="OTransition"in tt,mt=0===navigator.platform.indexOf("Win"),ft=et&&"transition"in tt,gt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rt,yt="MozPerspective"in tt,vt=!window.L_DISABLE_3D&&(ft||gt||yt)&&!_t&&!pt,bt="undefined"!=typeof orientation||At("mobile"),kt=bt&&ot,wt=bt&&gt,Lt=!window.PointerEvent&&window.MSPointerEvent,xt=!(!window.PointerEvent&&!Lt),$t="ontouchstart"in window||!!window.TouchEvent,Ct=!window.L_NO_TOUCH&&($t||xt),Mt=bt&&ct,Et=bt&&ut,Tt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Pt=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",c,e),window.removeEventListener("testPassiveEventSupport",c,e)}catch(t){}return t}(),St=!!document.createElement("canvas").getContext,Ot=!(!document.createElementNS||!X("svg").createSVGRect),Dt=!!Ot&&((Q=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(Q.firstChild&&Q.firstChild.namespaceURI)),It=!Ot&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),Bt=0===navigator.platform.indexOf("Mac"),Rt=0===navigator.platform.indexOf("Linux");function At(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Nt={ie:et,ielt9:it,edge:nt,webkit:ot,android:st,android23:rt,androidStock:lt,opera:ct,chrome:ht,gecko:ut,safari:dt,phantom:pt,opera12:_t,win:mt,ie3d:ft,webkit3d:gt,gecko3d:yt,any3d:vt,mobile:bt,mobileWebkit:kt,mobileWebkit3d:wt,msPointer:Lt,pointer:xt,touch:Ct,touchNative:$t,mobileOpera:Mt,mobileGecko:Et,retina:Tt,passiveEvents:Pt,canvas:St,svg:Ot,vml:It,inlineSvg:Dt,mac:Bt,linux:Rt},zt=Nt.msPointer?"MSPointerDown":"pointerdown",jt=Nt.msPointer?"MSPointerMove":"pointermove",Ft=Nt.msPointer?"MSPointerUp":"pointerup",Wt=Nt.msPointer?"MSPointerCancel":"pointercancel",Gt={touchstart:zt,touchmove:jt,touchend:Ft,touchcancel:Wt},Ht={touchstart:te,touchmove:Qt,touchend:Qt,touchcancel:Qt},Zt={},Ut=!1;function qt(t,e,i){return"touchstart"===e&&Jt(),Ht[e]?(i=Ht[e].bind(this,i),t.addEventListener(Gt[e],i,!1),i):(console.warn("wrong event specified:",e),c)}function Vt(t,e,i){Gt[e]?t.removeEventListener(Gt[e],i,!1):console.warn("wrong event specified:",e)}function Yt(t){Zt[t.pointerId]=t}function Kt(t){Zt[t.pointerId]&&(Zt[t.pointerId]=t)}function Xt(t){delete Zt[t.pointerId]}function Jt(){Ut||(document.addEventListener(zt,Yt,!0),document.addEventListener(jt,Kt,!0),document.addEventListener(Ft,Xt,!0),document.addEventListener(Wt,Xt,!0),Ut=!0)}function Qt(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var i in e.touches=[],Zt)e.touches.push(Zt[i]);e.changedTouches=[e],t(e)}}function te(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&Ye(e),Qt(t,e)}function ee(t){var e,i,n={};for(i in t)e=t[i],n[i]=e&&e.bind?e.bind(t):e;return t=n,n.type="dblclick",n.detail=2,n.isTrusted=!1,n._simulated=!0,n}var ie=200;function ne(t,e){t.addEventListener("dblclick",e);var i,n=0;function o(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var o=Xe(t);if(!o.some((function(t){return t instanceof HTMLLabelElement&&t.attributes.for}))||o.some((function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement}))){var s=Date.now();s-n<=ie?2==++i&&e(ee(t)):i=1,n=s}}}else i=t.detail}return t.addEventListener("click",o),{dblclick:e,simDblclick:o}}function oe(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var se,re,ae,le,ce,he=Me(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ue=Me(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),de="webkitTransition"===ue||"OTransition"===ue?ue+"End":"transitionend";function pe(t){return"string"==typeof t?document.getElementById(t):t}function _e(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function me(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function fe(t){var e=t.parentNode;e&&e.removeChild(t)}function ge(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ye(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function ve(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function be(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=xe(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function ke(t,e){if(void 0!==t.classList)for(var i=d(e),n=0,o=i.length;n<o;n++)t.classList.add(i[n]);else if(!be(t,e)){var s=xe(t);Le(t,(s?s+" ":"")+e)}}function we(t,e){void 0!==t.classList?t.classList.remove(e):Le(t,u((" "+xe(t)+" ").replace(" "+e+" "," ")))}function Le(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function xe(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function $e(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&Ce(t,e)}function Ce(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}function Me(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function Ee(t,e,i){var n=e||new D(0,0);t.style[he]=(Nt.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function Te(t,e){t._leaflet_pos=e,Nt.any3d?Ee(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Pe(t){return t._leaflet_pos||new D(0,0)}if("onselectstart"in document)se=function(){ze(window,"selectstart",Ye)},re=function(){Fe(window,"selectstart",Ye)};else{var Se=Me(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);se=function(){if(Se){var t=document.documentElement.style;ae=t[Se],t[Se]="none"}},re=function(){Se&&(document.documentElement.style[Se]=ae,ae=void 0)}}function Oe(){ze(window,"dragstart",Ye)}function De(){Fe(window,"dragstart",Ye)}function Ie(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Be(),le=t,ce=t.style.outlineStyle,t.style.outlineStyle="none",ze(window,"keydown",Be))}function Be(){le&&(le.style.outlineStyle=ce,le=void 0,ce=void 0,Fe(window,"keydown",Be))}function Re(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Ae(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Ne={__proto__:null,TRANSFORM:he,TRANSITION:ue,TRANSITION_END:de,get:pe,getStyle:_e,create:me,remove:fe,empty:ge,toFront:ye,toBack:ve,hasClass:be,addClass:ke,removeClass:we,setClass:Le,getClass:xe,setOpacity:$e,testProp:Me,setTransform:Ee,setPosition:Te,getPosition:Pe,get disableTextSelection(){return se},get enableTextSelection(){return re},disableImageDrag:Oe,enableImageDrag:De,preventOutline:Ie,restoreOutline:Be,getSizedParentNode:Re,getScale:Ae};function ze(t,e,i,n){if(e&&"object"==typeof e)for(var o in e)He(t,o,e[o],i);else for(var s=0,r=(e=d(e)).length;s<r;s++)He(t,e[s],i,n);return this}var je="_leaflet_events";function Fe(t,e,i,n){if(1===arguments.length)We(t),delete t[je];else if(e&&"object"==typeof e)for(var o in e)Ze(t,o,e[o],i);else if(e=d(e),2===arguments.length)We(t,(function(t){return-1!==y(e,t)}));else for(var s=0,r=e.length;s<r;s++)Ze(t,e[s],i,n);return this}function We(t,e){for(var i in t[je]){var n=i.split(/\d/)[0];e&&!e(n)||Ze(t,n,null,null,i)}}var Ge={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function He(t,e,i,n){var o=e+r(i)+(n?"_"+r(n):"");if(t[je]&&t[je][o])return this;var s=function(e){return i.call(n||t,e||window.event)},a=s;!Nt.touchNative&&Nt.pointer&&0===e.indexOf("touch")?s=qt(t,e,s):Nt.touch&&"dblclick"===e?s=ne(t,s):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Ge[e]||e,s,!!Nt.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(s=function(e){e=e||window.event,ei(t,e)&&a(e)},t.addEventListener(Ge[e],s,!1)):t.addEventListener(e,a,!1):t.attachEvent("on"+e,s),t[je]=t[je]||{},t[je][o]=s}function Ze(t,e,i,n,o){o=o||e+r(i)+(n?"_"+r(n):"");var s=t[je]&&t[je][o];if(!s)return this;!Nt.touchNative&&Nt.pointer&&0===e.indexOf("touch")?Vt(t,e,s):Nt.touch&&"dblclick"===e?oe(t,s):"removeEventListener"in t?t.removeEventListener(Ge[e]||e,s,!1):t.detachEvent("on"+e,s),t[je][o]=null}function Ue(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function qe(t){return He(t,"wheel",Ue),this}function Ve(t){return ze(t,"mousedown touchstart dblclick contextmenu",Ue),t._leaflet_disable_click=!0,this}function Ye(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ke(t){return Ye(t),Ue(t),this}function Xe(t){if(t.composedPath)return t.composedPath();for(var e=[],i=t.target;i;)e.push(i),i=i.parentNode;return e}function Je(t,e){if(!e)return new D(t.clientX,t.clientY);var i=Ae(e),n=i.boundingClientRect;return new D((t.clientX-n.left)/i.x-e.clientLeft,(t.clientY-n.top)/i.y-e.clientTop)}var Qe=Nt.linux&&Nt.chrome?window.devicePixelRatio:Nt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ti(t){return Nt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Qe:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function ei(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}var ii={__proto__:null,on:ze,off:Fe,stopPropagation:Ue,disableScrollPropagation:qe,disableClickPropagation:Ve,preventDefault:Ye,stop:Ke,getPropagationPath:Xe,getMousePosition:Je,getWheelDelta:ti,isExternalTarget:ei,addListener:ze,removeListener:Fe},ni=O.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=Pe(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=C(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),Te(this._el,i),this.fire("step")},_complete:function(){M(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),oi=O.extend({options:{crs:Y,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=p(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(F(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ue&&Nt.any3d&&!Nt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ze(this._proxy,de,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(F(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=i({animate:n.animate},n.zoom),n.pan=i({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e,n.pan&&n.pan.noMoveStart),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Nt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),s=(t instanceof D?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),r=this.containerPointToLatLng(o.add(s));return this.setView(r,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():z(t);var i=B(e.paddingTopLeft||e.padding||[0,0]),n=B(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n));if((o="number"==typeof e.maxZoom?Math.min(e.maxZoom,o):o)===1/0)return{center:t.getCenter(),zoom:o};var s=n.subtract(i).divideBy(2),r=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o);return{center:this.unproject(r.add(a).divideBy(2).add(s),o),zoom:o}},fitBounds:function(t,e){if(!(t=z(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=B(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ni,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){ke(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(!1===(i=i||{}).animate||!Nt.any3d)return this.setView(t,e,i);this._stop();var n=this.project(this.getCenter()),o=this.project(t),s=this.getSize(),r=this._zoom;t=F(t),e=void 0===e?r:e;var a=Math.max(s.x,s.y),l=a*this.getZoomScale(r,e),c=o.distanceTo(n)||1,h=1.42,u=h*h;function d(t){var e=(l*l-a*a+(t?-1:1)*u*u*c*c)/(2*(t?l:a)*u*c),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function p(t){return(Math.exp(t)-Math.exp(-t))/2}function _(t){return(Math.exp(t)+Math.exp(-t))/2}function m(t){return p(t)/_(t)}var f=d(0);function g(t){return a*(_(f)/_(f+h*t))}function y(t){return a*(_(f)*m(f+h*t)-p(f))/u}function v(t){return 1-Math.pow(1-t,1.5)}var b=Date.now(),k=(d(1)-f)/h,w=i.duration?1e3*i.duration:1e3*k*.8;function L(){var i=(Date.now()-b)/w,s=v(i)*k;i<=1?(this._flyToFrame=C(L,this),this._move(this.unproject(n.add(o.subtract(n).multiplyBy(y(s)/c)),r),this.getScaleZoom(a/g(s),r),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,i.noMoveStart),L.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return t=z(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,z(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},panInside:function(t,e){var i=B((e=e||{}).paddingTopLeft||e.padding||[0,0]),n=B(e.paddingBottomRight||e.padding||[0,0]),o=this.project(this.getCenter()),s=this.project(t),r=this.getPixelBounds(),a=A([r.min.add(i),r.max.subtract(n)]),l=a.getSize();if(!a.contains(s)){this._enforcingBounds=!0;var c=s.subtract(a.getCenter()),h=a.extend(s).getSize().subtract(l);o.x+=c.x<0?-h.x:h.x,o.y+=c.y<0?-h.y:h.y,this.panTo(this.unproject(o),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=i({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var n=this.getSize(),s=e.divideBy(2).round(),r=n.divideBy(2).round(),a=s.subtract(r);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=i({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o(this._handleGeolocationResponse,this),n=o(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new j(t.coords.latitude,t.coords.longitude),i=e.toBounds(2*t.coords.accuracy),n=this._locateOptions;if(n.setView){var o=this.getBoundsZoom(i);this.setView(e,n.maxZoom?Math.min(o,n.maxZoom):o)}var s={latlng:e,bounds:i,timestamp:t.timestamp};for(var r in t.coords)"number"==typeof t.coords[r]&&(s[r]=t.coords[r]);this.fire("locationfound",s)}},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),fe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(M(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)fe(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=me("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new N(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=z(t),i=B(i||[0,0]);var n=this.getZoom()||0,o=this.getMinZoom(),s=this.getMaxZoom(),r=t.getNorthWest(),a=t.getSouthEast(),l=this.getSize().subtract(i),c=A(this.project(a,n),this.project(r,n)).getSize(),h=Nt.any3d?this.options.zoomSnap:1,u=l.x/c.x,d=l.y/c.y,p=e?Math.max(u,d):Math.min(u,d);return n=this.getScaleZoom(p,n),h&&(n=Math.round(n/(h/100))*(h/100),n=e?Math.ceil(n/h)*h:Math.floor(n/h)*h),Math.max(o,Math.min(s,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new D(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new R(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(F(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(B(t),e)},layerPointToLatLng:function(t){var e=B(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(F(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(F(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(z(t))},distance:function(t,e){return this.options.crs.distance(F(t),F(e))},containerPointToLayerPoint:function(t){return B(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return B(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(B(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(t)))},mouseEventToContainerPoint:function(t){return Je(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=pe(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");ze(e,"scroll",this._onScroll,this),this._containerId=r(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Nt.any3d,ke(t,"leaflet-container"+(Nt.touch?" leaflet-touch":"")+(Nt.retina?" leaflet-retina":"")+(Nt.ielt9?" leaflet-oldie":"")+(Nt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=_e(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Te(this._mapPane,new D(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ke(t.markerPane,"leaflet-zoom-hide"),ke(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,i){Te(this._mapPane,new D(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var o=this._zoom!==e;this._moveStart(o,i)._move(t,e)._moveEnd(o),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i,n){void 0===e&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),n?i&&i.pinch&&this.fire("zoom",i):((o||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return M(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Te(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[r(this._container)]=this;var e=t?Fe:ze;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Nt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){M(this._resizeRequest),this._resizeRequest=C((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],o="mouseout"===e||"mouseover"===e,s=t.target||t.srcElement,a=!1;s;){if((i=this._targets[r(s)])&&("click"===e||"preclick"===e)&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(o&&!ei(s,t))break;if(n.push(i),o)break}if(s===this._container)break;s=s.parentNode}return n.length||a||o||!this.listens(e,!0)||(n=[this]),n},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var i=t.type;"mousedown"===i&&Ie(e),this._fireDOMEvent(t,i)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,n){if("click"===t.type){var o=i({},t);o.type="preclick",this._fireDOMEvent(o,o.type,n)}var s=this._findEventTargets(t,e);if(n){for(var r=[],a=0;a<n.length;a++)n[a].listens(e,!0)&&r.push(n[a]);s=r.concat(s)}if(s.length){"contextmenu"===e&&Ye(t);var l=s[0],c={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var h=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=h?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(t),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=h?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(a=0;a<s.length;a++)if(s[a].fire(e,c,!0),c.originalEvent._stopped||!1===s[a].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Pe(this._mapPane)||new D(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return A([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),s=new R(n.subtract(o),n.add(o)),r=this._getBoundsOffset(s,i,e);return Math.abs(r.x)<=1&&Math.abs(r.y)<=1?t:this.unproject(n.add(r),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new R(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=A(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),o=n.min.subtract(t.min),s=n.max.subtract(t.max);return new D(this._rebound(o.x,-s.x),this._rebound(o.y,-s.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=Nt.any3d?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){we(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i)||(this.panBy(i,e),0))},_createAnimProxy:function(){var t=this._proxy=me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=he,i=this._proxy.style[e];Ee(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){fe(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();Ee(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(o)||(C((function(){this._moveStart(!0,i.noMoveStart||!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,i,n){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ke(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&we(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function si(t,e){return new oi(t,e)}var ri=T.extend({options:{position:"topright"},initialize:function(t){p(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return ke(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(fe(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),ai=function(t){return new ri(t)};oi.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=me("div",e+"control-container",this._container);function n(n,o){var s=e+n+" "+e+o;t[n+o]=me("div",s,i)}n("top","left"),n("top","right"),n("bottom","left"),n("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)fe(this._controlCorners[t]);fe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var li=ri.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){for(var n in p(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return ri.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ke(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ke(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):we(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return we(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=me("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Ve(e),qe(e);var n=this._section=me("section",t+"-list");i&&(this._map.on("click",this.collapse,this),ze(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var o=this._layersLink=me("a",t+"-toggle",e);o.href="#",o.title="Layers",o.setAttribute("role","button"),ze(o,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){Ye(t),this._expandSafely()}},this),i||this.expand(),this._baseLayersList=me("div",t+"-base",n),this._separator=me("div",t+"-separator",n),this._overlaysList=me("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(o((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ge(this._baseLayersList),ge(this._overlaysList),this._layerControlInputs=[];var t,e,i,n,o=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,o+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&o>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers_"+r(this),n),this._layerControlInputs.push(e),e.layerId=r(t.layer),ze(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var s=document.createElement("span");return i.appendChild(s),s.appendChild(e),s.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){if(!this._preventClick){var t,e,i=this._layerControlInputs,n=[],o=[];this._handlingClick=!0;for(var s=i.length-1;s>=0;s--)t=i[s],e=this._getLayer(t.layerId).layer,t.checked?n.push(e):t.checked||o.push(e);for(s=0;s<o.length;s++)this._map.hasLayer(o[s])&&this._map.removeLayer(o[s]);for(s=0;s<n.length;s++)this._map.hasLayer(n[s])||this._map.addLayer(n[s]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,n=this._map.getZoom(),o=i.length-1;o>=0;o--)t=i[o],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,ze(t,"click",Ye),this.expand();var e=this;setTimeout((function(){Fe(t,"click",Ye),e._preventClick=!1}))}}),ci=function(t,e,i){return new li(t,e,i)},hi=ri.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=me("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,o){var s=me("a",i,n);return s.innerHTML=t,s.href="#",s.title=e,s.setAttribute("role","button"),s.setAttribute("aria-label",e),Ve(s),ze(s,"click",Ke),ze(s,"click",o,this),ze(s,"click",this._refocusOnMap,this),s},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";we(this._zoomInButton,e),we(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(ke(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(ke(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});oi.mergeOptions({zoomControl:!0}),oi.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new hi,this.addControl(this.zoomControl))}));var ui=function(t){return new hi(t)},di=ri.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=me("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=me("div",e,i)),t.imperial&&(this._iScale=me("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)}}),pi=function(t){return new di(t)},_i='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',mi=ri.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Nt.inlineSvg?_i+" ":"")+"Leaflet</a>"},initialize:function(t){p(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=me("div","leaflet-control-attribution"),Ve(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",(function(){this.removeAttribution(t.layer.getAttribution())}),this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(' <span aria-hidden="true">|</span> ')}}});oi.mergeOptions({attributionControl:!0}),oi.addInitHook((function(){this.options.attributionControl&&(new mi).addTo(this)}));var fi=function(t){return new mi(t)};ri.Layers=li,ri.Zoom=hi,ri.Scale=di,ri.Attribution=mi,ai.layers=ci,ai.zoom=ui,ai.scale=pi,ai.attribution=fi;var gi=T.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});gi.addTo=function(t,e){return t.addHandler(e,this),this};var yi={Events:S},vi=Nt.touch?"touchstart mousedown":"mousedown",bi=O.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){p(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(ze(this._dragStartTarget,vi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(bi._dragging===this&&this.finishDrag(!0),Fe(this._dragStartTarget,vi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!be(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)bi._dragging===this&&this.finishDrag();else if(!(bi._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(bi._dragging=this,this._preventOutline&&Ie(this._element),Oe(),se(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,i=Re(this._element);this._startPoint=new D(e.clientX,e.clientY),this._startPos=Pe(this._element),this._parentScale=Ae(i);var n="mousedown"===t.type;ze(document,n?"mousemove":"touchmove",this._onMove,this),ze(document,n?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new D(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,Ye(t),this._moved||(this.fire("dragstart"),this._moved=!0,ke(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ke(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Te(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){we(document.body,"leaflet-dragging"),this._lastTarget&&(we(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Fe(document,"mousemove touchmove",this._onMove,this),Fe(document,"mouseup touchend touchcancel",this._onUp,this),De(),re();var e=this._moved&&this._moving;this._moving=!1,bi._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ki(t,e,i){var n,o,s,r,a,l,c,h,u,d=[1,4,2,8];for(o=0,c=t.length;o<c;o++)t[o]._code=Ii(t[o],e);for(r=0;r<4;r++){for(h=d[r],n=[],o=0,s=(c=t.length)-1;o<c;s=o++)a=t[o],l=t[s],a._code&h?l._code&h||((u=Di(l,a,h,e,i))._code=Ii(u,e),n.push(u)):(l._code&h&&((u=Di(l,a,h,e,i))._code=Ii(u,e),n.push(u)),n.push(a));t=n}return t}function wi(t,e){var i,n,o,s,r,a,l,c,h;if(!t||0===t.length)throw new Error("latlngs not passed");Ai(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var u=F([0,0]),d=z(t);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(u=Li(t));var p=t.length,_=[];for(i=0;i<p;i++){var m=F(t[i]);_.push(e.project(F([m.lat-u.lat,m.lng-u.lng])))}for(a=l=c=0,i=0,n=p-1;i<p;n=i++)o=_[i],s=_[n],r=o.y*s.x-s.y*o.x,l+=(o.x+s.x)*r,c+=(o.y+s.y)*r,a+=3*r;h=0===a?_[0]:[l/a,c/a];var f=e.unproject(B(h));return F([f.lat+u.lat,f.lng+u.lng])}function Li(t){for(var e=0,i=0,n=0,o=0;o<t.length;o++){var s=F(t[o]);e+=s.lat,i+=s.lng,n++}return F([e/n,i/n])}var xi,$i={__proto__:null,clipPolygon:ki,polygonCenter:wi,centroid:Li};function Ci(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=Ti(t=Si(t,i),i)}function Mi(t,e,i){return Math.sqrt(Ri(t,e,i,!0))}function Ei(t,e,i){return Ri(t,e,i)}function Ti(t,e){var i=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,Pi(t,n,e,0,i-1);var o,s=[];for(o=0;o<i;o++)n[o]&&s.push(t[o]);return s}function Pi(t,e,i,n,o){var s,r,a,l=0;for(r=n+1;r<=o-1;r++)(a=Ri(t[r],t[n],t[o],!0))>l&&(s=r,l=a);l>i&&(e[s]=1,Pi(t,e,i,n,s),Pi(t,e,i,s,o))}function Si(t,e){for(var i=[t[0]],n=1,o=0,s=t.length;n<s;n++)Bi(t[n],t[o])>e&&(i.push(t[n]),o=n);return o<s-1&&i.push(t[s-1]),i}function Oi(t,e,i,n,o){var s,r,a,l=n?xi:Ii(t,i),c=Ii(e,i);for(xi=c;;){if(!(l|c))return[t,e];if(l&c)return!1;a=Ii(r=Di(t,e,s=l||c,i,o),i),s===l?(t=r,l=a):(e=r,c=a)}}function Di(t,e,i,n,o){var s,r,a=e.x-t.x,l=e.y-t.y,c=n.min,h=n.max;return 8&i?(s=t.x+a*(h.y-t.y)/l,r=h.y):4&i?(s=t.x+a*(c.y-t.y)/l,r=c.y):2&i?(s=h.x,r=t.y+l*(h.x-t.x)/a):1&i&&(s=c.x,r=t.y+l*(c.x-t.x)/a),new D(s,r,o)}function Ii(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function Bi(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function Ri(t,e,i,n){var o,s=e.x,r=e.y,a=i.x-s,l=i.y-r,c=a*a+l*l;return c>0&&((o=((t.x-s)*a+(t.y-r)*l)/c)>1?(s=i.x,r=i.y):o>0&&(s+=a*o,r+=l*o)),a=t.x-s,l=t.y-r,n?a*a+l*l:new D(s,r)}function Ai(t){return!g(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function Ni(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ai(t)}function zi(t,e){var i,n,o,s,r,a,l,c;if(!t||0===t.length)throw new Error("latlngs not passed");Ai(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var h=F([0,0]),u=z(t);u.getNorthWest().distanceTo(u.getSouthWest())*u.getNorthEast().distanceTo(u.getNorthWest())<1700&&(h=Li(t));var d=t.length,p=[];for(i=0;i<d;i++){var _=F(t[i]);p.push(e.project(F([_.lat-h.lat,_.lng-h.lng])))}for(i=0,n=0;i<d-1;i++)n+=p[i].distanceTo(p[i+1])/2;if(0===n)c=p[0];else for(i=0,s=0;i<d-1;i++)if(r=p[i],a=p[i+1],(s+=o=r.distanceTo(a))>n){l=(s-n)/o,c=[a.x-l*(a.x-r.x),a.y-l*(a.y-r.y)];break}var m=e.unproject(B(c));return F([m.lat+h.lat,m.lng+h.lng])}var ji={__proto__:null,simplify:Ci,pointToSegmentDistance:Mi,closestPointOnSegment:Ei,clipSegment:Oi,_getEdgeIntersection:Di,_getBitCode:Ii,_sqClosestPointOnSegment:Ri,isFlat:Ai,_flat:Ni,polylineCenter:zi},Fi={project:function(t){return new D(t.lng,t.lat)},unproject:function(t){return new j(t.y,t.x)},bounds:new R([-180,-90],[180,90])},Wi={R:6378137,R_MINOR:6356752.314245179,bounds:new R([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,o=this.R_MINOR/i,s=Math.sqrt(1-o*o),r=s*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-r)/(1+r),s/2);return n=-i*Math.log(Math.max(a,1e-10)),new D(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,o=this.R_MINOR/n,s=Math.sqrt(1-o*o),r=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(r),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)e=s*Math.sin(a),e=Math.pow((1-e)/(1+e),s/2),a+=c=Math.PI/2-2*Math.atan(r*e)-a;return new j(a*i,t.x*i/n)}},Gi={__proto__:null,LonLat:Fi,Mercator:Wi,SphericalMercator:U},Hi=i({},H,{code:"EPSG:3395",projection:Wi,transformation:function(){var t=.5/(Math.PI*Wi.R);return V(t,.5,-t,.5)}()}),Zi=i({},H,{code:"EPSG:4326",projection:Fi,transformation:V(1/180,1,-1/180,.5)}),Ui=i({},G,{projection:Fi,transformation:V(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});G.Earth=H,G.EPSG3395=Hi,G.EPSG3857=Y,G.EPSG900913=K,G.EPSG4326=Zi,G.Simple=Ui;var qi=O.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[r(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[r(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",(function(){e.off(i,this)}),this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});oi.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=r(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=r(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return r(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?g(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[r(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=r(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=void 0===o.minZoom?t:Math.min(t,o.minZoom),e=void 0===o.maxZoom?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Vi=qi.extend({initialize:function(t,e){var i,n;if(p(this,e),this._layers={},t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r(t)}}),Yi=function(t,e){return new Vi(t,e)},Ki=Vi.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Vi.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Vi.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new N;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Xi=function(t,e){return new Ki(t,e)},Ji=T.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){p(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var o=B(n),s=B("shadow"===e&&i.shadowAnchor||i.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),s&&(t.style.marginLeft=-s.x+"px",t.style.marginTop=-s.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Nt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Qi(t){return new Ji(t)}var tn=Ji.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof tn.imagePath&&(tn.imagePath=this._detectIconPath()),(this.options.imagePath||tn.imagePath)+Ji.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,i){var n=e.exec(t);return n&&n[i]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=me("div","leaflet-default-icon-path",document.body),e=_e(t,"background-image")||_e(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var i=document.querySelector('link[href$="leaflet.css"]');return i?i.href.substring(0,i.href.length-11-1):""}}),en=gi.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new bi(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ke(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&we(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,s=Pe(e._icon),r=i.getPixelBounds(),a=i.getPixelOrigin(),l=A(r.min._subtract(a).add(o),r.max._subtract(a).subtract(o));if(!l.contains(s)){var c=B((Math.max(l.max.x,s.x)-l.max.x)/(r.max.x-l.max.x)-(Math.min(l.min.x,s.x)-l.min.x)/(r.min.x-l.min.x),(Math.max(l.max.y,s.y)-l.max.y)/(r.max.y-l.max.y)-(Math.min(l.min.y,s.y)-l.min.y)/(r.min.y-l.min.y)).multiplyBy(n);i.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),Te(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=C(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(M(this._panRequest),this._panRequest=C(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=Pe(e._icon),o=e._map.layerPointToLatLng(n);i&&Te(i,n),e._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){M(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),nn=qi.extend({options:{icon:new tn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){p(this,e),this._latlng=F(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),ke(i,e),t.keyboard&&(i.tabIndex="0",i.setAttribute("role","button")),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ze(i,"focus",this._panOnFocus,this);var o=t.icon.createShadow(this._shadow),s=!1;o!==this._shadow&&(this._removeShadow(),s=!0),o&&(ke(o,e),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&s&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Fe(this._icon,"focus",this._panOnFocus,this),fe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&fe(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Te(this._icon,t),this._shadow&&Te(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ke(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),en)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new en(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&$e(this._icon,t),this._shadow&&$e(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,i=e.iconSize?B(e.iconSize):B(0,0),n=e.iconAnchor?B(e.iconAnchor):B(0,0);t.panInside(this._latlng,{paddingTopLeft:n,paddingBottomRight:i.subtract(n)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function on(t,e){return new nn(t,e)}var sn=qi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return p(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),rn=sn.extend({options:{fill:!0,radius:10},initialize:function(t,e){p(this,e),this._latlng=F(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return sn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new R(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function an(t,e){return new rn(t,e)}var ln=rn.extend({initialize:function(t,e,n){if("number"==typeof e&&(e=i({},n,{radius:e})),p(this,e),this._latlng=F(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new N(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:sn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===H.distance){var o=Math.PI/180,s=this._mRadius/H.R/o,r=i.project([e+s,t]),a=i.project([e-s,t]),l=r.add(a).divideBy(2),c=i.unproject(l).lat,h=Math.acos((Math.cos(s*o)-Math.sin(e*o)*Math.sin(c*o))/(Math.cos(e*o)*Math.cos(c*o)))/o;(isNaN(h)||0===h)&&(h=s/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(h)?0:l.x-i.project([c,t-h]).x,this._radiusY=l.y-r.y}else{var u=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(u).x}this._updateBounds()}});function cn(t,e,i){return new ln(t,e,i)}var hn=sn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){p(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,o=null,s=Ri,r=0,a=this._parts.length;r<a;r++)for(var l=this._parts[r],c=1,h=l.length;c<h;c++){var u=s(t,e=l[c-1],i=l[c],!0);u<n&&(n=u,o=s(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=F(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new N,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Ai(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=Ai(t),n=0,o=t.length;n<o;n++)i?(e[n]=F(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new D(t,t);this._rawPxBounds&&(this._pxBounds=new R([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,i){var n,o,s=t[0]instanceof j,r=t.length;if(s){for(o=[],n=0;n<r;n++)o[n]=this._map.latLngToLayerPoint(t[n]),i.extend(o[n]);e.push(o)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,o,s,r,a,l=this._parts;for(e=0,n=0,o=this._rings.length;e<o;e++)for(i=0,s=(a=this._rings[e]).length;i<s-1;i++)(r=Oi(a[i],a[i+1],t,i,!0))&&(l[n]=l[n]||[],l[n].push(r[0]),r[1]===a[i+1]&&i!==s-2||(l[n].push(r[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=Ci(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,o,s,r,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,s=this._parts.length;i<s;i++)for(n=0,o=(r=(a=this._parts[i]).length)-1;n<r;o=n++)if((e||0!==n)&&Mi(t,a[o],a[n])<=l)return!0;return!1}});function un(t,e){return new hn(t,e)}hn._flat=Ni;var dn=hn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return wi(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=hn.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof j&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){hn.prototype._setLatLngs.call(this,t),Ai(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ai(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new D(e,e);if(t=new R(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,o=0,s=this._rings.length;o<s;o++)(n=ki(this._rings[o],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,o,s,r,a,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(s=0,r=(l=(e=this._parts[o]).length)-1;s<l;r=s++)i=e[s],n=e[r],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(c=!c);return c||hn.prototype._containsPoint.call(this,t,!0)}});function pn(t,e){return new dn(t,e)}var _n=Ki.extend({initialize:function(t,e){p(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=g(t)?t:t.features;if(o){for(e=0,i=o.length;e<i;e++)((n=o[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var s=this.options;if(s.filter&&!s.filter(t))return this;var r=mn(t,s);return r?(r.feature=wn(t),r.defaultOptions=r.options,this.resetStyle(r),s.onEachFeature&&s.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=i({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function mn(t,e){var i,n,o,s,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,l=[],c=e&&e.pointToLayer,h=e&&e.coordsToLatLng||gn;if(!a&&!r)return null;switch(r.type){case"Point":return fn(c,t,i=h(a),e);case"MultiPoint":for(o=0,s=a.length;o<s;o++)i=h(a[o]),l.push(fn(c,t,i,e));return new Ki(l);case"LineString":case"MultiLineString":return n=yn(a,"LineString"===r.type?0:1,h),new hn(n,e);case"Polygon":case"MultiPolygon":return n=yn(a,"Polygon"===r.type?1:2,h),new dn(n,e);case"GeometryCollection":for(o=0,s=r.geometries.length;o<s;o++){var u=mn({geometry:r.geometries[o],type:"Feature",properties:t.properties},e);u&&l.push(u)}return new Ki(l);case"FeatureCollection":for(o=0,s=r.features.length;o<s;o++){var d=mn(r.features[o],e);d&&l.push(d)}return new Ki(l);default:throw new Error("Invalid GeoJSON object.")}}function fn(t,e,i,n){return t?t(e,i):new nn(i,n&&n.markersInheritOptions&&n)}function gn(t){return new j(t[1],t[0],t[2])}function yn(t,e,i){for(var n,o=[],s=0,r=t.length;s<r;s++)n=e?yn(t[s],e-1,i):(i||gn)(t[s]),o.push(n);return o}function vn(t,e){return void 0!==(t=F(t)).alt?[h(t.lng,e),h(t.lat,e),h(t.alt,e)]:[h(t.lng,e),h(t.lat,e)]}function bn(t,e,i,n){for(var o=[],s=0,r=t.length;s<r;s++)o.push(e?bn(t[s],Ai(t[s])?0:e-1,i,n):vn(t[s],n));return!e&&i&&o.length>0&&o.push(o[0].slice()),o}function kn(t,e){return t.feature?i({},t.feature,{geometry:e}):wn(e)}function wn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Ln={toGeoJSON:function(t){return kn(this,{type:"Point",coordinates:vn(this.getLatLng(),t)})}};function xn(t,e){return new _n(t,e)}nn.include(Ln),ln.include(Ln),rn.include(Ln),hn.include({toGeoJSON:function(t){var e=!Ai(this._latlngs);return kn(this,{type:(e?"Multi":"")+"LineString",coordinates:bn(this._latlngs,e?1:0,!1,t)})}}),dn.include({toGeoJSON:function(t){var e=!Ai(this._latlngs),i=e&&!Ai(this._latlngs[0]),n=bn(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),kn(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Vi.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(i){e.push(i.toGeoJSON(t).geometry.coordinates)})),kn(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer((function(e){if(e.toGeoJSON){var o=e.toGeoJSON(t);if(i)n.push(o.geometry);else{var s=wn(o);"FeatureCollection"===s.type?n.push.apply(n,s.features):n.push(s)}}})),i?kn(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var $n=xn,Cn=qi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=z(e),p(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ke(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){fe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ye(this._image),this},bringToBack:function(){return this._map&&ve(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=z(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:me("img");ke(e,"leaflet-image-layer"),this._zoomAnimated&&ke(e,"leaflet-zoom-animated"),this.options.className&&ke(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onload=o(this.fire,this,"load"),e.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Ee(this._image,i,e)},_reset:function(){var t=this._image,e=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();Te(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){$e(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Mn=function(t,e,i){return new Cn(t,e,i)},En=Cn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:me("video");if(ke(e,"leaflet-image-layer"),this._zoomAnimated&&ke(e,"leaflet-zoom-animated"),this.options.className&&ke(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onloadeddata=o(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),n=[],s=0;s<i.length;s++)n.push(i[s].src);this._url=i.length>0?n:[e.src]}else{g(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var r=0;r<this._url.length;r++){var a=me("source");a.src=this._url[r],e.appendChild(a)}}}});function Tn(t,e,i){return new En(t,e,i)}var Pn=Cn.extend({_initImage:function(){var t=this._image=this._url;ke(t,"leaflet-image-layer"),this._zoomAnimated&&ke(t,"leaflet-zoom-animated"),this.options.className&&ke(t,this.options.className),t.onselectstart=c,t.onmousemove=c}});function Sn(t,e,i){return new Pn(t,e,i)}var On=qi.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof j||g(t))?(this._latlng=F(t),p(this,e)):(p(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&$e(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&$e(this._container,1),this.bringToFront(),this.options.interactive&&(ke(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?($e(this._container,0),this._removeTimeout=setTimeout(o(fe,void 0,this._container),200)):fe(this._container),this.options.interactive&&(we(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=F(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ye(this._container),this},bringToBack:function(){return this._map&&ve(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof Ki){e=null;var i=this._source._layers;for(var n in i)if(i[n]._map){e=i[n];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=B(this.options.offset),i=this._getAnchor();this._zoomAnimated?Te(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}});oi.include({_initOverlay:function(t,e,i,n){var o=e;return o instanceof t||(o=new t(n).setContent(e)),i&&o.setLatLng(i),o}}),qi.include({_initOverlay:function(t,e,i,n){var o=i;return o instanceof t?(p(o,n),o._source=this):(o=e&&!n?e:new t(n,this)).setContent(i),o}});var Dn=On.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,On.prototype.openOn.call(this,t)},onAdd:function(t){On.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof sn||this._source.on("preclick",Ue))},onRemove:function(t){On.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof sn||this._source.off("preclick",Ue))},getEvents:function(){var t=On.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=me("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=me("div",t+"-content-wrapper",e);if(this._contentNode=me("div",t+"-content",i),Ve(e),qe(this._contentNode),ze(e,"contextmenu",Ue),this._tipContainer=me("div",t+"-tip-container",e),this._tip=me("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=me("a",t+"-close-button",e);n.setAttribute("role","button"),n.setAttribute("aria-label","Close popup"),n.href="#close",n.innerHTML='<span aria-hidden="true">&#215;</span>',ze(n,"click",(function(t){Ye(t),this.close()}),this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,s="leaflet-popup-scrolled";o&&n>o?(e.height=o+"px",ke(t,s)):we(t,s),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();Te(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,e=parseInt(_e(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,o=new D(this._containerLeft,-i-this._containerBottom);o._add(Pe(this._container));var s=t.layerPointToContainerPoint(o),r=B(this.options.autoPanPadding),a=B(this.options.autoPanPaddingTopLeft||r),l=B(this.options.autoPanPaddingBottomRight||r),c=t.getSize(),h=0,u=0;s.x+n+l.x>c.x&&(h=s.x+n-c.x+l.x),s.x-h-a.x<0&&(h=s.x-a.x),s.y+i+l.y>c.y&&(u=s.y+i-c.y+l.y),s.y-u-a.y<0&&(u=s.y-a.y),(h||u)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([h,u]))}},_getAnchor:function(){return B(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),In=function(t,e){return new Dn(t,e)};oi.mergeOptions({closePopupOnClick:!0}),oi.include({openPopup:function(t,e,i){return this._initOverlay(Dn,t,e,i).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),qi.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Dn,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Ki||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){Ke(t);var e=t.layer||t.target;this._popup._source!==e||e instanceof sn?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Bn=On.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){On.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){On.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=On.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=me("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+r(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,n=this._map,o=this._container,s=n.latLngToContainerPoint(n.getCenter()),r=n.layerPointToContainerPoint(t),a=this.options.direction,l=o.offsetWidth,c=o.offsetHeight,h=B(this.options.offset),u=this._getAnchor();"top"===a?(e=l/2,i=c):"bottom"===a?(e=l/2,i=0):"center"===a?(e=l/2,i=c/2):"right"===a?(e=0,i=c/2):"left"===a?(e=l,i=c/2):r.x<s.x?(a="right",e=0,i=c/2):(a="left",e=l+2*(h.x+u.x),i=c/2),t=t.subtract(B(e,i,!0)).add(h).add(u),we(o,"leaflet-tooltip-right"),we(o,"leaflet-tooltip-left"),we(o,"leaflet-tooltip-top"),we(o,"leaflet-tooltip-bottom"),ke(o,"leaflet-tooltip-"+a),Te(o,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&$e(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return B(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Rn=function(t,e){return new Bn(t,e)};oi.include({openTooltip:function(t,e,i){return this._initOverlay(Bn,t,e,i).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),qi.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Bn,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,i.click=this._openTooltip,this._map?this._addFocusListeners():i.add=this._addFocusListeners),this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Ki||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&(ze(e,"focus",(function(){this._tooltip._source=t,this.openTooltip()}),this),ze(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",(function(){e._openOnceFlag=!1,e._openTooltip(t)}))}else this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}});var An=Ji.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(ge(e),e.appendChild(i.html)):e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=B(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Nn(t){return new An(t)}Ji.Default=tn;var zn=qi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Nt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){p(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),fe(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ye(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ve(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=a(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof D?t:new D(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),o=0,s=i.length;o<s;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Nt.ielt9){$e(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var o=this._tiles[n];if(o.current&&o.loaded){var s=Math.min(1,(t-o.loaded)/200);$e(o.el,s),s<1?e=!0:(o.active?i=!0:this._onOpaqueTile(o),o.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(M(this._fadeFrame),this._fadeFrame=C(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(fe(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var n=this._levels[t],o=this._map;return n||((n=this._levels[t]={}).el=me("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),c(n.el.offsetWidth),this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)fe(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,n){var o=Math.floor(t/2),s=Math.floor(e/2),r=i-1,a=new D(+o,+s);a.z=+r;var l=this._tileCoordsToKey(a),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),r>n&&this._retainParent(o,s,r,n))},_retainChildren:function(t,e,i,n){for(var o=2*t;o<2*t+2;o++)for(var s=2*e;s<2*e+2;s++){var r=new D(o,s);r.z=i+1;var a=this._tileCoordsToKey(r),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<n&&this._retainChildren(o,s,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,n){var o=Math.round(e);o=void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom?void 0:this._clampZoom(o);var s=this.options.updateWhenZooming&&o!==this._tileZoom;n&&!s||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),o=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();Nt.any3d?Ee(t.el,o,n):Te(t.el,o)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),o=e.project(t,this._tileZoom).floor(),s=e.getSize().divideBy(2*n);return new R(o.subtract(s),o.add(s))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(n),s=o.getCenter(),r=[],a=this.options.keepBuffer,l=new R(o.getBottomLeft().subtract([a,-a]),o.getTopRight().add([a,-a]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var h=this._tiles[c].coords;h.z===this._tileZoom&&l.contains(new D(h.x,h.y))||(this._tiles[c].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var u=o.min.y;u<=o.max.y;u++)for(var d=o.min.x;d<=o.max.x;d++){var p=new D(d,u);if(p.z=this._tileZoom,this._isValidTile(p)){var _=this._tiles[this._tileCoordsToKey(p)];_?_.current=!0:r.push(p)}}if(r.sort((function(t,e){return t.distanceTo(s)-e.distanceTo(s)})),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<r.length;d++)this._addTile(r[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return z(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),o=n.add(i);return[e.unproject(n,t.z),e.unproject(o,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new N(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new D(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(fe(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ke(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=c,t.onmousemove=c,Nt.ielt9&&this.options.opacity<1&&$e(t,this.options.opacity)},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),s=this.createTile(this._wrapCoords(t),o(this._tileReady,this,t));this._initTile(s),this.createTile.length<2&&C(o(this._tileReady,this,t,null,s)),Te(s,i),this._tiles[n]={el:s,coords:t,current:!0},e.appendChild(s),this.fire("tileloadstart",{tile:s,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);(i=this._tiles[n])&&(i.loaded=+new Date,this._map._fadeAnimated?($e(i.el,0),M(this._fadeFrame),this._fadeFrame=C(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(ke(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Nt.ielt9||!this._map._fadeAnimated?C(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new D(this._wrapX?l(t.x,this._wrapX):t.x,this._wrapY?l(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new R(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function jn(t){return new zn(t)}var Fn=zn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=p(this,e)).detectRetina&&Nt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return ze(i,"load",o(this._tileOnLoad,this,e,i)),ze(i,"error",o(this._tileOnError,this,e,i)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(i.referrerPolicy=this.options.referrerPolicy),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){var e={r:Nt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=n),e["-y"]=n}return f(this._url,i(e,this.options))},_tileOnLoad:function(t,e){Nt.ielt9?setTimeout(o(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.getAttribute("src")!==n&&(e.src=n),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=c,e.onerror=c,!e.complete)){e.src=v;var i=this._tiles[t].coords;fe(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:i})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",v),zn.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(this._map&&(!i||i.getAttribute("src")!==v))return zn.prototype._tileReady.call(this,t,e,i)}});function Wn(t,e){return new Fn(t,e)}var Gn=Fn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var n=i({},this.defaultWmsParams);for(var o in e)o in this.options||(n[o]=e[o]);var s=(e=p(this,e)).detectRetina&&Nt.retina?2:1,r=this.getTileSize();n.width=r.x*s,n.height=r.y*s,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,Fn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,n=A(i.project(e[0]),i.project(e[1])),o=n.min,s=n.max,r=(this._wmsVersion>=1.3&&this._crs===Zi?[o.y,o.x,s.y,s.x]:[o.x,o.y,s.x,s.y]).join(","),a=Fn.prototype.getTileUrl.call(this,t);return a+_(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+r},setParams:function(t,e){return i(this.wmsParams,t),e||this.redraw(),this}});function Hn(t,e){return new Gn(t,e)}Fn.WMS=Gn,Wn.wms=Hn;var Zn=qi.extend({options:{padding:.1},initialize:function(t){p(this,t),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ke(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),s=n.multiplyBy(-i).add(o).subtract(this._map._getNewPixelOrigin(t,e));Nt.any3d?Ee(this._container,s,i):Te(this._container,s)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new R(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Un=Zn.extend({options:{tolerance:0},getEvents:function(){var t=Zn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Zn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");ze(t,"mousemove",this._onMouseMove,this),ze(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ze(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){M(this._redrawRequest),delete this._ctx,fe(this._container),Fe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Zn.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=Nt.retina?2:1;Te(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Nt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Zn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[r(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[r(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,i,n=t.options.dashArray.split(/[, ]+/),o=[];for(i=0;i<n.length;i++){if(e=Number(n[i]),isNaN(e))return;o.push(e)}t.options._dashArray=o}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||C(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,o,s,r=t._parts,a=r.length,l=this._ctx;if(a){for(l.beginPath(),i=0;i<a;i++){for(n=0,o=r[i].length;n<o;n++)s=r[i][n],l[n?"lineTo":"moveTo"](s.x,s.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),o=(Math.max(Math.round(t._radiusY),1)||n)/n;1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(n)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(i=e);this._fireEvent(!!i&&[i],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(we(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,n,s=this._drawFirst;s;s=s.next)(i=s.layer).options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(ke(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(o((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function qn(t){return Nt.canvas?new Un(t):null}var Vn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Yn={_initContainer:function(){this._container=me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Zn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Vn("shape");ke(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Vn("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;fe(e),t.removeInteractiveTarget(e),delete this._layers[r(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(e||(e=t._stroke=Vn("stroke")),o.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=g(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(o.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=Vn("fill")),o.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(o.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ye(t._container)},_bringToBack:function(t){ve(t._container)}},Kn=Nt.vml?Vn:X,Xn=Zn.extend({_initContainer:function(){this._container=Kn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Kn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){fe(this._container),Fe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Zn.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),Te(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Kn("path");t.options.className&&ke(e,t.options.className),t.options.interactive&&ke(e,"leaflet-interactive"),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){fe(t._path),t.removeInteractiveTarget(t._path),delete this._layers[r(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,J(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),n="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,o)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ye(t._path)},_bringToBack:function(t){ve(t._path)}});function Jn(t){return Nt.svg||Nt.vml?new Xn(t):null}Nt.vml&&Xn.include(Yn),oi.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&qn(t)||Jn(t)}});var Qn=dn.extend({initialize:function(t,e){dn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=z(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function to(t,e){return new Qn(t,e)}Xn.create=Kn,Xn.pointsToPath=J,_n.geometryToLayer=mn,_n.coordsToLatLng=gn,_n.coordsToLatLngs=yn,_n.latLngToCoords=vn,_n.latLngsToCoords=bn,_n.getFeature=kn,_n.asFeature=wn,oi.mergeOptions({boxZoom:!0});var eo=gi.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){ze(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Fe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){fe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),se(),Oe(),this._startPoint=this._map.mouseEventToContainerPoint(t),ze(document,{contextmenu:Ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=me("div","leaflet-zoom-box",this._container),ke(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new R(this._point,this._startPoint),i=e.getSize();Te(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(fe(this._box),we(this._container,"leaflet-crosshair")),re(),De(),Fe(document,{contextmenu:Ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var e=new N(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});oi.addInitHook("addHandler","boxZoom",eo),oi.mergeOptions({doubleClickZoom:!0});var io=gi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}});oi.addInitHook("addHandler","doubleClickZoom",io),oi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var no=gi.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new bi(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ke(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){we(this._map._container,"leaflet-grab"),we(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=z(this._map.options.maxBounds);this._offsetLimit=A(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,s=(n+e+i)%t-e-i,r=Math.abs(o+i)<Math.abs(s+i)?o:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{this._prunePositions(+new Date);var o=this._lastPos.subtract(this._positions[0]),s=(this._lastTime-this._times[0])/1e3,r=i.easeLinearity,a=o.multiplyBy(r/s),l=a.distanceTo([0,0]),c=Math.min(i.inertiaMaxSpeed,l),h=a.multiplyBy(c/l),u=c/(i.inertiaDeceleration*r),d=h.multiplyBy(-u/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),C((function(){e.panBy(d,{duration:u,easeLinearity:r,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});oi.addInitHook("addHandler","dragging",no),oi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var oo=gi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),ze(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Fe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){ze(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Fe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(!n._panAnim||!n._panAnim._inProgress)if(e=this._panKeys[i],t.shiftKey&&(e=B(e).multiplyBy(3)),n.options.maxBounds&&(e=n._limitOffset(B(e),n.options.maxBounds)),n.options.worldCopyJump){var o=n.wrapLatLng(n.unproject(n.project(n.getCenter()).add(e)));n.panTo(o)}else n.panBy(e)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Ke(t)}}});oi.addInitHook("addHandler","keyboard",oo),oi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var so=gi.extend({addHooks:function(){ze(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Fe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=ti(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),n),Ke(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,s=i?Math.ceil(o/i)*i:o,r=t._limitZoom(e+(this._delta>0?s:-s))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}});oi.addInitHook("addHandler","scrollWheelZoom",so);var ro=600;oi.mergeOptions({tapHold:Nt.touchNative&&Nt.safari&&Nt.mobile,tapTolerance:15});var ao=gi.extend({addHooks:function(){ze(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Fe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new D(e.clientX,e.clientY),this._holdTimeout=setTimeout(o((function(){this._cancel(),this._isTapValid()&&(ze(document,"touchend",Ye),ze(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))}),this),ro),ze(document,"touchend touchcancel contextmenu",this._cancel,this),ze(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Fe(document,"touchend",Ye),Fe(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Fe(document,"touchend touchcancel contextmenu",this._cancel,this),Fe(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new D(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var i=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});i._simulated=!0,e.target.dispatchEvent(i)}});oi.addInitHook("addHandler","tapHold",ao),oi.mergeOptions({touchZoom:Nt.touch,bounceAtZoomLimits:!0});var lo=gi.extend({addHooks:function(){ke(this._map._container,"leaflet-touch-zoom"),ze(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){we(this._map._container,"leaflet-touch-zoom"),Fe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),ze(document,"touchmove",this._onTouchMove,this),ze(document,"touchend touchcancel",this._onTouchEnd,this),Ye(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),s=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(s,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&s<1||this._zoom>e.getMaxZoom()&&s>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var r=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),M(this._animRequest);var a=o(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=C(a,this,!0),Ye(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,M(this._animRequest),Fe(document,"touchmove",this._onTouchMove,this),Fe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});oi.addInitHook("addHandler","touchZoom",lo),oi.BoxZoom=eo,oi.DoubleClickZoom=io,oi.Drag=no,oi.Keyboard=oo,oi.ScrollWheelZoom=so,oi.TapHold=ao,oi.TouchZoom=lo,t.Bounds=R,t.Browser=Nt,t.CRS=G,t.Canvas=Un,t.Circle=ln,t.CircleMarker=rn,t.Class=T,t.Control=ri,t.DivIcon=An,t.DivOverlay=On,t.DomEvent=ii,t.DomUtil=Ne,t.Draggable=bi,t.Evented=O,t.FeatureGroup=Ki,t.GeoJSON=_n,t.GridLayer=zn,t.Handler=gi,t.Icon=Ji,t.ImageOverlay=Cn,t.LatLng=j,t.LatLngBounds=N,t.Layer=qi,t.LayerGroup=Vi,t.LineUtil=ji,t.Map=oi,t.Marker=nn,t.Mixin=yi,t.Path=sn,t.Point=D,t.PolyUtil=$i,t.Polygon=dn,t.Polyline=hn,t.Popup=Dn,t.PosAnimation=ni,t.Projection=Gi,t.Rectangle=Qn,t.Renderer=Zn,t.SVG=Xn,t.SVGOverlay=Pn,t.TileLayer=Fn,t.Tooltip=Bn,t.Transformation=q,t.Util=E,t.VideoOverlay=En,t.bind=o,t.bounds=A,t.canvas=qn,t.circle=cn,t.circleMarker=an,t.control=ai,t.divIcon=Nn,t.extend=i,t.featureGroup=Xi,t.geoJSON=xn,t.geoJson=$n,t.gridLayer=jn,t.icon=Qi,t.imageOverlay=Mn,t.latLng=F,t.latLngBounds=z,t.layerGroup=Yi,t.map=si,t.marker=on,t.point=B,t.polygon=pn,t.polyline=un,t.popup=In,t.rectangle=to,t.setOptions=p,t.stamp=r,t.svg=Jn,t.svgOverlay=Sn,t.tileLayer=Wn,t.tooltip=Rn,t.transformation=V,t.version=e,t.videoOverlay=Tn;var co=window.L;t.noConflict=function(){return window.L=co,this},window.L=t}(e)})),distCjs=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.setDelay=e.pushState=e.replaceState=void 0;let i=null,n=null,o=null,s=-1/0,r=!1;e.replaceState=(t,e,i)=>{o=[t,i],a()};function a(){if(r)return;null===i&&(i="Apple Computer, Inc."===navigator.vendor?310:52);let t=performance.now()-s;t>=i?l():(setTimeout(l,i-t),r=!0)}function l(){r=!1,s=performance.now(),null!==n?(history.pushState(n[0],"",n[1]),n=null,null!==o&&a()):(history.replaceState(o[0],"",o[1]),o=null)}e.pushState=(t,e,i)=>{n=[t,i],o=null,a()},e.setDelay=function(t){i=t}}));
/**
     * leaflet plugin for plain image map projection
     * @copyright 2016 - commenthol
     * @license MIT
     * @link https://github.com/commenthol/leaflet-rastercoords
     */
class RasterCoords{constructor(t,e,i){if(void 0===window.L)throw new Error("Leaflet must be loaded first");this.map=t,this.width=e.width,this.height=e.height,this.tileSize=i||256,this.zoom=this.getZoomLevel(),this.width&&this.height&&this.setMaxBounds()}getZoomLevel(){return Math.ceil(Math.log(Math.max(this.width,this.height)/this.tileSize)/Math.log(2))}unproject(t){return this.map.unproject(t,this.zoom)}project(t){return this.map.project(t,this.zoom)}getMaxBounds(t){let e=this.unproject([0,this.height]),i=this.unproject([this.width,0]);return t&&(e.lng=e.lng-t,e.lat=e.lat-t,i.lng=i.lng+t,i.lat=i.lat+t),new L.LatLngBounds(e,i)}setMaxBounds(){let t=this.getMaxBounds();this.map.setMaxBounds(t)}}(()=>{var t=Object.create,e=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,o=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,r=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),a=(r,a,l)=>(l=null!=r?t(o(r)):{},((t,o,r,a)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let l of n(o))!s.call(t,l)&&l!==r&&e(t,l,{get:()=>o[l],enumerable:!(a=i(o,l))||a.enumerable});return t})(!a&&r&&r.__esModule?l:e(l,"default",{value:r,enumerable:!0}),r)),l=r(((t,e)=>{e.exports=function(){this.__data__=[],this.size=0}})),c=r(((t,e)=>{e.exports=function(t,e){return t===e||t!=t&&e!=e}})),h=r(((t,e)=>{var i=c();e.exports=function(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}})),u=r(((t,e)=>{var i=h(),n=Array.prototype.splice;e.exports=function(t){var e=this.__data__,o=i(e,t);return!(o<0)&&(o==e.length-1?e.pop():n.call(e,o,1),--this.size,!0)}})),d=r(((t,e)=>{var i=h();e.exports=function(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}})),p=r(((t,e)=>{var i=h();e.exports=function(t){return i(this.__data__,t)>-1}})),_=r(((t,e)=>{var i=h();e.exports=function(t,e){var n=this.__data__,o=i(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}})),m=r(((t,e)=>{var i=l(),n=u(),o=d(),s=p(),r=_();function a(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}a.prototype.clear=i,a.prototype.delete=n,a.prototype.get=o,a.prototype.has=s,a.prototype.set=r,e.exports=a})),f=r(((t,e)=>{var i=m();e.exports=function(){this.__data__=new i,this.size=0}})),g=r(((t,e)=>{e.exports=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}})),y=r(((t,e)=>{e.exports=function(t){return this.__data__.get(t)}})),v=r(((t,e)=>{e.exports=function(t){return this.__data__.has(t)}})),b=r(((t,e)=>{var i="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal;e.exports=i})),k=r(((t,e)=>{var i=b(),n="object"==typeof self&&self&&self.Object===Object&&self,o=i||n||Function("return this")();e.exports=o})),w=r(((t,e)=>{var i=k().Symbol;e.exports=i})),x=r(((t,e)=>{var i=w(),n=Object.prototype,o=n.hasOwnProperty,s=n.toString,r=i?i.toStringTag:void 0;e.exports=function(t){var e=o.call(t,r),i=t[r];try{t[r]=void 0;var n=!0}catch{}var a=s.call(t);return n&&(e?t[r]=i:delete t[r]),a}})),$=r(((t,e)=>{var i=Object.prototype.toString;e.exports=function(t){return i.call(t)}})),C=r(((t,e)=>{var i=w(),n=x(),o=$(),s=i?i.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?n(t):o(t)}})),M=r(((t,e)=>{e.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}})),E=r(((t,e)=>{var i=C(),n=M();e.exports=function(t){if(!n(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}})),T=r(((t,e)=>{var i=k()["__core-js_shared__"];e.exports=i})),P=r(((t,e)=>{var i,n=T(),o=(i=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";e.exports=function(t){return!!o&&o in t}})),S=r(((t,e)=>{var i=Function.prototype.toString;e.exports=function(t){if(null!=t){try{return i.call(t)}catch{}try{return t+""}catch{}}return""}})),O=r(((t,e)=>{var i=E(),n=P(),o=M(),s=S(),r=/^\[object .+?Constructor\]$/,a=Function.prototype,l=Object.prototype,c=a.toString,h=l.hasOwnProperty,u=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t){return!(!o(t)||n(t))&&(i(t)?u:r).test(s(t))}})),D=r(((t,e)=>{e.exports=function(t,e){return t?.[e]}})),I=r(((t,e)=>{var i=O(),n=D();e.exports=function(t,e){var o=n(t,e);return i(o)?o:void 0}})),B=r(((t,e)=>{var i=I()(k(),"Map");e.exports=i})),R=r(((t,e)=>{var i=I()(Object,"create");e.exports=i})),A=r(((t,e)=>{var i=R();e.exports=function(){this.__data__=i?i(null):{},this.size=0}})),N=r(((t,e)=>{e.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}})),z=r(((t,e)=>{var i=R(),n=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;if(i){var o=e[t];return"__lodash_hash_undefined__"===o?void 0:o}return n.call(e,t)?e[t]:void 0}})),j=r(((t,e)=>{var i=R(),n=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:n.call(e,t)}})),F=r(((t,e)=>{var i=R();e.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}})),W=r(((t,e)=>{var i=A(),n=N(),o=z(),s=j(),r=F();function a(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}a.prototype.clear=i,a.prototype.delete=n,a.prototype.get=o,a.prototype.has=s,a.prototype.set=r,e.exports=a})),G=r(((t,e)=>{var i=W(),n=m(),o=B();e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(o||n),string:new i}}})),H=r(((t,e)=>{e.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}})),Z=r(((t,e)=>{var i=H();e.exports=function(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}})),U=r(((t,e)=>{var i=Z();e.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}})),q=r(((t,e)=>{var i=Z();e.exports=function(t){return i(this,t).get(t)}})),V=r(((t,e)=>{var i=Z();e.exports=function(t){return i(this,t).has(t)}})),Y=r(((t,e)=>{var i=Z();e.exports=function(t,e){var n=i(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}})),K=r(((t,e)=>{var i=G(),n=U(),o=q(),s=V(),r=Y();function a(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}a.prototype.clear=i,a.prototype.delete=n,a.prototype.get=o,a.prototype.has=s,a.prototype.set=r,e.exports=a})),X=r(((t,e)=>{var i=m(),n=B(),o=K();e.exports=function(t,e){var s=this.__data__;if(s instanceof i){var r=s.__data__;if(!n||r.length<199)return r.push([t,e]),this.size=++s.size,this;s=this.__data__=new o(r)}return s.set(t,e),this.size=s.size,this}})),J=r(((t,e)=>{var i=m(),n=f(),o=g(),s=y(),r=v(),a=X();function l(t){var e=this.__data__=new i(t);this.size=e.size}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=s,l.prototype.has=r,l.prototype.set=a,e.exports=l})),Q=r(((t,e)=>{var i=I(),n=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch{}}();e.exports=n})),tt=r(((t,e)=>{var i=Q();e.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}})),et=r(((t,e)=>{var i=tt(),n=c();e.exports=function(t,e,o){(void 0!==o&&!n(t[e],o)||void 0===o&&!(e in t))&&i(t,e,o)}})),it=r(((t,e)=>{e.exports=function(t){return function(e,i,n){for(var o=-1,s=Object(e),r=n(e),a=r.length;a--;){var l=r[t?a:++o];if(!1===i(s[l],l,s))break}return e}}})),nt=r(((t,e)=>{var i=it()();e.exports=i})),ot=r(((t,e)=>{var i=k(),n="object"==typeof t&&t&&!t.nodeType&&t,o=n&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===n?i.Buffer:void 0,r=s?s.allocUnsafe:void 0;e.exports=function(t,e){if(e)return t.slice();var i=t.length,n=r?r(i):new t.constructor(i);return t.copy(n),n}})),st=r(((t,e)=>{var i=k().Uint8Array;e.exports=i})),rt=r(((t,e)=>{var i=st();e.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}})),at=r(((t,e)=>{var i=rt();e.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}})),lt=r(((t,e)=>{e.exports=function(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}})),ct=r(((t,e)=>{var i=M(),n=Object.create,o=function(){function t(){}return function(e){if(!i(e))return{};if(n)return n(e);t.prototype=e;var o=new t;return t.prototype=void 0,o}}();e.exports=o})),ht=r(((t,e)=>{e.exports=function(t,e){return function(i){return t(e(i))}}})),ut=r(((t,e)=>{var i=ht()(Object.getPrototypeOf,Object);e.exports=i})),dt=r(((t,e)=>{var i=Object.prototype;e.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}})),pt=r(((t,e)=>{var i=ct(),n=ut(),o=dt();e.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:i(n(t))}})),_t=r(((t,e)=>{e.exports=function(t){return null!=t&&"object"==typeof t}})),mt=r(((t,e)=>{var i=C(),n=_t();e.exports=function(t){return n(t)&&"[object Arguments]"==i(t)}})),ft=r(((t,e)=>{var i=mt(),n=_t(),o=Object.prototype,s=o.hasOwnProperty,r=o.propertyIsEnumerable,a=i(function(){return arguments}())?i:function(t){return n(t)&&s.call(t,"callee")&&!r.call(t,"callee")};e.exports=a})),gt=r(((t,e)=>{var i=Array.isArray;e.exports=i})),yt=r(((t,e)=>{e.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}})),vt=r(((t,e)=>{var i=E(),n=yt();e.exports=function(t){return null!=t&&n(t.length)&&!i(t)}})),bt=r(((t,e)=>{var i=vt(),n=_t();e.exports=function(t){return n(t)&&i(t)}})),kt=r(((t,e)=>{e.exports=function(){return!1}})),wt=r(((t,e)=>{var i=k(),n=kt(),o="object"==typeof t&&t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,r=s&&s.exports===o?i.Buffer:void 0,a=(r?r.isBuffer:void 0)||n;e.exports=a})),Lt=r(((t,e)=>{var i=C(),n=ut(),o=_t(),s=Function.prototype,r=Object.prototype,a=s.toString,l=r.hasOwnProperty,c=a.call(Object);e.exports=function(t){if(!o(t)||"[object Object]"!=i(t))return!1;var e=n(t);if(null===e)return!0;var s=l.call(e,"constructor")&&e.constructor;return"function"==typeof s&&s instanceof s&&a.call(s)==c}})),xt=r(((t,e)=>{var i=C(),n=yt(),o=_t(),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(t){return o(t)&&n(t.length)&&!!s[i(t)]}})),$t=r(((t,e)=>{e.exports=function(t){return function(e){return t(e)}}})),Ct=r(((t,e)=>{var i=b(),n="object"==typeof t&&t&&!t.nodeType&&t,o=n&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===n&&i.process,r=function(){try{return o&&o.require&&o.require("util").types||s&&s.binding&&s.binding("util")}catch{}}();e.exports=r})),Mt=r(((t,e)=>{var i=xt(),n=$t(),o=Ct(),s=o&&o.isTypedArray,r=s?n(s):i;e.exports=r})),Et=r(((t,e)=>{e.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}})),Tt=r(((t,e)=>{var i=tt(),n=c(),o=Object.prototype.hasOwnProperty;e.exports=function(t,e,s){var r=t[e];(!o.call(t,e)||!n(r,s)||void 0===s&&!(e in t))&&i(t,e,s)}})),Pt=r(((t,e)=>{var i=Tt(),n=tt();e.exports=function(t,e,o,s){var r=!o;o||(o={});for(var a=-1,l=e.length;++a<l;){var c=e[a],h=s?s(o[c],t[c],c,o,t):void 0;void 0===h&&(h=t[c]),r?n(o,c,h):i(o,c,h)}return o}})),St=r(((t,e)=>{e.exports=function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}})),Ot=r(((t,e)=>{var i=/^(?:0|[1-9]\d*)$/;e.exports=function(t,e){var n=typeof t;return!!(e=e??9007199254740991)&&("number"==n||"symbol"!=n&&i.test(t))&&t>-1&&t%1==0&&t<e}})),Dt=r(((t,e)=>{var i=St(),n=ft(),o=gt(),s=wt(),r=Ot(),a=Mt(),l=Object.prototype.hasOwnProperty;e.exports=function(t,e){var c=o(t),h=!c&&n(t),u=!c&&!h&&s(t),d=!c&&!h&&!u&&a(t),p=c||h||u||d,_=p?i(t.length,String):[],m=_.length;for(var f in t)(e||l.call(t,f))&&(!p||!("length"==f||u&&("offset"==f||"parent"==f)||d&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||r(f,m)))&&_.push(f);return _}})),It=r(((t,e)=>{e.exports=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}})),Bt=r(((t,e)=>{var i=M(),n=dt(),o=It(),s=Object.prototype.hasOwnProperty;e.exports=function(t){if(!i(t))return o(t);var e=n(t),r=[];for(var a in t)"constructor"==a&&(e||!s.call(t,a))||r.push(a);return r}})),Rt=r(((t,e)=>{var i=Dt(),n=Bt(),o=vt();e.exports=function(t){return o(t)?i(t,!0):n(t)}})),At=r(((t,e)=>{var i=Pt(),n=Rt();e.exports=function(t){return i(t,n(t))}})),Nt=r(((t,e)=>{var i=et(),n=ot(),o=at(),s=lt(),r=pt(),a=ft(),l=gt(),c=bt(),h=wt(),u=E(),d=M(),p=Lt(),_=Mt(),m=Et(),f=At();e.exports=function(t,e,g,y,v,b,k){var w=m(t,g),L=m(e,g),x=k.get(L);if(x)i(t,g,x);else{var $=b?b(w,L,g+"",t,e,k):void 0,C=void 0===$;if(C){var M=l(L),E=!M&&h(L),T=!M&&!E&&_(L);$=L,M||E||T?l(w)?$=w:c(w)?$=s(w):E?(C=!1,$=n(L,!0)):T?(C=!1,$=o(L,!0)):$=[]:p(L)||a(L)?($=w,a(w)?$=f(w):(!d(w)||u(w))&&($=r(L))):C=!1}C&&(k.set(L,$),v($,L,y,b,k),k.delete(L)),i(t,g,$)}}})),zt=r(((t,e)=>{var i=J(),n=et(),o=nt(),s=Nt(),r=M(),a=Rt(),l=Et();e.exports=function t(e,c,h,u,d){e!==c&&o(c,(function(o,a){if(d||(d=new i),r(o))s(e,c,a,h,t,u,d);else{var p=u?u(l(e,a),o,a+"",e,c,d):void 0;void 0===p&&(p=o),n(e,a,p)}}),a)}})),jt=r(((t,e)=>{e.exports=function(t){return t}})),Ft=r(((t,e)=>{e.exports=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}})),Wt=r(((t,e)=>{var i=Ft(),n=Math.max;e.exports=function(t,e,o){return e=n(void 0===e?t.length-1:e,0),function(){for(var s=arguments,r=-1,a=n(s.length-e,0),l=Array(a);++r<a;)l[r]=s[e+r];r=-1;for(var c=Array(e+1);++r<e;)c[r]=s[r];return c[e]=o(l),i(t,this,c)}}})),Gt=r(((t,e)=>{e.exports=function(t){return function(){return t}}})),Ht=r(((t,e)=>{var i=Gt(),n=Q(),o=jt(),s=n?function(t,e){return n(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:o;e.exports=s})),Zt=r(((t,e)=>{var i=Date.now;e.exports=function(t){var e=0,n=0;return function(){var o=i(),s=16-(o-n);if(n=o,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}})),Ut=r(((t,e)=>{var i=Ht(),n=Zt()(i);e.exports=n})),qt=r(((t,e)=>{var i=jt(),n=Wt(),o=Ut();e.exports=function(t,e){return o(n(t,e,i),t+"")}})),Vt=r(((t,e)=>{var i=c(),n=vt(),o=Ot(),s=M();e.exports=function(t,e,r){if(!s(r))return!1;var a=typeof e;return!!("number"==a?n(r)&&o(e,r.length):"string"==a&&e in r)&&i(r[e],t)}})),Yt=r(((t,e)=>{var i=qt(),n=Vt();e.exports=function(t){return i((function(e,i){var o=-1,s=i.length,r=s>1?i[s-1]:void 0,a=s>2?i[2]:void 0;for(r=t.length>3&&"function"==typeof r?(s--,r):void 0,a&&n(i[0],i[1],a)&&(r=s<3?void 0:r,s=1),e=Object(e);++o<s;){var l=i[o];l&&t(e,l,o,r)}return e}))}})),Kt=r(((t,e)=>{var i=zt(),n=Yt()((function(t,e,n){i(t,e,n)}));e.exports=n})),Xt=r(((t,e)=>{var i=C(),n=_t();e.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==i(t)}})),Jt=r(((t,e)=>{var i=gt(),n=Xt(),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(t,e){if(i(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!n(t))||(s.test(t)||!o.test(t)||null!=e&&t in Object(e))}})),Qt=r(((t,e)=>{var i=K();function n(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var o=function(){var i=arguments,n=e?e.apply(this,i):i[0],s=o.cache;if(s.has(n))return s.get(n);var r=t.apply(this,i);return o.cache=s.set(n,r)||s,r};return o.cache=new(n.Cache||i),o}n.Cache=i,e.exports=n})),te=r(((t,e)=>{var i=Qt();e.exports=function(t){var e=i(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}})),ee=r(((t,e)=>{var i=te(),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=i((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,(function(t,i,n,s){e.push(n?s.replace(o,"$1"):i||t)})),e}));e.exports=s})),ie=r(((t,e)=>{e.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,o=Array(n);++i<n;)o[i]=e(t[i],i,t);return o}})),ne=r(((t,e)=>{var i=w(),n=ie(),o=gt(),s=Xt(),r=1/0,a=i?i.prototype:void 0,l=a?a.toString:void 0;e.exports=function t(e){if("string"==typeof e)return e;if(o(e))return n(e,t)+"";if(s(e))return l?l.call(e):"";var i=e+"";return"0"==i&&1/e==-r?"-0":i}})),oe=r(((t,e)=>{var i=ne();e.exports=function(t){return null==t?"":i(t)}})),se=r(((t,e)=>{var i=gt(),n=Jt(),o=ee(),s=oe();e.exports=function(t,e){return i(t)?t:n(t,e)?[t]:o(s(t))}})),re=r(((t,e)=>{var i=Xt(),n=1/0;e.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-n?"-0":e}})),ae=r(((t,e)=>{var i=se(),n=re();e.exports=function(t,e){for(var o=0,s=(e=i(e,t)).length;null!=t&&o<s;)t=t[n(e[o++])];return o&&o==s?t:void 0}})),le=r(((t,e)=>{var i=ae();e.exports=function(t,e,n){var o=null==t?void 0:i(t,e);return void 0===o?n:o}})),ce=r(((t,e)=>{var i,n;i=t,n=function(){function t(t,n,o,s,r){!function t(i,n,o,s,r){for(;s>o;){if(s-o>600){var a=s-o+1,l=n-o+1,c=Math.log(a),h=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*h*(a-h)/a)*(l-a/2<0?-1:1);t(i,n,Math.max(o,Math.floor(n-l*h/a+u)),Math.min(s,Math.floor(n+(a-l)*h/a+u)),r)}var d=i[n],p=o,_=s;for(e(i,o,n),r(i[s],d)>0&&e(i,o,s);p<_;){for(e(i,p,_),p++,_--;r(i[p],d)<0;)p++;for(;r(i[_],d)>0;)_--}0===r(i[o],d)?e(i,o,_):e(i,++_,s),_<=n&&(o=_+1),n<=_&&(s=_-1)}}(t,n,o||0,s||t.length-1,r||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){r(t,0,t.children.length,e,t)}function r(t,e,i,n,o){o||(o=_(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var s=e;s<i;s++){var r=t.children[s];a(o,t.leaf?n(r):r)}return o}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function _(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,i,n,o,s){for(var r=[i,n];r.length;)if(!((n=r.pop())-(i=r.pop())<=o)){var a=i+Math.ceil((n-i)/o/2)*o;t(e,a,i,n,s),r.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!p(t,e))return i;for(var n=this.toBBox,o=[];e;){for(var s=0;s<e.children.length;s++){var r=e.children[s],a=e.leaf?n(r):r;p(t,a)&&(e.leaf?i.push(r):d(t,a)?this._all(r,i):o.push(r))}e=o.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var o=e.children[n],s=e.leaf?this.toBBox(o):o;if(p(t,s)){if(e.leaf||d(t,s))return!0;i.push(o)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=_([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,s,r=this.data,a=this.toBBox(t),l=[],c=[];r||l.length;){if(r||(r=l.pop(),n=l[l.length-1],i=c.pop(),s=!0),r.leaf){var h=o(t,r.children,e);if(-1!==h)return r.children.splice(h,1),l.push(r),this._condense(l),this}s||r.leaf||!d(r,a)?n?(i++,r=n.children[i],s=!1):r=null:(l.push(r),c.push(i),i=0,n=r,r=r.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var o,r=i-e+1,a=this._maxEntries;if(r<=a)return s(o=_(t.slice(e,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(r)/Math.log(a)),a=Math.ceil(r/Math.pow(a,n-1))),(o=_([])).leaf=!1,o.height=n;var l=Math.ceil(r/a),c=l*Math.ceil(Math.sqrt(a));m(t,e,i,c,this.compareMinX);for(var h=e;h<=i;h+=c){var u=Math.min(h+c-1,i);m(t,h,u,l,this.compareMinY);for(var d=h;d<=u;d+=l){var p=Math.min(d+l-1,u);o.children.push(this._build(t,d,p,n-1))}}return s(o,this.toBBox),o},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var o=1/0,s=1/0,r=void 0,a=0;a<e.children.length;a++){var l=e.children[a],c=h(l),u=(d=t,p=l,(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-c);u<s?(s=u,o=c<o?c:o,r=l):u===s&&c<o&&(o=c,r=l)}e=r||e.children[0]}var d,p;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),o=[],s=this._chooseSubtree(n,this.data,e,o);for(s.children.push(t),a(s,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var r=this._chooseSplitIndex(i,o,n),a=_(i.children.splice(r,i.children.length-r));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=_([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,o,s,a,l,c,u,d=1/0,p=1/0,_=e;_<=i-e;_++){var m=r(t,0,_,this.toBBox),f=r(t,_,i,this.toBBox),g=(o=m,s=f,a=Math.max(o.minX,s.minX),l=Math.max(o.minY,s.minY),c=Math.min(o.maxX,s.maxX),u=Math.min(o.maxY,s.maxY),Math.max(0,c-a)*Math.max(0,u-l)),y=h(m)+h(f);g<d?(d=g,n=_,p=y<p?y:p):g===d&&y<p&&(p=y,n=_)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:l,o=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,o)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var o=this.toBBox,s=r(t,0,e,o),l=r(t,i-e,i,o),c=u(s)+u(l),h=e;h<i-e;h++){var d=t.children[h];a(s,t.leaf?o(d):d),c+=u(s)}for(var p=i-e-1;p>=e;p--){var _=t.children[p];a(l,t.leaf?o(_):_),c+=u(l)}return c},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},n},"object"==typeof t&&typeof e<"u"?e.exports=n():(i=i||self).RBush=n()})),he=r((t=>{function e(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function i(t,i,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return e({type:"Point",coordinates:t},i,n)}function n(t,i,n){void 0===n&&(n={});for(var o=0,s=t;o<s.length;o++){var r=s[o];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<r[r.length-1].length;a++)if(r[r.length-1][a]!==r[0][a])throw new Error("First and last Position are not equivalent.")}return e({type:"Polygon",coordinates:t},i,n)}function o(t,i,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return e({type:"LineString",coordinates:t},i,n)}function s(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function r(t,i,n){return void 0===n&&(n={}),e({type:"MultiLineString",coordinates:t},i,n)}function a(t,i,n){return void 0===n&&(n={}),e({type:"MultiPoint",coordinates:t},i,n)}function l(t,i,n){return void 0===n&&(n={}),e({type:"MultiPolygon",coordinates:t},i,n)}function c(e,i){void 0===i&&(i="kilometers");var n=t.factors[i];if(!n)throw new Error(i+" units is invalid");return e*n}function h(e,i){void 0===i&&(i="kilometers");var n=t.factors[i];if(!n)throw new Error(i+" units is invalid");return e/n}function u(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:1.0936*t.earthRadius},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=e,t.geometry=function(t,e,s){switch(t){case"Point":return i(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return n(e).geometry;case"MultiPoint":return a(e).geometry;case"MultiLineString":return r(e).geometry;case"MultiPolygon":return l(e).geometry;default:throw new Error(t+" is invalid")}},t.point=i,t.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},t.polygon=n,t.polygons=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return n(t,e)})),i)},t.lineString=o,t.lineStrings=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return o(t,e)})),i)},t.featureCollection=s,t.multiLineString=r,t.multiPoint=a,t.multiPolygon=l,t.geometryCollection=function(t,i,n){return void 0===n&&(n={}),e({type:"GeometryCollection",geometries:t},i,n)},t.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i},t.radiansToLength=c,t.lengthToRadians=h,t.lengthToDegrees=function(t,e){return u(h(t,e))},t.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},t.radiansToDegrees=u,t.degreesToRadians=function(t){return t%360*Math.PI/180},t.convertLength=function(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(h(t,e),i)},t.convertArea=function(e,i,n){if(void 0===i&&(i="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[i];if(!o)throw new Error("invalid original units");var s=t.areaFactors[n];if(!s)throw new Error("invalid final units");return e/o*s},t.isNumber=d,t.isObject=function(t){return!!t&&t.constructor===Object},t.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},t.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}})),ue=r((t=>{Object.defineProperty(t,"__esModule",{value:!0});var e=he();function i(t,e,n){if(null!==t)for(var o,s,r,a,l,c,h,u,d=0,p=0,_=t.type,m="FeatureCollection"===_,f="Feature"===_,g=m?t.features.length:1,y=0;y<g;y++){l=(u=!!(h=m?t.features[y].geometry:f?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var v=0;v<l;v++){var b=0,k=0;if(null!==(a=u?h.geometries[v]:h)){c=a.coordinates;var w=a.type;switch(d=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(c,p,y,b,k))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(o=0;o<c.length;o++){if(!1===e(c[o],p,y,b,k))return!1;p++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(o=0;o<c.length;o++){for(s=0;s<c[o].length-d;s++){if(!1===e(c[o][s],p,y,b,k))return!1;p++}"MultiLineString"===w&&b++,"Polygon"===w&&k++}"Polygon"===w&&b++;break;case"MultiPolygon":for(o=0;o<c.length;o++){for(k=0,s=0;s<c[o].length;s++){for(r=0;r<c[o][s].length-d;r++){if(!1===e(c[o][s][r],p,y,b,k))return!1;p++}k++}b++}break;case"GeometryCollection":for(o=0;o<a.geometries.length;o++)if(!1===i(a.geometries[o],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function n(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function o(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function s(t,e){var i,n,o,s,r,a,l,c,h,u,d=0,p="FeatureCollection"===t.type,_="Feature"===t.type,m=p?t.features.length:1;for(i=0;i<m;i++){for(a=p?t.features[i].geometry:_?t.geometry:t,c=p?t.features[i].properties:_?t.properties:{},h=p?t.features[i].bbox:_?t.bbox:void 0,u=p?t.features[i].id:_?t.id:void 0,r=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<r;o++)if(null!==(s=l?a.geometries[o]:a))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(s,d,c,h,u))return!1;break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===e(s.geometries[n],d,c,h,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,c,h,u))return!1;d++}}function r(t,i){s(t,(function(t,n,o,s,r){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==i(e.feature(t,o,{bbox:s,id:r}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<t.coordinates.length;c++){var h={type:a,coordinates:t.coordinates[c]};if(!1===i(e.feature(h,o),n,c))return!1}}))}function a(t,n){r(t,(function(t,o,s){var r=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,c=0,h=0,u=0;if(!1===i(t,(function(i,a,d,p,_){if(void 0===l||o>c||p>h||_>u)return l=i,c=o,h=p,u=_,void(r=0);var m=e.lineString([l,i],t.properties);if(!1===n(m,o,s,_,r))return!1;r++,l=i})))return!1}}}))}function l(t,i){if(!t)throw new Error("geojson is required");r(t,(function(t,n,o){if(null!==t.geometry){var s=t.geometry.type,r=t.geometry.coordinates;switch(s){case"LineString":if(!1===i(t,n,o,0,0))return!1;break;case"Polygon":for(var a=0;a<r.length;a++)if(!1===i(e.lineString(r[a],t.properties),n,o,a))return!1}}}))}t.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},t.coordEach=i,t.coordReduce=function(t,e,n,o){var s=n;return i(t,(function(t,i,o,r,a){s=0===i&&void 0===n?t:e(s,t,i,o,r,a)}),o),s},t.featureEach=o,t.featureReduce=function(t,e,i){var n=i;return o(t,(function(t,o){n=0===o&&void 0===i?t:e(n,t,o)})),n},t.findPoint=function(t,i){if(i=i||{},!e.isObject(i))throw new Error("options is invalid");var n,o=i.featureIndex||0,s=i.multiFeatureIndex||0,r=i.geometryIndex||0,a=i.coordIndex||0,l=i.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),l=l||t.features[o].properties,n=t.features[o].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return e.point(c,l,i);case"MultiPoint":return s<0&&(s=c.length+s),e.point(c[s],l,i);case"LineString":return a<0&&(a=c.length+a),e.point(c[a],l,i);case"Polygon":return r<0&&(r=c.length+r),a<0&&(a=c[r].length+a),e.point(c[r][a],l,i);case"MultiLineString":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a),e.point(c[s][a],l,i);case"MultiPolygon":return s<0&&(s=c.length+s),r<0&&(r=c[s].length+r),a<0&&(a=c[s][r].length-a),e.point(c[s][r][a],l,i)}throw new Error("geojson is invalid")},t.findSegment=function(t,i){if(i=i||{},!e.isObject(i))throw new Error("options is invalid");var n,o=i.featureIndex||0,s=i.multiFeatureIndex||0,r=i.geometryIndex||0,a=i.segmentIndex||0,l=i.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),l=l||t.features[o].properties,n=t.features[o].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),e.lineString([c[a],c[a+1]],l,i);case"Polygon":return r<0&&(r=c.length+r),a<0&&(a=c[r].length+a-1),e.lineString([c[r][a],c[r][a+1]],l,i);case"MultiLineString":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a-1),e.lineString([c[s][a],c[s][a+1]],l,i);case"MultiPolygon":return s<0&&(s=c.length+s),r<0&&(r=c[s].length+r),a<0&&(a=c[s][r].length-a-1),e.lineString([c[s][r][a],c[s][r][a+1]],l,i)}throw new Error("geojson is invalid")},t.flattenEach=r,t.flattenReduce=function(t,e,i){var n=i;return r(t,(function(t,o,s){n=0===o&&0===s&&void 0===i?t:e(n,t,o,s)})),n},t.geomEach=s,t.geomReduce=function(t,e,i){var n=i;return s(t,(function(t,o,s,r,a){n=0===o&&void 0===i?t:e(n,t,o,s,r,a)})),n},t.lineEach=l,t.lineReduce=function(t,e,i){var n=i;return l(t,(function(t,o,s,r){n=0===o&&void 0===i?t:e(n,t,o,s,r)})),n},t.propEach=n,t.propReduce=function(t,e,i){var o=i;return n(t,(function(t,n){o=0===n&&void 0===i?t:e(o,t,n)})),o},t.segmentEach=a,t.segmentReduce=function(t,e,i){var n=i,o=!1;return a(t,(function(t,s,r,a,l){n=!1===o&&void 0===i?t:e(n,t,s,r,a,l),o=!0})),n}})),de=r((t=>{Object.defineProperty(t,"__esModule",{value:!0});var e=ue();function i(t){var i=[1/0,1/0,-1/0,-1/0];return e.coordEach(t,(function(t){i[0]>t[0]&&(i[0]=t[0]),i[1]>t[1]&&(i[1]=t[1]),i[2]<t[0]&&(i[2]=t[0]),i[3]<t[1]&&(i[3]=t[1])})),i}i.default=i,t.default=i})),pe=r(((t,e)=>{var i=ce(),n=he(),o=ue(),s=de().default,r=o.featureEach;o.coordEach,n.polygon;var a=n.featureCollection;function l(t){var e=new i(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):r(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),i.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.remove.call(this,t,e)},e.clear=function(){return i.prototype.clear.call(this)},e.search=function(t){var e=i.prototype.search.call(this,this.toBBox(t));return a(e)},e.collides=function(t){return i.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=i.prototype.all.call(this);return a(t)},e.toJSON=function(){return i.prototype.toJSON.call(this)},e.fromJSON=function(t){return i.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}e.exports=l,e.exports.default=l}));Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),i=e.length>>>0,n=arguments[1],o=0;o<i;o++)if(t.call(n,e[o],o,e))return o;return-1},Array.prototype.find=Array.prototype.find||function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),i=e.length>>>0,n=arguments[1],o=0;o<i;o++){var s=e[o];if(t.call(n,s,o,e))return s}},"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var i=arguments[e];if(null!=i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;var o,s,r=0|e,a=Math.max(r>=0?r:n-Math.abs(r),0);for(;a<n;){if((o=i[a])===(s=t)||"number"==typeof o&&"number"==typeof s&&isNaN(o)&&isNaN(s))return!0;a++}return!1}});var _e=a(Kt()),me={en:{tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},de:{tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex lschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer lschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Lnge",segmentLength:"Segment Lnge",area:"Flche",radius:"Radius",perimeter:"Umfang",height:"Hhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},it:{tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},id:{tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},ro:{tooltips:{placeMarker:"Adaug un punct",firstVertex:"Apas aici pentru a aduga primul Vertex",continueLine:"Apas aici pentru a continua desenul",finishLine:"Apas pe orice obiect pentru a finisa desenul",finishPoly:"Apas pe primul obiect pentru a finisa",finishRect:"Apas pentru a finisa",startCircle:"Apas pentru a desena un cerc",finishCircle:"Apas pentru a finisa un cerc",placeCircleMarker:"Adaug un punct"},actions:{finish:"Termin",cancel:"Anuleaz",removeLastVertex:"terge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaug o bulin",drawPolyButton:"Deseneaz un poligon",drawLineButton:"Deseneaz o linie",drawCircleButton:"Deseneaz un cerc",drawRectButton:"Deseneaz un dreptunghi",editButton:"Editeaz straturile",dragButton:"Mut straturile",cutButton:"Taie straturile",deleteButton:"terge straturile",drawCircleMarkerButton:"Deseneaz marcatorul cercului",snappingButton:"Fixai marcatorul glisat pe alte straturi i vrfuri",pinningButton:"Fixai vrfurile partajate mpreun",rotateButton:"Rotii stratul"}},ru:{tooltips:{placeMarker:",   ",firstVertex:",    ",continueLine:",   ",finishLine:"     ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" "}},es:{tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vrtice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del crculo",finishCircle:"Presiona para finalizar el crculo",placeCircleMarker:"Presiona para colocar un marcador de crculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar ltimo vrtice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polgono",drawLineButton:"Dibujar Lnea",drawCircleButton:"Dibujar Crculo",drawRectButton:"Dibujar Rectngulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Crculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vrtices",pinningButton:"Fijar juntos los vrtices compartidos",rotateButton:"Rotar capa"}},nl:{tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beindigen",finishPoly:"Klik op het eerst punt om te beindigen",finishRect:"Klik om te beindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},fr:{tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer  dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"diter des calques",dragButton:"Dplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"pingler ensemble les sommets partags",rotateButton:"Tourner des calques"}},pt_br:{tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vrtice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do crculo",finishCircle:"Clique para finalizar o crculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover ltimo vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},pt_pt:{tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vrtice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do crculo",finishCircle:"Clique para terminar o crculo",placeCircleMarker:"Clique para colocar marcador de crculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover ltimo Vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},zh:{tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},zh_tw:{tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},pl:{tooltips:{placeMarker:"Kliknij, aby umieci znacznik",firstVertex:"Kliknij, aby umieci pierwszy wierzchoek",continueLine:"Kliknij, aby kontynuowa rysowanie",finishLine:"Kliknij dowolny istniejcy znacznik, aby zakoczy",finishPoly:"Kliknij pierwszy znacznik, aby zakoczy",finishRect:"Kliknij, aby zakoczy",startCircle:"Kliknij, aby umieci rodek okrgu",finishCircle:"Kliknij, aby zakoczy okrg",placeCircleMarker:"Kliknij, aby umieci znacznik okrgu",placeText:"Kliknij, aby umieci tekst"},actions:{finish:"Zakocz",cancel:"Anuluj",removeLastVertex:"Usu ostatni wierzchoek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokt",drawLineButton:"Rysuj lini",drawCircleButton:"Rysuj okrg",drawRectButton:"Rysuj prostokt",editButton:"Edytuj warstwy",dragButton:"Przecignij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usu warstwy",drawCircleMarkerButton:"Rysuj znacznik okrgy",snappingButton:"Przycignij przenoszony znacznik do innych warstw i wierzchokw",pinningButton:"Przypnij wsplne wierzchoki razem",rotateButton:"Obr warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne ledzenie linii"},measurements:{totalLength:"Dugo",segmentLength:"Dugo odcinka",area:"Obszar",radius:"Promie",perimeter:"Obwd",height:"Wysoko",width:"Szeroko",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},sv:{tooltips:{placeMarker:"Klicka fr att placera markr",firstVertex:"Klicka fr att placera frsta hrnet",continueLine:"Klicka fr att fortstta rita",finishLine:"Klicka p en existerande punkt fr att slutfra",finishPoly:"Klicka p den frsta punkten fr att slutfra",finishRect:"Klicka fr att slutfra",startCircle:"Klicka fr att placera cirkelns centrum",finishCircle:"Klicka fr att slutfra cirkeln",placeCircleMarker:"Klicka fr att placera cirkelmarkr"},actions:{finish:"Slutfr",cancel:"Avbryt",removeLastVertex:"Ta bort sista hrnet"},buttonTitles:{drawMarkerButton:"Rita Markr",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkr",snappingButton:"Snpp dra markren till andra lager och hrn",pinningButton:"Fst delade hrn tillsammans",rotateButton:"Rotera lagret"}},el:{tooltips:{placeMarker:"     ",firstVertex:"       ",continueLine:"      ",finishLine:"        ",finishPoly:"       ",finishRect:"    ",startCircle:"      ",finishCircle:"      ",placeCircleMarker:"      "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"        ",pinningButton:"   ",rotateButton:"  "}},hu:{tooltips:{placeMarker:"Kattintson a jell elhelyezshez",firstVertex:"Kattintson az els pont elhelyezshez",continueLine:"Kattintson a kvetkez pont elhelyezshez",finishLine:"A befejezshez kattintson egy meglv pontra",finishPoly:"A befejezshez kattintson az els pontra",finishRect:"Kattintson a befejezshez",startCircle:"Kattintson a kr kzppontjnak elhelyezshez",finishCircle:"Kattintson a kr befejezshez",placeCircleMarker:"Kattintson a krjell elhelyezshez"},actions:{finish:"Befejezs",cancel:"Mgse",removeLastVertex:"Utols pont eltvoltsa"},buttonTitles:{drawMarkerButton:"Jell rajzolsa",drawPolyButton:"Poligon rajzolsa",drawLineButton:"Vonal rajzolsa",drawCircleButton:"Kr rajzolsa",drawRectButton:"Ngyzet rajzolsa",editButton:"Elemek szerkesztse",dragButton:"Elemek mozgatsa",cutButton:"Elemek vgsa",deleteButton:"Elemek trlse",drawCircleMarkerButton:"Kr jell rajzolsa",snappingButton:"Kapcsolja a jelltt msik elemhez vagy ponthoz",pinningButton:"Kzs pontok sszektse",rotateButton:"Flia elforgatsa"}},da:{tooltips:{placeMarker:"Tryk for at placere en markr",firstVertex:"Tryk for at placere det frste punkt",continueLine:"Tryk for at fortstte linjen",finishLine:"Tryk p et eksisterende punkt for at afslutte",finishPoly:"Tryk p det frste punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkr"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markr",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Trk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkr",snappingButton:"Fastgr trukket markr til andre elementer",pinningButton:"Sammenlg delte elementer",rotateButton:"Roter laget"}},no:{tooltips:{placeMarker:"Klikk for  plassere punkt",firstVertex:"Klikk for  plassere frste punkt",continueLine:"Klikk for  tegne videre",finishLine:"Klikk p et eksisterende punkt for  fullfre",finishPoly:"Klikk frste punkt for  fullfre",finishRect:"Klikk for  fullfre",startCircle:"Klikk for  sette sirkel midtpunkt",finishCircle:"Klikk for  fullfre sirkel",placeCircleMarker:"Klikk for  plassere sirkel",placeText:"Klikk for  plassere tekst"},actions:{finish:"Fullfr",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotr objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalr objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Omrde",radius:"Radius",perimeter:"Omriss",height:"Hyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkr"}},fa:{tooltips:{placeMarker:"   ",firstVertex:"    ",continueLine:"   ",finishLine:"      ",finishPoly:"     ",finishRect:"  ",startCircle:"    ",finishCircle:"    ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"      ",rotateButton:" ",drawTextButton:" ",scaleButton:"",autoTracingButton:" "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}},ua:{tooltips:{placeMarker:",   ",firstVertex:",    ",continueLine:",   ",finishLine:" -    ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"'   ",rotateButton:" "}},tr:{tooltips:{placeMarker:"areti yerletirmek iin tklayn",firstVertex:"lk tepe noktasn yerletirmek iin tklayn",continueLine:"izime devam etmek iin tklayn",finishLine:"Bitirmek iin mevcut herhangi bir iaretiyi tklayn",finishPoly:"Bitirmek iin ilk iaretiyi tklayn",finishRect:"Bitirmek iin tklayn",startCircle:"Daire merkezine yerletirmek iin tklayn",finishCircle:"Daireyi bitirmek iin tklayn",placeCircleMarker:"Daire iaretisi yerletirmek iin tklayn"},actions:{finish:"Bitir",cancel:"ptal",removeLastVertex:"Son keyi kaldr"},buttonTitles:{drawMarkerButton:"izim aretisi",drawPolyButton:"okgenler iz",drawLineButton:"oklu izgi iz",drawCircleButton:"ember iz",drawRectButton:"Dikdrtgen iz",editButton:"Katmanlar dzenle",dragButton:"Katmanlar srkle",cutButton:"Katmanlar kes",deleteButton:"Katmanlar kaldr",drawCircleMarkerButton:"Daire iaretisi iz",snappingButton:"Srklenen iaretiyi dier katmanlara ve kelere yaptr",pinningButton:"Paylalan keleri birbirine sabitle",rotateButton:"Katman dndr"}},cz:{tooltips:{placeMarker:"Kliknutm vytvote znaku",firstVertex:"Kliknutm vytvote prvn objekt",continueLine:"Kliknutm pokraujte v kreslen",finishLine:"Kliknut na libovolnou existujc znaku pro dokonen",finishPoly:"Vyberte prvn bod pro dokonen",finishRect:"Kliknte pro dokonen",startCircle:"Kliknutm pidejte sted kruhu",finishCircle:",   ",placeCircleMarker:"Kliknutm nastavte polomr"},actions:{finish:"Dokonit",cancel:"Zruit",removeLastVertex:"Zruit posledn akci"},buttonTitles:{drawMarkerButton:"Pidat znaku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit kivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdlnk",editButton:"Upravit vrstvu",dragButton:"Peneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Pidat kruhovou znaku",snappingButton:"Navzat tanou znaku k dalm vrstvm a vrcholm",pinningButton:"Spojit spolen body dohromady",rotateButton:"Otote vrstvu"}},ja:{tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:"",placeText:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:"",drawTextButton:""}},fi:{tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtmist",finishLine:"Klikkaa olemassa olevaa merkki lopettaaksesi",finishPoly:"Klikkaa ensimmist merkki lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrn keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrn",placeCircleMarker:"Klikkaa asettaaksesi ympyrmerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirr merkkej",drawPolyButton:"Piirr monikulmioita",drawLineButton:"Piirr viivoja",drawCircleButton:"Piirr ympyr",drawRectButton:"Piirr neliskulmioita",editButton:"Muokkaa",dragButton:"Siirr",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirr ympyrmerkki",snappingButton:"Kiinnit siirrettv merkki toisiin muotoihin",pinningButton:"Kiinnit jaetut muodot yhteen",rotateButton:"Knn",drawTextButton:"Piirr teksti"}},ko:{tooltips:{placeMarker:"  ",firstVertex:"   ",continueLine:"  ",finishLine:"   ",finishPoly:"   ",finishRect:" ",startCircle:"    ",finishCircle:"  ",placeCircleMarker:"   ",placeText:"  "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" ",drawTextButton:" "}},ky:{tooltips:{placeMarker:"   ",firstVertex:"    ",continueLine:"    ",finishLine:"    ",finishPoly:"    ",finishRect:"  ",startCircle:"    ",finishCircle:"   ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:" ",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:"  ",cutButton:"  ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"     ",pinningButton:"   ",rotateButton:" ",drawTextButton:" ",scaleButton:"  ",autoTracingButton:"  "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}}},fe={_globalEditModeEnabled:!1,enableGlobalEditMode(t){let e={...t};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach((t=>{this._isRelevantForEdit(t)&&t.pm.enable(e)})),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach((t=>{t.pm.disable()})),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(t=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)},handleLayerAdditionInGlobalEditMode(){let t=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let e in t){let i=t[e];this._isRelevantForEdit(i)&&i.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:t}){this._addedLayersEdit[L.stamp(t)]=t},_isRelevantForEdit:t=>t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowEditing},ge={_globalDragModeEnabled:!1,enableGlobalDragMode(){let t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},t.forEach((t=>{this._isRelevantForDrag(t)&&t.pm.enableLayerDrag()})),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,t.forEach((t=>{t.pm.disableLayerDrag()})),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let t=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let e in t){let i=t[e];this._isRelevantForDrag(i)&&i.pm.enableLayerDrag()}},_layerAddedDrag({layer:t}){this._addedLayersDrag[L.stamp(t)]=t},_isRelevantForDrag:t=>t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.draggable},ye={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer((t=>{this._isRelevantForRemoval(t)&&(t.pm.enabled()&&t.pm.disable(),t.on("click",this.removeLayer,this))})),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer((t=>{t.off("click",this.removeLayer,this)})),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(t){let e=t.target;this._isRelevantForRemoval(e)&&!e.pm.dragging()&&(e.removeFrom(this.map.pm._getContainingLayer()),e.remove(),e instanceof L.LayerGroup?(this._fireRemoveLayerGroup(e),this._fireRemoveLayerGroup(this.map,e)):(e.pm._fireRemove(e),e.pm._fireRemove(this.map,e)))},_isRelevantForRemoval:t=>t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRemoval,handleLayerAdditionInGlobalRemovalMode(){let t=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let e in t){let i=t[e];this._isRelevantForRemoval(i)&&(i.pm.enabled()&&i.pm.disable(),i.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:t}){this._addedLayersRemoval[L.stamp(t)]=t}},ve={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter((t=>t instanceof L.Polyline)).forEach((t=>{this._isRelevantForRotate(t)&&t.pm.enableRotate()})),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter((t=>t instanceof L.Polyline)).forEach((t=>{t.pm.disableRotate()})),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate:t=>t.pm&&t instanceof L.Polyline&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRotation,handleLayerAdditionInGlobalRotateMode(){let t=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let e in t){let i=t[e];this._isRelevantForRemoval(i)&&i.pm.enableRotate()}},_layerAddedRotate({layer:t}){this._addedLayersRotate[L.stamp(t)]=t}},be=a(Kt()),ke={_fireDrawStart(t="Draw",e={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},t,e)},_fireDrawEnd(t="Draw",e={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},t,e)},_fireCreate(t,e="Draw",i={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:t,layer:t},e,i)},_fireCenterPlaced(t="Draw",e={}){let i="Draw"===t?this._layer:void 0,n="Draw"!==t?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:i,layer:n,latlng:this._layer.getLatLng()},t,e)},_fireCut(t,e,i,n="Draw",o={}){this.__fire(t,"pm:cut",{shape:this._shape,layer:e,originalLayer:i},n,o)},_fireEdit(t=this._layer,e="Edit",i={}){this.__fire(t,"pm:edit",{layer:this._layer,shape:this.getShape()},e,i)},_fireEnable(t="Edit",e={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDisable(t="Edit",e={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},t,e)},_fireUpdate(t="Edit",e={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},t,e)},_fireMarkerDragStart(t,e=void 0,i="Edit",n={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},i,n)},_fireMarkerDrag(t,e=void 0,i="Edit",n={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},i,n)},_fireMarkerDragEnd(t,e=void 0,i=void 0,n="Edit",o={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e,intersectionReset:i},n,o)},_fireDragStart(t="Edit",e={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},t,e)},_fireDrag(t,e="Edit",i={}){this.__fire(this._layer,"pm:drag",{...t,shape:this.getShape()},e,i)},_fireDragEnd(t="Edit",e={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragEnable(t="Edit",e={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragDisable(t="Edit",e={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},t,e)},_fireRemove(t,e=t,i="Edit",n={}){this.__fire(t,"pm:remove",{layer:e,shape:this.getShape()},i,n)},_fireVertexAdded(t,e,i,n="Edit",o={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:t,indexPath:e,latlng:i,shape:this.getShape()},n,o)},_fireVertexRemoved(t,e,i="Edit",n={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:t,indexPath:e,shape:this.getShape()},i,n)},_fireVertexClick(t,e,i="Edit",n={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},i,n)},_fireIntersect(t,e=this._layer,i="Edit",n={}){this.__fire(e,"pm:intersect",{layer:this._layer,intersection:t,shape:this.getShape()},i,n)},_fireLayerReset(t,e,i="Edit",n={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},i,n)},_fireChange(t,e="Edit",i={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:t,shape:this.getShape()},e,i)},_fireTextChange(t,e="Edit",i={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:t,shape:this.getShape()},e,i)},_fireTextFocus(t="Edit",e={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},t,e)},_fireTextBlur(t="Edit",e={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},t,e)},_fireSnapDrag(t,e,i="Snapping",n={}){this.__fire(t,"pm:snapdrag",e,i,n)},_fireSnap(t,e,i="Snapping",n={}){this.__fire(t,"pm:snap",e,i,n)},_fireUnsnap(t,e,i="Snapping",n={}){this.__fire(t,"pm:unsnap",e,i,n)},_fireRotationEnable(t,e,i="Rotation",n={}){this.__fire(t,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},i,n)},_fireRotationDisable(t,e="Rotation",i={}){this.__fire(t,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},e,i)},_fireRotationStart(t,e,i="Rotation",n={}){this.__fire(t,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:e},i,n)},_fireRotation(t,e,i,n=this._rotationLayer,o="Rotation",s={}){this.__fire(t,"pm:rotate",{layer:n,helpLayer:this._layer,startAngle:this._startAngle,angle:n.pm.getAngle(),angleDiff:e,oldLatLngs:i,newLatLngs:n.getLatLngs()},o,s)},_fireRotationEnd(t,e,i,n="Rotation",o={}){this.__fire(t,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:e,angle:this._rotationLayer.pm.getAngle(),originLatLngs:i,newLatLngs:this._rotationLayer.getLatLngs()},n,o)},_fireActionClick(t,e,i,n="Toolbar",o={}){this.__fire(this._map,"pm:actionclick",{text:t.text,action:t,btnName:e,button:i},n,o)},_fireButtonClick(t,e,i="Toolbar",n={}){this.__fire(this._map,"pm:buttonclick",{btnName:t,button:e},i,n)},_fireLangChange(t,e,i,n,o="Global",s={}){this.__fire(this.map,"pm:langchange",{oldLang:t,activeLang:e,fallback:i,translations:n},o,s)},_fireGlobalDragModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalEditModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalRemovalModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalCutModeToggled(t="Global",e={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},t,e)},_fireGlobalDrawModeToggled(t="Global",e={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},t,e)},_fireGlobalRotateModeToggled(t="Global",e={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},t,e)},_fireRemoveLayerGroup(t,e=t,i="Edit",n={}){this.__fire(t,"pm:remove",{layer:e,shape:void 0},i,n)},_fireKeyeventEvent(t,e,i,n="Global",o={}){this.__fire(this.map,"pm:keyevent",{event:t,eventType:e,focusOn:i},n,o)},__fire(t,e,i,n,o={}){i=(0,be.default)(i,o,{source:n}),L.PM.Utils._fireEvent(t,e,i)}},we=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(t){this.map=t,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),t.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(t){let e="document";this.map.getContainer().contains(t.target)&&(e="map");let i={event:t,eventType:t.type,focusOn:e};this._lastEvents[t.type]=i,this._lastEvents.current=i,this.map.pm._fireKeyeventEvent(t,t.type,e)},_onBlur(t){t.altKey=!1;let e={event:t,eventType:t.type,focusOn:"document"};this._lastEvents[t.type]=e,this._lastEvents.current=e},getLastKeyEvent(t="current"){return this._lastEvents[t]},isShiftKeyPressed(){return this._lastEvents.current?.event.shiftKey},isAltKeyPressed(){return this._lastEvents.current?.event.altKey},isCtrlKeyPressed(){return this._lastEvents.current?.event.ctrlKey},isMetaKeyPressed(){return this._lastEvents.current?.event.metaKey},getPressedKey(){return this._lastEvents.current?.event.key}}),Le=a(le());function xe(t){let e=L.PM.activeLang;return(0,Le.default)(me[e],t)||(0,Le.default)(me.en,t)||t}function $e(t){for(let e=0;e<t.length;e+=1){let i=t[e];if(Array.isArray(i)){if($e(i))return!0}else if(null!=i&&""!==i)return!0}return!1}function Ce(t){return t.reduce(((t,e)=>{if(0!==e.length){let i=Array.isArray(e)?Ce(e):e;Array.isArray(i)?0!==i.length&&t.push(i):t.push(i)}return t}),[])}function Me(t,e,i){let n,o,s,r={a:L.CRS.Earth.R,b:6356752.3142,f:.0033528106647474805},{a:a,b:l,f:c}=r,h=t.lng,u=t.lat,d=i,p=Math.PI,_=e*p/180,m=Math.sin(_),f=Math.cos(_),g=(1-c)*Math.tan(u*p/180),y=1/Math.sqrt(1+g*g),v=g*y,b=Math.atan2(g,f),k=y*m,w=1-k*k,x=w*(a*a-l*l)/(l*l),$=1+x/16384*(4096+x*(x*(320-175*x)-768)),C=x/1024*(256+x*(x*(74-47*x)-128)),M=d/(l*$),E=2*Math.PI;for(;Math.abs(M-E)>1e-12;){n=Math.cos(2*b+M),o=Math.sin(M),s=Math.cos(M),E=M,M=d/(l*$)+C*o*(n+C/4*(s*(2*n*n-1)-C/6*n*(4*o*o-3)*(4*n*n-3)))}let T=v*o-y*s*f,P=Math.atan2(v*s+y*o*f,(1-c)*Math.sqrt(k*k+T*T)),S=c/16*w*(4+c*(4-3*w)),O=h+180*(Math.atan2(o*m,y*s-v*o*f)-(1-S)*c*k*(M+S*o*(n+S*s*(2*n*n-1))))/p,D=180*P/p;return L.latLng(O,D)}function Ee(t,e,i,n,o=!0){let s,r,a,l=[];for(let c=0;c<i;c+=1){if(o)s=360*c/i+n,r=Me(t,s,e),a=L.latLng(r.lng,r.lat);else{let n=t.lat+Math.cos(2*c*Math.PI/i)*e,o=t.lng+Math.sin(2*c*Math.PI/i)*e;a=L.latLng(n,o)}l.push(a)}return l}function Te(t,e,i){let n=t.latLngToContainerPoint(e),o=t.latLngToContainerPoint(i),s=180*Math.atan2(o.y-n.y,o.x-n.x)/Math.PI+90;return s+=s<0?360:0,s}function Pe(t,e,i,n){return function(t,e,i){e=(e+360)%360;let n=Math.PI/180,o=180/Math.PI,{R:s}=L.CRS.Earth,r=t.lng*n,a=t.lat*n,l=e*n,c=Math.sin(a),h=Math.cos(a),u=Math.cos(i/s),d=Math.sin(i/s),p=Math.asin(c*u+h*d*Math.cos(l)),_=r+Math.atan2(Math.sin(l)*d*h,u-c*Math.sin(p));return _*=o,_=_>180?_-360:_<-180?_+360:_,L.latLng([p*o,_])}(e,Te(t,e,i),n)}function Se(t,e=t.getLatLngs()){return t instanceof L.Polygon?L.polygon(e).getLatLngs():L.polyline(e).getLatLngs()}function Oe(t,e){if(e.options.crs?.projection?.MAX_LATITUDE){let i=e.options.crs?.projection?.MAX_LATITUDE;t.lat=Math.max(Math.min(i,t.lat),-i)}return t}function De(t){return t.options.renderer||t._map&&(t._map._getPaneRenderer(t.options.pane)||t._map.options.renderer||t._map._renderer)||t._renderer}var Ie=L.Class.extend({includes:[fe,ge,ye,ve,ke],initialize(t){this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this.Keyboard=we(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(t)},setLang(t="en",e,i="en"){let n=L.PM.activeLang;e&&(me[t]=(0,_e.default)(me[i],e)),L.PM.activeLang=t,this.map.pm.Toolbar.reinit(),this._fireLangChange(n,t,i,me[t])},addControls(t){this.Toolbar.addControls(t)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(t="Polygon",e){"Poly"===t&&(t="Polygon"),this.Draw.enable(t,e)},disableDraw(t="Polygon"){"Poly"===t&&(t="Polygon"),this.Draw.disable(t)},setPathOptions(t,e={}){let i=e.ignoreShapes||[],n=e.merge||!1;this.map.pm.Draw.shapes.forEach((e=>{-1===i.indexOf(e)&&this.map.pm.Draw[e].setPathOptions(t,n)}))},getGlobalOptions(){return this.globalOptions},setGlobalOptions(t){let e=(0,_e.default)(this.globalOptions,t);e.editable&&(e.resizeableCircleMarker=e.editable,delete e.editable);let i=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!e.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),i=!0);let n=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizableCircle!=!!e.resizableCircle&&(this.map.pm.Draw.Circle.disable(),n=!0),this.map.pm.Draw.shapes.forEach((t=>{this.map.pm.Draw[t].setOptions(e)})),i&&this.map.pm.Draw.CircleMarker.enable(),n&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach((t=>{t.pm.setOptions(e)})),this.map.fire("pm:globaloptionschanged"),this.globalOptions=e,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach((t=>{t.pm.enabled()&&t.pm.applyOptions()}))},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(t){return this.Draw.Cut.enable(t)},toggleGlobalCutMode(t){return this.Draw.Cut.toggle(t)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(t=!1){let e=L.PM.Utils.findLayers(this.map);if(!t)return e;let i=L.featureGroup();return i._pmTempLayer=!0,e.forEach((t=>{i.addLayer(t)})),i},getGeomanDrawLayers(t=!1){let e=L.PM.Utils.findLayers(this.map).filter((t=>!0===t._drawnByGeoman));if(!t)return e;let i=L.featureGroup();return i._pmTempLayer=!0,e.forEach((t=>{i.addLayer(t)})),i},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(t){0===this._touchEventCounter&&(L.DomEvent.on(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(t){1===this._touchEventCounter&&(L.DomEvent.off(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(t){De(this.map)._onMouseMove(this._createMouseEvent("mousemove",t))},_canvasTouchClick(t){let e="";"touchstart"===t.type||"pointerdown"===t.type?e="mousedown":("touchend"===t.type||"pointerup"===t.type||"touchcancel"===t.type||"pointercancel"===t.type)&&(e="mouseup"),e&&De(this.map)._onClick(this._createMouseEvent(e,t))},_createMouseEvent(t,e){let i,n=e.touches[0]||e.changedTouches[0];try{i=new MouseEvent(t,{bubbles:e.bubbles,cancelable:e.cancelable,view:e.view,detail:n.detail,screenX:n.screenX,screenY:n.screenY,clientX:n.clientX,clientY:n.clientY,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:e.button,relatedTarget:e.relatedTarget})}catch{i=document.createEvent("MouseEvents"),i.initMouseEvent(t,e.bubbles,e.cancelable,e.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}return i}}),Be=L.Control.extend({includes:[ke],options:{position:"topleft",disableByOtherButtons:!0},initialize(t){this._button=L.Util.extend({},this.options,t)},onAdd(t){return this._map=t,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):"edit"===this._button.tool?this._container=this._map.pm.Toolbar.editContainer:"options"===this._button.tool?this._container=this._map.pm.Toolbar.optionsContainer:"custom"===this._button.tool?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let t=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),t?t.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(t){return this._button.toggleStatus="boolean"==typeof t?t:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled()},_triggerClick(t){t&&t.preventDefault(),!this._button.disabled&&(this._button.onClick(t,{button:this,event:t}),this._clicked(t),this._button.afterClick(t,{button:this,event:t}))},_makeButton(t){let e=this.options.position.indexOf("right")>-1?"pos-right":"",i=L.DomUtil.create("div",`button-container  ${e}`,this._container);t.title&&i.setAttribute("title",t.title);let n=L.DomUtil.create("a","leaflet-buttons-control-button",i);n.setAttribute("role","button"),n.setAttribute("tabindex","0"),n.href="#";let o=L.DomUtil.create("div",`leaflet-pm-actions-container ${e}`,i),s=t.actions,r={cancel:{text:xe("actions.cancel"),title:xe("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:xe("actions.finish"),title:xe("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:xe("actions.removeLastVertex"),title:xe("actions.removeLastVertex"),onClick(){this._map.pm.Draw[t.jsClass]._removeLastVertex()}},finish:{text:xe("actions.finish"),title:xe("actions.finish"),onClick(e){this._map.pm.Draw[t.jsClass]._finishShape(e)}}};s.forEach((i=>{let n,s="string"==typeof i?i:i.name;if(r[s])n=r[s];else{if(!i.text)return;n=i}let a=L.DomUtil.create("a",`leaflet-pm-action ${e} action-${s}`,o);if(a.setAttribute("role","button"),a.setAttribute("tabindex","0"),a.href="#",n.title&&(a.title=n.title),a.innerHTML=n.text,L.DomEvent.disableClickPropagation(a),L.DomEvent.on(a,"click",L.DomEvent.stop),!t.disabled&&n.onClick){let e=e=>{e.preventDefault();let i="",{buttons:o}=this._map.pm.Toolbar;for(let e in o)if(o[e]._button===t){i=e;break}this._fireActionClick(n,i,t)};L.DomEvent.addListener(a,"click",e,this),L.DomEvent.addListener(a,"click",n.onClick,this)}})),t.toggleStatus&&L.DomUtil.addClass(i,"active");let a=L.DomUtil.create("div","control-icon",n);return t.iconUrl&&a.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(a,t.className),L.DomEvent.disableClickPropagation(n),L.DomEvent.on(n,"click",L.DomEvent.stop),t.disabled||(L.DomEvent.addListener(n,"click",this._onBtnClick,this),L.DomEvent.addListener(n,"click",this._triggerClick,this)),t.disabled&&(L.DomUtil.addClass(n,"pm-disabled"),n.setAttribute("aria-disabled","true")),i},_applyStyleClasses(){this._container&&(this._button.toggleStatus&&!1!==this._button.cssToggle?(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")):(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let t="",{buttons:e}=this._map.pm.Toolbar;for(let i in e)if(e[i]._button===this._button){t=i;break}this._fireButtonClick(t,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let t="pm-disabled",e=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(e,t),e.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(e,t),e.setAttribute("aria-disabled","false"))}});L.Control.PMButton=Be;var Re=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(t){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(t)},reinit(){let t=this.isVisible;this.removeControls(),this._defineButtons(),t&&this.addControls()},init(t){this.map=t,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(t){let e=`${t}Container`;return this[e]||(this[e]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${t} leaflet-bar leaflet-control`)),this[e]},getButtons(){return this.buttons},addControls(t=this.options){typeof t.editPolygon<"u"&&(t.editMode=t.editPolygon),typeof t.deleteLayer<"u"&&(t.removalMode=t.deleteLayer),L.Util.setOptions(this,t),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let t=this.getButtons(),e={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let i in t){let n=t[i];L.Util.setOptions(n,{className:e.geomanIcons[i]})}},removeControls(){let t=this.getButtons();for(let e in t)t[e].remove();this.isVisible=!1},toggleControls(t=this.options){this.isVisible?this.removeControls():this.addControls(t)},_addButton(t,e){return this.buttons[t]=e,this.options[t]=!!this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons(t){for(let e in this.buttons){let i=this.buttons[e];i._button.disableByOtherButtons&&i!==t&&i.toggled()&&i._triggerClick()}},toggleButton(t,e,i=!0){return"editPolygon"===t&&(t="editMode"),"deleteLayer"===t&&(t="removalMode"),i&&this.triggerClickOnToggledButtons(this.buttons[t]),!!this.buttons[t]&&this.buttons[t].toggle(e)},_defineButtons(){let t={className:"control-icon leaflet-pm-icon-marker",title:xe("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},e={title:xe("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={className:"control-icon leaflet-pm-icon-polyline",title:xe("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},n={title:xe("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},o={title:xe("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},s={title:xe("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},r={title:xe("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},a={title:xe("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},l={title:xe("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},c={title:xe("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},h={title:xe("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},u={className:"control-icon leaflet-pm-icon-text",title:xe("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(t,e)=>{this.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(t)),this._addButton("drawPolyline",new L.Control.PMButton(i)),this._addButton("drawRectangle",new L.Control.PMButton(s)),this._addButton("drawPolygon",new L.Control.PMButton(e)),this._addButton("drawCircle",new L.Control.PMButton(n)),this._addButton("drawCircleMarker",new L.Control.PMButton(o)),this._addButton("drawText",new L.Control.PMButton(u)),this._addButton("editMode",new L.Control.PMButton(r)),this._addButton("dragMode",new L.Control.PMButton(a)),this._addButton("cutPolygon",new L.Control.PMButton(l)),this._addButton("removalMode",new L.Control.PMButton(c)),this._addButton("rotateMode",new L.Control.PMButton(h))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let t=this.getButtons(),e=[];!1===this.options.drawControls&&(e=e.concat(Object.keys(t).filter((e=>!t[e]._button.tool)))),!1===this.options.editControls&&(e=e.concat(Object.keys(t).filter((e=>"edit"===t[e]._button.tool)))),!1===this.options.optionsControls&&(e=e.concat(Object.keys(t).filter((e=>"options"===t[e]._button.tool)))),!1===this.options.customControls&&(e=e.concat(Object.keys(t).filter((e=>"custom"===t[e]._button.tool))));for(let i in t)if(this.options[i]&&-1===e.indexOf(i)){let e=t[i]._button.tool;e||(e="draw"),t[i].setPosition(this._getBtnPosition(e)),t[i].addTo(this.map)}},_getBtnPosition(t){return this.options.positions&&this.options.positions[t]?this.options.positions[t]:this.options.position},setBlockPosition(t,e){this.options.positions[t]=e,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(t,e){if(!e)throw new TypeError("Button has no name");"object"!=typeof e&&(e={name:e});let i=this._btnNameMapping(t);if(!e.name)throw new TypeError("Button has no name");if(this.buttons[e.name])throw new TypeError("Button with this name already exists");let n=this.map.pm.Draw.createNewDrawInstance(e.name,i);return e={...this.buttons[i]._button,...e},{drawInstance:n,control:this.createCustomControl(e)}},createCustomControl(t){if(!t.name)throw new TypeError("Button has no name");if(this.buttons[t.name])throw new TypeError("Button with this name already exists");t.onClick||(t.onClick=()=>{}),t.afterClick||(t.afterClick=()=>{}),!1!==t.toggle&&(t.toggle=!0),t.block&&(t.block=t.block.toLowerCase()),(!t.block||"draw"===t.block)&&(t.block=""),t.className?-1===t.className.indexOf("control-icon")&&(t.className=`control-icon ${t.className}`):t.className="control-icon";let e={tool:t.block,className:t.className,title:t.title||"",jsClass:t.name,onClick:t.onClick,afterClick:t.afterClick,doToggle:t.toggle,toggleStatus:!1,disableOtherButtons:t.disableOtherButtons??!0,disableByOtherButtons:t.disableByOtherButtons??!0,cssToggle:t.toggle,position:this.options.position,actions:t.actions||[],disabled:!!t.disabled};!1!==this.options[t.name]&&(this.options[t.name]=!0);let i=this._addButton(t.name,new L.Control.PMButton(e));return this.changeControlOrder(),i},controlExists(t){return!!this.getButton(t)},getButton(t){return this.getButtons()[t]},getButtonsInBlock(t){let e={};if(t)for(let i in this.getButtons()){let n=this.getButtons()[i];(n._button.tool===t||"draw"===t&&!n._button.tool)&&(e[i]=n)}return e},changeControlOrder(t=[]){let e=this._shapeMapping(),i=[];t.forEach((t=>{e[t]?i.push(e[t]):i.push(t)}));let n=this.getButtons(),o={};i.forEach((t=>{n[t]&&(o[t]=n[t])})),Object.keys(n).filter((t=>!n[t]._button.tool)).forEach((t=>{-1===i.indexOf(t)&&(o[t]=n[t])})),Object.keys(n).filter((t=>"edit"===n[t]._button.tool)).forEach((t=>{-1===i.indexOf(t)&&(o[t]=n[t])})),Object.keys(n).filter((t=>"options"===n[t]._button.tool)).forEach((t=>{-1===i.indexOf(t)&&(o[t]=n[t])})),Object.keys(n).filter((t=>"custom"===n[t]._button.tool)).forEach((t=>{-1===i.indexOf(t)&&(o[t]=n[t])})),Object.keys(n).forEach((t=>{-1===i.indexOf(t)&&(o[t]=n[t])})),this.map.pm.Toolbar.buttons=o,this._showHideButtons()},getControlOrder(){let t=this.getButtons(),e=[];for(let i in t)e.push(i);return e},changeActionsOfControl(t,e){let i=this._btnNameMapping(t);if(!i)throw new TypeError("No name passed");if(!e)throw new TypeError("No actions passed");if(!this.buttons[i])throw new TypeError("Button with this name not exists");this.buttons[i]._button.actions=e,this.changeControlOrder()},setButtonDisabled(t,e){let i=this._btnNameMapping(t);e?this.buttons[i].disable():this.buttons[i].enable()},_shapeMapping:()=>({Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}),_btnNameMapping(t){let e=this._shapeMapping();return e[t]?e[t]:t}}),Ae=a(Kt()),Ne={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(t){t.forEach((t=>{Array.isArray(t)?this._assignEvents(t):(t.off("drag",this._handleSnapping,this),t.on("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.on("dragend",this._cleanupSnapping,this))}))},_cleanupSnapping(t){if(t){t.target._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach((t=>{t.remove()}))},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(t){let e=t.target;if(e._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),t?.originalEvent?.altKey||this._map?.pm?.Keyboard.isAltKeyPressed()||(void 0===this._snapList&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let i=this._calcClosestLayer(e.getLatLng(),this._snapList);if(0===Object.keys(i).length)return!1;let n,o=i.layer instanceof L.Marker||i.layer instanceof L.CircleMarker||!this.options.snapSegment;n=o?i.latlng:this._checkPrioritiySnapping(i);let s=this.options.snapDistance,r={marker:e,shape:this._shape,snapLatLng:n,segment:i.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:i.layer,distance:i.distance};if(this._fireSnapDrag(r.marker,r),this._fireSnapDrag(this._layer,r),i.distance<s){e._orgLatLng=e.getLatLng(),e.setLatLng(n),e._snapped=!0,e._snapInfo=r;let t=()=>{this._snapLatLng=n,this._fireSnap(e,r),this._fireSnap(this._layer,r)},i=this._snapLatLng||{},o=n||{};(i.lat!==o.lat||i.lng!==o.lng)&&t()}else this._snapLatLng&&(this._unsnap(r),e._snapped=!1,e._snapInfo=void 0,this._fireUnsnap(r.marker,r),this._fireUnsnap(this._layer,r));return!0},_createSnapList(){let t=[],e=[],i=this._map;i.off("layerremove",this._handleSnapLayerRemoval,this),i.on("layerremove",this._handleSnapLayerRemoval,this),i.eachLayer((i=>{if((i instanceof L.Polyline||i instanceof L.Marker||i instanceof L.CircleMarker||i instanceof L.ImageOverlay)&&!0!==i.options.snapIgnore){if(void 0===i.options.snapIgnore&&(!L.PM.optIn&&!0===i.options.pmIgnore||L.PM.optIn&&!1!==i.options.pmIgnore))return;(i instanceof L.Circle||i instanceof L.CircleMarker)&&i.pm&&i.pm._hiddenPolyCircle?t.push(i.pm._hiddenPolyCircle):i instanceof L.ImageOverlay&&(i=L.rectangle(i.getBounds())),t.push(i);let n=L.polyline([],{color:"red",pmIgnore:!0});n._pmTempLayer=!0,e.push(n),(i instanceof L.Circle||i instanceof L.CircleMarker)&&e.push(n)}})),t=t.filter((t=>this._layer!==t)),t=t.filter((t=>t._latlng||t._latlngs&&$e(t._latlngs))),t=t.filter((t=>!t._pmTempLayer)),this._otherSnapLayers?(this._otherSnapLayers.forEach((()=>{let t=L.polyline([],{color:"red",pmIgnore:!0});t._pmTempLayer=!0,e.push(t)})),this._snapList=t.concat(this._otherSnapLayers)):this._snapList=t,this.debugIndicatorLines=e},_handleSnapLayerRemoval({layer:t}){if(!t._leaflet_id)return;let e=this._snapList.findIndex((e=>e._leaflet_id===t._leaflet_id));e>-1&&this._snapList.splice(e,1)},_calcClosestLayer(t,e){return this._calcClosestLayers(t,e,1)[0]},_calcClosestLayers(t,e,i=1){let n=[],o={};e.forEach(((e,s)=>{if(e._parentCopy&&e._parentCopy===this._layer)return;let r=this._calcLayerDistances(t,e);if(r.distance=Math.floor(r.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[s]){let t=L.polyline([],{color:"red",pmIgnore:!0});t._pmTempLayer=!0,this.debugIndicatorLines[s]=t}this.debugIndicatorLines[s].setLatLngs([t,r.latlng])}1===i&&(void 0===o.distance||r.distance-5<=o.distance)?(r.distance+5<o.distance&&(n=[]),o=r,o.layer=e,n.push(o)):1!==i&&(o={},o=r,o.layer=e,n.push(o))})),1!==i&&(n=n.sort(((t,e)=>t.distance-e.distance))),-1===i&&(i=n.length);let s=this._getClosestLayerByPriority(n,i);return L.Util.isArray(s)?s:[s]},_calcLayerDistances(t,e){let i=this._map,n=e instanceof L.Marker||e instanceof L.CircleMarker,o=e instanceof L.Polygon,s=t;if(n){let t=e.getLatLng();return{latlng:{...t},distance:this._getDistance(i,t,s)}}return this._calcLatLngDistances(s,e.getLatLngs(),i,o)},_calcLatLngDistances(t,e,i,n=!1){let o,s,r,a=e=>{e.forEach(((l,c)=>{if(Array.isArray(l))a(l);else if(this.options.snapSegment){let o,a=l;o=n?c+1===e.length?0:c+1:c+1===e.length?void 0:c+1;let h=e[o];if(h){let e=this._getDistanceToSegment(i,t,a,h);(void 0===s||e<s)&&(s=e,r=[a,h])}}else{let e=this._getDistance(i,t,l);(void 0===s||e<s)&&(s=e,o=l)}}))};return a(e),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(i,t,r[0],r[1])},segment:r,distance:s}:{latlng:o,distance:s}},_getClosestLayerByPriority(t,e=1){t=t.sort(((t,e)=>t._leaflet_id-e._leaflet_id));let i=this._map.pm.globalOptions.snappingOrder||[],n=0,o={};return i.concat(["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"]).forEach((t=>{o[t]||(n+=1,o[t]=n)})),t.sort(function(t,e,i="asc"){if(!e||0===Object.keys(e).length)return(t,e)=>t-e;let n,o=Object.keys(e),s=o.length-1,r={};for(;s>=0;)n=o[s],r[n.toLowerCase()]=e[n],s-=1;function a(t){return t instanceof L.Marker?"Marker":t instanceof L.Circle?"Circle":t instanceof L.CircleMarker?"CircleMarker":t instanceof L.Rectangle?"Rectangle":t instanceof L.Polygon?"Polygon":t instanceof L.Polyline?"Line":void 0}return(e,n)=>{let o,s;if("instanceofShape"===t){if(o=a(e.layer).toLowerCase(),s=a(n.layer).toLowerCase(),!o||!s)return 0}else{if(!e.hasOwnProperty(t)||!n.hasOwnProperty(t))return 0;o=e[t].toLowerCase(),s=n[t].toLowerCase()}let l=o in r?r[o]:Number.MAX_SAFE_INTEGER,c=s in r?r[s]:Number.MAX_SAFE_INTEGER,h=0;return l<c?h=-1:l>c&&(h=1),"desc"===i?-1*h:h}}("instanceofShape",o)),1===e?t[0]||{}:t.slice(0,e)},_checkPrioritiySnapping(t){let e,i=this._map,n=t.segment[0],o=t.segment[1],s=t.latlng,r=this._getDistance(i,n,s),a=this._getDistance(i,o,s),l=r<a?n:o,c=r<a?r:a;if(this.options.snapMiddle){let t=L.PM.Utils.calcMiddleLatLng(i,n,o),e=this._getDistance(i,t,s);e<r&&e<a&&(l=t,c=e)}return e=c<this.options.snapDistance?l:s,{...e}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(t,e,i,n){let o=t.getMaxZoom();o===1/0&&(o=t.getZoom());let s=t.project(e,o),r=t.project(i,o),a=t.project(n,o),l=L.LineUtil.closestPointOnSegment(s,r,a);return t.unproject(l,o)},_getDistanceToSegment(t,e,i,n){let o=t.latLngToLayerPoint(e),s=t.latLngToLayerPoint(i),r=t.latLngToLayerPoint(n);return L.LineUtil.pointToSegmentDistance(o,s,r)},_getDistance:(t,e,i)=>t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(i))},ze=L.Class.extend({includes:[Ne,ke],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0},setOptions(t){L.Util.setOptions(this,t),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(t){let e=new L.Icon.Default;e.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=e,this._map=t,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach((t=>{this[t]=new L.PM.Draw[t](this._map)})),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(t,e=!1){this.options.pathOptions=e?(0,Ae.default)(this.options.pathOptions,t):t},getShapes(){return this.shapes},getShape(){return this._shape},enable(t,e){if(!t)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[t].enable(e)},disable(){this.shapes.forEach((t=>{this[t].disable()}))},addControls(){this.shapes.forEach((t=>{this[t].addButton()}))},getActiveShape(){let t;return this.shapes.forEach((e=>{this[e]._enabled&&(t=e)})),t},_setGlobalDrawMode(){"Cut"===this._shape?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let t=[];this._map.eachLayer((e=>{(e instanceof L.Polyline||e instanceof L.Marker||e instanceof L.Circle||e instanceof L.CircleMarker||e instanceof L.ImageOverlay)&&(e._pmTempLayer||t.push(e))})),this._enabled?t.forEach((t=>{L.PM.Utils.disablePopup(t)})):t.forEach((t=>{L.PM.Utils.enablePopup(t)}))},createNewDrawInstance(t,e){let i=this._getShapeFromBtnName(e);if(this[t])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[i])throw new TypeError(`There is no class L.PM.Draw.${i}`);return this[t]=new L.PM.Draw[i](this._map),this[t].toolbarButtonName=t,this[t]._shape=t,this.shapes.push(t),this[e]&&this[t].setOptions(this[e].options),this[t].setOptions(this[t].options),this[t]},_getShapeFromBtnName(t){let e={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return e[t]?e[t]:this[t]?this[t]._shape:t},_finishLayer(t){t.pm&&(t.pm.setOptions(this.options),t.pm._shape=this._shape,t.pm._map=this._map),this._addDrawnLayerProp(t)},_addDrawnLayerProp(t){t._drawnByGeoman=!0},_setPane(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return 0===(this._map||this._layer._map).pm.getGeomanLayers().length}});ze.Marker=ze.extend({initialize(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(xe("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer((t=>{this.isRelevantMarker(t)&&t.pm.enable()})),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer((t=>{this.isRelevantMarker(t)&&t.pm.disable()})),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},isRelevantMarker:t=>t instanceof L.Marker&&t.pm&&!t._pmTempLayer&&!t.pm._initTextMarker,_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(t){if(!t.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=new L.Marker(e,this.options.markerStyle);this._setPane(i,"markerPane"),this._finishLayer(i),i.pm||(i.options.draggable=!1),i.addTo(this._map.pm._getContainingLayer()),i.pm&&this.options.markerEditable?i.pm.enable():i.dragging&&i.dragging.disable(),this._fireCreate(i),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){this.options.markerStyle?.icon&&this._hintMarker?.setIcon(this.options.markerStyle.icon)}});var je=6371008.8,Fe={centimeters:100*je,centimetres:100*je,degrees:je/111325,feet:3.28084*je,inches:39.37*je,kilometers:je/1e3,kilometres:je/1e3,meters:je,metres:je,miles:je/1609.344,millimeters:1e3*je,millimetres:1e3*je,nauticalmiles:je/1852,radians:1,yards:1.0936*je};function We(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function Ge(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ve(t[0])||!Ve(t[1]))throw new Error("coordinates must contain numbers");return We({type:"Point",coordinates:t},e,i)}function He(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return We({type:"LineString",coordinates:t},e,i)}function Ze(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function Ue(t){return 180*(t%(2*Math.PI))/Math.PI}function qe(t){return t%360*Math.PI/180}function Ve(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Ye(t){var e,i,n={type:"FeatureCollection",features:[]};if("LineString"===(i="Feature"===t.type?t.geometry:t).type)e=[i.coordinates];else if("MultiLineString"===i.type)e=i.coordinates;else if("MultiPolygon"===i.type)e=[].concat.apply([],i.coordinates);else{if("Polygon"!==i.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=i.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var i=0;i<t.length-1;i++)for(var o=i;o<e.length-1;o++)if(t!==e||1!==Math.abs(i-o)&&(0!==i||o!==t.length-2||t[i][0]!==t[t.length-1][0]||t[i][1]!==t[t.length-1][1])){var s=Ke(t[i][0],t[i][1],t[i+1][0],t[i+1][1],e[o][0],e[o][1],e[o+1][0],e[o+1][1]);s&&n.features.push(Ge([s[0],s[1]]))}}))})),n}function Ke(t,e,i,n,o,s,r,a){var l,c,h,u,d={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(l=(a-s)*(i-t)-(r-o)*(n-e))?null!==d.x&&null!==d.y&&d:(u=(i-t)*(c=e-s)-(n-e)*(h=t-o),c=((r-o)*c-(a-s)*h)/l,h=u/l,d.x=t+c*(i-t),d.y=e+c*(n-e),c>=0&&c<=1&&(d.onLine1=!0),h>=0&&h<=1&&(d.onLine2=!0),!(!d.onLine1||!d.onLine2)&&[d.x,d.y])}function Xe(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Je(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Qe(t){return"Feature"===t.type?t.geometry:t}function ti(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}function ei(t,e,i){if(null!==t)for(var n,o,s,r,a,l,c,h,u=0,d=0,p=t.type,_="FeatureCollection"===p,m="Feature"===p,f=_?t.features.length:1,g=0;g<f;g++){a=(h=!!(c=_?t.features[g].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var y=0;y<a;y++){var v=0,b=0;if(null!==(r=h?c.geometries[y]:c)){l=r.coordinates;var k=r.type;switch(u=!i||"Polygon"!==k&&"MultiPolygon"!==k?0:1,k){case null:break;case"Point":if(!1===e(l,d,g,v,b))return!1;d++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],d,g,v,b))return!1;d++,"MultiPoint"===k&&v++}"LineString"===k&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(o=0;o<l[n].length-u;o++){if(!1===e(l[n][o],d,g,v,b))return!1;d++}"MultiLineString"===k&&v++,"Polygon"===k&&b++}"Polygon"===k&&v++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(b=0,o=0;o<l[n].length;o++){for(s=0;s<l[n][o].length-u;s++){if(!1===e(l[n][o][s],d,g,v,b))return!1;d++}b++}v++}break;case"GeometryCollection":for(n=0;n<r.geometries.length;n++)if(!1===ei(r.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ii(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function ni(t,e){!function(t,e){var i,n,o,s,r,a,l,c,h,u,d=0,p="FeatureCollection"===t.type,_="Feature"===t.type,m=p?t.features.length:1;for(i=0;i<m;i++){for(a=p?t.features[i].geometry:_?t.geometry:t,c=p?t.features[i].properties:_?t.properties:{},h=p?t.features[i].bbox:_?t.bbox:void 0,u=p?t.features[i].id:_?t.id:void 0,r=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<r;o++)if(null!==(s=l?a.geometries[o]:a))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(s,d,c,h,u))return!1;break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===e(s.geometries[n],d,c,h,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,c,h,u))return!1;d++}}(t,(function(t,i,n,o,s){var r,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(We(t,n,{bbox:o,id:s}),i,0)&&void 0}switch(a){case"MultiPoint":r="Point";break;case"MultiLineString":r="LineString";break;case"MultiPolygon":r="Polygon"}for(var l=0;l<t.coordinates.length;l++){var c=t.coordinates[l];if(!1===e(We({type:r,coordinates:c},n),i,l))return!1}}))}ze.Line=ze.extend({initialize(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(xe("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine(){let t=this._layer.getLatLngs();if(t.length>0){let e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let e=t;e.target=this._hintMarker,this._handleSnapping(e)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let e=this._layer._defaultShape().slice();e.push(this._hintMarker.getLatLng()),this._change(e)},hasSelfIntersection(){return Ye(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(t,e){let i=L.polyline(this._layer.getLatLngs());t&&(e||(e=this._hintMarker.getLatLng()),i.addLatLng(e));let n=Ye(i.toGeoJSON(15));this._doesSelfIntersect=n.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(n,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(t){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,t.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=this._layer.getLatLngs(),n=i[i.length-1];if(e.equals(i[0])||i.length>0&&e.equals(n))return void this._finishShape();this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:e,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(e);let o=this._createMarker(e);this._setTooltipText(),this._setHintLineAfterNewVertex(e),this._fireVertexAdded(o,void 0,e,"Draw"),this._change(this._layer.getLatLngs()),"snap"===this.options.finishOn&&this._hintMarker._snapped&&this._finishShape(t)},_setHintLineAfterNewVertex(t){this._hintline.setLatLngs([t,t])},_removeLastVertex(){let t=this._markers;if(t.length<=1)return void this.disable();let e=this._layer.getLatLngs(),i=t[t.length-1],{indexPath:n}=L.PM.Utils.findDeepMarkerIndex(t,i);t.pop(),this._layerGroup.removeLayer(i);let o=t[t.length-1],s=e.indexOf(o.getLatLng());e=e.slice(0,s+1),this._layer.setLatLngs(e),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(i,n,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=1)return;let e=L.polyline(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this.options.snappable&&this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()},_createMarker(t){let e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),e.on("click",this._finishShape,this),e},_setTooltipText(){let{length:t}=this._layer.getLatLngs().flat(),e="";e=xe(t<=1?"tooltips.continueLine":"tooltips.finishLine"),this._hintMarker.setTooltipContent(e)},_change(t){this._fireChange(t,"Draw")},setStyle(){this._layer?.setStyle(this.options.templineStyle),this._hintline?.setStyle(this.options.hintlineStyle)}}),ze.Polygon=ze.Line.extend({initialize(t){this._map=t,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(t){L.PM.Draw.Line.prototype.enable.call(this,t),this._layer.pm._shape="Polygon"},_createMarker(t){let e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),1===this._layer.getLatLngs().flat().length?(e.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(e)-1,this.options.snappable&&this._cleanupSnapping()):e.on("click",(()=>1)),e},_setTooltipText(){let{length:t}=this._layer.getLatLngs().flat(),e="";e=xe(t<=2?"tooltips.continueLine":"tooltips.finishPoly"),this._hintMarker.setTooltipContent(e)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=2)return;let e=L.polygon(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this.disable(),this.options.continueDrawing&&this.enable()}}),ze.Rectangle=ze.extend({initialize(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(xe("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let t=0;t<2;t+=1){let t=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(t,"vertexPane"),t._pmTempLayer=!0,this._layerGroup.addLayer(t),this._styleMarkers.push(t)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach((t=>{L.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)})),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(xe("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let e=t;e.target=this._hintMarker,this._handleSnapping(e)}let e=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(e,"Draw")},_syncRectangleSize(){let t=Oe(this._startMarker.getLatLng(),this._map),e=Oe(this._hintMarker.getLatLng(),this._map),i=L.PM.Utils._getRotatedRectangle(t,e,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(i),this.options.cursorMarker&&this._styleMarkers){let n=[];i.forEach((i=>{!i.equals(t,1e-8)&&!i.equals(e,1e-8)&&n.push(i)})),n.forEach(((t,e)=>{try{this._styleMarkers[e].setLatLng(t)}catch{}}))}},_findCorners(){let t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this.options.rectangleAngle||0,this._map)},_finishShape(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||i.equals(e))return;let n=L.rectangle([i,e],this.options.pathOptions);if(this.options.rectangleAngle){let t=L.PM.Utils._getRotatedRectangle(i,e,this.options.rectangleAngle||0,this._map);n.setLatLngs(t),n.pm&&n.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(n,"layerPane"),this._finishLayer(n),n.addTo(this._map.pm._getContainingLayer()),this._fireCreate(n),this.disable(),this.options.continueDrawing&&this.enable()},setStyle(){this._layer?.setStyle(this.options.pathOptions)}}),ze.CircleMarker=ze.extend({initialize(t){this._map=t,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(t){if(L.Util.setOptions(this,t),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let t={};L.extend(t,this.options.templineStyle),t.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),t),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(xe("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(xe("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer((t=>{this.isRelevantMarker(t)&&t.pm.enable()})),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer((t=>{this.isRelevantMarker(t)&&t.pm.disable()}))},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_placeCenterMarker(t){this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker),this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();this._layerGroup.addLayer(this._layer),this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(xe("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius(){let t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(i)},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._handleHintMarkerSnapping();let e=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(e,"Draw")},isRelevantMarker:t=>t instanceof L.CircleMarker&&!(t instanceof L.Circle)&&t.pm&&!t._pmTempLayer,_createMarker(t){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!t.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=new this._BaseCircleClass(e,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(i,"layerPane"),this._finishLayer(i),i.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(i),this._fireCreate(i),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(t){t.pm&&this.options.markerEditable&&t.pm.enable()},_finishShape(t){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._centerMarker.getLatLng(),i=this._defaultRadius;if(this.options[this._editableOption]){let t=this._hintMarker.getLatLng();i=this._distanceCalculation(e,t),this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?i=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(i=this.options[this._maxRadiusOption])}let n={...this.options.pathOptions,radius:i},o=new this._BaseCircleClass(e,n);this._setPane(o,"layerPane"),this._finishLayer(o),o.addTo(this._map.pm._getContainingLayer()),o.pm&&o.pm._updateHiddenPolyCircle(),this._fireCreate(o),this.disable(),this.options.continueDrawing&&this.enable()},_getNewDestinationOfHintMarker(){let t=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return t;let e=this._centerMarker.getLatLng(),i=this._distanceCalculation(e,t);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?t=Pe(this._map,e,t,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(t=Pe(this._map,e,t,this._getMaxDistanceInMeter()))}return t},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),i=this._distanceCalculation(t,e);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]||this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption])&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){let t={};L.extend(t,this.options.templineStyle),this.options[this._editableOption]&&(t.radius=0),this._layer?.setStyle(t),this._hintline?.setStyle(this.options.hintlineStyle)},_distanceCalculation(t,e){return this._map.project(t).distanceTo(this._map.project(e))}}),ze.Circle=ze.CircleMarker.extend({initialize(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(t,e){return this._map.distance(t,e)}});var oi=function(t){if(!t)throw new Error("geojson is required");var e=[];return ni(t,(function(t){!function(t,e){var i=[],n=t.geometry;if(null!==n){switch(n.type){case"Polygon":i=Je(n);break;case"LineString":i=[Je(n)]}i.forEach((function(i){var n=function(t,e){var i=[];return t.reduce((function(t,n){var o=He([t,n],e);return o.bbox=function(t,e){var i=t[0],n=t[1],o=e[0],s=e[1],r=i<o?i:o,a=n<s?n:s,l=i>o?i:o,c=n>s?n:s;return[r,a,l,c]}(t,n),i.push(o),n})),i}(i,t.properties);n.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),Ze(e)},si=a(pe(),1);function ri(t,e){var i=Je(t),n=Je(e);if(2!==i.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=i[0][0],s=i[0][1],r=i[1][0],a=i[1][1],l=n[0][0],c=n[0][1],h=n[1][0],u=n[1][1],d=(u-c)*(r-o)-(h-l)*(a-s);if(0===d)return null;var p=((h-l)*(s-c)-(u-c)*(o-l))/d,_=((r-o)*(s-c)-(a-s)*(o-l))/d;return p>=0&&p<=1&&_>=0&&_<=1?Ge([o+p*(r-o),s+p*(a-s)]):null}var ai=function(t,e){var i={},n=[];if("LineString"===t.type&&(t=We(t)),"LineString"===e.type&&(e=We(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var o=ri(t,e);return o&&n.push(o),Ze(n)}var s=(0,si.default)();return s.load(oi(e)),ii(oi(t),(function(t){ii(s.search(t),(function(e){var o=ri(t,e);if(o){var s=Je(o).join(",");i[s]||(i[s]=!0,n.push(o))}}))})),Ze(n)},li=a(pe(),1);var ci=function(t,e,i){void 0===i&&(i={});var n=Xe(t),o=Xe(e),s=qe(o[1]-n[1]),r=qe(o[0]-n[0]),a=qe(n[1]),l=qe(o[1]),c=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(r/2),2)*Math.cos(a)*Math.cos(l);return function(t,e){void 0===e&&(e="kilometers");var i=Fe[e];if(!i)throw new Error(e+" units is invalid");return t*i}(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),i.units)};var hi=function(t){var e=t[0],i=t[1],n=t[2],o=t[3];if(ci(t.slice(0,2),[n,i])>=ci(t.slice(0,2),[e,o])){var s=(i+o)/2;return[e,s-(n-e)/2,n,s+(n-e)/2]}var r=(e+n)/2;return[r-(o-i)/2,i,r+(o-i)/2,o]};function ui(t){var e=[1/0,1/0,-1/0,-1/0];return ei(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}ui.default=ui;var di=ui;var pi=function(t,e){void 0===e&&(e={});var i=e.precision,n=e.coordinates,o=e.mutate;if(i=null==i||isNaN(i)?6:i,n=null==n||isNaN(n)?3:n,!t)throw new Error("<geojson> is required");if("number"!=typeof i)throw new Error("<precision> must be a number");if("number"!=typeof n)throw new Error("<coordinates> must be a number");(!1===o||void 0===o)&&(t=JSON.parse(JSON.stringify(t)));var s=Math.pow(10,i);return ei(t,(function(t){!function(t,e,i){t.length>i&&t.splice(i,t.length);for(var n=0;n<t.length;n++)t[n]=Math.round(t[n]*e)/e}(t,s,n)})),t};function _i(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=_i(e,t);return i=(i+180)%360,i}(t,e);var n=Xe(t),o=Xe(e),s=qe(n[0]),r=qe(o[0]),a=qe(n[1]),l=qe(o[1]),c=Math.sin(r-s)*Math.cos(l),h=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(r-s);return Ue(Math.atan2(c,h))}function mi(t,e,i,n){void 0===n&&(n={});var o=Xe(t),s=qe(o[0]),r=qe(o[1]),a=qe(i),l=function(t,e){void 0===e&&(e="kilometers");var i=Fe[e];if(!i)throw new Error(e+" units is invalid");return t/i}(e,n.units),c=Math.asin(Math.sin(r)*Math.cos(l)+Math.cos(r)*Math.sin(l)*Math.cos(a));return Ge([Ue(s+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(r),Math.cos(l)-Math.sin(r)*Math.sin(c))),Ue(c)],n.properties)}var fi=function(t,e,i){void 0===i&&(i={});var n=Ge([1/0,1/0],{dist:1/0}),o=0;return ni(t,(function(t){for(var s=Je(t),r=0;r<s.length-1;r++){var a=Ge(s[r]);a.properties.dist=ci(e,a,i);var l=Ge(s[r+1]);l.properties.dist=ci(e,l,i);var c=ci(a,l,i),h=Math.max(a.properties.dist,l.properties.dist),u=_i(a,l),d=mi(e,h,u+90,i),p=mi(e,h,u-90,i),_=ai(He([d.geometry.coordinates,p.geometry.coordinates]),He([a.geometry.coordinates,l.geometry.coordinates])),m=null;_.features.length>0&&((m=_.features[0]).properties.dist=ci(e,m,i),m.properties.location=o+ci(a,m,i)),a.properties.dist<n.properties.dist&&((n=a).properties.index=r,n.properties.location=o),l.properties.dist<n.properties.dist&&((n=l).properties.index=r+1,n.properties.location=o+c),m&&m.properties.dist<n.properties.dist&&((n=m).properties.index=r),o+=c}})),n};function gi(t,e){var i=[],n=(0,li.default)();return ni(e,(function(e){if(i.forEach((function(t,e){t.id=e})),i.length){var o=n.search(e);if(o.features.length){var s=vi(e,o);i=i.filter((function(t){return t.id!==s.id})),n.remove(s),ii(yi(s,e),(function(t){i.push(t),n.insert(t)}))}}else(i=yi(t,e).features).forEach((function(t){t.bbox||(t.bbox=hi(di(t)))})),n.load(Ze(i))})),Ze(i)}function yi(t,e){var i=[],n=Je(t)[0],o=Je(t)[t.geometry.coordinates.length-1];if(bi(n,Xe(e))||bi(o,Xe(e)))return Ze([t]);var s=(0,li.default)(),r=oi(t);s.load(r);var a=s.search(e);if(!a.features.length)return Ze([t]);var l=vi(e,a),c=function(t,e,i){var n=i;return ii(t,(function(t,o){n=0===o&&void 0===i?t:e(n,t,o)})),n}(r,(function(t,n,o){var s=Je(n)[1],r=Xe(e);return o===l.id?(t.push(r),i.push(He(t)),bi(r,s)?[r]:[r,s]):(t.push(s),t)}),[n]);return c.length>1&&i.push(He(c)),Ze(i)}function vi(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var i,n=1/0;return ii(e,(function(e){var o=fi(e,t).properties.dist;o<n&&(i=e,n=o)})),i}function bi(t,e){return t[0]===e[0]&&t[1]===e[1]}var ki=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var i=ti(t),n=ti(e);if("LineString"!==i)throw new Error("line must be LineString");if("FeatureCollection"===n)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===n)throw new Error("splitter cannot be a GeometryCollection");var o=pi(e,{precision:7});switch(n){case"Point":return yi(t,o);case"MultiPoint":return gi(t,o);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return gi(t,ai(t,o))}};function wi(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=Xe(t),o=Qe(e),s=o.type,r=e.bbox,a=o.coordinates;if(r&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(n,r))return!1;"Polygon"===s&&(a=[a]);for(var l=!1,c=0;c<a.length&&!l;c++)if(Li(n,a[c][0],i.ignoreBoundary)){for(var h=!1,u=1;u<a[c].length&&!h;)Li(n,a[c][u],!i.ignoreBoundary)&&(h=!0),u++;h||(l=!0)}return l}function Li(t,e,i){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,s=e.length-1;o<e.length;s=o++){var r=e[o][0],a=e[o][1],l=e[s][0],c=e[s][1];if(t[1]*(r-l)+a*(l-t[0])+c*(t[0]-r)==0&&(r-t[0])*(l-t[0])<=0&&(a-t[1])*(c-t[1])<=0)return!i;a>t[1]!=c>t[1]&&t[0]<(l-r)*(t[1]-a)/(c-a)+r&&(n=!n)}return n}function xi(t,e,i,n,o){var s=i[0],r=i[1],a=t[0],l=t[1],c=e[0],h=e[1],u=c-a,d=h-l,p=(i[0]-a)*d-(i[1]-l)*u;if(null!==o){if(Math.abs(p)>o)return!1}else if(0!==p)return!1;return n?"start"===n?Math.abs(u)>=Math.abs(d)?u>0?a<s&&s<=c:c<=s&&s<a:d>0?l<r&&r<=h:h<=r&&r<l:"end"===n?Math.abs(u)>=Math.abs(d)?u>0?a<=s&&s<c:c<s&&s<=a:d>0?l<=r&&r<h:h<r&&r<=l:"both"===n&&(Math.abs(u)>=Math.abs(d)?u>0?a<s&&s<c:c<s&&s<a:d>0?l<r&&r<h:h<r&&r<l):Math.abs(u)>=Math.abs(d)?u>0?a<=s&&s<=c:c<=s&&s<=a:d>0?l<=r&&r<=h:h<=r&&r<=l}var $i=function(t,e,i){void 0===i&&(i={});for(var n=Xe(t),o=Je(e),s=0;s<o.length-1;s++){var r=!1;if(i.ignoreEndVertices&&(0===s&&(r="start"),s===o.length-2&&(r="end"),0===s&&s+1===o.length-1&&(r="both")),xi(o[s],o[s+1],n,r,typeof i.epsilon>"u"?null:i.epsilon))return!0}return!1};function Ci(t,e){var i=Qe(t),n=Qe(e),o=i.type,s=n.type,r=i.coordinates,a=n.coordinates;switch(o){case"Point":if("Point"===s)return Ei(r,a);throw new Error("feature2 "+s+" geometry not supported");case"MultiPoint":switch(s){case"Point":return function(t,e){var i,n=!1;for(i=0;i<t.coordinates.length;i++)if(Ei(t.coordinates[i],e.coordinates)){n=!0;break}return n}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){for(var o=n[i],s=!1,r=0,a=t.coordinates;r<a.length;r++){if(Ei(o,a[r])){s=!0;break}}if(!s)return!1}return!0}(i,n);default:throw new Error("feature2 "+s+" geometry not supported")}case"LineString":switch(s){case"Point":return $i(n,i,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var i=!1,n=0,o=e.coordinates;n<o.length;n++){var s=o[n];if($i({type:"Point",coordinates:s},t,{ignoreEndVertices:!0})&&(i=!0),!$i({type:"Point",coordinates:s},t,{ignoreEndVertices:!1}))return!1}return i}(i,n);case"MultiPoint":return function(t,e){for(var i=!1,n=0,o=e.coordinates;n<o.length;n++){var s=o[n];if($i(s,t,{ignoreEndVertices:!0})&&(i=!0),!$i(s,t))return!1}return!!i}(i,n);default:throw new Error("feature2 "+s+" geometry not supported")}case"Polygon":switch(s){case"Point":return wi(n,i,{ignoreBoundary:!0});case"LineString":return function(t,e){var i=!1,n=0,o=di(t),s=di(e);if(!Mi(o,s))return!1;for(;n<e.coordinates.length-1;n++){if(wi({type:"Point",coordinates:Ti(e.coordinates[n],e.coordinates[n+1])},t,{ignoreBoundary:!0})){i=!0;break}}return i}(i,n);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry||"Feature"===e.type&&null===e.geometry)return!1;var i=di(t),n=di(e);if(!Mi(i,n))return!1;for(var o=Qe(e).coordinates,s=0,r=o;s<r.length;s++)for(var a=r[s],l=0,c=a;l<c.length;l++){if(!wi(c[l],t))return!1}return!0}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){if(!wi(n[i],t,{ignoreBoundary:!0}))return!1}return!0}(i,n);default:throw new Error("feature2 "+s+" geometry not supported")}default:throw new Error("feature1 "+o+" geometry not supported")}}function Mi(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Ei(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ti(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}var Pi=a(le()),Si=t=>()=>t,Oi=t=>{let e=t?(e,i)=>i.minus(e).abs().isLessThanOrEqualTo(t):Si(!1);return(t,i)=>e(t,i)?0:t.comparedTo(i)};function Di(t){let e=t?(e,i,n,o,s)=>e.exponentiatedBy(2).isLessThanOrEqualTo(o.minus(i).exponentiatedBy(2).plus(s.minus(n).exponentiatedBy(2)).times(t)):Si(!1);return(t,i,n)=>{let o=t.x,s=t.y,r=n.x,a=n.y,l=s.minus(a).times(i.x.minus(r)).minus(o.minus(r).times(i.y.minus(a)));return e(l,o,s,r,a)?0:l.comparedTo(0)}}var Ii=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Bi=Math.ceil,Ri=Math.floor,Ai="[BigNumber Error] ",Ni=Ai+"Number primitive has more than 15 significant digits: ",zi=1e14,ji=14,Fi=9007199254740991,Wi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Gi=1e7,Hi=1e9;function Zi(t){var e=0|t;return t>0||t===e?e:e-1}function Ui(t){for(var e,i,n=1,o=t.length,s=t[0]+"";n<o;){for(e=t[n++]+"",i=ji-e.length;i--;e="0"+e);s+=e}for(o=s.length;48===s.charCodeAt(--o););return s.slice(0,o+1||1)}function qi(t,e){var i,n,o=t.c,s=e.c,r=t.s,a=e.s,l=t.e,c=e.e;if(!r||!a)return null;if(i=o&&!o[0],n=s&&!s[0],i||n)return i?n?0:-a:r;if(r!=a)return r;if(i=r<0,n=l==c,!o||!s)return n?0:!o^i?1:-1;if(!n)return l>c^i?1:-1;for(a=(l=o.length)<(c=s.length)?l:c,r=0;r<a;r++)if(o[r]!=s[r])return o[r]>s[r]^i?1:-1;return l==c?0:l>c^i?1:-1}function Vi(t,e,i,n){if(t<e||t>i||t!==Ri(t))throw Error(Ai+(n||"Argument")+("number"==typeof t?t<e||t>i?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function Yi(t){var e=t.c.length-1;return Zi(t.e/ji)==e&&t.c[e]%2!=0}function Ki(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function Xi(t,e,i){var n,o;if(e<0){for(o=i+".";++e;o+=i);t=o+t}else if(++e>(n=t.length)){for(o=i,e-=n;--e;o+=i);t+=o}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}var Ji=function t(e){var i,n,o,s,r,a=k.prototype={constructor:k,toString:null,valueOf:null},l=new k(1),c=20,h=4,u=-7,d=21,p=-1e7,_=1e7,m=!1,f=1,g=0,y={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},v="0123456789abcdefghijklmnopqrstuvwxyz",b=!0;function k(t,e){var i,s,r,a,l,u,d,m,f=this;if(!(f instanceof k))return new k(t,e);if(null==e){if(t&&!0===t._isBigNumber)return f.s=t.s,void(!t.c||t.e>_?f.c=f.e=null:t.e<p?f.c=[f.e=0]:(f.e=t.e,f.c=t.c.slice()));if((u="number"==typeof t)&&0*t==0){if(f.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,l=t;l>=10;l/=10,a++);return void(a>_?f.c=f.e=null:(f.e=a,f.c=[t]))}m=String(t)}else{if(!Ii.test(m=String(t)))return o(f,m,u);f.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(a=m.indexOf("."))>-1&&(m=m.replace(".","")),(l=m.search(/e/i))>0?(a<0&&(a=l),a+=+m.slice(l+1),m=m.substring(0,l)):a<0&&(a=m.length)}else{if(Vi(e,2,v.length,"Base"),10==e&&b)return $(f=new k(t),c+f.e+1,h);if(m=String(t),u="number"==typeof t){if(0*t!=0)return o(f,m,u,e);if(f.s=1/t<0?(m=m.slice(1),-1):1,k.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(Ni+t)}else f.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(i=v.slice(0,e),a=l=0,d=m.length;l<d;l++)if(i.indexOf(s=m.charAt(l))<0){if("."==s){if(l>a){a=d;continue}}else if(!r&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){r=!0,l=-1,a=0;continue}return o(f,String(t),u,e)}u=!1,(a=(m=n(m,e,10,f.s)).indexOf("."))>-1?m=m.replace(".",""):a=m.length}for(l=0;48===m.charCodeAt(l);l++);for(d=m.length;48===m.charCodeAt(--d););if(m=m.slice(l,++d)){if(d-=l,u&&k.DEBUG&&d>15&&(t>Fi||t!==Ri(t)))throw Error(Ni+f.s*t);if((a=a-l-1)>_)f.c=f.e=null;else if(a<p)f.c=[f.e=0];else{if(f.e=a,f.c=[],l=(a+1)%ji,a<0&&(l+=ji),l<d){for(l&&f.c.push(+m.slice(0,l)),d-=ji;l<d;)f.c.push(+m.slice(l,l+=ji));l=ji-(m=m.slice(l)).length}else l-=d;for(;l--;m+="0");f.c.push(+m)}}else f.c=[f.e=0]}function w(t,e,i,n){var o,s,r,a,l;if(null==i?i=h:Vi(i,0,8),!t.c)return t.toString();if(o=t.c[0],r=t.e,null==e)l=Ui(t.c),l=1==n||2==n&&(r<=u||r>=d)?Ki(l,r):Xi(l,r,"0");else if(s=(t=$(new k(t),e,i)).e,a=(l=Ui(t.c)).length,1==n||2==n&&(e<=s||s<=u)){for(;a<e;l+="0",a++);l=Ki(l,s)}else if(e-=r,l=Xi(l,s,"0"),s+1>a){if(--e>0)for(l+=".";e--;l+="0");}else if((e+=s-a)>0)for(s+1==a&&(l+=".");e--;l+="0");return t.s<0&&o?"-"+l:l}function L(t,e){for(var i,n,o=1,s=new k(t[0]);o<t.length;o++)(!(n=new k(t[o])).s||(i=qi(s,n))===e||0===i&&s.s===e)&&(s=n);return s}function x(t,e,i){for(var n=1,o=e.length;!e[--o];e.pop());for(o=e[0];o>=10;o/=10,n++);return(i=n+i*ji-1)>_?t.c=t.e=null:i<p?t.c=[t.e=0]:(t.e=i,t.c=e),t}function $(t,e,i,n){var o,s,r,a,l,c,h,u=t.c,d=Wi;if(u){t:{for(o=1,a=u[0];a>=10;a/=10,o++);if((s=e-o)<0)s+=ji,r=e,l=u[c=0],h=Ri(l/d[o-r-1]%10);else if((c=Bi((s+1)/ji))>=u.length){if(!n)break t;for(;u.length<=c;u.push(0));l=h=0,o=1,r=(s%=ji)-ji+1}else{for(l=a=u[c],o=1;a>=10;a/=10,o++);h=(r=(s%=ji)-ji+o)<0?0:Ri(l/d[o-r-1]%10)}if(n=n||e<0||null!=u[c+1]||(r<0?l:l%d[o-r-1]),n=i<4?(h||n)&&(0==i||i==(t.s<0?3:2)):h>5||5==h&&(4==i||n||6==i&&(s>0?r>0?l/d[o-r]:0:u[c-1])%10&1||i==(t.s<0?8:7)),e<1||!u[0])return u.length=0,n?(e-=t.e+1,u[0]=d[(ji-e%ji)%ji],t.e=-e||0):u[0]=t.e=0,t;if(0==s?(u.length=c,a=1,c--):(u.length=c+1,a=d[ji-s],u[c]=r>0?Ri(l/d[o-r]%d[r])*a:0),n)for(;;){if(0==c){for(s=1,r=u[0];r>=10;r/=10,s++);for(r=u[0]+=a,a=1;r>=10;r/=10,a++);s!=a&&(t.e++,u[0]==zi&&(u[0]=1));break}if(u[c]+=a,u[c]!=zi)break;u[c--]=0,a=1}for(s=u.length;0===u[--s];u.pop());}t.e>_?t.c=t.e=null:t.e<p&&(t.c=[t.e=0])}return t}function C(t){var e,i=t.e;return null===i?t.toString():(e=Ui(t.c),e=i<=u||i>=d?Ki(e,i):Xi(e,i,"0"),t.s<0?"-"+e:e)}return k.clone=t,k.ROUND_UP=0,k.ROUND_DOWN=1,k.ROUND_CEIL=2,k.ROUND_FLOOR=3,k.ROUND_HALF_UP=4,k.ROUND_HALF_DOWN=5,k.ROUND_HALF_EVEN=6,k.ROUND_HALF_CEIL=7,k.ROUND_HALF_FLOOR=8,k.EUCLID=9,k.config=k.set=function(t){var e,i;if(null!=t){if("object"!=typeof t)throw Error(Ai+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(Vi(i=t[e],0,Hi,e),c=i),t.hasOwnProperty(e="ROUNDING_MODE")&&(Vi(i=t[e],0,8,e),h=i),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((i=t[e])&&i.pop?(Vi(i[0],-Hi,0,e),Vi(i[1],0,Hi,e),u=i[0],d=i[1]):(Vi(i,-Hi,Hi,e),u=-(d=i<0?-i:i))),t.hasOwnProperty(e="RANGE"))if((i=t[e])&&i.pop)Vi(i[0],-Hi,-1,e),Vi(i[1],1,Hi,e),p=i[0],_=i[1];else{if(Vi(i,-Hi,Hi,e),!i)throw Error(Ai+e+" cannot be zero: "+i);p=-(_=i<0?-i:i)}if(t.hasOwnProperty(e="CRYPTO")){if((i=t[e])!==!!i)throw Error(Ai+e+" not true or false: "+i);if(i){if(!(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes)))throw m=!i,Error(Ai+"crypto unavailable");m=i}else m=i}if(t.hasOwnProperty(e="MODULO_MODE")&&(Vi(i=t[e],0,9,e),f=i),t.hasOwnProperty(e="POW_PRECISION")&&(Vi(i=t[e],0,Hi,e),g=i),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(i=t[e]))throw Error(Ai+e+" not an object: "+i);y=i}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(i=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(i))throw Error(Ai+e+" invalid: "+i);b="0123456789"==i.slice(0,10),v=i}}return{DECIMAL_PLACES:c,ROUNDING_MODE:h,EXPONENTIAL_AT:[u,d],RANGE:[p,_],CRYPTO:m,MODULO_MODE:f,POW_PRECISION:g,FORMAT:y,ALPHABET:v}},k.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!k.DEBUG)return!0;var e,i,n=t.c,o=t.e,s=t.s;t:if("[object Array]"=={}.toString.call(n)){if((1===s||-1===s)&&o>=-Hi&&o<=Hi&&o===Ri(o)){if(0===n[0]){if(0===o&&1===n.length)return!0;break t}if((e=(o+1)%ji)<1&&(e+=ji),String(n[0]).length==e){for(e=0;e<n.length;e++)if((i=n[e])<0||i>=zi||i!==Ri(i))break t;if(0!==i)return!0}}}else if(null===n&&null===o&&(null===s||1===s||-1===s))return!0;throw Error(Ai+"Invalid BigNumber: "+t)},k.maximum=k.max=function(){return L(arguments,-1)},k.minimum=k.min=function(){return L(arguments,1)},k.random=(s=9007199254740992,r=Math.random()*s&2097151?function(){return Ri(Math.random()*s)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,i,n,o,s,a=0,h=[],u=new k(l);if(null==t?t=c:Vi(t,0,Hi),o=Bi(t/ji),m)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(o*=2));a<o;)(s=131072*e[a]+(e[a+1]>>>11))>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),e[a]=i[0],e[a+1]=i[1]):(h.push(s%1e14),a+=2);a=o/2}else{if(!crypto.randomBytes)throw m=!1,Error(Ai+"crypto unavailable");for(e=crypto.randomBytes(o*=7);a<o;)(s=281474976710656*(31&e[a])+1099511627776*e[a+1]+4294967296*e[a+2]+16777216*e[a+3]+(e[a+4]<<16)+(e[a+5]<<8)+e[a+6])>=9e15?crypto.randomBytes(7).copy(e,a):(h.push(s%1e14),a+=7);a=o/7}if(!m)for(;a<o;)(s=r())<9e15&&(h[a++]=s%1e14);for(o=h[--a],t%=ji,o&&t&&(s=Wi[ji-t],h[a]=Ri(o/s)*s);0===h[a];h.pop(),a--);if(a<0)h=[n=0];else{for(n=-1;0===h[0];h.splice(0,1),n-=ji);for(a=1,s=h[0];s>=10;s/=10,a++);a<ji&&(n-=ji-a)}return u.e=n,u.c=h,u}),k.sum=function(){for(var t=1,e=arguments,i=new k(e[0]);t<e.length;)i=i.plus(e[t++]);return i},n=function(){var t="0123456789";function e(t,e,i,n){for(var o,s,r=[0],a=0,l=t.length;a<l;){for(s=r.length;s--;r[s]*=e);for(r[0]+=n.indexOf(t.charAt(a++)),o=0;o<r.length;o++)r[o]>i-1&&(null==r[o+1]&&(r[o+1]=0),r[o+1]+=r[o]/i|0,r[o]%=i)}return r.reverse()}return function(n,o,s,r,a){var l,u,d,p,_,m,f,y,b=n.indexOf("."),w=c,L=h;for(b>=0&&(p=g,g=0,n=n.replace(".",""),m=(y=new k(o)).pow(n.length-b),g=p,y.c=e(Xi(Ui(m.c),m.e,"0"),10,s,t),y.e=y.c.length),d=p=(f=e(n,o,s,a?(l=v,t):(l=t,v))).length;0==f[--p];f.pop());if(!f[0])return l.charAt(0);if(b<0?--d:(m.c=f,m.e=d,m.s=r,f=(m=i(m,y,w,L,s)).c,_=m.r,d=m.e),b=f[u=d+w+1],p=s/2,_=_||u<0||null!=f[u+1],_=L<4?(null!=b||_)&&(0==L||L==(m.s<0?3:2)):b>p||b==p&&(4==L||_||6==L&&1&f[u-1]||L==(m.s<0?8:7)),u<1||!f[0])n=_?Xi(l.charAt(1),-w,l.charAt(0)):l.charAt(0);else{if(f.length=u,_)for(--s;++f[--u]>s;)f[u]=0,u||(++d,f=[1].concat(f));for(p=f.length;!f[--p];);for(b=0,n="";b<=p;n+=l.charAt(f[b++]));n=Xi(n,d,l.charAt(0))}return n}}(),i=function(){function t(t,e,i){var n,o,s,r,a=0,l=t.length,c=e%Gi,h=e/Gi|0;for(t=t.slice();l--;)a=((o=c*(s=t[l]%Gi)+(n=h*s+(r=t[l]/Gi|0)*c)%Gi*Gi+a)/i|0)+(n/Gi|0)+h*r,t[l]=o%i;return a&&(t=[a].concat(t)),t}function e(t,e,i,n){var o,s;if(i!=n)s=i>n?1:-1;else for(o=s=0;o<i;o++)if(t[o]!=e[o]){s=t[o]>e[o]?1:-1;break}return s}function i(t,e,i,n){for(var o=0;i--;)t[i]-=o,o=t[i]<e[i]?1:0,t[i]=o*n+t[i]-e[i];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(n,o,s,r,a){var l,c,h,u,d,p,_,m,f,g,y,v,b,w,L,x,C,M=n.s==o.s?1:-1,E=n.c,T=o.c;if(!(E&&E[0]&&T&&T[0]))return new k(n.s&&o.s&&(E?!T||E[0]!=T[0]:T)?E&&0==E[0]||!T?0*M:M/0:NaN);for(f=(m=new k(M)).c=[],M=s+(c=n.e-o.e)+1,a||(a=zi,c=Zi(n.e/ji)-Zi(o.e/ji),M=M/ji|0),h=0;T[h]==(E[h]||0);h++);if(T[h]>(E[h]||0)&&c--,M<0)f.push(1),u=!0;else{for(w=E.length,x=T.length,h=0,M+=2,(d=Ri(a/(T[0]+1)))>1&&(T=t(T,d,a),E=t(E,d,a),x=T.length,w=E.length),b=x,y=(g=E.slice(0,x)).length;y<x;g[y++]=0);C=T.slice(),C=[0].concat(C),L=T[0],T[1]>=a/2&&L++;do{if(d=0,(l=e(T,g,x,y))<0){if(v=g[0],x!=y&&(v=v*a+(g[1]||0)),(d=Ri(v/L))>1)for(d>=a&&(d=a-1),_=(p=t(T,d,a)).length,y=g.length;1==e(p,g,_,y);)d--,i(p,x<_?C:T,_,a),_=p.length,l=1;else 0==d&&(l=d=1),_=(p=T.slice()).length;if(_<y&&(p=[0].concat(p)),i(g,p,y,a),y=g.length,-1==l)for(;e(T,g,x,y)<1;)d++,i(g,x<y?C:T,y,a),y=g.length}else 0===l&&(d++,g=[0]);f[h++]=d,g[0]?g[y++]=E[b]||0:(g=[E[b]],y=1)}while((b++<w||null!=g[0])&&M--);u=null!=g[0],f[0]||f.splice(0,1)}if(a==zi){for(h=1,M=f[0];M>=10;M/=10,h++);$(m,s+(m.e=h+c*ji-1)+1,r,u)}else m.e=c,m.r=+u;return m}}(),o=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,i=/^\.([^.]+)$/,n=/^-?(Infinity|NaN)$/,o=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(s,r,a,l){var c,h=a?r:r.replace(o,"");if(n.test(h))s.s=isNaN(h)?null:h<0?-1:1;else{if(!a&&(h=h.replace(t,(function(t,e,i){return c="x"==(i=i.toLowerCase())?16:"b"==i?2:8,l&&l!=c?t:e})),l&&(c=l,h=h.replace(e,"$1").replace(i,"0.$1")),r!=h))return new k(h,c);if(k.DEBUG)throw Error(Ai+"Not a"+(l?" base "+l:"")+" number: "+r);s.s=null}s.c=s.e=null}}(),a.absoluteValue=a.abs=function(){var t=new k(this);return t.s<0&&(t.s=1),t},a.comparedTo=function(t,e){return qi(this,new k(t,e))},a.decimalPlaces=a.dp=function(t,e){var i,n,o,s=this;if(null!=t)return Vi(t,0,Hi),null==e?e=h:Vi(e,0,8),$(new k(s),t+s.e+1,e);if(!(i=s.c))return null;if(n=((o=i.length-1)-Zi(this.e/ji))*ji,o=i[o])for(;o%10==0;o/=10,n--);return n<0&&(n=0),n},a.dividedBy=a.div=function(t,e){return i(this,new k(t,e),c,h)},a.dividedToIntegerBy=a.idiv=function(t,e){return i(this,new k(t,e),0,1)},a.exponentiatedBy=a.pow=function(t,e){var i,n,o,s,r,a,c,u,d=this;if((t=new k(t)).c&&!t.isInteger())throw Error(Ai+"Exponent not an integer: "+C(t));if(null!=e&&(e=new k(e)),r=t.e>14,!d.c||!d.c[0]||1==d.c[0]&&!d.e&&1==d.c.length||!t.c||!t.c[0])return u=new k(Math.pow(+C(d),r?t.s*(2-Yi(t)):+C(t))),e?u.mod(e):u;if(a=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new k(NaN);(n=!a&&d.isInteger()&&e.isInteger())&&(d=d.mod(e))}else{if(t.e>9&&(d.e>0||d.e<-1||(0==d.e?d.c[0]>1||r&&d.c[1]>=24e7:d.c[0]<8e13||r&&d.c[0]<=9999975e7)))return s=d.s<0&&Yi(t)?-0:0,d.e>-1&&(s=1/s),new k(a?1/s:s);g&&(s=Bi(g/ji+2))}for(r?(i=new k(.5),a&&(t.s=1),c=Yi(t)):c=(o=Math.abs(+C(t)))%2,u=new k(l);;){if(c){if(!(u=u.times(d)).c)break;s?u.c.length>s&&(u.c.length=s):n&&(u=u.mod(e))}if(o){if(0===(o=Ri(o/2)))break;c=o%2}else if($(t=t.times(i),t.e+1,1),t.e>14)c=Yi(t);else{if(0===(o=+C(t)))break;c=o%2}d=d.times(d),s?d.c&&d.c.length>s&&(d.c.length=s):n&&(d=d.mod(e))}return n?u:(a&&(u=l.div(u)),e?u.mod(e):s?$(u,g,h,undefined):u)},a.integerValue=function(t){var e=new k(this);return null==t?t=h:Vi(t,0,8),$(e,e.e+1,t)},a.isEqualTo=a.eq=function(t,e){return 0===qi(this,new k(t,e))},a.isFinite=function(){return!!this.c},a.isGreaterThan=a.gt=function(t,e){return qi(this,new k(t,e))>0},a.isGreaterThanOrEqualTo=a.gte=function(t,e){return 1===(e=qi(this,new k(t,e)))||0===e},a.isInteger=function(){return!!this.c&&Zi(this.e/ji)>this.c.length-2},a.isLessThan=a.lt=function(t,e){return qi(this,new k(t,e))<0},a.isLessThanOrEqualTo=a.lte=function(t,e){return-1===(e=qi(this,new k(t,e)))||0===e},a.isNaN=function(){return!this.s},a.isNegative=function(){return this.s<0},a.isPositive=function(){return this.s>0},a.isZero=function(){return!!this.c&&0==this.c[0]},a.minus=function(t,e){var i,n,o,s,r=this,a=r.s;if(e=(t=new k(t,e)).s,!a||!e)return new k(NaN);if(a!=e)return t.s=-e,r.plus(t);var l=r.e/ji,c=t.e/ji,u=r.c,d=t.c;if(!l||!c){if(!u||!d)return u?(t.s=-e,t):new k(d?r:NaN);if(!u[0]||!d[0])return d[0]?(t.s=-e,t):new k(u[0]?r:3==h?-0:0)}if(l=Zi(l),c=Zi(c),u=u.slice(),a=l-c){for((s=a<0)?(a=-a,o=u):(c=l,o=d),o.reverse(),e=a;e--;o.push(0));o.reverse()}else for(n=(s=(a=u.length)<(e=d.length))?a:e,a=e=0;e<n;e++)if(u[e]!=d[e]){s=u[e]<d[e];break}if(s&&(o=u,u=d,d=o,t.s=-t.s),(e=(n=d.length)-(i=u.length))>0)for(;e--;u[i++]=0);for(e=zi-1;n>a;){if(u[--n]<d[n]){for(i=n;i&&!u[--i];u[i]=e);--u[i],u[n]+=zi}u[n]-=d[n]}for(;0==u[0];u.splice(0,1),--c);return u[0]?x(t,u,c):(t.s=3==h?-1:1,t.c=[t.e=0],t)},a.modulo=a.mod=function(t,e){var n,o,s=this;return t=new k(t,e),!s.c||!t.s||t.c&&!t.c[0]?new k(NaN):!t.c||s.c&&!s.c[0]?new k(s):(9==f?(o=t.s,t.s=1,n=i(s,t,0,3),t.s=o,n.s*=o):n=i(s,t,0,f),!(t=s.minus(n.times(t))).c[0]&&1==f&&(t.s=s.s),t)},a.multipliedBy=a.times=function(t,e){var i,n,o,s,r,a,l,c,h,u,d,p,_,m,f,g=this,y=g.c,v=(t=new k(t,e)).c;if(!(y&&v&&y[0]&&v[0]))return!g.s||!t.s||y&&!y[0]&&!v||v&&!v[0]&&!y?t.c=t.e=t.s=null:(t.s*=g.s,y&&v?(t.c=[0],t.e=0):t.c=t.e=null),t;for(n=Zi(g.e/ji)+Zi(t.e/ji),t.s*=g.s,(l=y.length)<(u=v.length)&&(_=y,y=v,v=_,o=l,l=u,u=o),o=l+u,_=[];o--;_.push(0));for(m=zi,f=Gi,o=u;--o>=0;){for(i=0,d=v[o]%f,p=v[o]/f|0,s=o+(r=l);s>o;)i=((c=d*(c=y[--r]%f)+(a=p*c+(h=y[r]/f|0)*d)%f*f+_[s]+i)/m|0)+(a/f|0)+p*h,_[s--]=c%m;_[s]=i}return i?++n:_.splice(0,1),x(t,_,n)},a.negated=function(){var t=new k(this);return t.s=-t.s||null,t},a.plus=function(t,e){var i,n=this,o=n.s;if(e=(t=new k(t,e)).s,!o||!e)return new k(NaN);if(o!=e)return t.s=-e,n.minus(t);var s=n.e/ji,r=t.e/ji,a=n.c,l=t.c;if(!s||!r){if(!a||!l)return new k(o/0);if(!a[0]||!l[0])return l[0]?t:new k(a[0]?n:0*o)}if(s=Zi(s),r=Zi(r),a=a.slice(),o=s-r){for(o>0?(r=s,i=l):(o=-o,i=a),i.reverse();o--;i.push(0));i.reverse()}for((o=a.length)-(e=l.length)<0&&(i=l,l=a,a=i,e=o),o=0;e;)o=(a[--e]=a[e]+l[e]+o)/zi|0,a[e]=zi===a[e]?0:a[e]%zi;return o&&(a=[o].concat(a),++r),x(t,a,r)},a.precision=a.sd=function(t,e){var i,n,o,s=this;if(null!=t&&t!==!!t)return Vi(t,1,Hi),null==e?e=h:Vi(e,0,8),$(new k(s),t,e);if(!(i=s.c))return null;if(n=(o=i.length-1)*ji+1,o=i[o]){for(;o%10==0;o/=10,n--);for(o=i[0];o>=10;o/=10,n++);}return t&&s.e+1>n&&(n=s.e+1),n},a.shiftedBy=function(t){return Vi(t,-Fi,Fi),this.times("1e"+t)},a.squareRoot=a.sqrt=function(){var t,e,n,o,s,r=this,a=r.c,l=r.s,u=r.e,d=c+4,p=new k("0.5");if(1!==l||!a||!a[0])return new k(!l||l<0&&(!a||a[0])?NaN:a?r:1/0);if(0==(l=Math.sqrt(+C(r)))||l==1/0?(((e=Ui(a)).length+u)%2==0&&(e+="0"),l=Math.sqrt(+e),u=Zi((u+1)/2)-(u<0||u%2),l==1/0?e="5e"+u:e=(e=l.toExponential()).slice(0,e.indexOf("e")+1)+u,n=new k(e)):n=new k(l+""),n.c[0])for((l=(u=n.e)+d)<3&&(l=0);;)if(s=n,n=p.times(s.plus(i(r,s,d,1))),Ui(s.c).slice(0,l)===(e=Ui(n.c)).slice(0,l)){if(n.e<u&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(o||"4999"!=e)){(!+e||!+e.slice(1)&&"5"==e.charAt(0))&&($(n,n.e+c+2,1),t=!n.times(n).eq(r));break}if(!o&&($(s,s.e+c+2,0),s.times(s).eq(r))){n=s;break}d+=4,l+=4,o=1}return $(n,n.e+c+1,h,t)},a.toExponential=function(t,e){return null!=t&&(Vi(t,0,Hi),t++),w(this,t,e,1)},a.toFixed=function(t,e){return null!=t&&(Vi(t,0,Hi),t=t+this.e+1),w(this,t,e)},a.toFormat=function(t,e,i){var n,o=this;if(null==i)null!=t&&e&&"object"==typeof e?(i=e,e=null):t&&"object"==typeof t?(i=t,t=e=null):i=y;else if("object"!=typeof i)throw Error(Ai+"Argument not an object: "+i);if(n=o.toFixed(t,e),o.c){var s,r=n.split("."),a=+i.groupSize,l=+i.secondaryGroupSize,c=i.groupSeparator||"",h=r[0],u=r[1],d=o.s<0,p=d?h.slice(1):h,_=p.length;if(l&&(s=a,a=l,l=s,_-=s),a>0&&_>0){for(s=_%a||a,h=p.substr(0,s);s<_;s+=a)h+=c+p.substr(s,a);l>0&&(h+=c+p.slice(s)),d&&(h="-"+h)}n=u?h+(i.decimalSeparator||"")+((l=+i.fractionGroupSize)?u.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):u):h}return(i.prefix||"")+n+(i.suffix||"")},a.toFraction=function(t){var e,n,o,s,r,a,c,u,d,p,m,f,g=this,y=g.c;if(null!=t&&(!(c=new k(t)).isInteger()&&(c.c||1!==c.s)||c.lt(l)))throw Error(Ai+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+C(c));if(!y)return new k(g);for(e=new k(l),d=n=new k(l),o=u=new k(l),f=Ui(y),r=e.e=f.length-g.e-1,e.c[0]=Wi[(a=r%ji)<0?ji+a:a],t=!t||c.comparedTo(e)>0?r>0?e:d:c,a=_,_=1/0,c=new k(f),u.c[0]=0;p=i(c,e,0,1),1!=(s=n.plus(p.times(o))).comparedTo(t);)n=o,o=s,d=u.plus(p.times(s=d)),u=s,e=c.minus(p.times(s=e)),c=s;return s=i(t.minus(n),o,0,1),u=u.plus(s.times(d)),n=n.plus(s.times(o)),u.s=d.s=g.s,m=i(d,o,r*=2,h).minus(g).abs().comparedTo(i(u,n,r,h).minus(g).abs())<1?[d,o]:[u,n],_=a,m},a.toNumber=function(){return+C(this)},a.toPrecision=function(t,e){return null!=t&&Vi(t,1,Hi),w(this,t,e,2)},a.toString=function(t){var e,i=this,o=i.s,s=i.e;return null===s?o?(e="Infinity",o<0&&(e="-"+e)):e="NaN":(null==t?e=s<=u||s>=d?Ki(Ui(i.c),s):Xi(Ui(i.c),s,"0"):10===t&&b?e=Xi(Ui((i=$(new k(i),c+s+1,h)).c),i.e,"0"):(Vi(t,2,v.length,"Base"),e=n(Xi(Ui(i.c),s,"0"),10,t,o,!0)),o<0&&i.c[0]&&(e="-"+e)),e},a.valueOf=a.toJSON=function(){return C(this)},a._isBigNumber=!0,a[Symbol.toStringTag]="BigNumber",a[Symbol.for("nodejs.util.inspect.custom")]=a.valueOf,null!=e&&k.set(e),k}(),Qi=Ji,tn=class{key;left=null;right=null;constructor(t){this.key=t}},en=class extends tn{constructor(t){super(t)}},nn=class{size=0;modificationCount=0;splayCount=0;splay(t){let e=this.root;if(null==e)return this.compare(t,t),-1;let i,n=null,o=null,s=null,r=null,a=e,l=this.compare;for(;;)if(i=l(a.key,t),i>0){let e=a.left;if(null==e||(i=l(e.key,t),i>0&&(a.left=e.right,e.right=a,a=e,e=a.left,null==e)))break;null==n?o=a:n.left=a,n=a,a=e}else{if(!(i<0))break;{let e=a.right;if(null==e||(i=l(e.key,t),i<0&&(a.right=e.left,e.left=a,a=e,e=a.right,null==e)))break;null==s?r=a:s.right=a,s=a,a=e}}return null!=s&&(s.right=a.left,a.left=r),null!=n&&(n.left=a.right,a.right=o),this.root!==a&&(this.root=a,this.splayCount++),i}splayMin(t){let e=t,i=e.left;for(;null!=i;){let t=i;e.left=t.right,t.right=e,e=t,i=e.left}return e}splayMax(t){let e=t,i=e.right;for(;null!=i;){let t=i;e.right=t.left,t.left=e,e=t,i=e.right}return e}_delete(t){if(null==this.root||0!=this.splay(t))return null;let e=this.root,i=e,n=e.left;if(this.size--,null==n)this.root=e.right;else{let t=e.right;e=this.splayMax(n),e.right=t,this.root=e}return this.modificationCount++,i}addNewRoot(t,e){this.size++,this.modificationCount++;let i=this.root;null!=i?(e<0?(t.left=i,t.right=i.right,i.right=null):(t.right=i,t.left=i.left,i.left=null),this.root=t):this.root=t}_first(){let t=this.root;return null==t?null:(this.root=this.splayMin(t),this.root)}_last(){let t=this.root;return null==t?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&0==this.splay(t)}defaultCompare(){return(t,e)=>t<e?-1:t>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}},on=class t extends nn{root=null;compare;validKey;constructor(t,e){super(),this.compare=t??this.defaultCompare(),this.validKey=e??(t=>null!=t&&null!=t)}delete(t){return!!this.validKey(t)&&null!=this._delete(t)}deleteAll(t){for(let e of t)this.delete(e)}forEach(t){let e,i=this[Symbol.iterator]();for(;e=i.next(),!e.done;)t(e.value,e.value,this)}add(t){let e=this.splay(t);return 0!=e&&this.addNewRoot(new en(t),e),this}addAndReturn(t){let e=this.splay(t);return 0!=e&&this.addNewRoot(new en(t),e),this.root.key}addAll(t){for(let e of t)this.add(e)}isEmpty(){return null==this.root}isNotEmpty(){return null!=this.root}single(){if(0==this.size)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(0==this.size)throw"Bad state: No element";return this._first().key}last(){if(0==this.size)throw"Bad state: No element";return this._last().key}lastBefore(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;if(this.splay(t)<0)return this.root.key;let e=this.root.left;if(null==e)return null;let i=e.right;for(;null!=i;)e=i,i=e.right;return e.key}firstAfter(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;if(this.splay(t)>0)return this.root.key;let e=this.root.right;if(null==e)return null;let i=e.left;for(;null!=i;)e=i,i=e.left;return e.key}retainAll(e){let i=new t(this.compare,this.validKey),n=this.modificationCount;for(let t of e){if(n!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(t)&&0==this.splay(t)&&i.add(this.root.key)}i.size!=this.size&&(this.root=i.root,this.size=i.size,this.modificationCount++)}lookup(t){return this.validKey(t)&&0==this.splay(t)?this.root.key:null}intersection(e){let i=new t(this.compare,this.validKey);for(let t of this)e.has(t)&&i.add(t);return i}difference(e){let i=new t(this.compare,this.validKey);for(let t of this)e.has(t)||i.add(t);return i}union(t){let e=this.clone();return e.addAll(t),e}clone(){let e=new t(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(t){if(null==t)return null;let e=new en(t.key);return function t(e,i){let n,o;do{if(n=e.left,o=e.right,null!=n){let e=new en(n.key);i.left=e,t(n,e)}if(null!=o){let t=new en(o.key);i.right=t,e=o,i=t}}while(null!=o)}(t,e),e}toSet(){return this.clone()}entries(){return new an(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new rn(this.wrap())}[Symbol.toStringTag]="[object Set]"},sn=class{tree;path=new Array;modificationCount=null;splayCount;constructor(t){this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;null!=t;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(null==this.modificationCount){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;null!=t;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],e=t.right;if(null!=e){for(;null!=e;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}},rn=class extends sn{getValue(t){return t.key}},an=class extends sn{getValue(t){return[t.key,t.key]}},ln=t=>t,cn=t=>{if(t){let e=new on(Oi(t)),i=new on(Oi(t)),n=(t,e)=>e.addAndReturn(t),o=t=>({x:n(t.x,e),y:n(t.y,i)});return o({x:new Qi(0),y:new Qi(0)}),o}return ln},hn=t=>({set:t=>{un=hn(t)},reset:()=>hn(t),compare:Oi(t),snap:cn(t),orient:Di(t)}),un=hn(),dn=(t,e)=>t.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(t.ur.x)&&t.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(t.ur.y),pn=(t,e)=>{if(e.ur.x.isLessThan(t.ll.x)||t.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(t.ll.y)||t.ur.y.isLessThan(e.ll.y))return null;let i=t.ll.x.isLessThan(e.ll.x)?e.ll.x:t.ll.x,n=t.ur.x.isLessThan(e.ur.x)?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y.isLessThan(e.ll.y)?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y.isLessThan(e.ur.y)?t.ur.y:e.ur.y}}},_n=(t,e)=>t.x.times(e.y).minus(t.y.times(e.x)),mn=(t,e)=>t.x.times(e.x).plus(t.y.times(e.y)),fn=t=>mn(t,t).sqrt(),gn=(t,e,i)=>{let n={x:e.x.minus(t.x),y:e.y.minus(t.y)},o={x:i.x.minus(t.x),y:i.y.minus(t.y)};return _n(o,n).div(fn(o)).div(fn(n))},yn=(t,e,i)=>{let n={x:e.x.minus(t.x),y:e.y.minus(t.y)},o={x:i.x.minus(t.x),y:i.y.minus(t.y)};return mn(o,n).div(fn(o)).div(fn(n))},vn=(t,e,i)=>e.y.isZero()?null:{x:t.x.plus(e.x.div(e.y).times(i.minus(t.y))),y:i},bn=(t,e,i)=>e.x.isZero()?null:{x:i,y:t.y.plus(e.y.div(e.x).times(i.minus(t.x)))},kn=class t{point;isLeft;segment;otherSE;consumedBy;static compare(e,i){let n=t.comparePoints(e.point,i.point);return 0!==n?n:(e.point!==i.point&&e.link(i),e.isLeft!==i.isLeft?e.isLeft?1:-1:Ln.compare(e.segment,i.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:t.y.isGreaterThan(e.y)?1:0}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");let e=t.point.events;for(let t=0,i=e.length;t<i;t++){let i=e[t];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}checkForConsuming(){let t=this.point.events.length;for(let e=0;e<t;e++){let i=this.point.events[e];if(void 0===i.segment.consumedBy)for(let n=e+1;n<t;n++){let t=this.point.events[n];void 0===t.consumedBy&&i.otherSE.point.events===t.otherSE.point.events&&i.segment.consume(t.segment)}}}getAvailableLinkedEvents(){let t=[];for(let e=0,i=this.point.events.length;e<i;e++){let i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){let e=new Map,i=i=>{let n=i.otherSE;e.set(i,{sine:gn(this.point,t.point,n.point),cosine:yn(this.point,t.point,n.point)})};return(t,n)=>{e.has(t)||i(t),e.has(n)||i(n);let{sine:o,cosine:s}=e.get(t),{sine:r,cosine:a}=e.get(n);return o.isGreaterThanOrEqualTo(0)&&r.isGreaterThanOrEqualTo(0)?s.isLessThan(a)?1:s.isGreaterThan(a)?-1:0:o.isLessThan(0)&&r.isLessThan(0)?s.isLessThan(a)?-1:s.isGreaterThan(a)?1:0:r.isLessThan(o)?-1:r.isGreaterThan(o)?1:0}}},wn=0,Ln=class t{id;leftSE;rightSE;rings;windings;ringOut;consumedBy;prev;_prevInResult;_beforeState;_afterState;_isInResult;static compare(t,e){let i=t.leftSE.point.x,n=e.leftSE.point.x,o=t.rightSE.point.x,s=e.rightSE.point.x;if(s.isLessThan(i))return 1;if(o.isLessThan(n))return-1;let r=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,c=e.rightSE.point.y;if(i.isLessThan(n)){if(a.isLessThan(r)&&a.isLessThan(l))return 1;if(a.isGreaterThan(r)&&a.isGreaterThan(l))return-1;let i=t.comparePoint(e.leftSE.point);if(i<0)return 1;if(i>0)return-1;let n=e.comparePoint(t.rightSE.point);return 0!==n?n:-1}if(i.isGreaterThan(n)){if(r.isLessThan(a)&&r.isLessThan(c))return-1;if(r.isGreaterThan(a)&&r.isGreaterThan(c))return 1;let i=e.comparePoint(t.leftSE.point);if(0!==i)return i;let n=t.comparePoint(e.rightSE.point);return n<0?1:n>0?-1:1}if(r.isLessThan(a))return-1;if(r.isGreaterThan(a))return 1;if(o.isLessThan(s)){let i=e.comparePoint(t.rightSE.point);if(0!==i)return i}if(o.isGreaterThan(s)){let i=t.comparePoint(e.rightSE.point);if(i<0)return 1;if(i>0)return-1}if(!o.eq(s)){let t=l.minus(r),e=o.minus(i),h=c.minus(a),u=s.minus(n);if(t.isGreaterThan(e)&&h.isLessThan(u))return 1;if(t.isLessThan(e)&&h.isGreaterThan(u))return-1}return o.isGreaterThan(s)?1:o.isLessThan(s)||l.isLessThan(c)?-1:l.isGreaterThan(c)?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,i,n){this.id=++wn,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=i,this.windings=n}static fromRing(e,i,n){let o,s,r,a=kn.comparePoints(e,i);if(a<0)o=e,s=i,r=1;else{if(!(a>0))throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);o=i,s=e,r=-1}let l=new kn(o,!0),c=new kn(s,!1);return new t(l,c,[n],[r])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return un.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){let e=this.bbox(),i=t.bbox(),n=pn(e,i);if(null===n)return null;let o=this.leftSE.point,s=this.rightSE.point,r=t.leftSE.point,a=t.rightSE.point,l=dn(e,r)&&0===this.comparePoint(r),c=dn(i,o)&&0===t.comparePoint(o),h=dn(e,a)&&0===this.comparePoint(a),u=dn(i,s)&&0===t.comparePoint(s);if(c&&l)return u&&!h?s:!u&&h?a:null;if(c)return h&&o.x.eq(a.x)&&o.y.eq(a.y)?null:o;if(l)return u&&s.x.eq(r.x)&&s.y.eq(r.y)?null:r;if(u&&h)return null;if(u)return s;if(h)return a;let d=((t,e,i,n)=>{if(e.x.isZero())return bn(i,n,t.x);if(n.x.isZero())return bn(t,e,i.x);if(e.y.isZero())return vn(i,n,t.y);if(n.y.isZero())return vn(t,e,i.y);let o=_n(e,n);if(o.isZero())return null;let s={x:i.x.minus(t.x),y:i.y.minus(t.y)},r=_n(s,e).div(o),a=_n(s,n).div(o),l=t.x.plus(a.times(e.x)),c=i.x.plus(r.times(n.x)),h=t.y.plus(a.times(e.y)),u=i.y.plus(r.times(n.y));return{x:l.plus(c).div(2),y:h.plus(u).div(2)}})(o,this.vector(),r,t.vector());return null!==d&&dn(n,d)?un.snap(d):null}split(e){let i=[],n=void 0!==e.events,o=new kn(e,!0),s=new kn(e,!1),r=this.rightSE;this.replaceRightSE(s),i.push(s),i.push(o);let a=new t(o,r,this.rings.slice(),this.windings.slice());return kn.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),kn.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(o.checkForConsuming(),s.checkForConsuming()),i}swapEvents(){let t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,e=this.windings.length;t<e;t++)this.windings[t]*=-1}consume(e){let i=this,n=e;for(;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;let o=t.compare(i,n);if(0!==o){if(o>0){let t=i;i=n,n=t}if(i.prev===n){let t=i;i=n,n=t}for(let t=0,e=n.rings.length;t<e;t++){let e=n.rings[t],o=n.windings[t],s=i.rings.indexOf(e);-1===s?(i.rings.push(e),i.windings.push(o)):i.windings[s]+=o}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){let t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;let t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};let e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys;for(let t=0,n=this.rings.length;t<n;t++){let n=this.rings[t],o=this.windings[t],s=e.indexOf(n);-1===s?(e.push(n),i.push(o)):i[s]+=o}let o=[],s=[];for(let t=0,n=e.length;t<n;t++){if(0===i[t])continue;let n=e[t],r=n.poly;if(-1===s.indexOf(r))if(n.isExterior)o.push(r);else{-1===s.indexOf(r)&&s.push(r);let t=o.indexOf(n.poly);-1!==t&&o.splice(t,1)}}for(let t=0,e=o.length;t<e;t++){let e=o[t].multiPoly;-1===n.indexOf(e)&&n.push(e)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;let t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(On.type){case"union":{let i=0===t.length,n=0===e.length;this._isInResult=i!==n;break}case"intersection":{let i,n;t.length<e.length?(i=t.length,n=e.length):(i=e.length,n=t.length),this._isInResult=n===On.numMultiPolys&&i<n;break}case"xor":{let i=Math.abs(t.length-e.length);this._isInResult=i%2==1;break}case"difference":{let i=t=>1===t.length&&t[0].isSubject;this._isInResult=i(t)!==i(e);break}}return this._isInResult}},xn=class{poly;isExterior;segments;bbox;constructor(t,e,i){if(!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=i,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let n=un.snap({x:new Qi(t[0][0]),y:new Qi(t[0][1])});this.bbox={ll:{x:n.x,y:n.y},ur:{x:n.x,y:n.y}};let o=n;for(let e=1,i=t.length;e<i;e++){if("number"!=typeof t[e][0]||"number"!=typeof t[e][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let i=un.snap({x:new Qi(t[e][0]),y:new Qi(t[e][1])});i.x.eq(o.x)&&i.y.eq(o.y)||(this.segments.push(Ln.fromRing(o,i,this)),i.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.x),i.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.y),i.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.x),i.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.y),o=i)}(!n.x.eq(o.x)||!n.y.eq(o.y))&&this.segments.push(Ln.fromRing(o,n,this))}getSweepEvents(){let t=[];for(let e=0,i=this.segments.length;e<i;e++){let i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}},$n=class{multiPoly;exteriorRing;interiorRings;bbox;constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new xn(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,i=t.length;e<i;e++){let i=new xn(t[e],this,!1);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=e}getSweepEvents(){let t=this.exteriorRing.getSweepEvents();for(let e=0,i=this.interiorRings.length;e<i;e++){let i=this.interiorRings[e].getSweepEvents();for(let e=0,n=i.length;e<n;e++)t.push(i[e])}return t}},Cn=class{isSubject;polys;bbox;constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:new Qi(Number.POSITIVE_INFINITY),y:new Qi(Number.POSITIVE_INFINITY)},ur:{x:new Qi(Number.NEGATIVE_INFINITY),y:new Qi(Number.NEGATIVE_INFINITY)}};for(let e=0,i=t.length;e<i;e++){let i=new $n(t[e],this);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=e}getSweepEvents(){let t=[];for(let e=0,i=this.polys.length;e<i;e++){let i=this.polys[e].getSweepEvents();for(let e=0,n=i.length;e<n;e++)t.push(i[e])}return t}},Mn=class t{events;poly;_isExteriorRing;_enclosingRing;static factory(e){let i=[];for(let n=0,o=e.length;n<o;n++){let o=e[n];if(!o.isInResult()||o.ringOut)continue;let s=null,r=o.leftSE,a=o.rightSE,l=[r],c=r.point,h=[];for(;s=r,r=a,l.push(r),r.point!==c;)for(;;){let e=r.getAvailableLinkedEvents();if(0===e.length){let t=l[0].point,e=l[l.length-1].point;throw new Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===e.length){a=e[0].otherSE;break}let n=null;for(let t=0,e=h.length;t<e;t++)if(h[t].point===r.point){n=t;break}if(null!==n){let e=h.splice(n)[0],o=l.splice(e.index);o.unshift(o[0].otherSE),i.push(new t(o.reverse()));continue}h.push({index:l.length,point:r.point});let o=r.getLeftmostComparator(s);a=e.sort(o)[0].otherSE;break}i.push(new t(l))}return i}constructor(t){this.events=t;for(let e=0,i=t.length;e<i;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point,e=[t];for(let i=1,n=this.events.length-1;i<n;i++){let n=this.events[i].point,o=this.events[i+1].point;0!==un.orient(n,t,o)&&(e.push(n),t=n)}if(1===e.length)return null;let i=e[0],n=e[1];0===un.orient(i,t,n)&&e.shift(),e.push(e[0]);let o=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:e.length-1,r=this.isExteriorRing()?e.length:-1,a=[];for(let t=s;t!=r;t+=o)a.push([e[t].x.toNumber(),e[t].y.toNumber()]);return a}isExteriorRing(){if(void 0===this._isExteriorRing){let t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let e=1,i=this.events.length;e<i;e++){let i=this.events[e];kn.compare(t,i)>0&&(t=i)}let e=t.segment.prevInResult(),i=e?e.prevInResult():null;for(;;){if(!e)return null;if(!i)return e.ringOut;if(i.ringOut!==e.ringOut)return i.ringOut?.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut?.enclosingRing();e=i.prevInResult(),i=e?e.prevInResult():null}}},En=class{exteriorRing;interiorRings;constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){let t=this.exteriorRing.getGeom();if(null===t)return null;let e=[t];for(let t=0,i=this.interiorRings.length;t<i;t++){let i=this.interiorRings[t].getGeom();null!==i&&e.push(i)}return e}},Tn=class{rings;polys;constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){let t=[];for(let e=0,i=this.polys.length;e<i;e++){let i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}_composePolys(t){let e=[];for(let i=0,n=t.length;i<n;i++){let n=t[i];if(!n.poly)if(n.isExteriorRing())e.push(new En(n));else{let t=n.enclosingRing();t?.poly||e.push(new En(t)),t?.poly?.addInterior(n)}}return e}},Pn=class{queue;tree;segments;constructor(t,e=Ln.compare){this.queue=t,this.tree=new on(e),this.segments=[]}process(t){let e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(e),i;t.isLeft&&this.tree.add(e);let n=e,o=e;do{n=this.tree.lastBefore(n)}while(null!=n&&null!=n.consumedBy);do{o=this.tree.firstAfter(o)}while(null!=o&&null!=o.consumedBy);if(t.isLeft){let s=null;if(n){let t=n.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(s=t),!n.isAnEndpoint(t))){let e=this._splitSafely(n,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}}let r=null;if(o){let t=o.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(r=t),!o.isAnEndpoint(t))){let e=this._splitSafely(o,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}}if(null!==s||null!==r){let t=null;t=null===s?r:null===r||kn.comparePoints(s,r)<=0?s:r,this.queue.delete(e.rightSE),i.push(e.rightSE);let n=e.split(t);for(let t=0,e=n.length;t<e;t++)i.push(n[t])}i.length>0?(this.tree.delete(e),i.push(t)):(this.segments.push(e),e.prev=n)}else{if(n&&o){let t=n.getIntersection(o);if(null!==t){if(!n.isAnEndpoint(t)){let e=this._splitSafely(n,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}if(!o.isAnEndpoint(t)){let e=this._splitSafely(o,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}}}this.tree.delete(e)}return i}_splitSafely(t,e){this.tree.delete(t);let i=t.rightSE;this.queue.delete(i);let n=t.split(e);return n.push(i),void 0===t.consumedBy&&this.tree.add(t),n}},Sn=new class{type;numMultiPolys;run(t,e,i){Sn.type=t;let n=[new Cn(e,!0)];for(let t=0,e=i.length;t<e;t++)n.push(new Cn(i[t],!1));if(Sn.numMultiPolys=n.length,"difference"===Sn.type){let t=n[0],e=1;for(;e<n.length;)null!==pn(n[e].bbox,t.bbox)?e++:n.splice(e,1)}if("intersection"===Sn.type)for(let t=0,e=n.length;t<e;t++){let e=n[t];for(let i=t+1,o=n.length;i<o;i++)if(null===pn(e.bbox,n[i].bbox))return[]}let o=new on(kn.compare);for(let t=0,e=n.length;t<e;t++){let e=n[t].getSweepEvents();for(let t=0,i=e.length;t<i;t++)o.add(e[t])}let s=new Pn(o),r=null;for(0!=o.size&&(r=o.first(),o.delete(r));r;){let t=s.process(r);for(let e=0,i=t.length;e<i;e++){let i=t[e];void 0===i.consumedBy&&o.add(i)}0!=o.size?(r=o.first(),o.delete(r)):r=null}un.reset();let a=Mn.factory(s.segments);return new Tn(a).getGeom()}},On=Sn;function Dn(t){let e={type:"Feature"};return e.geometry=t,e}function In(t){return"Feature"===t.type?t.geometry:t}function Bn(t){return t&&t.geometry&&t.geometry.coordinates?t.geometry.coordinates:t}function Rn(t){return Dn({type:"Polygon",coordinates:t})}function An(t){return Dn({type:"MultiPolygon",coordinates:t})}function Nn(t,e){let i=In(t),n=In(e),o=((t,...e)=>On.run("intersection",t,e))(i.coordinates,n.coordinates);return 0===o.length?null:1===o.length?Rn(o[0]):An(o)}function zn(t,e){let i=In(t),n=In(e),o=((t,...e)=>On.run("difference",t,e))(i.coordinates,n.coordinates);return 0===o.length?null:1===o.length?Rn(o[0]):An(o)}function jn(t){return Array.isArray(t)?1+jn(t[0]):-1}function Fn(t){t instanceof L.Polyline&&(t=t.toGeoJSON(15));let e=Bn(t),i=jn(e),n=[];return i>1?e.forEach((t=>{n.push(function(t){return Dn({type:"LineString",coordinates:t})}(t))})):n.push(t),n}function Wn(t){let e=[];return t.eachLayer((t=>{e.push(Bn(t.toGeoJSON(15)))})),function(t){return Dn({type:"MultiLineString",coordinates:t})}(e)}un.set,ze.Cut=ze.Polygon.extend({initialize(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=2)return;let e=L.polygon(t,this.options.pathOptions);e._latlngInfos=this._layer._latlngInfo,this.cut(e),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach((({layer:t,originalLayer:e})=>{this._fireCut(e,t,e),this._fireCut(this._map,t,e),e.pm._fireEdit()})),this._editedLayers=[],this.disable(),this.options.continueDrawing&&this.enable()},cut(t){let e=this._map._layers,i=t._latlngInfos||[];Object.keys(e).map((t=>e[t])).filter((t=>t.pm)).filter((t=>!t._pmTempLayer)).filter((t=>!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)).filter((t=>t instanceof L.Polyline)).filter((e=>e!==t)).filter((t=>t.pm.options.allowCutting)).filter((t=>!(this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0)||this.options.layersToCut.indexOf(t)>-1)).filter((t=>!this._layerGroup.hasLayer(t))).filter((e=>{try{let i=!!ai(t.toGeoJSON(15),e.toGeoJSON(15)).features.length>0;return i||e instanceof L.Polyline&&!(e instanceof L.Polygon)?i:!!Nn(t.toGeoJSON(15),e.toGeoJSON(15))}catch{return e instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}})).forEach((e=>{let n;if(e instanceof L.Polygon){n=L.polygon(e.getLatLngs());let t=n.getLatLngs();i.forEach((e=>{if(e&&e.snapInfo){let{latlng:i}=e,o=this._calcClosestLayer(i,[n]);if(o&&o.segment&&o.distance<this.options.snapDistance){let{segment:e}=o;if(e&&2===e.length){let{indexPath:n,parentPath:o,newIndex:s}=L.PM.Utils._getIndexFromSegment(t,e);(n.length>1?(0,Pi.default)(t,o):t).splice(s,0,i)}}}}))}else n=e;let o=this._cutLayer(t,n),s=L.geoJSON(o,e.options);1===s.getLayers().length&&([s]=s.getLayers()),this._setPane(s,"layerPane");let r=s.addTo(this._map.pm._getContainingLayer());if(r.pm.enable(e.pm.options),r.pm.disable(),e._pmTempLayer=!0,t._pmTempLayer=!0,e.remove(),e.removeFrom(this._map.pm._getContainingLayer()),t.remove(),t.removeFrom(this._map.pm._getContainingLayer()),r.getLayers&&0===r.getLayers().length&&this._map.pm.removeLayer({target:r}),r instanceof L.LayerGroup?(r.eachLayer((t=>{this._addDrawnLayerProp(t)})),this._addDrawnLayerProp(r)):this._addDrawnLayerProp(r),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let t=this.options.layersToCut.indexOf(e);t>-1&&this.options.layersToCut.splice(t,1)}this._editedLayers.push({layer:r,originalLayer:e})}))},_cutLayer(t,e){let i,n=L.geoJSON();if(e instanceof L.Polygon)i=zn(e.toGeoJSON(15),t.toGeoJSON(15));else{let o=Fn(e);o.forEach((e=>{let i,o=ki(e,t.toGeoJSON(15));i=o&&o.features.length>0?L.geoJSON(o):L.geoJSON(e),i.getLayers().forEach((e=>{Ci(t.toGeoJSON(15),e.toGeoJSON(15))||e.addTo(n)}))})),i=o.length>1?Wn(n):n.toGeoJSON(15)}return i},_change:L.Util.falseFn}),ze.Text=ze.extend({initialize(t){this._map=t,this._shape="Text",this.toolbarButtonName="drawText"},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(xe("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker?.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_createMarker(t){if(!t.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),this.options.textOptions?.className){let t=this.options.textOptions.className.split(" ");this.textArea.classList.add(...t)}let i=this._createTextIcon(this.textArea),n=new L.Marker(e,{textMarker:!0,_textMarkerOverPM:!0,icon:i});if(this._setPane(n,"markerPane"),this._finishLayer(n),n.pm||(n.options.draggable=!1),n.addTo(this._map.pm._getContainingLayer()),n.pm){n.pm.textArea=this.textArea,L.setOptions(n.pm,{removeIfEmpty:this.options.textOptions?.removeIfEmpty??!0});let t=this.options.textOptions?.focusAfterDraw??!0;n.pm._createTextMarker(t),this.options.textOptions?.text&&n.pm.setText(this.options.textOptions.text)}this._fireCreate(n),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()},_createTextArea(){let t=document.createElement("textarea");return t.readOnly=!0,t.classList.add("pm-textarea","pm-disabled"),t},_createTextIcon:t=>L.divIcon({className:"pm-text-marker",html:t})});var Gn={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,De(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let t=this._getDOMElem();t&&(De(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(t)):L.DomEvent.on(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,De(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let t=this._getDOMElem();t&&(De(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(t)):L.DomEvent.off(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(t){let e=t.touches?t.touches[0]:t,i={originalEvent:e,target:this._layer};return i.containerPoint=this._map.mouseEventToContainerPoint(e),i.latlng=this._map.containerPointToLatLng(i.containerPoint),this._dragMixinOnMouseDown(i),!1},_simulateMouseMoveEvent(t){let e=t.touches?t.touches[0]:t,i={originalEvent:e,target:this._layer};return i.containerPoint=this._map.mouseEventToContainerPoint(e),i.latlng=this._map.containerPointToLatLng(i.containerPoint),this._dragMixinOnMouseMove(i),!1},_simulateMouseUpEvent(t){let e={originalEvent:t.touches?t.touches[0]:t,target:this._layer};return-1===t.type.indexOf("touch")&&(e.containerPoint=this._map.mouseEventToContainerPoint(t),e.latlng=this._map.containerPointToLatLng(e.containerPoint)),this._dragMixinOnMouseUp(e),!1},_dragMixinOnMouseDown(t){if(t.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(t);let e=t._fromLayerSync,i=this._syncLayers("_dragMixinOnMouseDown",t);if(this._layer instanceof L.Marker&&(!this.options.snappable||e||i?this._disableSnapping():this._initSnappableMarkers()),this._layer instanceof L.CircleMarker){let t="resizeableCircleMarker";this._layer instanceof L.Circle&&(t="resizableCircle"),!this.options.snappable||e||i?this._layer.pm.options[t]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag():this._layer.pm.options[t]||this._initSnappableMarkersDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(t){this._overwriteEventIfItComesFromMarker(t);let e=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",t),this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=t.latlng),this._onLayerDrag(t),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(t){let e=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",t),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),!!this._dragging&&(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout((()=>{this._dragging=!1,e&&L.DomUtil.removeClass(e,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0}),10),!0)},_onLayerDrag(t){let{latlng:e}=t,i=e.lat-this._tempDragCoord.lat,n=e.lng-this._tempDragCoord.lng,o=t=>t.map((t=>{if(Array.isArray(t))return o(t);let e={lat:t.lat+i,lng:t.lng+n};return(t.alt||0===t.alt)&&(e.alt=t.alt),e}));if(this._layer instanceof L.Circle&&this._layer.options.resizableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let t=o([this._layer.getLatLng()]);this._layer.setLatLng(t[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let t=this._layer.getLatLng();this._layer._snapped&&(t=this._layer._orgLatLng);let e=o([t]);this._layer.setLatLng(e[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let t=o([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(t),this._fireChange(this._layer.getBounds(),"Edit")}else{let t=o(this._layer.getLatLngs());this._layer.setLatLngs(t),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=e,t.layer=this._layer,this._fireDrag(t)},addDraggingClass(){let t=this._getDOMElem();t&&L.DomUtil.addClass(t,"leaflet-pm-draggable")},removeDraggingClass(){let t=this._getDOMElem();t&&L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_getDOMElem(){let t=null;return this._layer._path?t=this._layer._path:this._layer._renderer&&this._layer._renderer._container?t=this._layer._renderer._container:this._layer._image?t=this._layer._image:this._layer._icon&&(t=this._layer._icon),t},_overwriteEventIfItComesFromMarker(t){t.target.getLatLng&&(!t.target._radius||t.target._radius<=10)&&(t.containerPoint=this._map.mouseEventToContainerPoint(t.originalEvent),t.latlng=this._map.containerPointToLatLng(t.containerPoint))},_syncLayers(t,e){if(this.enabled())return!1;if(!e._fromLayerSync&&this._layer===e.target&&this.options.syncLayersOnDrag){e._fromLayerSync=!0;let i=[];if(L.Util.isArray(this.options.syncLayersOnDrag))i=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach((t=>{t instanceof L.LayerGroup&&(i=i.concat(t.pm.getLayers(!0)))}));else if(!0===this.options.syncLayersOnDrag&&this._parentLayerGroup)for(let t in this._parentLayerGroup){let e=this._parentLayerGroup[t];e.pm&&(i=e.pm.getLayers(!0))}return L.Util.isArray(i)&&i.length>0&&(i=i.filter((t=>!!t.pm)).filter((t=>!!t.pm.options.draggable)),i.forEach((i=>{i!==this._layer&&i.pm[t]&&(i._snapped=!1,i.pm[t](e))}))),i.length>0}return!1},_stopDOMImageDrag:t=>(t.preventDefault(),!1)},Hn=a(le());function Zn(t,e,i){let n=i.getMaxZoom();if(n===1/0&&(n=i.getZoom()),L.Util.isArray(t)){let n=[];return t.forEach((t=>{n.push(Zn(t,e,i))})),n}return t instanceof L.LatLng?function(t,e,i,n){return i.unproject(e.transform(i.project(t,n)),n)}(t,e,i,n):null}function Un(t,e){e instanceof L.Layer&&(e=e.getLatLng());let i=t.getMaxZoom();return i===1/0&&(i=t.getZoom()),t.project(e,i)}function qn(t,e){let i=t.getMaxZoom();return i===1/0&&(i=t.getZoom()),t.unproject(e,i)}var Vn={_onRotateStart(t){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Un(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Un(this._map,t.target.getLatLng()),this._initialRotateLatLng=Se(this._layer),this._startAngle=this.getAngle();let e=Se(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,e),this._fireRotationStart(this._map,e)},_onRotate(t){let e=Un(this._map,t.target.getLatLng()),i=this._rotationStartPoint,n=this._rotationOriginPoint,o=Math.atan2(e.y-n.y,e.x-n.x)-Math.atan2(i.y-n.y,i.x-n.x);this._layer.setLatLngs(this._rotateLayer(o,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let s=this;!function t(e,i=[],n=-1){if(n>-1&&i.push(n),L.Util.isArray(e[0]))e.forEach(((e,n)=>t(e,i.slice(),n)));else{let t=(0,Hn.default)(s._markers,i);e.forEach(((e,i)=>{t[i].setLatLng(e)}))}}(this._layer.getLatLngs());let r=Se(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(o,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let a=180*o/Math.PI;a=a<0?a+360:a;let l=a+this._startAngle;this._setAngle(l),this._rotationLayer.pm._setAngle(l),this._fireRotation(this._rotationLayer,a,r),this._fireRotation(this._map,a,r),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let t=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let e=Se(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=Se(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,t,e),this._fireRotationEnd(this._map,t,e),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(t,e,i,n,o){let s=Un(o,i);return this._matrix=n.clone().rotate(t,s).flip(),Zn(e,this._matrix,o)},_setAngle(t){t=t<0?t+360:t,this._angle=t%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let t=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),e=t.getCenter();return t.removeFrom(this._layer._map),e},enableRotate(){if(!this.options.allowRotation)return void this.disableRotate();this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&void 0===this._angle&&this.setInitAngle(Te(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);this._rotatePoly=L.polygon(this._layer.getLatLngs(),{fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0}),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=Se(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(t){let e=this.getAngle(),i=this._layer.getLatLngs(),n=t*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(n,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+t),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(n,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let o=this.getAngle()-e;o=o<0?o+360:o,this._startAngle=e,this._fireRotation(this._layer,o,i,this._layer),this._fireRotation(this._map||this._layer._map,o,i,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(t){let e=t-this.getAngle();this.rotateLayer(e)},getAngle(){return this._angle||0},setInitAngle(t){this._setAngle(t)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(t){this._rotationCenter=t,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(t)}},Yn=L.Class.extend({includes:[Gn,Ne,Vn,ke],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizableCircle:!0},setOptions(t){L.Util.setOptions(this,t)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(t,e){let i=e.target,n={layer:this._layer,marker:i,event:e},o="";return"move"===t?o="moveVertexValidation":"add"===t?o="addVertexValidation":"remove"===t&&(o="removeVertexValidation"),this.options[o]&&"function"==typeof this.options[o]&&!this.options[o](n)?("move"===t&&(i._cancelDragEventChain=i.getLatLng()),!1):(i._cancelDragEventChain=null,!0)},_vertexValidationDrag:t=>!t._cancelDragEventChain||(t._latlng=t._cancelDragEventChain,t.update(),!1),_vertexValidationDragEnd:t=>!t._cancelDragEventChain||(t._cancelDragEventChain=null,!1)});Yn.LayerGroup=L.Class.extend({initialize(t){this._layerGroup=t,this._layers=this.getLayers(),this._getMap(),this._layers.forEach((t=>this._initLayer(t)));this._layerGroup.on("layeradd",L.Util.throttle((t=>{if(t.layer._pmTempLayer)return;this._layers=this.getLayers();let e=this._layers.filter((t=>!t.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in t.pm._parentLayerGroup)));e.forEach((t=>{this._initLayer(t)})),e.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())}),100,this),this),this._layerGroup.on("layerremove",(t=>{this._removeLayerFromGroup(t.target)}),this);this._layerGroup.on("layerremove",L.Util.throttle((t=>{t.target._pmTempLayer||(this._layers=this.getLayers())}),100,this),this)},enable(t,e=[]){0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach((i=>{i instanceof L.LayerGroup?-1===e.indexOf(i._leaflet_id)&&(e.push(i._leaflet_id),i.pm.enable(t,e)):i.pm.enable(t)}))},disable(t=[]){0===t.length&&(this._layers=this.getLayers()),this._layers.forEach((e=>{e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.disable(t)):e.pm.disable()}))},enabled(t=[]){return 0===t.length&&(this._layers=this.getLayers()),!!this._layers.find((e=>e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.enabled(t)):e.pm.enabled()))},toggleEdit(t,e=[]){0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach((i=>{i instanceof L.LayerGroup?-1===e.indexOf(i._leaflet_id)&&(e.push(i._leaflet_id),i.pm.toggleEdit(t,e)):i.pm.toggleEdit(t)}))},_initLayer(t){let e=L.Util.stamp(this._layerGroup);t.pm._parentLayerGroup||(t.pm._parentLayerGroup={}),t.pm._parentLayerGroup[e]=this._layerGroup},_removeLayerFromGroup(t){if(t.pm&&t.pm._layerGroup){let e=L.Util.stamp(this._layerGroup);delete t.pm._layerGroup[e]}},dragging(){return this._layers=this.getLayers(),!!this._layers&&!!this._layers.find((t=>t.pm.dragging()))},getOptions(){return this.options},_getMap(){return this._map||this._layers.find((t=>!!t._map))?._map||null},getLayers(t=!1,e=!0,i=!0,n=[]){let o=[];return t?this._layerGroup.getLayers().forEach((t=>{o.push(t),t instanceof L.LayerGroup&&-1===n.indexOf(t._leaflet_id)&&(n.push(t._leaflet_id),o=o.concat(t.pm.getLayers(!0,!0,!0,n)))})):o=this._layerGroup.getLayers(),i&&(o=o.filter((t=>!(t instanceof L.LayerGroup)))),e&&(o=o.filter((t=>!!t.pm)),o=o.filter((t=>!t._pmTempLayer)),o=o.filter((t=>!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore))),o},setOptions(t,e=[]){0===e.length&&(this._layers=this.getLayers()),this.options=t,this._layers.forEach((i=>{i.pm&&(i instanceof L.LayerGroup?-1===e.indexOf(i._leaflet_id)&&(e.push(i._leaflet_id),i.pm.setOptions(t,e)):i.pm.setOptions(t))}))}}),Yn.Marker=Yn.extend({_shape:"Marker",initialize(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(t={draggable:!0}){L.Util.setOptions(this,t),this.options.allowEditing&&this._layer._map?(this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()):this.disable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(t){let e=t.target;e.remove(),this._fireRemove(e),this._fireRemove(this._map,e)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}});var Kn=a(le()),Xn={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let t=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=t.filter(((t,e,i)=>i.indexOf(t)===e))},_removeFromCache(t){let e=this.markerCache.indexOf(t);e>-1&&this.markerCache.splice(e,1)},renderLimits(t){this.markerCache.forEach((e=>{t.includes(e)?this._markerGroup.addLayer(e):this._markerGroup.removeLayer(e)}))},applyLimitFilters({latlng:t={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let e=[...this._filterClosestMarkers(t)];this.renderLimits(e)},_filterClosestMarkers(t){let e=[...this.markerCache],i=this.options.limitMarkersToCount;return-1===i?e:(e.sort(((e,i)=>e._latlng.distanceTo(t)-i._latlng.distanceTo(t))),e.filter(((t,e)=>!(i>-1)||e<i)))},_preventRenderMarkers:!1,_preventRenderingMarkers(t){this._preventRenderMarkers=!!t}};Yn.Line=Yn.extend({includes:[Xn],_shape:"Line",initialize(t){this._layer=t,this._enabled=!1},enable(t){if(L.Util.setOptions(this,t),this._map=this._layer._map,this._map){if(!this.options.allowEditing)return void this.disable();this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:("#f00000ff"!==this._layer.options.color?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(t){return this.enabled()?this.disable():this.enable(t),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let t=this._map,e=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let i=t=>{if(Array.isArray(t[0]))return t.map(i,this);let e=t.map(this._createMarker,this);return!0!==this.options.hideMiddleMarkers&&t.map(((i,n)=>{let o=this.isPolygon()?(n+1)%t.length:n+1;return this._createMiddleMarker(e[n],e[o])})),e};this._markers=i(e),this.filterMarkerGroup(),t.addLayer(this._markerGroup)},_createMarker(t){let e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this.options.rotate?(e.on("dragstart",this._onRotateStart,this),e.on("drag",this._onRotate,this),e.on("dragend",this._onRotateEnd,this)):(e.on("click",this._onVertexClick,this),e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(e),e},_createMiddleMarker(t,e){if(!t||!e)return!1;let i=L.PM.Utils.calcMiddleLatLng(this._map,t.getLatLng(),e.getLatLng()),n=this._createMarker(i),o=L.divIcon({className:"marker-icon marker-icon-middle"});return n.setIcon(o),n.leftM=t,n.rightM=e,t._middleMarkerNext=n,e._middleMarkerPrev=n,n.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),n.on("movestart",this._onMiddleMarkerMoveStart,this),n},_onMiddleMarkerClick(t){let e=t.target;if(!this._vertexValidation("add",t))return;let i=L.divIcon({className:"marker-icon"});e.setIcon(i),this._addMarker(e,e.leftM,e.rightM)},_onMiddleMarkerMoveStart(t){let e=t.target;e.on("moveend",this._onMiddleMarkerMoveEnd,this),this._vertexValidation("add",t)?(e._dragging=!0,this._addMarker(e,e.leftM,e.rightM)):e.on("move",this._onMiddleMarkerMovePrevent,this)},_onMiddleMarkerMovePrevent(t){let e=t.target;this._vertexValidationDrag(e)},_onMiddleMarkerMoveEnd(t){let e=t.target;if(e.off("move",this._onMiddleMarkerMovePrevent,this),e.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(e))return;let i=L.divIcon({className:"marker-icon"});e.setIcon(i),setTimeout((()=>{delete e._dragging}),100)},_addMarker(t,e,i){t.off("movestart",this._onMiddleMarkerMoveStart,this),t.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let n=t.getLatLng(),o=this._layer._latlngs;delete t.leftM,delete t.rightM;let{indexPath:s,index:r,parentPath:a}=L.PM.Utils.findDeepMarkerIndex(this._markers,e),l=s.length>1?(0,Kn.default)(o,a):o,c=s.length>1?(0,Kn.default)(this._markers,a):this._markers;l.splice(r+1,0,n),c.splice(r+1,0,t),this._layer.setLatLngs(o),!0!==this.options.hideMiddleMarkers&&(this._createMiddleMarker(e,t),this._createMiddleMarker(t,i)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(t,L.PM.Utils.findDeepMarkerIndex(this._markers,t).indexPath,n),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return Ye(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(t){let e,i,n=this._layer;if(this.options.allowSelfIntersection?e=!1:(i=Ye(this._layer.toGeoJSON(15)),e=i.features.length>0),e){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return e;t?this._flashLayer():(n.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(i)}else n.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return e},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout((()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1}),200)},_updateDisabledMarkerStyle(t,e){t.forEach((t=>{Array.isArray(t)?this._updateDisabledMarkerStyle(t,e):t._icon&&(e&&!this._checkMarkerAllowedToDrag(t)?L.DomUtil.addClass(t._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(t._icon,"vertexmarker-disabled"))}))},_removeMarker(t){let e=t.target;if(!this._vertexValidation("remove",t))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=Se(this._layer,this._layer.getLatLngs()));let i=this._layer.getLatLngs(),{indexPath:n,index:o,parentPath:s}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);if(!n)return;let r=n.length>1?(0,Kn.default)(i,s):i,a=n.length>1?(0,Kn.default)(this._markers,s):this._markers;if(!this.options.removeLayerBelowMinVertexCount&&(r.length<=2||this.isPolygon()&&r.length<=3))return void this._flashLayer();r.splice(o,1),this._layer.setLatLngs(i),this.isPolygon()&&r.length<=2&&r.splice(0,r.length);let l=!1;if(r.length<=1&&(r.splice(0,r.length),s.length>1&&n.length>1&&(i=Ce(i)),this._layer.setLatLngs(i),this._initMarkers(),l=!0),$e(i)||this._layer.remove(),i=Ce(i),this._layer.setLatLngs(i),this._markers=Ce(this._markers),!l&&(a=n.length>1?(0,Kn.default)(this._markers,s):this._markers,e._middleMarkerPrev&&(this._markerGroup.removeLayer(e._middleMarkerPrev),this._removeFromCache(e._middleMarkerPrev)),e._middleMarkerNext&&(this._markerGroup.removeLayer(e._middleMarkerNext),this._removeFromCache(e._middleMarkerNext)),this._markerGroup.removeLayer(e),this._removeFromCache(e),a)){let t,e;if(this.isPolygon()?(t=(o+1)%a.length,e=(o+(a.length-1))%a.length):(e=o-1<0?void 0:o-1,t=o+1>=a.length?void 0:o+1),t!==e){let i=a[e],n=a[t];!0!==this.options.hideMiddleMarkers&&this._createMiddleMarker(i,n)}a.splice(o,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(e,n),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(t){let e=this._layer.getLatLngs(),i=t.getLatLng(),{indexPath:n,index:o,parentPath:s}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);(n.length>1?(0,Kn.default)(e,s):e).splice(o,1,i),this._layer.setLatLngs(e)},_getNeighborMarkers(t){let{indexPath:e,index:i,parentPath:n}=L.PM.Utils.findDeepMarkerIndex(this._markers,t),o=e.length>1?(0,Kn.default)(this._markers,n):this._markers,s=(i+1)%o.length;return{prevMarker:o[(i+(o.length-1))%o.length],nextMarker:o[s]}},_checkMarkerAllowedToDrag(t){let{prevMarker:e,nextMarker:i}=this._getNeighborMarkers(t),n=L.polyline([e.getLatLng(),t.getLatLng()]),o=L.polyline([t.getLatLng(),i.getLatLng()]),s=ai(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length,r=ai(this._layer.toGeoJSON(15),o.toGeoJSON(15)).features.length;return t.getLatLng()===this._markers[0][0].getLatLng()?r+=1:t.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(s+=1),!(s<=2&&r<=2)},_onMarkerDragStart(t){let e=t.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",t))return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDragStart(t,i),this.options.allowSelfIntersection||(this._coordsBeforeEdit=Se(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(e):this._markerAllowedToDrag=null},_onMarkerDrag(t){let e=t.target;if(!this._vertexValidationDrag(e))return;let{indexPath:i,index:n,parentPath:o}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);if(!i)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&!1===this._markerAllowedToDrag)return this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),void this._handleLayerStyle();this.updatePolygonCoordsFromMarkerDrag(e);let s=i.length>1?(0,Kn.default)(this._markers,o):this._markers,r=(n+1)%s.length,a=(n+(s.length-1))%s.length,l=e.getLatLng(),c=s[a].getLatLng(),h=s[r].getLatLng();if(e._middleMarkerNext){let t=L.PM.Utils.calcMiddleLatLng(this._map,l,h);e._middleMarkerNext.setLatLng(t)}if(e._middleMarkerPrev){let t=L.PM.Utils.calcMiddleLatLng(this._map,l,c);e._middleMarkerPrev.setLatLng(t)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(t,i),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(t){let e=t.target;if(!this._vertexValidationDragEnd(e))return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e),n=this.hasSelfIntersection();n&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(n=!1);let o=!this.options.allowSelfIntersection&&n;if(this._fireMarkerDragEnd(t,i,o),o)return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),void this._fireLayerReset(t,i);!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(t){let e=t.target;if(e._dragging)return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireVertexClick(t,i)}}),Yn.Polygon=Yn.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(t){let{prevMarker:e,nextMarker:i}=this._getNeighborMarkers(t),n=L.polyline([e.getLatLng(),t.getLatLng()]),o=L.polyline([t.getLatLng(),i.getLatLng()]),s=ai(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length,r=ai(this._layer.toGeoJSON(15),o.toGeoJSON(15)).features.length;return!(s<=2&&r<=2)}}),Yn.Rectangle=Yn.Polygon.extend({_shape:"Rectangle",_initMarkers(){let t=this._map,e=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup),this._markers=[],this._markers[0]=e.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach(((t,e)=>{let i=this._cornerMarkers.find((t=>t._index===e));i&&i.setLatLng(t)}))},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(t,e){let i=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(i,"vertexPane"),i._origLatLng=t,i._index=e,i._pmTempLayer=!0,i.on("click",this._onVertexClick,this),this._markerGroup.addLayer(i),i},_addMarkerEvents(){this._markers[0].forEach((t=>{t.on("dragstart",this._onMarkerDragStart,this),t.on("drag",this._onMarkerDrag,this),t.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||t.on("contextmenu",this._removeMarker,this)}))},_removeMarker:()=>null,_onMarkerDragStart(t){if(!this._vertexValidation("move",t))return;let e=t.target,i=this._cornerMarkers;e._oppositeCornerLatLng=i.find((t=>t._index===(e._index+2)%4)).getLatLng(),e._snapped=!1;let{indexPath:n}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDragStart(t,n)},_onMarkerDrag(t){let e=t.target;if(!this._vertexValidationDrag(e)||void 0===e._index)return;this._adjustRectangleForMarkerMove(e);let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDrag(t,i),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(t){let e=t.target;if(!this._vertexValidationDragEnd(e))return;this._cornerMarkers.forEach((t=>{delete t._oppositeCornerLatLng}));let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDragEnd(t,i),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(t){L.extend(t._origLatLng,t._latlng);let e=L.PM.Utils._getRotatedRectangle(t.getLatLng(),t._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(e),this._adjustAllMarkers(),this._layer.redraw()},_adjustAllMarkers(){let t=this._layer.getLatLngs()[0];t&&4!==t.length&&t.length>0?(t.forEach(((t,e)=>{this._cornerMarkers[e].setLatLng(t)})),this._cornerMarkers.slice(t.length).forEach((e=>{e.setLatLng(t[0])}))):t&&t.length?this._cornerMarkers.forEach((e=>{e.setLatLng(t[e._index])})):console.error("The layer has no LatLngs")},_findCorners(){void 0===this._angle&&this.setInitAngle(Te(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this.getAngle(),this._map||this)}}),Yn.CircleMarker=Yn.extend({_shape:"CircleMarker",initialize(t){this._layer=t,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(t={draggable:!0,snappable:!0}){L.Util.setOptions(this,t),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this.options.allowEditing&&this._layer._map?(this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()):this.disable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this.options[this._editableOption]?(this._helperLayers&&this._helperLayers.clearLayers(),this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this),this._centerMarker.on("move",this._moveCircle,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let t=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);let e=this._layer.getLatLng(),i=this._layer._radius,n=this._getLatLngOnCircle(e,i);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(n),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(t,e){let i=this._map.project(t),n=L.point(i.x+e,i.y);return this._map.unproject(n)},_createHintLine(t,e){let i=t.getLatLng(),n=e.getLatLng();this._hintline=L.polyline([i,n],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(t){let e=this._createMarker(t);return this.options.draggable?L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"):e.dragging.disable(),e},_createOuterMarker(t){let e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker(t){let e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),e.on("click",this._onVertexClick,this),this._helperLayers.addLayer(e),e},_moveCircle(t){if(t.target._cancelDragEventChain)return;let e=this._centerMarker.getLatLng();this._layer.setLatLng(e);let i=this._layer._radius,n=this._getLatLngOnCircle(e,i);this._outerMarker._latlng=n,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let t=this._layer.getLatLng(),e=this._layer._radius,i=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(i),this._centerMarker.setLatLng(t),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(i),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(t){this._vertexValidation("move",t)&&this._fireMarkerDragStart(t)},_onMarkerDrag(t){let e=t.target;e instanceof L.Marker&&!this._vertexValidationDrag(e)||this._fireMarkerDrag(t)},_onMarkerDragEnd(t){this._extedingMarkerDragEnd();let e=t.target;this._vertexValidationDragEnd(e)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(t))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let t=this._layer._map||this._map;if(t){let e=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),t,this._layer.getLatLng()),i=L.circle(this._layer.getLatLng(),this._layer.options);i.setRadius(e);let n=t&&t.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(i,200,!n).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(i,200,!n),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);return this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?e=Pe(this._map,t,e,this._getMinDistanceInMeter(t)):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(e=Pe(this._map,t,e,this._getMaxDistanceInMeter(t))),e},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);(this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]||this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption])&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(t,e){return this._map.project(t).distanceTo(this._map.project(e))},_getMinDistanceInMeter(t){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,t)},_getMaxDistanceInMeter(t){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,t)},_onVertexClick(t){t.target._dragging||this._fireVertexClick(t,void 0)}}),Yn.Circle=Yn.CircleMarker.extend({_shape:"Circle",initialize(t){this._layer=t,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizableCircle",this._updateHiddenPolyCircle()},enable(t){L.PM.Edit.CircleMarker.prototype.enable.call(this,t||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let t=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!t).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!t),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(t,e){return this._map.distance(t,e)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(t){t.target._dragging||this._fireVertexClick(t,void 0)}}),Yn.ImageOverlay=Yn.extend({_shape:"ImageOverlay",initialize(t){this._layer=t,this._enabled=!1},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},enabled(){return this._enabled},enable(t={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,t),this._map=this._layer._map,this._map){if(!this.options.allowEditing)return void this.disable();this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),Yn.Text=Yn.extend({_shape:"Text",initialize(t){this._layer=t,this._enabled=!1},enable(t){if(L.Util.setOptions(this,t),this.textArea){if(!this.options.allowEditing||!this._layer._map)return void this.disable();this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let t=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),t.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let t=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,e=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${t}px`,this.textArea.style.width=`${e}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout((()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)}),100)},_documentClick(t){t.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(t={}){let e=this._hasFocus;this._hasFocus="focus"===t.type,!e!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(t){this.textArea.value=t,this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let t=this.options.className.split(" ");this.textArea.classList.add(...t)}let t=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(t),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(t=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),!0===t&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(t){t.preventDefault()}});var Jn=function(t,e,i,n,o,s){this._matrix=[t,e,i,n,o,s]};Jn.init=()=>new L.PM.Matrix(1,0,0,1,0,0),Jn.prototype={transform(t){return this._transform(t.clone())},_transform(t){let e=this._matrix,{x:i,y:n}=t;return t.x=e[0]*i+e[1]*n+e[4],t.y=e[2]*i+e[3]*n+e[5],t},untransform(t){let e=this._matrix;return new L.Point((t.x/e[0]-e[4])/e[0],(t.y/e[2]-e[5])/e[2])},clone(){let t=this._matrix;return new L.PM.Matrix(t[0],t[1],t[2],t[3],t[4],t[5])},translate(t){if(void 0===t)return new L.Point(this._matrix[4],this._matrix[5]);let e,i;return"number"==typeof t?(e=t,i=t):(e=t.x,i=t.y),this._add(1,0,0,1,e,i)},scale(t,e){if(void 0===t)return new L.Point(this._matrix[0],this._matrix[3]);let i,n;return e=e||L.point(0,0),"number"==typeof t?(i=t,n=t):(i=t.x,n=t.y),this._add(i,0,0,n,e.x,e.y)._add(1,0,0,1,-e.x,-e.y)},rotate(t,e){let i=Math.cos(t),n=Math.sin(t);return e=e||new L.Point(0,0),this._add(i,n,-n,i,e.x,e.y)._add(1,0,0,1,-e.x,-e.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(t,e,i,n,o,s){let r,a=[[],[],[]],l=this._matrix,c=[[l[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]],h=[[t,i,o],[e,n,s],[0,0,1]];t&&t instanceof L.PM.Matrix&&(l=t._matrix,h=[[l[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]]);for(let t=0;t<3;t+=1)for(let e=0;e<3;e+=1){r=0;for(let i=0;i<3;i+=1)r+=c[t][i]*h[i][e];a[t][e]=r}return this._matrix=[a[0][0],a[1][0],a[0][1],a[1][1],a[0][2],a[1][2]],this}};var Qn=Jn,to={calcMiddleLatLng(t,e,i){let n=t.project(e),o=t.project(i);return t.unproject(n._add(o)._divideBy(2))},findLayers(t){let e=[];return t.eachLayer((t=>{(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle||t instanceof L.CircleMarker||t instanceof L.ImageOverlay)&&e.push(t)})),e=e.filter((t=>!!t.pm)),e=e.filter((t=>!t._pmTempLayer)),e=e.filter((t=>!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)),e},circleToPolygon(t,e=60,i=!0){let n=Ee(t.getLatLng(),t.getRadius(),e,0,i),o=[];for(let t=0;t<n.length;t+=1){let e=[n[t].lat,n[t].lng];o.push(e)}return L.polygon(o,t.options)},disablePopup(t){t.getPopup()&&(t._tempPopupCopy=t.getPopup(),t.unbindPopup())},enablePopup(t){t._tempPopupCopy&&(t.bindPopup(t._tempPopupCopy),delete t._tempPopupCopy)},_fireEvent(t,e,i,n=!1){t.fire(e,i,n);let{groups:o}=this.getAllParentGroups(t);o.forEach((t=>{t.fire(e,i,n)}))},getAllParentGroups(t){let e=[],i=[],n=t=>{for(let o in t._eventParents)if(-1===e.indexOf(o)){e.push(o);let s=t._eventParents[o];i.push(s),n(s)}};return!t._pmLastGroupFetch||!t._pmLastGroupFetch.time||(new Date).getTime()-t._pmLastGroupFetch.time>1e3?(n(t),t._pmLastGroupFetch={time:(new Date).getTime(),groups:i,groupIds:e},{groupIds:e,groups:i}):{groups:t._pmLastGroupFetch.groups,groupIds:t._pmLastGroupFetch.groupIds}},createGeodesicPolygon:Ee,getTranslation:xe,findDeepCoordIndex(t,e,i=!0){let n,o=t=>(s,r)=>{let a=t.concat(r);if(i){if(s.lat&&s.lat===e.lat&&s.lng===e.lng)return n=a,!0}else if(s.lat&&L.latLng(s).equals(e))return n=a,!0;return Array.isArray(s)&&s.some(o(a))};t.some(o([]));let s={};return n&&(s={indexPath:n,index:n[n.length-1],parentPath:n.slice(0,n.length-1)}),s},findDeepMarkerIndex(t,e){let i,n=t=>(o,s)=>{let r=t.concat(s);return o._leaflet_id===e._leaflet_id?(i=r,!0):Array.isArray(o)&&o.some(n(r))};t.some(n([]));let o={};return i&&(o={indexPath:i,index:i[i.length-1],parentPath:i.slice(0,i.length-1)}),o},_getIndexFromSegment(t,e){if(e&&2===e.length){let i=this.findDeepCoordIndex(t,e[0]),n=this.findDeepCoordIndex(t,e[1]),o=Math.max(i.index,n.index);return(0===i.index||0===n.index)&&1!==o&&(o+=1),{indexA:i,indexB:n,newIndex:o,indexPath:i.indexPath,parentPath:i.parentPath}}return null},_getRotatedRectangle(t,e,i,n){let o=Un(n,t),s=Un(n,e),r=i*Math.PI/180,a=Math.cos(r),l=Math.sin(r),c=(s.x-o.x)*a+(s.y-o.y)*l,h=(s.y-o.y)*a-(s.x-o.x)*l,u=c*a+o.x,d=c*l+o.y,p=-h*l+o.x,_=h*a+o.y;return[qn(n,o),qn(n,{x:u,y:d}),qn(n,s),qn(n,{x:p,y:_})]},pxRadiusToMeterRadius(t,e,i){let n=e.project(i),o=L.point(n.x+t,n.y);return e.distance(e.unproject(o),i)}};L.PM=L.PM||{version:"2.17.0",Map:Ie,Toolbar:Re,Draw:ze,Edit:Yn,Utils:to,Matrix:Qn,activeLang:"en",optIn:!1,initialize(t){this.addInitHooks(t)},setOptIn(t){this.optIn=!!t},addInitHooks(){L.Map.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})})),L.LayerGroup.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))})),L.Marker.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))})),L.CircleMarker.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))})),L.Polyline.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))})),L.Polygon.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))})),L.Rectangle.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))})),L.Circle.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))})),L.ImageOverlay.addInitHook((function(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}))},reInitLayer(t){t instanceof L.LayerGroup&&t.eachLayer((t=>{this.reInitLayer(t)})),t.pm||L.PM.optIn&&!1!==t.options.pmIgnore||t.options.pmIgnore||(t instanceof L.Map?t.pm=new L.PM.Map(t):t instanceof L.Marker?t.options.textMarker?(t.pm=new L.PM.Edit.Text(t),t.pm._initTextMarker(),t.pm._createTextMarker(!1)):t.pm=new L.PM.Edit.Marker(t):t instanceof L.Circle?t.pm=new L.PM.Edit.Circle(t):t instanceof L.CircleMarker?t.pm=new L.PM.Edit.CircleMarker(t):t instanceof L.Rectangle?t.pm=new L.PM.Edit.Rectangle(t):t instanceof L.Polygon?t.pm=new L.PM.Edit.Polygon(t):t instanceof L.Polyline?t.pm=new L.PM.Edit.Line(t):t instanceof L.LayerGroup?t.pm=new L.PM.Edit.LayerGroup(t):t instanceof L.ImageOverlay&&(t.pm=new L.PM.Edit.ImageOverlay(t)))}},"1.7.1"===L.version&&L.Canvas.include({_onClick(t){let e,i,n=this._map.mouseEventToLayerPoint(t);for(let o=this._drawFirst;o;o=o.next)e=o.layer,e.options.interactive&&e._containsPoint(n)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(i=e);i&&(L.DomEvent.fakeStop(t),this._fireEvent([i],t))}}),L.PM.initialize()})(),L.Map.mergeOptions({smoothWheelZoom:!0,smoothSensitivity:1}),L.Map.SmoothWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"wheel",this._onWheelScroll,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){this._isWheeling||this._onWheelStart(t),this._onWheeling(t)},_onWheelStart:function(t){var e=this._map;this._isWheeling=!0,this._wheelMousePosition=e.mouseEventToContainerPoint(t),this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),this._wheelStartLatLng=e.containerPointToLatLng(this._wheelMousePosition),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),e._panAnim&&e._panAnim.stop(),this._goalZoom=e.getZoom(),this._prevCenter=e.getCenter(),this._prevZoom=e.getZoom(),this._zoomAnimationId=requestAnimationFrame(this._updateWheelZoom.bind(this))},_onWheeling:function(t){var e=this._map;this._goalZoom=this._goalZoom+.003*L.DomEvent.getWheelDelta(t)*e.options.smoothSensitivity,(this._goalZoom<e.getMinZoom()||this._goalZoom>e.getMaxZoom())&&(this._goalZoom=e._limitZoom(this._goalZoom)),this._wheelMousePosition=this._map.mouseEventToContainerPoint(t),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(this._onWheelEnd.bind(this),200),L.DomEvent.preventDefault(t),L.DomEvent.stopPropagation(t)},_onWheelEnd:function(t){this._isWheeling=!1,cancelAnimationFrame(this._zoomAnimationId),this._map._moveEnd(!0)},_updateWheelZoom:function(){var t=this._map;if(t.getCenter().equals(this._prevCenter)&&t.getZoom()==this._prevZoom){this._zoom=t.getZoom()+.3*(this._goalZoom-t.getZoom());var e=this._wheelMousePosition.subtract(this._centerPoint);0===e.x&&0===e.y||("center"===t.options.smoothWheelZoom?this._center=this._startLatLng:this._center=t.unproject(t.project(this._wheelStartLatLng,this._zoom).subtract(e),this._zoom),this._moved||(t._moveStart(!0,!1),this._moved=!0),t._move(this._center,this._zoom),this._prevCenter=t.getCenter(),this._prevZoom=t.getZoom(),this._zoomAnimationId=requestAnimationFrame(this._updateWheelZoom.bind(this)))}}}),L.Map.addInitHook("addHandler","smoothWheelZoom",L.Map.SmoothWheelZoom),L.TileLayer.Canvas=L.TileLayer.extend({_delays:{},_delaysForZoom:null,createCanvas:function(t,e,i){let n;const o=t.getContext("2d"),{doubleSize:s}=this.options,{x:r,y:a}=this.getTileSize();t.width=s?2*r:r,t.height=s?2*a:a;const l=new Image;l.onload=()=>{try{o.drawImage(l,0,0),t.complete=!0}catch(t){n=t}finally{i(n,t)}};const c=this._getZoomForUrl();l.src=isNaN(c)?"":this.getTileUrl(e),l.crossOrigin=null},createTile:function(t,e){const{timeout:i}=this.options,{z:n}=t,o=document.createElement("canvas");return i?(n!==this._delaysForZoom&&(this._clearDelaysForZoom(),this._delaysForZoom=n),this._delays[n]||(this._delays[n]=[]),this._delays[n].push(setTimeout((()=>{this.createCanvas(o,t,e)}),i))):this.createCanvas(o,t,e),o},_clearDelaysForZoom:function(){const t=this._delaysForZoom,e=this._delays[t];e&&(e.forEach(((t,i)=>{clearTimeout(t),delete e[i]})),delete this._delays[t])}}),L.tileLayer.canvas=function(t,e){return new L.TileLayer.Canvas(t,e)},L.CanvasOverlay=L.Layer.extend({initialize:function(t,e){this._userDrawFunc=t,L.setOptions(this,e)},params:function(t){return L.setOptions(this,t),this},drawing:function(t){return this._userDrawFunc=t,this},canvas:function(){return this._canvas},redraw:function(){return this._frame||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this._canvas=L.DomUtil.create("canvas","leaflet-canvas-layer cellGrid");var e=this._map.getSize();this._canvas.width=e.x,this._canvas.height=e.y;var i=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(i?"animated":"hide")),t._panes.overlayPane.appendChild(this._canvas),t.on("move",this._reset,this),t.on("resize",this._resize,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._canvas),t.off("move",this._reset,this),t.off("resize",this._resize,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this),this._canvas=null},addTo:function(t){return t.addLayer(this),this},_resize:function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t),this._redraw()},_redraw:function(){var t=this._map.getSize(),e=this.options.bounds||this._map.getBounds(),i=180*t.x/(20037508.34*(e.getEast()-e.getWest())),n=this._map.getZoom();this._userDrawFunc&&this._userDrawFunc(this,{canvas:this._canvas,bounds:e,size:t,zoomScale:i,zoom:n,options:this.options}),this._frame=null},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil?.getTranslateString(i)+" scale("+e+")"}}),L.canvasOverlay=function(t,e){return new L.CanvasOverlay(t,e)},createCommonjsModule((function(t,e){!function(e,i){t.exports=e(leafletSrc),void 0!==i&&i.L&&!i.L.EdgeBuffer&&e(i.L)}((function(t){t.EdgeBuffer={previousMethods:{getTiledPixelBounds:t.GridLayer.prototype._getTiledPixelBounds}},t.GridLayer.include({_getTiledPixelBounds:function(e,i,n){var o=t.EdgeBuffer.previousMethods.getTiledPixelBounds.call(this,e,i,n),s=1;if(void 0!==this.options.edgeBufferTiles&&null!==this.options.edgeBufferTiles&&(s=this.options.edgeBufferTiles),s>0){var r=t.GridLayer.prototype.getTileSize.call(this).multiplyBy(s);o=new t.Bounds(o.min.subtract(r),o.max.add(r))}return o}})}),window)}));class MapState{constructor(t){this.pendingJump=t?.pendingJump??null,this.coords=t?.coords??this.pendingJump instanceof Location?this.pendingJump?.getCentre():null,this.world=(()=>{if(t?.world)return t.world;if(null==this.pendingJump)return gamemap.getWorldByID(MAPCONFIG.defaultWorldID||0);{let t=this.pendingJump;if(t instanceof Location)return gamemap.getWorldByID(t.worldID);if(t instanceof World)return t}})(),this.zoom=t?.zoom??(this.pendingJump instanceof Location?gamemap.getWorldByID(this.pendingJump?.worldID).maxZoomLevel:null),this.gridData=t?.gridData??null,this.layerIndex=t?.layerIndex??0,this.pendingSearch=null}getZoom(){return this.zoom}isGridEnabled(){return null!=this.gridData&&this.world.hasGrid()}isGridShown(){return null!=this.gridData?.gridShown}}let self$1,map,tileLayer,RC,gridLayer;class Gamemap{constructor(t,e,i){if(null==t){let e=document.createElement("div");e.id="gamemap",(null!=document.body.children[0]?document.body.children[0]:document.body).prepend(e),t=e}if(!e||!i)throw new Error("The gamemap was provided invalid/missing params.");if(this.mapConfig=e,this.mapCallbacks=i,this.mapRoot=t,self$1=this,this.mapConfig.hasCustomFavIcon&&changeFavIcon(e.iconPath+"favicon.png"),this.mapConfig.bgColor&&(t.style.backgroundColor=e.bgColor),this.mapConfig.hasCustomCSS){let t=e.assetsPath+"css/"+e.database+"-styles.css";print("Loading custom map css: "+t),injectCSS(t)}this.mapWorlds=new Map,this.gridEnabled=!1,this.mapLock=null,this.checkEditingPermissions(),this.getWorlds(e)}initialise(){var t={crs:leafletSrc.CRS.Simple,zoomSnap:!1,zoomDelta:.5,zoomControl:!1,boxZoom:!1,doubleClickZoom:!1,scrollWheelZoom:!1,smoothWheelZoom:!0,smoothSensitivity:.9,attributionControl:!1,renderer:leafletSrc.svg({padding:2})};map=leafletSrc.map(this.mapRoot.id,t),self$1.mapRoot.style.transition="background-color ease 100ms";let e=new MapState;this.hasURLParams()&&(e=this.getMapStateFromURL()),this.setMapState(e),this.bindMapEvents()}getMapState(){return this.mapState}async setMapState(t,e){if(print("Setting map state!"),print(t),e=e??!1,null!=tileLayer&&(tileLayer.remove(),e||this.clearLocations()),getURLParams().has("centeron")){print("pending centeron");try{let e=await this.getLocation(getURLParams().get("centeron"),getURLParams().has("world")?this.getWorld(getURLParams().get("world")):null);t.world=this.getWorldFromID(e.worldID),t.zoom=t.world.maxZoomLevel,t.pendingJump=e,t.coords=e.getCentre()}catch(e){t.pendingJump=null,print(e)}t.legacy=null}if(t.world=t.world?t.world:this.getWorldByID(MAPCONFIG.defaultWorldID),this.currentWorldID=t.world.id,RC=new RasterCoords(map,t.world.getWorldDimensions()),map.setMaxBounds(null),t.legacy){if(t.zoom=t.zoom&&t.zoom>t.world.maxZoomLevel?t.zoom-t.world.zoomOffset:t.zoom,MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED&&t.coords){let e=(t.coords.x-t.world.minX)/t.world.maxRangeX,i=Math.abs((t.coords.y-t.world.maxY)/t.world.maxRangeY);e=(e*nextPowerOfTwo(t.world.dbNumTilesX)/t.world.dbNumTilesX).toFixed(3),i=(i*nextPowerOfTwo(t.world.dbNumTilesY)/t.world.dbNumTilesY).toFixed(3),t.coords=new Point(e,i,MAPCONFIG.coordType)}t.legacy=!1}t.zoom=t.zoom?t.zoom:t.coords&&!t.zoom?t.world.maxZoomLevel:map.getBoundsZoom(RC.getMaxBounds()),t.coords=t.coords?t.coords:this.toCoords(RC.getMaxBounds().getCenter()),t.coords||t.zoom?map.setView(this.toLatLngs(t.coords),t.zoom,{animate:!1}):map.fitBounds(RC.getMaxBounds(),{animate:!1}),map.setMaxBounds(RC.getMaxBounds(130)),t.pendingJump instanceof World&&t.pendingJump.editing&&(this.edit(t.pendingJump),t.pendingJump=null),this.updateMapState(t);let i={noWrap:!0,bounds:RC.getMaxBounds(),errorTileUrl:IMAGES_DIR+"outofrange.png",minZoom:t.world.minZoomLevel,maxZoom:t.world.maxZoomLevel,edgeBufferTiles:2};tileLayer=isFirefox()?leafletSrc.tileLayer(this.getMapTileImageURL(t.world,t.layerIndex),i):tileLayer=leafletSrc.tileLayer.canvas(this.getMapTileImageURL(t.world,t.layerIndex),i),tileLayer.addTo(map),t.world.layers[t.layerIndex].bg_color&&(this.mapRoot.style.backgroundColor=t.world.layers[t.layerIndex].bg_color),e||(null==t.world.locations?this.getLocations(t.world.id):this.drawLocations(t.world.locations)),this.toggleGrid(t?.gridData)}getMapStateFromURL(){let t=new MapState;if(t.legacy=getURLParams().has("legacy"),getURLParams().has("world")&&(print(getURLParams().get("world")),t.world=this.getWorld(getURLParams().get("world"))),getURLParams().has("zoom")&&(t.zoom=Number(getURLParams().get("zoom"))),getURLParams().has("x")&&getURLParams().has("y")||getURLParams().has("locx")&&getURLParams().has("locy")){let e=Number(getURLParams().get("x")??getURLParams().get("locx")),i=Number(getURLParams().get("y")??getURLParams().get("locy"));t.coords=new Point(e,i,MAPCONFIG.coordType)}if(getURLParams().has("grid")&&(t.gridData=JSON.parse(decodeURIComponent(getURLParams().get("grid")))),getURLParams().has("cellresource")&&(t.cellResource=getURLParams().get("cellresource")),getURLParams().has("layer")){let e=getURLParams().get("layer");t.layerIndex=isNaN(parseInt(e))?this.getLayerIndexFromName(e,t.world.layers):parseInt(e)}return getURLParams().has("search")&&(t.pendingSearch=getURLParams().get("search")),t}updateMapState(t){t=t??this.getMapState();let e,i=Number(this.toCoords(map.getCenter()).x,MAPCONFIG.coordType).toFixed(3),n=Number(this.toCoords(map.getCenter()).y,MAPCONFIG.coordType).toFixed(3);t.coords=MAPCONFIG.coordType==COORD_TYPES.NORMALISED||MAPCONFIG.coordType==COORD_TYPES.PSEUDO_NORMALISED?[i,n]:[Math.floor(i),Math.floor(n)],t.zoom=parseFloat(map.getZoom().toFixed(3)),t.world=this.getWorldFromID(this.currentWorldID),this.mapState=t,e=location.href.includes("localhost")||window.location.href.includes("/"+MAPCONFIG.database+"/")?"?":MAPCONFIG.database+"/?",this.hasMultipleWorlds()&&(e+=`world=${t.world.name}&`),t.world.hasMultipleLayers()&&(e+=`layer=${t.world.layers[t.layerIndex]?.name}&`),e+=`x=${t.coords[0]}`,e+=`&y=${t.coords[1]}`,e+=`&zoom=${t.zoom}`,t?.gridData&&(e+=`&grid=${encodeURIComponent(JSON.stringify(t.gridData))}`),t?.pendingSearch&&(e+=`&search=${t.pendingSearch}`),self$1.mapCallbacks?.onMapStateChanged(t),distCjs.replaceState(t,document.title,e),window.dispatchEvent(new PopStateEvent("popstate"))}setMapLock(t){t&&t==MAPLOCK.FULL?(map.dragging.disable(),map.smoothWheelZoom.disable(),map.keyboard.disable(),this.mapRoot.classList.add("locked")):(map.dragging.enable(),map.smoothWheelZoom.enable(),map.keyboard.enable(),this.mapRoot.classList.remove("locked")),this.mapLock=t,this.mapCallbacks?.onMapLockChanged(this.mapLock)}getMapLock(){return this.mapLock}async edit(t){isNaN(t)||(t=t>0?this.getWorldByID(t):await this.getLocation(t));let e=t instanceof Location;t instanceof World&&t.id!=this.getCurrentWorldID()||e&&t.worldID!=this.getCurrentWorldID()?(t.editing=!0,self$1.mapState.pendingJump=t,self$1.setMapState(new MapState({pendingJump:t}))):(this.mapCallbacks?.edit(t),map.closePopup())}reset(t,e){!this.hasMultipleWorlds()||t?e?map.fitBounds(RC.getMaxBounds(e),{animate:!0}):map.fitBounds(RC.getMaxBounds(),{animate:!0}):this.goto(this.mapConfig.defaultWorldID)}setZoomTo(t){map.setZoom(t,{animate:!0})}hasURLParams(){return Array.from(getURLParams().values()).length>=1}isEmbedded(){return window.self!==window.top}getWorlds(t){if(!t)return this.mapWorlds;{let e={action:"get_worlds"};e.db=t.database,self$1.mapCallbacks?.setLoading("Loading worlds"),0==this.mapWorlds.size&&getJSON(GAME_DATA_SCRIPT+queryify(e)).then((e=>{print(e.worlds);let i=e.worlds;i.forEach((e=>{e.id>=t.minWorldID&&e.id<=t.maxWorldID&&e.name&&self$1.mapWorlds.set(e.id,new World(e))})),print(`Loaded ${i.length} worlds!`),print(i),self$1.initialise()})).catch((t=>{throw new Error(`Could not retrieve world data: ${t}`)}))}}isWorldValid(t){return t&&t>=0&&this.mapWorlds.has(t)}getCurrentWorld(){return this.getWorldFromID(this.currentWorldID)??this.getMapState()?.world??getWorldFromID(this.mapConfig.defaultWorldID)}getCurrentWorldID(){return this.currentWorldID??getCurrentWorld()?.id}getWorldByID(t){return this.getWorldFromID(t)}getWorldFromID(t){return this.mapWorlds.get(Number(t))}getWorldNameByID(t){return this.getWorldFromID(t)}getWorldNameFromID(t){return this.getWorldFromID(t)?.name}getWorldDisplayNameByID(t){return this.getWorldDisplayNameFromID(t)}getWorldDisplayNameFromID(t){return this.getWorldFromID(t)?.displayName}getWorldByName(t){return this.getWorldFromName(t)}getWorldFromName(t){return[...this.mapWorlds.values()].find((e=>e.name.toLowerCase()==t.toLowerCase()))}getWorldByDisplayName(t){return this.getWorldFromDisplayName(t)}getWorldFromDisplayName(t){return[...this.mapWorlds.values()].find((e=>e.displayName==t))}getWorld(t){if(t&&"undefined"!=t){let e=isNaN(parseInt(t))?this.getWorldFromName(t)??this.getWorldFromDisplayName(t):this.isWorldValid(t)?this.getWorldFromID(t):null;return e||(M.toast({html:"That world doesn't exist!"}),this.getWorldFromID(MAPCONFIG.defaultWorldID))}return this.getCurrentWorld()}hasMultipleWorlds(){return this.mapWorlds.size>1}updateWorld(t){this.getWorlds().set(t?.id,t),this.setMapState(this.getMapState(),!0)}deleteWorld(t){this.getWorlds()?.delete(t.id),this.goto(t.parentID??MAPCONFIG.defaultWorldID),getWorldLists()}getZoom(){return this.getCurrentZoom()}getCurrentZoom(){return map?map.getZoom():0}getMaxZoom(){return this.getCurrentWorld()?this.getCurrentWorld().maxZoomLevel:MAPCONFIG.maxZoomLevel}getMinZoom(){return this.getCurrentWorld()?this.getCurrentWorld().minZoomLevel:MAPCONFIG.minZoomLevel}async getLocation(t,e){if(null==t)return Promise.reject("Location identifier was null");this.mapCallbacks?.setLoading(!0);let i,n=!isNaN(t)||t instanceof Location,o=t instanceof String||"string"==typeof t,s=Math.abs(t?.id??t),r=o?t?.toLowerCase():null;if(print(`Getting info for location: ${t}`),e?i=e.getLocation(t):this.mapWorlds?.forEach((e=>{i=e.hasLocation(t)?e.getLocation(t):i})),i)return print("found cached location"),this.mapCallbacks?.setLoading(!1),Promise.resolve(i);if(!i){let i={action:"get_centeron",db:MAPCONFIG.database,centeron:n?s:r,world:e?.id??null},o=await getJSON(GAME_DATA_SCRIPT+queryify(i));if(o&&o.locations.length>0){print("Got location info!");let t=self$1.getWorldFromID(o?.locations[0]?.worldId),e=new Location(o.locations[0],t);return this.mapCallbacks?.setLoading(!1),Promise.resolve(e)}return M.toast({html:"That location doesn't exist!"}),this.mapCallbacks?.setLoading(!1),Promise.reject(`Location ${t} was invalid.`)}}addLocation(t){print("adding location..");let e=t==LOCTYPES.MARKER,i=e;this.setMapLock(e?MAPLOCK.PARTIAL_NEW_MARKER:t==LOCTYPES.AREA?MAPLOCK.PARTIAL_NEW_POLYGON:MAPLOCK.PARTIAL_NEW_LINE);let n=e?"Marker":t==LOCTYPES.AREA?"Polygon":"Line",o=e?"new_marker":"";if(map.pm.enableDraw(n,{markerStyle:{icon:this.getIcon(Math.min(...Array.from(MAPCONFIG.icons.keys()))),alt:o},continueDrawing:!1,tooltips:i}),e){let t=document.querySelectorAll(`[alt="${o}"]`)[0];if(t){t.removeAttribute("alt"),t.classList.add("editing"),print(t);let e=document.getElementById(t.getAttribute("aria-describedby"));e.classList.add("location-label","new-marker-label","editing"),e.innerText="New Marker"}}map.on("pm:create",(({shape:t,layer:e})=>{print(t),print(e);let i="Marker"==t;e.remove(),print(i);let n=new Location({locType:i?LOCTYPES.MARKER:"Polygon"==t?LOCTYPES.AREA:LOCTYPES.PATH,coords:self$1.toCoords(e.getCoordinates())},this.getCurrentWorld());this.getCurrentWorld()?.locations?.set(n.id,n),this.edit(n)}))}getLocations(t){if(self$1.clearLocations(),print("Getting locations..."),null==t||isNaN(t)||this.isWorldValid(t)&&(t=this.getWorldFromID(t)),!(null==t||null==t.id||t.id<0)){var e={action:"get_locs"};e.world=t.id,e.db=MAPCONFIG.database,getJSON(GAME_DATA_SCRIPT+queryify(e)).then((e=>{let i=e.locations,n=new Map;print(`Got ${e.locationCount} locations!`),print(i),i.forEach((e=>{e.id&&1==e.visible&&!e.description.includes("teleport dest")&&n.set(e.id,new Location(e,t))})),self$1.mapWorlds.get(t.id).locations=n,self$1.getCurrentWorldID()==t.id&&self$1.drawLocations(n)})).catch((t=>{throw new Error(`There was an error getting locations: ${t}`)}))}}deleteLocation(t){this.findMarkers(t).forEach((function(t){t.remove()}));let e=this.getCurrentWorld().locations;e?.delete(t.id)}updateLocation(t){let e=this.findMarkers(t);e.forEach((function(t){t.remove()})),map.closePopup(),this.getCurrentWorld().locations?.set(t?.id,t),e=this.getMarkers(t),e.forEach((function(t){t.addTo(map)})),t?.editing&&(t.revertID||(t.locType==LOCTYPES.MARKER?setTimeout((()=>{e[0].edit()}),0):e[0].edit()),e.forEach((function(t){t.setEditingEffect(!0)})))}clearLocations(){map.eachLayer((t=>{t._tiles||"cellGrid"==t.options.className||(t.off("resize move zoom"),t.remove())}))}drawLocations(t){this.clearLocations(),print("Loading initial locations..."),t.size>0&&(print("Adding location markers to map..."),t.forEach((t=>{if(t?.isVisible()){this.getMarkers(t).forEach((t=>{t.addTo(map)})),t.setWasVisible(!0);let e=this.mapState?.pendingJump;e instanceof Location&&e.id==t.id&&(this.mapState.pendingJump=null,this.gotoLocation(e))}}))),this.mapCallbacks?.onMapLoaded(!0),this.mapRoot.style.animation="none"}getMarkers(t){if(null==t||null==t.coords)return[];let e=null,i=t.coords,n=new leafletSrc.marker(this.toLatLngs(i[0]),{riseOnHover:!0});if(leafletSrc.Marker.prototype.options.icon=leafletSrc.icon({iconUrl:IMAGES_DIR+"transparent.png"}),t.isPolygon()){i=[];for(let e=0;e<t.coords.length;e++)i.push(this.toLatLngs(t.coords[e]));let o={noClip:!0,smoothFactor:2,fillColor:t.fillColour,color:t.strokeColour,fillOpacity:null,weight:t.strokeWidth};t.locType==LOCTYPES.AREA&&(n=new leafletSrc.polygon(i,o),t.hasIcon()&&(n.setIsIconPolygon(!0),e=t.getMarker())),t.locType==LOCTYPES.PATH&&(n=new leafletSrc.polyline(i,o))}else t.hasIcon()&&(n=t.getMarker());let o=[n,e].filter((t=>null!==t));return o.forEach((e=>{e.setLocation(t),t.hasLabel()&&!e.isIconPolygon()&&e.bindTooltip(t.name,t.getLabel()),e.once("add",(function(){e.on("mouseout",(function(){self$1.clearTooltips(),e.location.isPolygon()&&e._path&&this.setStyle({fillColor:t.fillColour,color:t.strokeColour,weight:t.strokeWidth})})),e.on("mouseover",(function(){let i=t.isPolygon()&&e._path;leafletSrc.tooltip(self$1.toLatLngs(t.getCentre()),{content:t.getTooltipContent(),sticky:!0,className:"location-tooltip"}).addTo(map),i&&this.setStyle({fillColor:t.fillColourHover,color:t.strokeColourHover,weight:t.strokeWidthHover})})),e.on("click",(t=>{let e=t.originalEvent.shiftKey,i=t.originalEvent.ctrlKey;self$1.mapLock&&!MAPLOCK.isPartialNoNew(self$1.mapLock)||self$1.onMarkerClicked(this,e,i)})),e.on("dblclick",(()=>{self$1.mapLock&&!MAPLOCK.isPartialNoNew(self$1.mapLock)||this.getLocation().isClickable()||self$1.onMarkerClicked(this,!0,!1)}))}))})),o}findMarkers(t){let e=[];return map.eachLayer((i=>{i?.location&&i.location?.id==t?.id&&e.push(i)})),e}goto(t){if(null==t)return;this.mapCallbacks?.setLoading(!0);let e=(t=t?isString(t)?parseInt(t):t:this.getCurrentWorldID())instanceof World||t.numTilesX||t>0,i=t instanceof Location||t.coords||t<0;e?this.gotoWorld(this.getWorld(t)):i&&this.gotoLocation(t)}gotoWorld(t,e){if(t=t instanceof World?t.id:t,print(t),self$1.isWorldValid(t))if(t==self$1.getCurrentWorldID())e?map.setView(self$1.toLatLngs(e),self$1.getCurrentWorld().maxZoomLevel):self$1.reset(!0),self$1.mapCallbacks?.setLoading(!1);else{self$1.clearLocations();let i=self$1.getWorldFromID(t);print(`Going to world... ${i.displayName} (${i.id});`),self$1.setMapState(new MapState({coords:e,world:i,pendingJump:i?.editing?i:null,layerIndex:0}))}else this.mapCallbacks?.setLoading(!1),print("Gamemap attempted to navigate to invalid world ID: "+t)}gotoLocation(t){print(`going to location: ${t}`),this.mapCallbacks?.setLoading(!0),this.mapState.pendingJump=null,this.getLocation(t).then((e=>{e.worldID==self$1.getCurrentWorldID()?(setTimeout((()=>{map.setZoom(self$1.getCurrentZoom()-1e-4,{animate:!1}),map.setView(self$1.toLatLngs(e.getCentre()),self$1.getCurrentWorld().maxZoomLevel,{animate:!0}),t?.editing?this.edit(e):e.openPopup()}),1),this.mapCallbacks?.setLoading(!1)):(self$1.mapState.pendingJump=e,self$1.setMapState(new MapState({pendingJump:e})))})).catch((t=>{print(t),self$1.mapCallbacks?.setLoading(!1)}))}getMapTileImageURL(t,e,i){isNaN(e)&&(e=this.getLayerIndexFromName(e));let n=i?"/zoom0/":"/zoom{z}/",o=i?"-0-0.jpg":"-{x}-{y}.jpg";return`${this.mapConfig.tileURL+t.name}/leaflet/${t.layers[e].name+n+t.name+o}`}setTileLayerTo(t){if(null!=t){let e;if(e=isNaN(t)?this.getLayerIndexFromName(t):t,e>-1&&e<this.getCurrentWorld().layers.length){let t=this.getMapState();print(t),t.layerIndex!=e&&(t.layerIndex=e,this.setMapState(t,!0))}else print.warn("TileLayer index was out of bounds.")}else print.error("Provided TileLayer was invalid.")}getCurrentTileLayerIndex(){return parseInt(this.getMapState().layerIndex)}getNextTileLayerIndex(){return this.getCurrentTileLayerIndex()+1==this.getMapState().world?.layers?.length?0:this.getCurrentTileLayerIndex()+1}getNextTileLayerName(){return this.getMapState().world?.layers[this.getNextTileLayerIndex()]?.name}getCurrentTileLayerName(){return this.getMapState().world?.layers[this.getCurrentTileLayerIndex()]?.name}getLayerIndexFromName(t,e){let i=null!=e?e:this.getCurrentWorld().layers;for(let[e]of Object.entries(i))if(i[e].name==t)return parseInt(e);return 0}toggleGrid(t){let e=t?.cellResourceData??this.getMapState()?.cellResourceData;t=null==t||0===Object.keys(t).length?null:{gridShown:t.gridShown??t.gridshown,cellResource:t.cellResource??t.cellresource,cellResourceData:t.cellResourceData};let i=t?.cellResource&&"none"!=t?.cellResource?t.cellResource:null,n=t?.gridShown,o=this.getMapState();if(t){let{cellResourceData:e,...i}=t;o.gridData=i}else o.gridData=null;o.cellResourceData=t?e:null,this.updateMapState(o),!i||e&&i==e?.resource||(this.mapCallbacks?.setLoading(!0),this.getCellResourceData(i).then((e=>{this.mapCallbacks?.setLoading(!1),o.isGridEnabled()&&(t.cellResourceData={resource:i,data:e},self$1.toggleGrid(t))})).catch((()=>this.mapCallbacks?.setLoading(!1)))),t?(gridLayer?.remove(),gridLayer=leafletSrc.canvasOverlay().params({bounds:RC.getMaxBounds(),className:"cellGrid",zoomAnimation:!0}).drawing((function(t,i){let o=i.canvas.getContext("2d");o.clearRect(0,0,i.size.x,i.size.y);let s=RC.getMaxBounds(),[r,a,l,c]=[map.layerPointToContainerPoint(map.latLngToLayerPoint(s.getNorthWest())).x,map.layerPointToContainerPoint(map.latLngToLayerPoint(s.getNorthEast())).x,map.layerPointToContainerPoint(map.latLngToLayerPoint(s.getNorthEast())).y,map.layerPointToContainerPoint(map.latLngToLayerPoint(s.getSouthEast())).y],[h,u]=[a-r,c-l],d=self$1.getCurrentWorld(),p=self$1.getCurrentZoom(),_=null!=self$1.mapConfig.cellSize?self$1.mapConfig.cellSize:Math.round(self$1.mapConfig.tileSize*Math.pow(2,Math.round(d.maxZoomLevel))/((d.maxX-d.minX)/d.cellSize)),m=_/Math.pow(2,Math.round(d.maxZoomLevel)-p)/u,f=d.getWorldDimensions().width/_,g=d.getWorldDimensions().height/_;for(let v=0;v<=f;v++)for(let b=0;b<=g;b++){let k=v*m,w=b*m,L=(y(k).x>=0||y(k).x<0&&y(k+m).x>=0)&&(y(w).y>=0||y(w).y<0&&y(w+m).y>=0)&&y(k).x<=window.innerWidth&&y(w).y<=window.innerHeight;if(n&&v==b&&(o.beginPath(),o.moveTo(y(0).x,y(w).y),o.lineTo(y(1).x,y(w).y),o.moveTo(y(k).x,y(0).y),o.lineTo(y(k).x,y(1).y),o.strokeStyle=o.strokeStyle=self$1.mapConfig.gridLineColour,o.lineWidth=self$1.mapConfig.gridLineWidth,o.stroke()),L){let $=e?.data;if($){let C=b<(v<$.length?$[v]:[]).length?$[v][b]:0;0!=C&&(C>0&&C<=2?x(self$1.mapConfig.cellResourceColours[0]):C>2&&C<=5?x(self$1.mapConfig.cellResourceColours[1]):C>5&&C<=10?x(self$1.mapConfig.cellResourceColours[2]):C>10&&C<=20?x(self$1.mapConfig.cellResourceColours[3]):C>20&&C<=50?x(self$1.mapConfig.cellResourceColours[4]):C>50&&x(self$1.mapConfig.cellResourceColours[5]))}if(n&&p>self$1.mapConfig.gridShowLabelZoom){let M=v+d.gridStart[0],E=-b+d.gridStart[1];E%5!=0&&M%5!=0||v==f||b==g||(x(self$1.mapConfig.gridLabelCellBgColour),E%5==0&&M%5==0&&(o.fillStyle=self$1.mapConfig.gridLabelColour,o.font="bold 13px Arial",o.fillText([M,E].join(", "),y(k).x,y(w+m).y)))}}function x(t){o.fillStyle=t,o.beginPath(),o.moveTo(y(k).x,y(w).y),o.lineTo(y(k+m).x,y(w).y),o.lineTo(y(k+m).x,y(w+m).y),o.lineTo(y(k).x,y(w+m).y),o.closePath(),o.fill()}}function y(t,e){return((e=null!=e?e:t)>4||e<-4)&&(e/=u),(t>4||t<-4)&&(t/=h),new Point(r+t*h,l+e*u)}})),gridLayer.addTo(map)):!t&&gridLayer&&(gridLayer.remove(),gridLayer=null)}async getCellResourceData(t){if(null!=t||""!=t){var e={action:"get_cellresource"};e.db=MAPCONFIG.database,e.worldid=this.getCurrentWorldID(),e.editorid=t;let i=(await getJSON(GAME_DATA_SCRIPT+queryify(e))).resources[0].data;for(let t in i)i[t]=i[t].reverse();return i}}getCoords(...t){return this.toCoords(...t)}toCoords(t,e){if(t=structuredClone(t),e=null!=e?e:t instanceof Point?t.coordType:this.mapConfig.coordType,null!=t.lat){let i=RC.project(t);if(e==COORD_TYPES.XY)return i;{let t=this.getCurrentWorld().getWorldDimensions();if(e==COORD_TYPES.NORMALISED||e==COORD_TYPES.PSEUDO_NORMALISED){let e=(i.x/t.width).toFixed(3),n=(i.y/t.height).toFixed(3);return new Point(e,n,COORD_TYPES.NORMALISED)}if(e==COORD_TYPES.WORLDSPACE){let e=i.x/t.width,n=1-i.y/t.height,o=Math.trunc(t.minX+(t.maxX-t.minX)*e),s=Math.trunc(t.minY+(t.maxY-t.minY)*n);return new Point(o,s,COORD_TYPES.WORLDSPACE)}}}else if(Array.isArray(t)){let e=[];return t.forEach((t=>{e.push(this.toCoords(t,this.mapConfig.coordType))})),e}}getLatLngs(...t){return this.toLatLngs(...t)}toLatLngs(t){if(((t=structuredClone(t))instanceof Point||t?.x)&&!Array.isArray(t))switch(t.coordType){default:case COORD_TYPES.XY:return RC.unproject([t.x,t.y]);case COORD_TYPES.NORMALISED:let e=Number(t.x)*this.getCurrentWorld().width,i=Number(t.y)*this.getCurrentWorld().height;return RC.unproject([e,i]);case COORD_TYPES.PSEUDO_NORMALISED:return t.coordType=COORD_TYPES.NORMALISED,this.toLatLngs(t);case COORD_TYPES.WORLDSPACE:let n=t.x,o=t.y;return n=(n-this.getCurrentWorld().minX)/this.getCurrentWorld().maxRangeX,o=Math.abs((o-this.getCurrentWorld().maxY)/this.getCurrentWorld().maxRangeY),this.toLatLngs(new Point(n,o,COORD_TYPES.NORMALISED))}else if(Array.isArray(t))if(t[0]?.x){if(1==t.length)return this.toLatLngs(t[0])}else if(t.length>1)return this.toLatLngs(new Point(0==t[0]?.001:t[0],0==t[1]?.001:t[1],this.mapConfig.coordType))}getMapObject(){return map}getMap(){return map}getMapConfig(){return this.mapConfig}getElement(){return this.mapRoot}canEdit(){return MAPCONFIG.editingEnabled}checkEditingPermissions(){let t={},e=this;t.action="get_perm",t.db=MAPCONFIG.database,this.mapCallbacks?.setLoading("Getting permissions"),getJSON(GAME_DATA_SCRIPT+queryify(t)).then((t=>{let i=t?.canEdit;MAPCONFIG.editingEnabled=!!i&&!e.isEmbedded(),MAPCONFIG.isAdmin=t.isAdmin,MAPCONFIG.hasAds=MAPCONFIG.adScriptName&&!MAPCONFIG.editingEnabled,e.mapCallbacks?.onPermissionsLoaded(MAPCONFIG.editingEnabled)}))}clearTooltips(){map.eachLayer((t=>{"location-tooltip"==t.options.className&&t.remove()}))}getIconByName(t){if(t=t?.trim()?.toLowerCase(),!MAPCONFIG.icons||""==t)return null;print(t);for(const[e,i]of MAPCONFIG.icons)if(print(e,i),t==i?.toLowerCase())return print("found it"),e}getIcon(t){let e=[MAPCONFIG.iconSize/2,MAPCONFIG.iconSize/2],i=MAPCONFIG.iconPath+t+".png";return leafletSrc.icon({iconUrl:i,iconAnchor:e,iconSize:[MAPCONFIG.iconSize,MAPCONFIG.iconSize]})}getZoomFromBounds(t){return map.getBoundsZoom(t,!1)}getMaxBoundsZoom(){return map.getBoundsZoom(this.getMaxMapBounds())}getMaxMapBounds(){return RC.getMaxBounds()}getViewBounds(){let t=this.toCoords(map.getBounds().getNorthWest()),e=this.toCoords(map.getBounds().getSouthEast()),i={};return i.minX=t.x,i.maxX=e.x,i.minY=this.mapConfig.coordType==COORD_TYPES.WORLDSPACE?e.y:t.y,i.maxY=this.mapConfig.coordType==COORD_TYPES.WORLDSPACE?t.y:e.y,i}bindMapEvents(){map.on("resize moveend zoomend",(function(){self$1.getCurrentWorld()?.locations?.forEach((t=>{let e=t?.isVisible()??!1;if(e!=(t?.getWasVisible()??!1)){if(e){self$1.getMarkers(t).forEach((function(t){t.addTo(map),!t.location.hasLabel()||t.location.hasIcon()&&t._path||t.bindTooltip(t.location.name,t.location.getLabel())}))}else self$1.findMarkers(t).forEach((t=>t.remove()));t.setWasVisible(e)}})),self$1.clearTooltips(),self$1.getMapState()&&(self$1.getMapState().isGridEnabled()&&self$1.toggleGrid(self$1.getMapState()?.gridData),self$1.updateMapState())})),map.on("contextmenu",(function(){null!=self$1.getMapState().world.parentID&&-1!=self$1.getMapState().world.parentID&&!self$1.mapLock&&self$1.hasMultipleWorlds()&&self$1.goto(self$1.getMapState().world.parentID)})),map.on("zoom",(function(){self$1.mapLock||"full"==self$1.mapLock||map.dragging.enable()})),map.on("mousemove mousedown",(function(t){let e=t.originalEvent?.target??t?.originalEvent?.explicitOriginalTarget??t?.sourceTarget?._container;self$1.mapLock==MAPLOCK.FULL||e!=self$1.mapRoot&&!e?.classList?.contains("leaflet-interactive")?(t?.originalEvent?.preventDefault(),map.dragging.disable()):map.dragging.enable()})),map.on("dblclick",(function(t){let e=t.originalEvent?.target??t?.originalEvent?.explicitOriginalTarget;e?.className?.includes&&e?.className?.includes("leaflet")&&!self$1.mapLock&&map.panTo(t.latlng,{animate:!0})}))}onMarkerClicked(t,e,i){print(t.location);let n=t.getLocation()?.isClickable()&&!this.mapLock;if(!n||e||i)e&&this.canEdit()?this.edit(t.location):e&&!i&&n||t.getLocation()?.editing||t.openPopup();else{let e=t.getLocation();null!=e&&(this.mapCallbacks?.setLoading(!0),e.destinationID>0?this.goto(e.destinationID):this.getLocation(e.destinationID).then((t=>self$1.goto(t))))}}}leafletSrc.Layer.include({location:null,element:null,editing:!1,isIconPoly:null,getLocation:function(){return this.location},getCentre:function(){return gamemap.toLatLngs(this.getLocation().getCentre())},getElement(){return this.element=this?._icon??this?._path},getTooltip(){return document.getElementById(this.getElement()?.getAttribute("aria-describedby"))},isIconPolygon(){return this.isIconPoly},isEditing(){return this.getElement()?.classList?.contains("editing")||this.editing},setLocation(t){this.location=t},setIsIconPolygon(t){this.isIconPoly=t},getCoordinates(){if(this.getLatLng)return[structuredClone(this.getLatLng())];if(this.getLatLngs){let t=structuredClone(this.getLatLngs());return t.length>1?t:t[0]}},setEditingEffect(t){t&&(this.getElement()?.classList?.add("editing"),setTimeout((()=>{this.getTooltip()?.classList?.add("editing")}),15),this.editing=t)},edit(){this.editing=!0,this.pm.enable({allowEditing:!0,snapDistance:self$1.mapConfig.markerSnapDistance,draggable:!0,preventMarkerRemoval:1==this.getCoordinates().length}),this.on("pm:drag",(()=>gamemap.clearTooltips())),this.on("pm:markerdragend pm:vertexremoved pm:edit",(t=>{"Marker"!=t.shape&&("Polygon"!=t.shape&&"Line"!=t.shape||"pm:markerdragend"!=t.type&&"pm:vertexremoved"!=t.type)||updateMarkerCoords(self$1.toCoords(t.layer.getCoordinates()))}))},openPopup(){print("making popup"),print(this),leafletSrc.popup(this.getCentre(),{content:this.getLocation().getPopupContent()}).openOn(map)}});const{window:window_1}=globals;function get_each_context(t,e,i){const n=t.slice();return n[46]=e[i][0],n[47]=e[i][1],n}function create_if_block_19(t){let e,i;return e=new MapChooser({}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_6(t){let e,i,n=t[16]&&create_if_block_7(t);return{c(){n&&n.c(),e=empty()},m(t,o){n&&n.m(t,o),insert(t,e,o),i=!0},p(t,i){t[16]?n?(n.p(t,i),65536&i[0]&&transition_in(n,1)):(n=create_if_block_7(t),n.c(),transition_in(n,1),n.m(e.parentNode,e)):n&&(group_outros(),transition_out(n,1,1,(()=>{n=null})),check_outros())},i(t){i||(transition_in(n),i=!0)},o(t){transition_out(n),i=!1},d(t){n&&n.d(t),t&&detach(e)}}}function create_if_block_7(t){let e,i,n,o,s=!t[15]?.isGridEnabled(),r=t[3]&&create_if_block_18(),a=t[5]&&create_if_block_10(t),l=s&&create_if_block_8(t);return{c(){r&&r.c(),e=space(),a&&a.c(),i=space(),l&&l.c(),n=empty()},m(t,s){r&&r.m(t,s),insert(t,e,s),a&&a.m(t,s),insert(t,i,s),l&&l.m(t,s),insert(t,n,s),o=!0},p(t,o){t[3]?r?8&o[0]&&transition_in(r,1):(r=create_if_block_18(),r.c(),transition_in(r,1),r.m(e.parentNode,e)):r&&(group_outros(),transition_out(r,1,1,(()=>{r=null})),check_outros()),t[5]?a?(a.p(t,o),32&o[0]&&transition_in(a,1)):(a=create_if_block_10(t),a.c(),transition_in(a,1),a.m(i.parentNode,i)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros()),32768&o[0]&&(s=!t[15]?.isGridEnabled()),s?l?(l.p(t,o),32768&o[0]&&transition_in(l,1)):(l=create_if_block_8(t),l.c(),transition_in(l,1),l.m(n.parentNode,n)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros())},i(t){o||(transition_in(r),transition_in(a),transition_in(l),o=!0)},o(t){transition_out(r),transition_out(a),transition_out(l),o=!1},d(t){r&&r.d(t),t&&detach(e),a&&a.d(t),t&&detach(i),l&&l.d(t),t&&detach(n)}}}function create_if_block_18(t){let e,i;return e=new ProgressBar({}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_10(t){let e,i,n=!t[10].isEmbedded(),o=n&&create_if_block_11(t);return{c(){o&&o.c(),e=empty()},m(t,n){o&&o.m(t,n),insert(t,e,n),i=!0},p(t,i){1024&i[0]&&(n=!t[10].isEmbedded()),n?o?(o.p(t,i),1024&i[0]&&transition_in(o,1)):(o=create_if_block_11(t),o.c(),transition_in(o,1),o.m(e.parentNode,e)):o&&(group_outros(),transition_out(o,1,1,(()=>{o=null})),check_outros())},i(t){i||(transition_in(o),i=!0)},o(t){transition_out(o),i=!1},d(t){o&&o.d(t),t&&detach(e)}}}function create_if_block_11(t){let e,i,n,o,s,r,a,l,c,h=t[15].world.hasLayerMenu();e=new ZoomWidget({props:{currentZoom:t[15]?.getZoom(),lock:t[14]}});let u={lock:t[14]};n=new SearchPane({props:u}),t[25](n);let d=h&&create_if_block_17(t);r=new IconBar({props:{$$slots:{secondary:[create_secondary_slot],primary:[create_primary_slot]},$$scope:{ctx:t}}});return l=new LocationList({props:{}}),t[31](l),l.$on("toggled",t[32]),{c(){create_component(e.$$.fragment),i=space(),create_component(n.$$.fragment),o=space(),d&&d.c(),s=space(),create_component(r.$$.fragment),a=space(),create_component(l.$$.fragment)},m(t,h){mount_component(e,t,h),insert(t,i,h),mount_component(n,t,h),insert(t,o,h),d&&d.m(t,h),insert(t,s,h),mount_component(r,t,h),insert(t,a,h),mount_component(l,t,h),c=!0},p(t,i){const o={};32768&i[0]&&(o.currentZoom=t[15]?.getZoom()),16384&i[0]&&(o.lock=t[14]),e.$set(o);const a={};16384&i[0]&&(a.lock=t[14]),n.$set(a),32768&i[0]&&(h=t[15].world.hasLayerMenu()),h?d?(d.p(t,i),32768&i[0]&&transition_in(d,1)):(d=create_if_block_17(t),d.c(),transition_in(d,1),d.m(s.parentNode,s)):d&&(group_outros(),transition_out(d,1,1,(()=>{d=null})),check_outros());const c={};1504897&i[0]|524288&i[1]&&(c.$$scope={dirty:i,ctx:t}),r.$set(c);l.$set({})},i(t){c||(transition_in(e.$$.fragment,t),transition_in(n.$$.fragment,t),transition_in(d),transition_in(r.$$.fragment,t),transition_in(l.$$.fragment,t),c=!0)},o(t){transition_out(e.$$.fragment,t),transition_out(n.$$.fragment,t),transition_out(d),transition_out(r.$$.fragment,t),transition_out(l.$$.fragment,t),c=!1},d(c){destroy_component(e,c),c&&detach(i),t[25](null),destroy_component(n,c),c&&detach(o),d&&d.d(c),c&&detach(s),destroy_component(r,c),c&&detach(a),t[31](null),destroy_component(l,c)}}}function create_if_block_17(t){let e,i;return e=new LayerSwitcher({props:{mapState:t[15],lock:t[14]}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};32768&i[0]&&(n.mapState=t[15]),16384&i[0]&&(n.lock=t[14]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_16(t){let e,i;return e=new IconButton({props:{icon:"edit",tooltip:"Toggle map editor",noMobile:"true",checked:t[13],lock:t[14]}}),e.$on("checked",t[29]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};8192&i[0]&&(n.checked=t[13]),16384&i[0]&&(n.lock=t[14]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_15(t){let e,i,n,o,s,r;return n=new Icon({props:{name:"help_outline"}}),{c(){e=element("li"),i=element("a"),create_component(n.$$.fragment),o=text("Help"),attr(i,"title","See help info"),attr(i,"href",s=t[9].helpURL),attr(i,"target","_blank"),attr(i,"rel","noopener noreferrer"),attr(e,"class","waves-effect")},m(t,s){insert(t,e,s),append(e,i),mount_component(n,i,null),append(i,o),r=!0},p(t,e){(!r||512&e[0]&&s!==(s=t[9].helpURL))&&attr(i,"href",s)},i(t){r||(transition_in(n.$$.fragment,t),r=!0)},o(t){transition_out(n.$$.fragment,t),r=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_if_block_14(t){let e,i,n,o,s,r;return n=new Icon({props:{name:"messenger_outline"}}),{c(){e=element("li"),i=element("a"),create_component(n.$$.fragment),o=text("Feedback"),attr(i,"href",s=t[9].feedbackURL),attr(i,"target","_blank"),attr(i,"rel","noopener noreferrer"),attr(i,"title","Tell us your thoughts"),attr(e,"class","waves-effect")},m(t,s){insert(t,e,s),append(e,i),mount_component(n,i,null),append(i,o),r=!0},p(t,e){(!r||512&e[0]&&s!==(s=t[9].feedbackURL))&&attr(i,"href",s)},i(t){r||(transition_in(n.$$.fragment,t),r=!0)},o(t){transition_out(n.$$.fragment,t),r=!1},d(t){t&&detach(e),destroy_component(n)}}}function create_default_slot_2(t){let e,i,n,o,s,r,a,l,c,h,u,d,p,_,m,f=t[7]?"Exit":"Fullscreen",g=t[9].helpURL&&create_if_block_15(t);s=new Icon({props:{name:"list"}});let y=t[9].feedbackURL&&create_if_block_14(t);return u=new Icon({props:{name:t[7]?"fullscreen_exit":"fullscreen"}}),{c(){e=element("ul"),g&&g.c(),i=space(),n=element("li"),o=element("a"),create_component(s.$$.fragment),r=text("Map Key"),a=space(),y&&y.c(),l=space(),c=element("li"),h=element("a"),create_component(u.$$.fragment),d=text(f),attr(o,"title","Show map key"),attr(n,"class","waves-effect"),attr(h,"id","fullscreen-toggle"),attr(h,"title","Toggle fullscreen mode"),attr(c,"class","waves-effect"),attr(e,"id","overflow-menu"),attr(e,"class","dropdown-content")},m(f,v){insert(f,e,v),g&&g.m(e,null),append(e,i),append(e,n),append(n,o),mount_component(s,o,null),append(o,r),append(e,a),y&&y.m(e,null),append(e,l),append(e,c),append(c,h),mount_component(u,h,null),append(h,d),p=!0,_||(m=[listen(o,"click",t[30]),listen(h,"click",t[23])],_=!0)},p(t,n){t[9].helpURL?g?(g.p(t,n),512&n[0]&&transition_in(g,1)):(g=create_if_block_15(t),g.c(),transition_in(g,1),g.m(e,i)):g&&(group_outros(),transition_out(g,1,1,(()=>{g=null})),check_outros()),t[9].feedbackURL?y?(y.p(t,n),512&n[0]&&transition_in(y,1)):(y=create_if_block_14(t),y.c(),transition_in(y,1),y.m(e,l)):y&&(group_outros(),transition_out(y,1,1,(()=>{y=null})),check_outros());const o={};128&n[0]&&(o.name=t[7]?"fullscreen_exit":"fullscreen"),u.$set(o),(!p||128&n[0])&&f!==(f=t[7]?"Exit":"Fullscreen")&&set_data(d,f)},i(t){p||(transition_in(g),transition_in(s.$$.fragment,t),transition_in(y),transition_in(u.$$.fragment,t),p=!0)},o(t){transition_out(g),transition_out(s.$$.fragment,t),transition_out(y),transition_out(u.$$.fragment,t),p=!1},d(t){t&&detach(e),g&&g.d(),destroy_component(s),y&&y.d(),destroy_component(u),_=!1,run_all(m)}}}function create_primary_slot(t){let e,i,n,o,s=t[0]&&create_if_block_16(t);return n=new IconButton({props:{icon:"more_vert",tooltip:"More actions",menu:"overflow-menu",lock:t[14],$$slots:{default:[create_default_slot_2]},$$scope:{ctx:t}}}),{c(){e=element("slot:template"),s&&s.c(),i=space(),create_component(n.$$.fragment),attr(e,"slot","primary")},m(t,r){insert(t,e,r),s&&s.m(e,null),append(e,i),mount_component(n,e,null),o=!0},p(t,o){t[0]?s?(s.p(t,o),1&o[0]&&transition_in(s,1)):(s=create_if_block_16(t),s.c(),transition_in(s,1),s.m(e,i)):s&&(group_outros(),transition_out(s,1,1,(()=>{s=null})),check_outros());const r={};16384&o[0]&&(r.lock=t[14]),1049216&o[0]|524288&o[1]&&(r.$$scope={dirty:o,ctx:t}),n.$set(r)},i(t){o||(transition_in(s),transition_in(n.$$.fragment,t),o=!0)},o(t){transition_out(s),transition_out(n.$$.fragment,t),o=!1},d(t){t&&detach(e),s&&s.d(),destroy_component(n)}}}function create_if_block_13(t){let e,i;return e=new IconButton({props:{icon:"explore",label:t[15].world.displayName,tooltip:"Show location list",dropdown:"true",lock:t[14],checked:t[18]}}),e.$on("checked",t[26]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};32768&i[0]&&(n.label=t[15].world.displayName),16384&i[0]&&(n.lock=t[14]),262144&i[0]&&(n.checked=t[18]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_12(t){let e,i;return e=new IconButton({props:{icon:"article",label:"Goto Article",tooltip:"Goto this map's article",lock:t[14]}}),e.$on("click",t[27]),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16384&i[0]&&(n.lock=t[14]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_secondary_slot(t){let e,i,n,o,s,r=t[10].hasMultipleWorlds(),a=r&&create_if_block_13(t),l=t[15].world.wikiPage&&create_if_block_12(t);return o=new IconButton({props:{icon:"link",label:"Copy Link",lock:t[14],tooltip:"Copy link to current map view"}}),o.$on("click",t[28]),{c(){e=element("slot:template"),a&&a.c(),i=space(),l&&l.c(),n=space(),create_component(o.$$.fragment),attr(e,"slot","secondary")},m(t,r){insert(t,e,r),a&&a.m(e,null),append(e,i),l&&l.m(e,null),append(e,n),mount_component(o,e,null),s=!0},p(t,s){1024&s[0]&&(r=t[10].hasMultipleWorlds()),r?a?(a.p(t,s),1024&s[0]&&transition_in(a,1)):(a=create_if_block_13(t),a.c(),transition_in(a,1),a.m(e,i)):a&&(group_outros(),transition_out(a,1,1,(()=>{a=null})),check_outros()),t[15].world.wikiPage?l?(l.p(t,s),32768&s[0]&&transition_in(l,1)):(l=create_if_block_12(t),l.c(),transition_in(l,1),l.m(e,n)):l&&(group_outros(),transition_out(l,1,1,(()=>{l=null})),check_outros());const c={};16384&s[0]&&(c.lock=t[14]),o.$set(c)},i(t){s||(transition_in(a),transition_in(l),transition_in(o.$$.fragment,t),s=!0)},o(t){transition_out(a),transition_out(l),transition_out(o.$$.fragment,t),s=!1},d(t){t&&detach(e),a&&a.d(),l&&l.d(),destroy_component(o)}}}function create_if_block_8(t){let e,i;return e=new LayerOptionsContainer({props:{config:t[9],$$slots:{ad:[create_ad_slot],default:[create_default_slot_1]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};512&i[0]&&(n.config=t[9]),17922&i[0]|524288&i[1]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_default_slot_1(t){let e,i;return e=new Infobar({props:{mapName:t[9].mapTitle,embedded:t[10].isEmbedded(),lock:t[14]}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};512&i[0]&&(n.mapName=t[9].mapTitle),1024&i[0]&&(n.embedded=t[10].isEmbedded()),16384&i[0]&&(n.lock=t[14]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_9(t){let e,i;return e=new AdComponent({}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_ad_slot(t){let e,i,n=t[9].hasAds&&!t[1]&&create_if_block_9();return{c(){e=element("slot:template"),n&&n.c(),attr(e,"slot","ad")},m(t,o){insert(t,e,o),n&&n.m(e,null),i=!0},p(t,i){t[9].hasAds&&!t[1]?n?514&i[0]&&transition_in(n,1):(n=create_if_block_9(),n.c(),transition_in(n,1),n.m(e,null)):n&&(group_outros(),transition_out(n,1,1,(()=>{n=null})),check_outros())},i(t){i||(transition_in(n),i=!0)},o(t){transition_out(n),i=!1},d(t){t&&detach(e),n&&n.d()}}}function create_if_block_5(t){let e,i;return e=new ErrorBox({props:{reason:t[8]}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};256&i[0]&&(n.reason=t[8]),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_4(t){let e,i;return e=new LoadingBox({props:{reason:t[4]+"..."}}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};16&i[0]&&(n.reason=t[4]+"..."),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_if_block_3(t){let e,i,n;function o(e){t[35](e)}let s={};return void 0!==t[13]&&(s.shown=t[13]),e=new Editor({props:s}),t[34](e),binding_callbacks.push((()=>bind(e,"shown",o))),{c(){create_component(e.$$.fragment)},m(t,i){mount_component(e,t,i),n=!0},p(t,n){const o={};!i&&8192&n[0]&&(i=!0,o.shown=t[13],add_flush_callback((()=>i=!1))),e.$set(o)},i(t){n||(transition_in(e.$$.fragment,t),n=!0)},o(t){transition_out(e.$$.fragment,t),n=!1},d(i){t[34](null),destroy_component(e,i)}}}function create_if_block_2(t){let e,i;return e=new Dialog({props:{title:"Map Key",fixedFooter:!0,cancel:"close",$$slots:{default:[create_default_slot]},$$scope:{ctx:t}}}),t[36](e),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},p(t,i){const n={};512&i[0]|524288&i[1]&&(n.$$scope={dirty:i,ctx:t}),e.$set(n)},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(i){t[36](null),destroy_component(e,i)}}}function create_each_block(t){let e,i,n,o,s,r,a,l,c,h=t[47]+"";return{c(){e=element("div"),i=element("img"),r=space(),a=element("b"),l=text(h),c=space(),attr(i,"title",n=t[47]),attr(i,"alt",o=t[47]),src_url_equal(i.src,s=t[9].iconPath+t[46]+".png")||attr(i,"src",s),attr(a,"class","left-align"),attr(e,"class","map_key_item left-align")},m(t,n){insert(t,e,n),append(e,i),append(e,r),append(e,a),append(a,l),append(e,c)},p(t,e){512&e[0]&&n!==(n=t[47])&&attr(i,"title",n),512&e[0]&&o!==(o=t[47])&&attr(i,"alt",o),512&e[0]&&!src_url_equal(i.src,s=t[9].iconPath+t[46]+".png")&&attr(i,"src",s),512&e[0]&&h!==(h=t[47]+"")&&set_data(l,h)},d(t){t&&detach(e)}}}function create_default_slot(t){let e,i=[...t[9].icons],n=[];for(let e=0;e<i.length;e+=1)n[e]=create_each_block(get_each_context(t,i,e));return{c(){e=element("div");for(let t=0;t<n.length;t+=1)n[t].c();attr(e,"id","map_key_container")},m(t,i){insert(t,e,i);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null)},p(t,o){if(512&o[0]){let s;for(i=[...t[9].icons],s=0;s<i.length;s+=1){const r=get_each_context(t,i,s);n[s]?n[s].p(r,o):(n[s]=create_each_block(r),n[s].c(),n[s].m(e,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=i.length}},d(t){t&&detach(e),destroy_each(n,t)}}}function create_if_block(t){let e,i;return e=new AdComponent({}),{c(){create_component(e.$$.fragment)},m(t,n){mount_component(e,t,n),i=!0},i(t){i||(transition_in(e.$$.fragment,t),i=!0)},o(t){transition_out(e.$$.fragment,t),i=!1},d(t){destroy_component(e,t)}}}function create_fragment(t){let e,i,n,o,s,r,a,l,c,h,u,d,p;add_render_callback(t[24]);let _=t[19]&&create_if_block_19(),m=t[10]&&create_if_block_6(t);const f=[create_if_block_4,create_if_block_5],g=[];function y(t,e){return t[5]||""==t[4]?t[6]?1:-1:0}~(o=y(t))&&(s=g[o]=f[o](t));let v=t[0]&&create_if_block_3(t),b=t[9]&&create_if_block_2(t),k=!1,w=t[1]&&t[9]?.hasAds&&create_if_block();return{c(){_&&_.c(),e=space(),i=element("div"),m&&m.c(),n=space(),s&&s.c(),r=space(),v&&v.c(),a=space(),b&&b.c(),l=space(),c=space(),w&&w.c(),h=empty(),attr(i,"id","gamemap")},m(s,f){_&&_.m(s,f),insert(s,e,f),insert(s,i,f),m&&m.m(i,null),t[33](i),insert(s,n,f),~o&&g[o].m(s,f),insert(s,r,f),v&&v.m(s,f),insert(s,a,f),b&&b.m(s,f),insert(s,l,f),insert(s,c,f),w&&w.m(s,f),insert(s,h,f),u=!0,d||(p=[listen(window_1,"keydown",t[22]),listen(window_1,"fullscreenchange",t[23]),listen(window_1,"resize",t[24])],d=!0)},p(t,n){t[19]?_?524288&n[0]&&transition_in(_,1):(_=create_if_block_19(),_.c(),transition_in(_,1),_.m(e.parentNode,e)):_&&(group_outros(),transition_out(_,1,1,(()=>{_=null})),check_outros()),t[10]?m?(m.p(t,n),1024&n[0]&&transition_in(m,1)):(m=create_if_block_6(t),m.c(),transition_in(m,1),m.m(i,null)):m&&(group_outros(),transition_out(m,1,1,(()=>{m=null})),check_outros());let c=o;o=y(t),o===c?~o&&g[o].p(t,n):(s&&(group_outros(),transition_out(g[c],1,1,(()=>{g[c]=null})),check_outros()),~o?(s=g[o],s?s.p(t,n):(s=g[o]=f[o](t),s.c()),transition_in(s,1),s.m(r.parentNode,r)):s=null),t[0]?v?(v.p(t,n),1&n[0]&&transition_in(v,1)):(v=create_if_block_3(t),v.c(),transition_in(v,1),v.m(a.parentNode,a)):v&&(group_outros(),transition_out(v,1,1,(()=>{v=null})),check_outros()),t[9]?b?(b.p(t,n),512&n[0]&&transition_in(b,1)):(b=create_if_block_2(t),b.c(),transition_in(b,1),b.m(l.parentNode,l)):b&&(group_outros(),transition_out(b,1,1,(()=>{b=null})),check_outros()),t[1]&&t[9]?.hasAds?w?514&n[0]&&transition_in(w,1):(w=create_if_block(),w.c(),transition_in(w,1),w.m(h.parentNode,h)):w&&(group_outros(),transition_out(w,1,1,(()=>{w=null})),check_outros())},i(t){u||(transition_in(_),transition_in(m),transition_in(s),transition_in(v),transition_in(b),transition_in(k),transition_in(w),u=!0)},o(t){transition_out(_),transition_out(m),transition_out(s),transition_out(v),transition_out(b),transition_out(k),transition_out(w),u=!1},d(s){_&&_.d(s),s&&detach(e),s&&detach(i),m&&m.d(),t[33](null),s&&detach(n),~o&&g[o].d(s),s&&detach(r),v&&v.d(s),s&&detach(a),b&&b.d(s),s&&detach(l),s&&detach(c),w&&w.d(s),s&&detach(h),d=!1,run_all(p)}}}function instance(t,e,i){print("Initialising app...");const n=document.getElementById("app"),o=new MutationObserver((function(){let t=document.querySelectorAll("[class*='svelte']");for(let e=0;e<t.length;e++){let i=t[e];L.DomEvent.disableScrollPropagation(i)}}));o.observe(n,{childList:!0,subtree:!0});let s,r,a,l,c,h,u=!0,d="",p=!1,_=!1,m=!1,f="",g=null,y=null,v=null,b=null,k=null,w=!0,x=!1,$=!1,C=!1,E=0;function T(t){i(15,a=t),function(t){document.title=g.mapTitle,y.hasMultipleWorlds()&&(document.title=t+" | "+document.title);document.title=document.title+(g.wikiName?` (${g?.wikiName})`:"")}(a.world.displayName),l?.dismiss(),i(5,p=!0),i(9,g=MAPCONFIG),setTimeout((()=>{a.pendingSearch&&(h.updateSearch(a.pendingSearch),i(15,a.pendingSearch=null,a),y.updateMapState(a))}))}function P(t){"boolean"==typeof t?(i(3,u=t),i(4,d="")):(i(3,u=!0),i(4,d=t),print(d+"..."))}function S(t){0==t?i(6,_=t):(P(!1),i(6,_=!0),i(8,f=t),print.error(t))}onMount((async()=>{var t=document.getElementsByTagName("noscript");for(let e=t.length-1;e>=0;e--)t[e].parentNode.removeChild(t[e]);setTimeout((function(){document.firstElementChild.style.zoom="reset",document.querySelector('meta[name="viewport"]').content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"}),location.toString().includes("dev")?1e4:0),P("Loading map"),null!=GAME&&GAME.toLowerCase().match(/^([a-z]+)/)?(print("Game parameter was: "+GAME),getJSON(DEFAULT_MAP_CONFIG_DIR).then((t=>{window.DEFAULT_MAP_CONFIG=t;let e=MAPS_DIR+GAME.toLowerCase()+"/config/"+GAME+"-"+MAP_CONFIG_FILENAME;P("Loading config"),print("Getting map config at "+MAP_CONFIG_DIR+"..."),getJSON(e).then((t=>{print("Imported map config successfully."),print("Merging with default map config..."),i(9,g=mergeObjects(DEFAULT_MAP_CONFIG,t)),i(9,g.hasAds=null!=g.adScriptName,g),i(9,g.assetsPath=MAP_ASSETS_DIR,g),i(9,g.iconPath=g.assetsPath+"icons/",g),i(9,g.db=g.database,g),i(9,g.tileURL=g.tileURLName?g.baseTileURL+g.tileURLName+"/":g.baseTileURL+g.database+"map/",g);let e=Object.entries(g.icons).map((([t,e])=>({[t]:e})));e.sort(((t,e)=>Object.values(t)[0].localeCompare(Object.values(e)[0],"en",{sensitivity:"base"}))),i(9,g.icons=new Map(e.map((t=>[Number(Object.keys(t)[0]),Object.values(t)[0]]))),g),print("Completed merged map config:"),print(g),window.MAPCONFIG=g,function(t){let e={onPermissionsLoaded:t=>{print("Editing permissions: "+t),i(0,b=t)},onMapLoaded:()=>P(!1),onMapLockChanged:t=>{i(14,k=t)},edit:t=>{s.edit(t)},onMapStateChanged:T,setLoading:P};window.gamemap=new Gamemap(v,t,e),i(10,y=window.gamemap)}(g)})).catch((t=>t.toString().includes("JSON.parse")?S("Provided game doesn't exist. Please check the URL."):S(`Could not load map: ${t}`)))})).catch((t=>S(`There was an error getting the default map config: ${t}`)))):(P(!1),i(19,$=!0))})),window.onunhandledrejection=t=>{C||S(t.reason)};return t.$$.update=()=>{if(7&t.$$.dirty[0]){i(1,C=E<=670||navigator.userAgent.match(/Mobi/)),window.isMobile=C,C?document.querySelector("#app").classList.add("mobile"):document.querySelector("#app").classList.remove("mobile");try{i(0,b=null!=MAPCONFIG?MAPCONFIG.editingEnabled&&!C:b)}catch(t){}}},[b,C,E,u,d,p,_,m,f,g,y,v,s,r,k,a,w,l,x,$,c,h,function(t){45==t.keyCode&&(i(16,w=!w),print("UI "+(w?"shown.":"hidden.")))},function(t){i(7,m=null!=document.fullscreenElement),"fullscreenchange"!=t.type?(m?document.exitFullscreen():document.documentElement.requestFullscreen(),i(7,m=null!=document.fullscreenElement)):"fullscreenchange"==t.type&&i(7,m=null!=document.fullscreenElement)},function(){i(2,E=window_1.innerWidth)},function(t){binding_callbacks[t?"unshift":"push"]((()=>{h=t,i(21,h)}))},()=>l.toggle(),()=>{print("Getting article link..."),window.open(a.world.getWikiLink())},()=>{print("Copying link to clipboard..."),M.toast({html:"Map link copied to clipboard!"}),navigator?.clipboard?.writeText(window.location)},t=>{t.detail.checked&&t.detail.shift?s.edit(y.getCurrentWorld()):s.show(t.detail.checked)},()=>c.show(),function(t){binding_callbacks[t?"unshift":"push"]((()=>{l=t,i(17,l)}))},t=>i(18,x=t.detail),function(t){binding_callbacks[t?"unshift":"push"]((()=>{v=t,i(11,v)}))},function(t){binding_callbacks[t?"unshift":"push"]((()=>{s=t,i(12,s)}))},function(t){r=t,i(13,r)},function(t){binding_callbacks[t?"unshift":"push"]((()=>{c=t,i(20,c)}))}]}class App extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{},null,[-1,-1])}}var mount=new App({target:document.querySelector("#app")});return mount}();
//# sourceMappingURL=bundle.js.map
